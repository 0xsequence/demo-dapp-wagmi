import{g as Eo,c as Vt,a as Ql,b as ge,d as Tm,w as Yl,r as Xl,f as Rc,t as Io,e as Nm,h as xi,V as Lm,M as Dm,N as ne,k as Fm,i as mc,j as $m,K as jm,A as Mm,q as qh,x as qm,H as zm,F as Um,l as zh,$ as Hm,p as Bm,J as km,u as Zn,m as Uh,X as Km,n as Vm,_ as Zl,o as Mr,I as Gm,s as Hh,v as gn,y as Ft,U as Qt,z as Ii,B as pr,C as Wm,D as yn,E as ef,G as Jm,L as Qm,O as Ym,P as tf,Q as Xm,R as rf,S as nf,T as mn,W as _c,Y as po,Z as bn,a0 as Zm,a1 as go,a2 as e_,a3 as t_,a4 as r_,a5 as i_,a6 as ao,a7 as n_,a8 as s_,a9 as tc,aa as Bh,ab as o_,ac as a_,ad as c_,ae as kh,af as u_,ag as h_,ah as l_,ai as f_,aj as p_,ak as d_,al as g_,am as Jn,an as sf,ao as rc,ap as y_,aq as v_,ar as m_}from"./index-5349c5c9.js";var Ac={exports:{}},_n=typeof Reflect=="object"?Reflect:null,Kh=_n&&typeof _n.apply=="function"?_n.apply:function(t,r,n){return Function.prototype.apply.call(t,r,n)},yo;_n&&typeof _n.ownKeys=="function"?yo=_n.ownKeys:Object.getOwnPropertySymbols?yo=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:yo=function(t){return Object.getOwnPropertyNames(t)};function __(a){console&&console.warn&&console.warn(a)}var of=Number.isNaN||function(t){return t!==t};function Ke(){Ke.init.call(this)}Ac.exports=Ke;Ac.exports.once=I_;Ke.EventEmitter=Ke;Ke.prototype._events=void 0;Ke.prototype._eventsCount=0;Ke.prototype._maxListeners=void 0;var Vh=10;function xo(a){if(typeof a!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof a)}Object.defineProperty(Ke,"defaultMaxListeners",{enumerable:!0,get:function(){return Vh},set:function(a){if(typeof a!="number"||a<0||of(a))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+a+".");Vh=a}});Ke.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Ke.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||of(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function af(a){return a._maxListeners===void 0?Ke.defaultMaxListeners:a._maxListeners}Ke.prototype.getMaxListeners=function(){return af(this)};Ke.prototype.emit=function(t){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var o=t==="error",h=this._events;if(h!==void 0)o=o&&h.error===void 0;else if(!o)return!1;if(o){var d;if(r.length>0&&(d=r[0]),d instanceof Error)throw d;var _=new Error("Unhandled error."+(d?" ("+d.message+")":""));throw _.context=d,_}var x=h[t];if(x===void 0)return!1;if(typeof x=="function")Kh(x,this,r);else for(var b=x.length,S=ff(x,b),n=0;n<b;++n)Kh(S[n],this,r);return!0};function cf(a,t,r,n){var o,h,d;if(xo(r),h=a._events,h===void 0?(h=a._events=Object.create(null),a._eventsCount=0):(h.newListener!==void 0&&(a.emit("newListener",t,r.listener?r.listener:r),h=a._events),d=h[t]),d===void 0)d=h[t]=r,++a._eventsCount;else if(typeof d=="function"?d=h[t]=n?[r,d]:[d,r]:n?d.unshift(r):d.push(r),o=af(a),o>0&&d.length>o&&!d.warned){d.warned=!0;var _=new Error("Possible EventEmitter memory leak detected. "+d.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");_.name="MaxListenersExceededWarning",_.emitter=a,_.type=t,_.count=d.length,__(_)}return a}Ke.prototype.addListener=function(t,r){return cf(this,t,r,!1)};Ke.prototype.on=Ke.prototype.addListener;Ke.prototype.prependListener=function(t,r){return cf(this,t,r,!0)};function w_(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function uf(a,t,r){var n={fired:!1,wrapFn:void 0,target:a,type:t,listener:r},o=w_.bind(n);return o.listener=r,n.wrapFn=o,o}Ke.prototype.once=function(t,r){return xo(r),this.on(t,uf(this,t,r)),this};Ke.prototype.prependOnceListener=function(t,r){return xo(r),this.prependListener(t,uf(this,t,r)),this};Ke.prototype.removeListener=function(t,r){var n,o,h,d,_;if(xo(r),o=this._events,o===void 0)return this;if(n=o[t],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete o[t],o.removeListener&&this.emit("removeListener",t,n.listener||r));else if(typeof n!="function"){for(h=-1,d=n.length-1;d>=0;d--)if(n[d]===r||n[d].listener===r){_=n[d].listener,h=d;break}if(h<0)return this;h===0?n.shift():b_(n,h),n.length===1&&(o[t]=n[0]),o.removeListener!==void 0&&this.emit("removeListener",t,_||r)}return this};Ke.prototype.off=Ke.prototype.removeListener;Ke.prototype.removeAllListeners=function(t){var r,n,o;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[t]),this;if(arguments.length===0){var h=Object.keys(n),d;for(o=0;o<h.length;++o)d=h[o],d!=="removeListener"&&this.removeAllListeners(d);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[t],typeof r=="function")this.removeListener(t,r);else if(r!==void 0)for(o=r.length-1;o>=0;o--)this.removeListener(t,r[o]);return this};function hf(a,t,r){var n=a._events;if(n===void 0)return[];var o=n[t];return o===void 0?[]:typeof o=="function"?r?[o.listener||o]:[o]:r?E_(o):ff(o,o.length)}Ke.prototype.listeners=function(t){return hf(this,t,!0)};Ke.prototype.rawListeners=function(t){return hf(this,t,!1)};Ke.listenerCount=function(a,t){return typeof a.listenerCount=="function"?a.listenerCount(t):lf.call(a,t)};Ke.prototype.listenerCount=lf;function lf(a){var t=this._events;if(t!==void 0){var r=t[a];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Ke.prototype.eventNames=function(){return this._eventsCount>0?yo(this._events):[]};function ff(a,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=a[n];return r}function b_(a,t){for(;t+1<a.length;t++)a[t]=a[t+1];a.pop()}function E_(a){for(var t=new Array(a.length),r=0;r<t.length;++r)t[r]=a[r].listener||a[r];return t}function I_(a,t){return new Promise(function(r,n){function o(d){a.removeListener(t,h),n(d)}function h(){typeof a.removeListener=="function"&&a.removeListener("error",o),r([].slice.call(arguments))}pf(a,t,h,{once:!0}),t!=="error"&&x_(a,o,{once:!0})})}function x_(a,t,r){typeof a.on=="function"&&pf(a,"error",t,r)}function pf(a,t,r,n){if(typeof a.on=="function")n.once?a.once(t,r):a.on(t,r);else if(typeof a.addEventListener=="function")a.addEventListener(t,function o(h){n.once&&a.removeEventListener(t,o),r(h)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof a)}var wr=Ac.exports;const Cc=Eo(wr),P_=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,S_=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,O_=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function R_(a,t){if(a==="__proto__"||a==="constructor"&&t&&typeof t=="object"&&"prototype"in t){A_(a);return}return t}function A_(a){console.warn(`[destr] Dropping "${a}" key to prevent prototype pollution.`)}function co(a,t={}){if(typeof a!="string")return a;const r=a.trim();if(a[0]==='"'&&a.at(-1)==='"'&&!a.includes("\\"))return r.slice(1,-1);if(r.length<=9){const n=r.toLowerCase();if(n==="true")return!0;if(n==="false")return!1;if(n==="undefined")return;if(n==="null")return null;if(n==="nan")return Number.NaN;if(n==="infinity")return Number.POSITIVE_INFINITY;if(n==="-infinity")return Number.NEGATIVE_INFINITY}if(!O_.test(a)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return a}try{if(P_.test(a)||S_.test(a)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(a,R_)}return JSON.parse(a)}catch(n){if(t.strict)throw n;return a}}function C_(a){return!a||typeof a.then!="function"?Promise.resolve(a):a}function Ht(a,...t){try{return C_(a(...t))}catch(r){return Promise.reject(r)}}function T_(a){const t=typeof a;return a===null||t!=="object"&&t!=="function"}function N_(a){const t=Object.getPrototypeOf(a);return!t||t.isPrototypeOf(Object)}function vo(a){if(T_(a))return String(a);if(N_(a)||Array.isArray(a))return JSON.stringify(a);if(typeof a.toJSON=="function")return vo(a.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function df(){if(typeof Buffer===void 0)throw new TypeError("[unstorage] Buffer is not supported!")}const wc="base64:";function L_(a){if(typeof a=="string")return a;df();const t=Buffer.from(a).toString("base64");return wc+t}function D_(a){return typeof a!="string"||!a.startsWith(wc)?a:(df(),Buffer.from(a.slice(wc.length),"base64"))}function fr(a){return a?a.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function F_(...a){return fr(a.join(":"))}function uo(a){return a=fr(a),a?a+":":""}const $_="memory",j_=()=>{const a=new Map;return{name:$_,options:{},hasItem(t){return a.has(t)},getItem(t){return a.get(t)??null},getItemRaw(t){return a.get(t)??null},setItem(t,r){a.set(t,r)},setItemRaw(t,r){a.set(t,r)},removeItem(t){a.delete(t)},getKeys(){return Array.from(a.keys())},clear(){a.clear()},dispose(){a.clear()}}};function M_(a={}){const t={mounts:{"":a.driver||j_()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=b=>{for(const S of t.mountpoints)if(b.startsWith(S))return{base:S,relativeKey:b.slice(S.length),driver:t.mounts[S]};return{base:"",relativeKey:b,driver:t.mounts[""]}},n=(b,S)=>t.mountpoints.filter(D=>D.startsWith(b)||S&&b.startsWith(D)).map(D=>({relativeBase:b.length>D.length?b.slice(D.length):void 0,mountpoint:D,driver:t.mounts[D]})),o=(b,S)=>{if(t.watching){S=fr(S);for(const D of t.watchListeners)D(b,S)}},h=async()=>{if(!t.watching){t.watching=!0;for(const b in t.mounts)t.unwatch[b]=await Gh(t.mounts[b],o,b)}},d=async()=>{if(t.watching){for(const b in t.unwatch)await t.unwatch[b]();t.unwatch={},t.watching=!1}},_=(b,S,D)=>{const M=new Map,K=F=>{let ee=M.get(F.base);return ee||(ee={driver:F.driver,base:F.base,items:[]},M.set(F.base,ee)),ee};for(const F of b){const ee=typeof F=="string",oe=fr(ee?F:F.key),he=ee?void 0:F.value,le=ee||!F.options?S:{...S,...F.options},fe=r(oe);K(fe).items.push({key:oe,value:he,relativeKey:fe.relativeKey,options:le})}return Promise.all([...M.values()].map(F=>D(F))).then(F=>F.flat())},x={hasItem(b,S={}){b=fr(b);const{relativeKey:D,driver:M}=r(b);return Ht(M.hasItem,D,S)},getItem(b,S={}){b=fr(b);const{relativeKey:D,driver:M}=r(b);return Ht(M.getItem,D,S).then(K=>co(K))},getItems(b,S){return _(b,S,D=>D.driver.getItems?Ht(D.driver.getItems,D.items.map(M=>({key:M.relativeKey,options:M.options})),S).then(M=>M.map(K=>({key:F_(D.base,K.key),value:co(K.value)}))):Promise.all(D.items.map(M=>Ht(D.driver.getItem,M.relativeKey,M.options).then(K=>({key:M.key,value:co(K)})))))},getItemRaw(b,S={}){b=fr(b);const{relativeKey:D,driver:M}=r(b);return M.getItemRaw?Ht(M.getItemRaw,D,S):Ht(M.getItem,D,S).then(K=>D_(K))},async setItem(b,S,D={}){if(S===void 0)return x.removeItem(b);b=fr(b);const{relativeKey:M,driver:K}=r(b);K.setItem&&(await Ht(K.setItem,M,vo(S),D),K.watch||o("update",b))},async setItems(b,S){await _(b,S,async D=>{D.driver.setItems&&await Ht(D.driver.setItems,D.items.map(M=>({key:M.relativeKey,value:vo(M.value),options:M.options})),S),D.driver.setItem&&await Promise.all(D.items.map(M=>Ht(D.driver.setItem,M.relativeKey,vo(M.value),M.options)))})},async setItemRaw(b,S,D={}){if(S===void 0)return x.removeItem(b,D);b=fr(b);const{relativeKey:M,driver:K}=r(b);if(K.setItemRaw)await Ht(K.setItemRaw,M,S,D);else if(K.setItem)await Ht(K.setItem,M,L_(S),D);else return;K.watch||o("update",b)},async removeItem(b,S={}){typeof S=="boolean"&&(S={removeMeta:S}),b=fr(b);const{relativeKey:D,driver:M}=r(b);M.removeItem&&(await Ht(M.removeItem,D,S),(S.removeMeta||S.removeMata)&&await Ht(M.removeItem,D+"$",S),M.watch||o("remove",b))},async getMeta(b,S={}){typeof S=="boolean"&&(S={nativeOnly:S}),b=fr(b);const{relativeKey:D,driver:M}=r(b),K=Object.create(null);if(M.getMeta&&Object.assign(K,await Ht(M.getMeta,D,S)),!S.nativeOnly){const F=await Ht(M.getItem,D+"$",S).then(ee=>co(ee));F&&typeof F=="object"&&(typeof F.atime=="string"&&(F.atime=new Date(F.atime)),typeof F.mtime=="string"&&(F.mtime=new Date(F.mtime)),Object.assign(K,F))}return K},setMeta(b,S,D={}){return this.setItem(b+"$",S,D)},removeMeta(b,S={}){return this.removeItem(b+"$",S)},async getKeys(b,S={}){b=uo(b);const D=n(b,!0);let M=[];const K=[];for(const F of D){const oe=(await Ht(F.driver.getKeys,F.relativeBase,S)).map(he=>F.mountpoint+fr(he)).filter(he=>!M.some(le=>he.startsWith(le)));K.push(...oe),M=[F.mountpoint,...M.filter(he=>!he.startsWith(F.mountpoint))]}return b?K.filter(F=>F.startsWith(b)&&!F.endsWith("$")):K.filter(F=>!F.endsWith("$"))},async clear(b,S={}){b=uo(b),await Promise.all(n(b,!1).map(async D=>{if(D.driver.clear)return Ht(D.driver.clear,D.relativeBase,S);if(D.driver.removeItem){const M=await D.driver.getKeys(D.relativeBase||"",S);return Promise.all(M.map(K=>D.driver.removeItem(K,S)))}}))},async dispose(){await Promise.all(Object.values(t.mounts).map(b=>Wh(b)))},async watch(b){return await h(),t.watchListeners.push(b),async()=>{t.watchListeners=t.watchListeners.filter(S=>S!==b),t.watchListeners.length===0&&await d()}},async unwatch(){t.watchListeners=[],await d()},mount(b,S){if(b=uo(b),b&&t.mounts[b])throw new Error(`already mounted at ${b}`);return b&&(t.mountpoints.push(b),t.mountpoints.sort((D,M)=>M.length-D.length)),t.mounts[b]=S,t.watching&&Promise.resolve(Gh(S,o,b)).then(D=>{t.unwatch[b]=D}).catch(console.error),x},async unmount(b,S=!0){b=uo(b),!(!b||!t.mounts[b])&&(t.watching&&b in t.unwatch&&(t.unwatch[b](),delete t.unwatch[b]),S&&await Wh(t.mounts[b]),t.mountpoints=t.mountpoints.filter(D=>D!==b),delete t.mounts[b])},getMount(b=""){b=fr(b)+":";const S=r(b);return{driver:S.driver,base:S.base}},getMounts(b="",S={}){return b=fr(b),n(b,S.parents).map(M=>({driver:M.driver,base:M.mountpoint}))}};return x}function Gh(a,t,r){return a.watch?a.watch((n,o)=>t(n,r+o)):()=>{}}async function Wh(a){typeof a.dispose=="function"&&await Ht(a.dispose)}function Ki(a){return new Promise((t,r)=>{a.oncomplete=a.onsuccess=()=>t(a.result),a.onabort=a.onerror=()=>r(a.error)})}function gf(a,t){const r=indexedDB.open(a);r.onupgradeneeded=()=>r.result.createObjectStore(t);const n=Ki(r);return(o,h)=>n.then(d=>h(d.transaction(t,o).objectStore(t)))}let ic;function es(){return ic||(ic=gf("keyval-store","keyval")),ic}function Jh(a,t=es()){return t("readonly",r=>Ki(r.get(a)))}function q_(a,t,r=es()){return r("readwrite",n=>(n.put(t,a),Ki(n.transaction)))}function z_(a,t=es()){return t("readwrite",r=>(r.delete(a),Ki(r.transaction)))}function U_(a=es()){return a("readwrite",t=>(t.clear(),Ki(t.transaction)))}function H_(a,t){return a.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},Ki(a.transaction)}function B_(a=es()){return a("readonly",t=>{if(t.getAllKeys)return Ki(t.getAllKeys());const r=[];return H_(t,n=>r.push(n.key)).then(()=>r)})}const k_=a=>JSON.stringify(a,(t,r)=>typeof r=="bigint"?r.toString()+"n":r),K_=a=>{const t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=a.replace(t,'$1"$2n"$3');return JSON.parse(r,(n,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function ts(a){if(typeof a!="string")throw new Error(`Cannot safe json parse value of type ${typeof a}`);try{return K_(a)}catch{return a}}function ki(a){return typeof a=="string"?a:k_(a)||""}const V_="idb-keyval";var G_=(a={})=>{const t=a.base&&a.base.length>0?`${a.base}:`:"",r=o=>t+o;let n;return a.dbName&&a.storeName&&(n=gf(a.dbName,a.storeName)),{name:V_,options:a,async hasItem(o){return!(typeof await Jh(r(o),n)>"u")},async getItem(o){return await Jh(r(o),n)??null},setItem(o,h){return q_(r(o),h,n)},removeItem(o){return z_(r(o),n)},getKeys(){return B_(n)},clear(){return U_(n)}}};const W_="WALLET_CONNECT_V2_INDEXED_DB",J_="keyvaluestorage";let Q_=class{constructor(){this.indexedDb=M_({driver:G_({dbName:W_,storeName:J_})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(t=>[t.key,t.value])}async getItem(t){const r=await this.indexedDb.getItem(t);if(r!==null)return r}async setItem(t,r){await this.indexedDb.setItem(t,ki(r))}async removeItem(t){await this.indexedDb.removeItem(t)}};var nc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},mo={exports:{}};(function(){let a;function t(){}a=t,a.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},a.prototype.setItem=function(r,n){this[r]=String(n)},a.prototype.removeItem=function(r){delete this[r]},a.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(n){r[n]=void 0,delete r[n]})},a.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},a.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof nc<"u"&&nc.localStorage?mo.exports=nc.localStorage:typeof window<"u"&&window.localStorage?mo.exports=window.localStorage:mo.exports=new t})();function Y_(a){var t;return[a[0],ts((t=a[1])!=null?t:"")]}class X_{constructor(){this.localStorage=mo.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(Y_)}async getItem(t){const r=this.localStorage.getItem(t);if(r!==null)return ts(r)}async setItem(t,r){this.localStorage.setItem(t,ki(r))}async removeItem(t){this.localStorage.removeItem(t)}}const Z_="wc_storage_version",Qh=1,e1=async(a,t,r)=>{const n=Z_,o=await t.getItem(n);if(o&&o>=Qh){r(t);return}const h=await a.getKeys();if(!h.length){r(t);return}const d=[];for(;h.length;){const _=h.shift();if(!_)continue;const x=_.toLowerCase();if(x.includes("wc@")||x.includes("walletconnect")||x.includes("wc_")||x.includes("wallet_connect")){const b=await a.getItem(_);await t.setItem(_,b),d.push(_)}}await t.setItem(n,Qh),r(t),t1(a,d)},t1=async(a,t)=>{t.length&&t.forEach(async r=>{await a.removeItem(r)})};let r1=class{constructor(){this.initialized=!1,this.setInitialized=r=>{this.storage=r,this.initialized=!0};const t=new X_;this.storage=t;try{const r=new Q_;e1(t,r,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(t){return await this.initialize(),this.storage.getItem(t)}async setItem(t,r){return await this.initialize(),this.storage.setItem(t,r)}async removeItem(t){return await this.initialize(),this.storage.removeItem(t)}async initialize(){this.initialized||await new Promise(t=>{const r=setInterval(()=>{this.initialized&&(clearInterval(r),t())},20)})}};var En={},yf={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(a){var t,r,n,o,h,d,_,x,b,S,D,M,K,F,ee,oe,he,le,fe,pe,de,U,Q;(function($){var ue=typeof Vt=="object"?Vt:typeof self=="object"?self:typeof this=="object"?this:{};$(g(ue,g(a.exports)));function g(m,w){return m!==ue&&(typeof Object.create=="function"?Object.defineProperty(m,"__esModule",{value:!0}):m.__esModule=!0),function(R,l){return m[R]=w?w(R,l):l}}})(function($){var ue=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,m){g.__proto__=m}||function(g,m){for(var w in m)m.hasOwnProperty(w)&&(g[w]=m[w])};t=function(g,m){ue(g,m);function w(){this.constructor=g}g.prototype=m===null?Object.create(m):(w.prototype=m.prototype,new w)},r=Object.assign||function(g){for(var m,w=1,R=arguments.length;w<R;w++){m=arguments[w];for(var l in m)Object.prototype.hasOwnProperty.call(m,l)&&(g[l]=m[l])}return g},n=function(g,m){var w={};for(var R in g)Object.prototype.hasOwnProperty.call(g,R)&&m.indexOf(R)<0&&(w[R]=g[R]);if(g!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,R=Object.getOwnPropertySymbols(g);l<R.length;l++)m.indexOf(R[l])<0&&Object.prototype.propertyIsEnumerable.call(g,R[l])&&(w[R[l]]=g[R[l]]);return w},o=function(g,m,w,R){var l=arguments.length,p=l<3?m:R===null?R=Object.getOwnPropertyDescriptor(m,w):R,N;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(g,m,w,R);else for(var V=g.length-1;V>=0;V--)(N=g[V])&&(p=(l<3?N(p):l>3?N(m,w,p):N(m,w))||p);return l>3&&p&&Object.defineProperty(m,w,p),p},h=function(g,m){return function(w,R){m(w,R,g)}},d=function(g,m){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(g,m)},_=function(g,m,w,R){function l(p){return p instanceof w?p:new w(function(N){N(p)})}return new(w||(w=Promise))(function(p,N){function V(q){try{P(R.next(q))}catch(X){N(X)}}function G(q){try{P(R.throw(q))}catch(X){N(X)}}function P(q){q.done?p(q.value):l(q.value).then(V,G)}P((R=R.apply(g,m||[])).next())})},x=function(g,m){var w={label:0,sent:function(){if(p[0]&1)throw p[1];return p[1]},trys:[],ops:[]},R,l,p,N;return N={next:V(0),throw:V(1),return:V(2)},typeof Symbol=="function"&&(N[Symbol.iterator]=function(){return this}),N;function V(P){return function(q){return G([P,q])}}function G(P){if(R)throw new TypeError("Generator is already executing.");for(;w;)try{if(R=1,l&&(p=P[0]&2?l.return:P[0]?l.throw||((p=l.return)&&p.call(l),0):l.next)&&!(p=p.call(l,P[1])).done)return p;switch(l=0,p&&(P=[P[0]&2,p.value]),P[0]){case 0:case 1:p=P;break;case 4:return w.label++,{value:P[1],done:!1};case 5:w.label++,l=P[1],P=[0];continue;case 7:P=w.ops.pop(),w.trys.pop();continue;default:if(p=w.trys,!(p=p.length>0&&p[p.length-1])&&(P[0]===6||P[0]===2)){w=0;continue}if(P[0]===3&&(!p||P[1]>p[0]&&P[1]<p[3])){w.label=P[1];break}if(P[0]===6&&w.label<p[1]){w.label=p[1],p=P;break}if(p&&w.label<p[2]){w.label=p[2],w.ops.push(P);break}p[2]&&w.ops.pop(),w.trys.pop();continue}P=m.call(g,w)}catch(q){P=[6,q],l=0}finally{R=p=0}if(P[0]&5)throw P[1];return{value:P[0]?P[1]:void 0,done:!0}}},Q=function(g,m,w,R){R===void 0&&(R=w),g[R]=m[w]},b=function(g,m){for(var w in g)w!=="default"&&!m.hasOwnProperty(w)&&(m[w]=g[w])},S=function(g){var m=typeof Symbol=="function"&&Symbol.iterator,w=m&&g[m],R=0;if(w)return w.call(g);if(g&&typeof g.length=="number")return{next:function(){return g&&R>=g.length&&(g=void 0),{value:g&&g[R++],done:!g}}};throw new TypeError(m?"Object is not iterable.":"Symbol.iterator is not defined.")},D=function(g,m){var w=typeof Symbol=="function"&&g[Symbol.iterator];if(!w)return g;var R=w.call(g),l,p=[],N;try{for(;(m===void 0||m-- >0)&&!(l=R.next()).done;)p.push(l.value)}catch(V){N={error:V}}finally{try{l&&!l.done&&(w=R.return)&&w.call(R)}finally{if(N)throw N.error}}return p},M=function(){for(var g=[],m=0;m<arguments.length;m++)g=g.concat(D(arguments[m]));return g},K=function(){for(var g=0,m=0,w=arguments.length;m<w;m++)g+=arguments[m].length;for(var R=Array(g),l=0,m=0;m<w;m++)for(var p=arguments[m],N=0,V=p.length;N<V;N++,l++)R[l]=p[N];return R},F=function(g){return this instanceof F?(this.v=g,this):new F(g)},ee=function(g,m,w){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var R=w.apply(g,m||[]),l,p=[];return l={},N("next"),N("throw"),N("return"),l[Symbol.asyncIterator]=function(){return this},l;function N(te){R[te]&&(l[te]=function(_e){return new Promise(function(lt,be){p.push([te,_e,lt,be])>1||V(te,_e)})})}function V(te,_e){try{G(R[te](_e))}catch(lt){X(p[0][3],lt)}}function G(te){te.value instanceof F?Promise.resolve(te.value.v).then(P,q):X(p[0][2],te)}function P(te){V("next",te)}function q(te){V("throw",te)}function X(te,_e){te(_e),p.shift(),p.length&&V(p[0][0],p[0][1])}},oe=function(g){var m,w;return m={},R("next"),R("throw",function(l){throw l}),R("return"),m[Symbol.iterator]=function(){return this},m;function R(l,p){m[l]=g[l]?function(N){return(w=!w)?{value:F(g[l](N)),done:l==="return"}:p?p(N):N}:p}},he=function(g){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var m=g[Symbol.asyncIterator],w;return m?m.call(g):(g=typeof S=="function"?S(g):g[Symbol.iterator](),w={},R("next"),R("throw"),R("return"),w[Symbol.asyncIterator]=function(){return this},w);function R(p){w[p]=g[p]&&function(N){return new Promise(function(V,G){N=g[p](N),l(V,G,N.done,N.value)})}}function l(p,N,V,G){Promise.resolve(G).then(function(P){p({value:P,done:V})},N)}},le=function(g,m){return Object.defineProperty?Object.defineProperty(g,"raw",{value:m}):g.raw=m,g},fe=function(g){if(g&&g.__esModule)return g;var m={};if(g!=null)for(var w in g)Object.hasOwnProperty.call(g,w)&&(m[w]=g[w]);return m.default=g,m},pe=function(g){return g&&g.__esModule?g:{default:g}},de=function(g,m){if(!m.has(g))throw new TypeError("attempted to get private field on non-instance");return m.get(g)},U=function(g,m,w){if(!m.has(g))throw new TypeError("attempted to set private field on non-instance");return m.set(g,w),w},$("__extends",t),$("__assign",r),$("__rest",n),$("__decorate",o),$("__param",h),$("__metadata",d),$("__awaiter",_),$("__generator",x),$("__exportStar",b),$("__createBinding",Q),$("__values",S),$("__read",D),$("__spread",M),$("__spreadArrays",K),$("__await",F),$("__asyncGenerator",ee),$("__asyncDelegator",oe),$("__asyncValues",he),$("__makeTemplateObject",le),$("__importStar",fe),$("__importDefault",pe),$("__classPrivateFieldGet",de),$("__classPrivateFieldSet",U)})})(yf);var Po=yf.exports,Hn={},sc={},Bn={};let Vi=class{};const i1=Object.freeze(Object.defineProperty({__proto__:null,IEvents:Vi},Symbol.toStringTag,{value:"Module"})),n1=Ql(i1);var Yh;function s1(){if(Yh)return Bn;Yh=1,Object.defineProperty(Bn,"__esModule",{value:!0}),Bn.IHeartBeat=void 0;const a=n1;class t extends a.IEvents{constructor(n){super()}}return Bn.IHeartBeat=t,Bn}var Xh;function vf(){return Xh||(Xh=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),Po.__exportStar(s1(),a)}(sc)),sc}var oc={},Hi={},Zh;function o1(){if(Zh)return Hi;Zh=1,Object.defineProperty(Hi,"__esModule",{value:!0}),Hi.HEARTBEAT_EVENTS=Hi.HEARTBEAT_INTERVAL=void 0;const a=ge;return Hi.HEARTBEAT_INTERVAL=a.FIVE_SECONDS,Hi.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Hi}var el;function mf(){return el||(el=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),Po.__exportStar(o1(),a)}(oc)),oc}var tl;function a1(){if(tl)return Hn;tl=1,Object.defineProperty(Hn,"__esModule",{value:!0}),Hn.HeartBeat=void 0;const a=Po,t=wr,r=ge,n=vf(),o=mf();class h extends n.IHeartBeat{constructor(_){super(_),this.events=new t.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=(_==null?void 0:_.interval)||o.HEARTBEAT_INTERVAL}static init(_){return a.__awaiter(this,void 0,void 0,function*(){const x=new h(_);return yield x.init(),x})}init(){return a.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(_,x){this.events.on(_,x)}once(_,x){this.events.once(_,x)}off(_,x){this.events.off(_,x)}removeListener(_,x){this.events.removeListener(_,x)}initialize(){return a.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return Hn.HeartBeat=h,Hn}(function(a){Object.defineProperty(a,"__esModule",{value:!0});const t=Po;t.__exportStar(a1(),a),t.__exportStar(vf(),a),t.__exportStar(mf(),a)})(En);var Ne={},_f={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(a){var t,r,n,o,h,d,_,x,b,S,D,M,K,F,ee,oe,he,le,fe,pe,de,U,Q;(function($){var ue=typeof Vt=="object"?Vt:typeof self=="object"?self:typeof this=="object"?this:{};$(g(ue,g(a.exports)));function g(m,w){return m!==ue&&(typeof Object.create=="function"?Object.defineProperty(m,"__esModule",{value:!0}):m.__esModule=!0),function(R,l){return m[R]=w?w(R,l):l}}})(function($){var ue=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,m){g.__proto__=m}||function(g,m){for(var w in m)m.hasOwnProperty(w)&&(g[w]=m[w])};t=function(g,m){ue(g,m);function w(){this.constructor=g}g.prototype=m===null?Object.create(m):(w.prototype=m.prototype,new w)},r=Object.assign||function(g){for(var m,w=1,R=arguments.length;w<R;w++){m=arguments[w];for(var l in m)Object.prototype.hasOwnProperty.call(m,l)&&(g[l]=m[l])}return g},n=function(g,m){var w={};for(var R in g)Object.prototype.hasOwnProperty.call(g,R)&&m.indexOf(R)<0&&(w[R]=g[R]);if(g!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,R=Object.getOwnPropertySymbols(g);l<R.length;l++)m.indexOf(R[l])<0&&Object.prototype.propertyIsEnumerable.call(g,R[l])&&(w[R[l]]=g[R[l]]);return w},o=function(g,m,w,R){var l=arguments.length,p=l<3?m:R===null?R=Object.getOwnPropertyDescriptor(m,w):R,N;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(g,m,w,R);else for(var V=g.length-1;V>=0;V--)(N=g[V])&&(p=(l<3?N(p):l>3?N(m,w,p):N(m,w))||p);return l>3&&p&&Object.defineProperty(m,w,p),p},h=function(g,m){return function(w,R){m(w,R,g)}},d=function(g,m){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(g,m)},_=function(g,m,w,R){function l(p){return p instanceof w?p:new w(function(N){N(p)})}return new(w||(w=Promise))(function(p,N){function V(q){try{P(R.next(q))}catch(X){N(X)}}function G(q){try{P(R.throw(q))}catch(X){N(X)}}function P(q){q.done?p(q.value):l(q.value).then(V,G)}P((R=R.apply(g,m||[])).next())})},x=function(g,m){var w={label:0,sent:function(){if(p[0]&1)throw p[1];return p[1]},trys:[],ops:[]},R,l,p,N;return N={next:V(0),throw:V(1),return:V(2)},typeof Symbol=="function"&&(N[Symbol.iterator]=function(){return this}),N;function V(P){return function(q){return G([P,q])}}function G(P){if(R)throw new TypeError("Generator is already executing.");for(;w;)try{if(R=1,l&&(p=P[0]&2?l.return:P[0]?l.throw||((p=l.return)&&p.call(l),0):l.next)&&!(p=p.call(l,P[1])).done)return p;switch(l=0,p&&(P=[P[0]&2,p.value]),P[0]){case 0:case 1:p=P;break;case 4:return w.label++,{value:P[1],done:!1};case 5:w.label++,l=P[1],P=[0];continue;case 7:P=w.ops.pop(),w.trys.pop();continue;default:if(p=w.trys,!(p=p.length>0&&p[p.length-1])&&(P[0]===6||P[0]===2)){w=0;continue}if(P[0]===3&&(!p||P[1]>p[0]&&P[1]<p[3])){w.label=P[1];break}if(P[0]===6&&w.label<p[1]){w.label=p[1],p=P;break}if(p&&w.label<p[2]){w.label=p[2],w.ops.push(P);break}p[2]&&w.ops.pop(),w.trys.pop();continue}P=m.call(g,w)}catch(q){P=[6,q],l=0}finally{R=p=0}if(P[0]&5)throw P[1];return{value:P[0]?P[1]:void 0,done:!0}}},Q=function(g,m,w,R){R===void 0&&(R=w),g[R]=m[w]},b=function(g,m){for(var w in g)w!=="default"&&!m.hasOwnProperty(w)&&(m[w]=g[w])},S=function(g){var m=typeof Symbol=="function"&&Symbol.iterator,w=m&&g[m],R=0;if(w)return w.call(g);if(g&&typeof g.length=="number")return{next:function(){return g&&R>=g.length&&(g=void 0),{value:g&&g[R++],done:!g}}};throw new TypeError(m?"Object is not iterable.":"Symbol.iterator is not defined.")},D=function(g,m){var w=typeof Symbol=="function"&&g[Symbol.iterator];if(!w)return g;var R=w.call(g),l,p=[],N;try{for(;(m===void 0||m-- >0)&&!(l=R.next()).done;)p.push(l.value)}catch(V){N={error:V}}finally{try{l&&!l.done&&(w=R.return)&&w.call(R)}finally{if(N)throw N.error}}return p},M=function(){for(var g=[],m=0;m<arguments.length;m++)g=g.concat(D(arguments[m]));return g},K=function(){for(var g=0,m=0,w=arguments.length;m<w;m++)g+=arguments[m].length;for(var R=Array(g),l=0,m=0;m<w;m++)for(var p=arguments[m],N=0,V=p.length;N<V;N++,l++)R[l]=p[N];return R},F=function(g){return this instanceof F?(this.v=g,this):new F(g)},ee=function(g,m,w){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var R=w.apply(g,m||[]),l,p=[];return l={},N("next"),N("throw"),N("return"),l[Symbol.asyncIterator]=function(){return this},l;function N(te){R[te]&&(l[te]=function(_e){return new Promise(function(lt,be){p.push([te,_e,lt,be])>1||V(te,_e)})})}function V(te,_e){try{G(R[te](_e))}catch(lt){X(p[0][3],lt)}}function G(te){te.value instanceof F?Promise.resolve(te.value.v).then(P,q):X(p[0][2],te)}function P(te){V("next",te)}function q(te){V("throw",te)}function X(te,_e){te(_e),p.shift(),p.length&&V(p[0][0],p[0][1])}},oe=function(g){var m,w;return m={},R("next"),R("throw",function(l){throw l}),R("return"),m[Symbol.iterator]=function(){return this},m;function R(l,p){m[l]=g[l]?function(N){return(w=!w)?{value:F(g[l](N)),done:l==="return"}:p?p(N):N}:p}},he=function(g){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var m=g[Symbol.asyncIterator],w;return m?m.call(g):(g=typeof S=="function"?S(g):g[Symbol.iterator](),w={},R("next"),R("throw"),R("return"),w[Symbol.asyncIterator]=function(){return this},w);function R(p){w[p]=g[p]&&function(N){return new Promise(function(V,G){N=g[p](N),l(V,G,N.done,N.value)})}}function l(p,N,V,G){Promise.resolve(G).then(function(P){p({value:P,done:V})},N)}},le=function(g,m){return Object.defineProperty?Object.defineProperty(g,"raw",{value:m}):g.raw=m,g},fe=function(g){if(g&&g.__esModule)return g;var m={};if(g!=null)for(var w in g)Object.hasOwnProperty.call(g,w)&&(m[w]=g[w]);return m.default=g,m},pe=function(g){return g&&g.__esModule?g:{default:g}},de=function(g,m){if(!m.has(g))throw new TypeError("attempted to get private field on non-instance");return m.get(g)},U=function(g,m,w){if(!m.has(g))throw new TypeError("attempted to set private field on non-instance");return m.set(g,w),w},$("__extends",t),$("__assign",r),$("__rest",n),$("__decorate",o),$("__param",h),$("__metadata",d),$("__awaiter",_),$("__generator",x),$("__exportStar",b),$("__createBinding",Q),$("__values",S),$("__read",D),$("__spread",M),$("__spreadArrays",K),$("__await",F),$("__asyncGenerator",ee),$("__asyncDelegator",oe),$("__asyncValues",he),$("__makeTemplateObject",le),$("__importStar",fe),$("__importDefault",pe),$("__classPrivateFieldGet",de),$("__classPrivateFieldSet",U)})})(_f);var c1=_f.exports,ac,rl;function u1(){if(rl)return ac;rl=1;function a(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}ac=t;function t(r,n,o){var h=o&&o.stringify||a,d=1;if(typeof r=="object"&&r!==null){var _=n.length+d;if(_===1)return r;var x=new Array(_);x[0]=h(r);for(var b=1;b<_;b++)x[b]=h(n[b]);return x.join(" ")}if(typeof r!="string")return r;var S=n.length;if(S===0)return r;for(var D="",M=1-d,K=-1,F=r&&r.length||0,ee=0;ee<F;){if(r.charCodeAt(ee)===37&&ee+1<F){switch(K=K>-1?K:0,r.charCodeAt(ee+1)){case 100:case 102:if(M>=S||n[M]==null)break;K<ee&&(D+=r.slice(K,ee)),D+=Number(n[M]),K=ee+2,ee++;break;case 105:if(M>=S||n[M]==null)break;K<ee&&(D+=r.slice(K,ee)),D+=Math.floor(Number(n[M])),K=ee+2,ee++;break;case 79:case 111:case 106:if(M>=S||n[M]===void 0)break;K<ee&&(D+=r.slice(K,ee));var oe=typeof n[M];if(oe==="string"){D+="'"+n[M]+"'",K=ee+2,ee++;break}if(oe==="function"){D+=n[M].name||"<anonymous>",K=ee+2,ee++;break}D+=h(n[M]),K=ee+2,ee++;break;case 115:if(M>=S)break;K<ee&&(D+=r.slice(K,ee)),D+=String(n[M]),K=ee+2,ee++;break;case 37:K<ee&&(D+=r.slice(K,ee)),D+="%",K=ee+2,ee++,M--;break}++M}++ee}return K===-1?r:(K<F&&(D+=r.slice(K)),D)}return ac}var cc,il;function h1(){if(il)return cc;il=1;const a=u1();cc=o;const t=de().console||{},r={mapHttpRequest:F,mapHttpResponse:F,wrapRequestSerializer:ee,wrapResponseSerializer:ee,wrapErrorSerializer:ee,req:F,res:F,err:M};function n(U,Q){return Array.isArray(U)?U.filter(function(ue){return ue!=="!stdSerializers.err"}):U===!0?Object.keys(Q):!1}function o(U){U=U||{},U.browser=U.browser||{};const Q=U.browser.transmit;if(Q&&typeof Q.send!="function")throw Error("pino: transmit option must have a send function");const $=U.browser.write||t;U.browser.write&&(U.browser.asObject=!0);const ue=U.serializers||{},g=n(U.browser.serialize,ue);let m=U.browser.serialize;Array.isArray(U.browser.serialize)&&U.browser.serialize.indexOf("!stdSerializers.err")>-1&&(m=!1);const w=["error","fatal","warn","info","debug","trace"];typeof $=="function"&&($.error=$.fatal=$.warn=$.info=$.debug=$.trace=$),U.enabled===!1&&(U.level="silent");const R=U.level||"info",l=Object.create($);l.log||(l.log=oe),Object.defineProperty(l,"levelVal",{get:N}),Object.defineProperty(l,"level",{get:V,set:G});const p={transmit:Q,serialize:g,asObject:U.browser.asObject,levels:w,timestamp:K(U)};l.levels=o.levels,l.level=R,l.setMaxListeners=l.getMaxListeners=l.emit=l.addListener=l.on=l.prependListener=l.once=l.prependOnceListener=l.removeListener=l.removeAllListeners=l.listeners=l.listenerCount=l.eventNames=l.write=l.flush=oe,l.serializers=ue,l._serialize=g,l._stdErrSerialize=m,l.child=P,Q&&(l._logEvent=D());function N(){return this.level==="silent"?1/0:this.levels.values[this.level]}function V(){return this._level}function G(q){if(q!=="silent"&&!this.levels.values[q])throw Error("unknown level "+q);this._level=q,h(p,l,"error","log"),h(p,l,"fatal","error"),h(p,l,"warn","error"),h(p,l,"info","log"),h(p,l,"debug","log"),h(p,l,"trace","log")}function P(q,X){if(!q)throw new Error("missing bindings for child Pino");X=X||{},g&&q.serializers&&(X.serializers=q.serializers);const te=X.serializers;if(g&&te){var _e=Object.assign({},ue,te),lt=U.browser.serialize===!0?Object.keys(_e):g;delete q.serializers,x([q],lt,_e,this._stdErrSerialize)}function be(Pt){this._childLevel=(Pt._childLevel|0)+1,this.error=b(Pt,q,"error"),this.fatal=b(Pt,q,"fatal"),this.warn=b(Pt,q,"warn"),this.info=b(Pt,q,"info"),this.debug=b(Pt,q,"debug"),this.trace=b(Pt,q,"trace"),_e&&(this.serializers=_e,this._serialize=lt),Q&&(this._logEvent=D([].concat(Pt._logEvent.bindings,q)))}return be.prototype=this,new be(this)}return l}o.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},o.stdSerializers=r,o.stdTimeFunctions=Object.assign({},{nullTime:he,epochTime:le,unixTime:fe,isoTime:pe});function h(U,Q,$,ue){const g=Object.getPrototypeOf(Q);Q[$]=Q.levelVal>Q.levels.values[$]?oe:g[$]?g[$]:t[$]||t[ue]||oe,d(U,Q,$)}function d(U,Q,$){!U.transmit&&Q[$]===oe||(Q[$]=function(ue){return function(){const m=U.timestamp(),w=new Array(arguments.length),R=Object.getPrototypeOf&&Object.getPrototypeOf(this)===t?t:this;for(var l=0;l<w.length;l++)w[l]=arguments[l];if(U.serialize&&!U.asObject&&x(w,this._serialize,this.serializers,this._stdErrSerialize),U.asObject?ue.call(R,_(this,$,w,m)):ue.apply(R,w),U.transmit){const p=U.transmit.level||Q.level,N=o.levels.values[p],V=o.levels.values[$];if(V<N)return;S(this,{ts:m,methodLevel:$,methodValue:V,transmitLevel:p,transmitValue:o.levels.values[U.transmit.level||Q.level],send:U.transmit.send,val:Q.levelVal},w)}}}(Q[$]))}function _(U,Q,$,ue){U._serialize&&x($,U._serialize,U.serializers,U._stdErrSerialize);const g=$.slice();let m=g[0];const w={};ue&&(w.time=ue),w.level=o.levels.values[Q];let R=(U._childLevel|0)+1;if(R<1&&(R=1),m!==null&&typeof m=="object"){for(;R--&&typeof g[0]=="object";)Object.assign(w,g.shift());m=g.length?a(g.shift(),g):void 0}else typeof m=="string"&&(m=a(g.shift(),g));return m!==void 0&&(w.msg=m),w}function x(U,Q,$,ue){for(const g in U)if(ue&&U[g]instanceof Error)U[g]=o.stdSerializers.err(U[g]);else if(typeof U[g]=="object"&&!Array.isArray(U[g]))for(const m in U[g])Q&&Q.indexOf(m)>-1&&m in $&&(U[g][m]=$[m](U[g][m]))}function b(U,Q,$){return function(){const ue=new Array(1+arguments.length);ue[0]=Q;for(var g=1;g<ue.length;g++)ue[g]=arguments[g-1];return U[$].apply(this,ue)}}function S(U,Q,$){const ue=Q.send,g=Q.ts,m=Q.methodLevel,w=Q.methodValue,R=Q.val,l=U._logEvent.bindings;x($,U._serialize||Object.keys(U.serializers),U.serializers,U._stdErrSerialize===void 0?!0:U._stdErrSerialize),U._logEvent.ts=g,U._logEvent.messages=$.filter(function(p){return l.indexOf(p)===-1}),U._logEvent.level.label=m,U._logEvent.level.value=w,ue(m,U._logEvent,R),U._logEvent=D(l)}function D(U){return{ts:0,messages:[],bindings:U||[],level:{label:"",value:0}}}function M(U){const Q={type:U.constructor.name,msg:U.message,stack:U.stack};for(const $ in U)Q[$]===void 0&&(Q[$]=U[$]);return Q}function K(U){return typeof U.timestamp=="function"?U.timestamp:U.timestamp===!1?he:le}function F(){return{}}function ee(U){return U}function oe(){}function he(){return!1}function le(){return Date.now()}function fe(){return Math.round(Date.now()/1e3)}function pe(){return new Date(Date.now()).toISOString()}function de(){function U(Q){return typeof Q<"u"&&Q}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return U(self)||U(window)||U(this)||{}}}return cc}var Bi={},nl;function wf(){return nl||(nl=1,Object.defineProperty(Bi,"__esModule",{value:!0}),Bi.PINO_CUSTOM_CONTEXT_KEY=Bi.PINO_LOGGER_DEFAULTS=void 0,Bi.PINO_LOGGER_DEFAULTS={level:"info"},Bi.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Bi}var nr={},sl;function l1(){if(sl)return nr;sl=1,Object.defineProperty(nr,"__esModule",{value:!0}),nr.generateChildLogger=nr.formatChildLoggerContext=nr.getLoggerContext=nr.setBrowserLoggerContext=nr.getBrowserLoggerContext=nr.getDefaultLoggerOptions=void 0;const a=wf();function t(_){return Object.assign(Object.assign({},_),{level:(_==null?void 0:_.level)||a.PINO_LOGGER_DEFAULTS.level})}nr.getDefaultLoggerOptions=t;function r(_,x=a.PINO_CUSTOM_CONTEXT_KEY){return _[x]||""}nr.getBrowserLoggerContext=r;function n(_,x,b=a.PINO_CUSTOM_CONTEXT_KEY){return _[b]=x,_}nr.setBrowserLoggerContext=n;function o(_,x=a.PINO_CUSTOM_CONTEXT_KEY){let b="";return typeof _.bindings>"u"?b=r(_,x):b=_.bindings().context||"",b}nr.getLoggerContext=o;function h(_,x,b=a.PINO_CUSTOM_CONTEXT_KEY){const S=o(_,b);return S.trim()?`${S}/${x}`:x}nr.formatChildLoggerContext=h;function d(_,x,b=a.PINO_CUSTOM_CONTEXT_KEY){const S=h(_,x,b),D=_.child({context:S});return n(D,S,b)}return nr.generateChildLogger=d,nr}(function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.pino=void 0;const t=c1,r=t.__importDefault(h1());Object.defineProperty(a,"pino",{enumerable:!0,get:function(){return r.default}}),t.__exportStar(wf(),a),t.__exportStar(l1(),a)})(Ne);class f1 extends Vi{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}}let p1=class extends Vi{constructor(t,r){super(),this.core=t,this.logger=r,this.records=new Map}},d1=class{constructor(t,r){this.logger=t,this.core=r}},g1=class extends Vi{constructor(t,r){super(),this.relayer=t,this.logger=r}},y1=class extends Vi{constructor(t){super()}},v1=class{constructor(t,r,n,o){this.core=t,this.logger=r,this.name=n}};class m1 extends Vi{constructor(t,r){super(),this.relayer=t,this.logger=r}}let _1=class extends Vi{constructor(t,r){super(),this.core=t,this.logger=r}},w1=class{constructor(t,r){this.projectId=t,this.logger=r}},b1=class{constructor(t,r){this.projectId=t,this.logger=r}},E1=class{constructor(t){this.opts=t,this.protocol="wc",this.version=2}},I1=class{constructor(t){this.client=t}};var Tc={},bf={};(function(a){Object.defineProperty(a,"__esModule",{value:!0});var t=Tm,r=Yl;a.DIGEST_LENGTH=64,a.BLOCK_SIZE=128;var n=function(){function _(){this.digestLength=a.DIGEST_LENGTH,this.blockSize=a.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return _.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},_.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},_.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},_.prototype.update=function(x,b){if(b===void 0&&(b=x.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var S=0;if(this._bytesHashed+=b,this._bufferLength>0){for(;this._bufferLength<a.BLOCK_SIZE&&b>0;)this._buffer[this._bufferLength++]=x[S++],b--;this._bufferLength===this.blockSize&&(h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(b>=this.blockSize&&(S=h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,x,S,b),b%=this.blockSize);b>0;)this._buffer[this._bufferLength++]=x[S++],b--;return this},_.prototype.finish=function(x){if(!this._finished){var b=this._bytesHashed,S=this._bufferLength,D=b/536870912|0,M=b<<3,K=b%128<112?128:256;this._buffer[S]=128;for(var F=S+1;F<K-8;F++)this._buffer[F]=0;t.writeUint32BE(D,this._buffer,K-8),t.writeUint32BE(M,this._buffer,K-4),h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,K),this._finished=!0}for(var F=0;F<this.digestLength/8;F++)t.writeUint32BE(this._stateHi[F],x,F*8),t.writeUint32BE(this._stateLo[F],x,F*8+4);return this},_.prototype.digest=function(){var x=new Uint8Array(this.digestLength);return this.finish(x),x},_.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},_.prototype.restoreState=function(x){return this._stateHi.set(x.stateHi),this._stateLo.set(x.stateLo),this._bufferLength=x.bufferLength,x.buffer&&this._buffer.set(x.buffer),this._bytesHashed=x.bytesHashed,this._finished=!1,this},_.prototype.cleanSavedState=function(x){r.wipe(x.stateHi),r.wipe(x.stateLo),x.buffer&&r.wipe(x.buffer),x.bufferLength=0,x.bytesHashed=0},_}();a.SHA512=n;var o=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function h(_,x,b,S,D,M,K){for(var F=b[0],ee=b[1],oe=b[2],he=b[3],le=b[4],fe=b[5],pe=b[6],de=b[7],U=S[0],Q=S[1],$=S[2],ue=S[3],g=S[4],m=S[5],w=S[6],R=S[7],l,p,N,V,G,P,q,X;K>=128;){for(var te=0;te<16;te++){var _e=8*te+M;_[te]=t.readUint32BE(D,_e),x[te]=t.readUint32BE(D,_e+4)}for(var te=0;te<80;te++){var lt=F,be=ee,Pt=oe,B=he,H=le,j=fe,u=pe,A=de,ae=U,we=Q,Se=$,Fe=ue,je=g,Ce=m,St=w,wt=R;if(l=de,p=R,G=p&65535,P=p>>>16,q=l&65535,X=l>>>16,l=(le>>>14|g<<32-14)^(le>>>18|g<<32-18)^(g>>>41-32|le<<32-(41-32)),p=(g>>>14|le<<32-14)^(g>>>18|le<<32-18)^(le>>>41-32|g<<32-(41-32)),G+=p&65535,P+=p>>>16,q+=l&65535,X+=l>>>16,l=le&fe^~le&pe,p=g&m^~g&w,G+=p&65535,P+=p>>>16,q+=l&65535,X+=l>>>16,l=o[te*2],p=o[te*2+1],G+=p&65535,P+=p>>>16,q+=l&65535,X+=l>>>16,l=_[te%16],p=x[te%16],G+=p&65535,P+=p>>>16,q+=l&65535,X+=l>>>16,P+=G>>>16,q+=P>>>16,X+=q>>>16,N=q&65535|X<<16,V=G&65535|P<<16,l=N,p=V,G=p&65535,P=p>>>16,q=l&65535,X=l>>>16,l=(F>>>28|U<<32-28)^(U>>>34-32|F<<32-(34-32))^(U>>>39-32|F<<32-(39-32)),p=(U>>>28|F<<32-28)^(F>>>34-32|U<<32-(34-32))^(F>>>39-32|U<<32-(39-32)),G+=p&65535,P+=p>>>16,q+=l&65535,X+=l>>>16,l=F&ee^F&oe^ee&oe,p=U&Q^U&$^Q&$,G+=p&65535,P+=p>>>16,q+=l&65535,X+=l>>>16,P+=G>>>16,q+=P>>>16,X+=q>>>16,A=q&65535|X<<16,wt=G&65535|P<<16,l=B,p=Fe,G=p&65535,P=p>>>16,q=l&65535,X=l>>>16,l=N,p=V,G+=p&65535,P+=p>>>16,q+=l&65535,X+=l>>>16,P+=G>>>16,q+=P>>>16,X+=q>>>16,B=q&65535|X<<16,Fe=G&65535|P<<16,ee=lt,oe=be,he=Pt,le=B,fe=H,pe=j,de=u,F=A,Q=ae,$=we,ue=Se,g=Fe,m=je,w=Ce,R=St,U=wt,te%16===15)for(var _e=0;_e<16;_e++)l=_[_e],p=x[_e],G=p&65535,P=p>>>16,q=l&65535,X=l>>>16,l=_[(_e+9)%16],p=x[(_e+9)%16],G+=p&65535,P+=p>>>16,q+=l&65535,X+=l>>>16,N=_[(_e+1)%16],V=x[(_e+1)%16],l=(N>>>1|V<<32-1)^(N>>>8|V<<32-8)^N>>>7,p=(V>>>1|N<<32-1)^(V>>>8|N<<32-8)^(V>>>7|N<<32-7),G+=p&65535,P+=p>>>16,q+=l&65535,X+=l>>>16,N=_[(_e+14)%16],V=x[(_e+14)%16],l=(N>>>19|V<<32-19)^(V>>>61-32|N<<32-(61-32))^N>>>6,p=(V>>>19|N<<32-19)^(N>>>61-32|V<<32-(61-32))^(V>>>6|N<<32-6),G+=p&65535,P+=p>>>16,q+=l&65535,X+=l>>>16,P+=G>>>16,q+=P>>>16,X+=q>>>16,_[_e]=q&65535|X<<16,x[_e]=G&65535|P<<16}l=F,p=U,G=p&65535,P=p>>>16,q=l&65535,X=l>>>16,l=b[0],p=S[0],G+=p&65535,P+=p>>>16,q+=l&65535,X+=l>>>16,P+=G>>>16,q+=P>>>16,X+=q>>>16,b[0]=F=q&65535|X<<16,S[0]=U=G&65535|P<<16,l=ee,p=Q,G=p&65535,P=p>>>16,q=l&65535,X=l>>>16,l=b[1],p=S[1],G+=p&65535,P+=p>>>16,q+=l&65535,X+=l>>>16,P+=G>>>16,q+=P>>>16,X+=q>>>16,b[1]=ee=q&65535|X<<16,S[1]=Q=G&65535|P<<16,l=oe,p=$,G=p&65535,P=p>>>16,q=l&65535,X=l>>>16,l=b[2],p=S[2],G+=p&65535,P+=p>>>16,q+=l&65535,X+=l>>>16,P+=G>>>16,q+=P>>>16,X+=q>>>16,b[2]=oe=q&65535|X<<16,S[2]=$=G&65535|P<<16,l=he,p=ue,G=p&65535,P=p>>>16,q=l&65535,X=l>>>16,l=b[3],p=S[3],G+=p&65535,P+=p>>>16,q+=l&65535,X+=l>>>16,P+=G>>>16,q+=P>>>16,X+=q>>>16,b[3]=he=q&65535|X<<16,S[3]=ue=G&65535|P<<16,l=le,p=g,G=p&65535,P=p>>>16,q=l&65535,X=l>>>16,l=b[4],p=S[4],G+=p&65535,P+=p>>>16,q+=l&65535,X+=l>>>16,P+=G>>>16,q+=P>>>16,X+=q>>>16,b[4]=le=q&65535|X<<16,S[4]=g=G&65535|P<<16,l=fe,p=m,G=p&65535,P=p>>>16,q=l&65535,X=l>>>16,l=b[5],p=S[5],G+=p&65535,P+=p>>>16,q+=l&65535,X+=l>>>16,P+=G>>>16,q+=P>>>16,X+=q>>>16,b[5]=fe=q&65535|X<<16,S[5]=m=G&65535|P<<16,l=pe,p=w,G=p&65535,P=p>>>16,q=l&65535,X=l>>>16,l=b[6],p=S[6],G+=p&65535,P+=p>>>16,q+=l&65535,X+=l>>>16,P+=G>>>16,q+=P>>>16,X+=q>>>16,b[6]=pe=q&65535|X<<16,S[6]=w=G&65535|P<<16,l=de,p=R,G=p&65535,P=p>>>16,q=l&65535,X=l>>>16,l=b[7],p=S[7],G+=p&65535,P+=p>>>16,q+=l&65535,X+=l>>>16,P+=G>>>16,q+=P>>>16,X+=q>>>16,b[7]=de=q&65535|X<<16,S[7]=R=G&65535|P<<16,M+=128,K-=128}return M}function d(_){var x=new n;x.update(_);var b=x.digest();return x.clean(),b}a.hash=d})(bf);(function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.convertSecretKeyToX25519=a.convertPublicKeyToX25519=a.verify=a.sign=a.extractPublicKeyFromSecretKey=a.generateKeyPair=a.generateKeyPairFromSeed=a.SEED_LENGTH=a.SECRET_KEY_LENGTH=a.PUBLIC_KEY_LENGTH=a.SIGNATURE_LENGTH=void 0;const t=Xl,r=bf,n=Yl;a.SIGNATURE_LENGTH=64,a.PUBLIC_KEY_LENGTH=32,a.SECRET_KEY_LENGTH=64,a.SEED_LENGTH=32;function o(B){const H=new Float64Array(16);if(B)for(let j=0;j<B.length;j++)H[j]=B[j];return H}const h=new Uint8Array(32);h[0]=9;const d=o(),_=o([1]),x=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),b=o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),S=o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),D=o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),M=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function K(B,H){for(let j=0;j<16;j++)B[j]=H[j]|0}function F(B){let H=1;for(let j=0;j<16;j++){let u=B[j]+H+65535;H=Math.floor(u/65536),B[j]=u-H*65536}B[0]+=H-1+37*(H-1)}function ee(B,H,j){const u=~(j-1);for(let A=0;A<16;A++){const ae=u&(B[A]^H[A]);B[A]^=ae,H[A]^=ae}}function oe(B,H){const j=o(),u=o();for(let A=0;A<16;A++)u[A]=H[A];F(u),F(u),F(u);for(let A=0;A<2;A++){j[0]=u[0]-65517;for(let we=1;we<15;we++)j[we]=u[we]-65535-(j[we-1]>>16&1),j[we-1]&=65535;j[15]=u[15]-32767-(j[14]>>16&1);const ae=j[15]>>16&1;j[14]&=65535,ee(u,j,1-ae)}for(let A=0;A<16;A++)B[2*A]=u[A]&255,B[2*A+1]=u[A]>>8}function he(B,H){let j=0;for(let u=0;u<32;u++)j|=B[u]^H[u];return(1&j-1>>>8)-1}function le(B,H){const j=new Uint8Array(32),u=new Uint8Array(32);return oe(j,B),oe(u,H),he(j,u)}function fe(B){const H=new Uint8Array(32);return oe(H,B),H[0]&1}function pe(B,H){for(let j=0;j<16;j++)B[j]=H[2*j]+(H[2*j+1]<<8);B[15]&=32767}function de(B,H,j){for(let u=0;u<16;u++)B[u]=H[u]+j[u]}function U(B,H,j){for(let u=0;u<16;u++)B[u]=H[u]-j[u]}function Q(B,H,j){let u,A,ae=0,we=0,Se=0,Fe=0,je=0,Ce=0,St=0,wt=0,at=0,qe=0,Xe=0,Ze=0,ct=0,Be=0,et=0,$e=0,Ve=0,ft=0,Ue=0,Ot=0,$t=0,Bt=0,kt=0,qt=0,Xt=0,sr=0,zr=0,Zt=0,Gr=0,fi=0,Ri=0,pt=j[0],it=j[1],dt=j[2],gt=j[3],ut=j[4],nt=j[5],Rt=j[6],At=j[7],yt=j[8],Ct=j[9],vt=j[10],bt=j[11],mt=j[12],Ye=j[13],Tt=j[14],Nt=j[15];u=H[0],ae+=u*pt,we+=u*it,Se+=u*dt,Fe+=u*gt,je+=u*ut,Ce+=u*nt,St+=u*Rt,wt+=u*At,at+=u*yt,qe+=u*Ct,Xe+=u*vt,Ze+=u*bt,ct+=u*mt,Be+=u*Ye,et+=u*Tt,$e+=u*Nt,u=H[1],we+=u*pt,Se+=u*it,Fe+=u*dt,je+=u*gt,Ce+=u*ut,St+=u*nt,wt+=u*Rt,at+=u*At,qe+=u*yt,Xe+=u*Ct,Ze+=u*vt,ct+=u*bt,Be+=u*mt,et+=u*Ye,$e+=u*Tt,Ve+=u*Nt,u=H[2],Se+=u*pt,Fe+=u*it,je+=u*dt,Ce+=u*gt,St+=u*ut,wt+=u*nt,at+=u*Rt,qe+=u*At,Xe+=u*yt,Ze+=u*Ct,ct+=u*vt,Be+=u*bt,et+=u*mt,$e+=u*Ye,Ve+=u*Tt,ft+=u*Nt,u=H[3],Fe+=u*pt,je+=u*it,Ce+=u*dt,St+=u*gt,wt+=u*ut,at+=u*nt,qe+=u*Rt,Xe+=u*At,Ze+=u*yt,ct+=u*Ct,Be+=u*vt,et+=u*bt,$e+=u*mt,Ve+=u*Ye,ft+=u*Tt,Ue+=u*Nt,u=H[4],je+=u*pt,Ce+=u*it,St+=u*dt,wt+=u*gt,at+=u*ut,qe+=u*nt,Xe+=u*Rt,Ze+=u*At,ct+=u*yt,Be+=u*Ct,et+=u*vt,$e+=u*bt,Ve+=u*mt,ft+=u*Ye,Ue+=u*Tt,Ot+=u*Nt,u=H[5],Ce+=u*pt,St+=u*it,wt+=u*dt,at+=u*gt,qe+=u*ut,Xe+=u*nt,Ze+=u*Rt,ct+=u*At,Be+=u*yt,et+=u*Ct,$e+=u*vt,Ve+=u*bt,ft+=u*mt,Ue+=u*Ye,Ot+=u*Tt,$t+=u*Nt,u=H[6],St+=u*pt,wt+=u*it,at+=u*dt,qe+=u*gt,Xe+=u*ut,Ze+=u*nt,ct+=u*Rt,Be+=u*At,et+=u*yt,$e+=u*Ct,Ve+=u*vt,ft+=u*bt,Ue+=u*mt,Ot+=u*Ye,$t+=u*Tt,Bt+=u*Nt,u=H[7],wt+=u*pt,at+=u*it,qe+=u*dt,Xe+=u*gt,Ze+=u*ut,ct+=u*nt,Be+=u*Rt,et+=u*At,$e+=u*yt,Ve+=u*Ct,ft+=u*vt,Ue+=u*bt,Ot+=u*mt,$t+=u*Ye,Bt+=u*Tt,kt+=u*Nt,u=H[8],at+=u*pt,qe+=u*it,Xe+=u*dt,Ze+=u*gt,ct+=u*ut,Be+=u*nt,et+=u*Rt,$e+=u*At,Ve+=u*yt,ft+=u*Ct,Ue+=u*vt,Ot+=u*bt,$t+=u*mt,Bt+=u*Ye,kt+=u*Tt,qt+=u*Nt,u=H[9],qe+=u*pt,Xe+=u*it,Ze+=u*dt,ct+=u*gt,Be+=u*ut,et+=u*nt,$e+=u*Rt,Ve+=u*At,ft+=u*yt,Ue+=u*Ct,Ot+=u*vt,$t+=u*bt,Bt+=u*mt,kt+=u*Ye,qt+=u*Tt,Xt+=u*Nt,u=H[10],Xe+=u*pt,Ze+=u*it,ct+=u*dt,Be+=u*gt,et+=u*ut,$e+=u*nt,Ve+=u*Rt,ft+=u*At,Ue+=u*yt,Ot+=u*Ct,$t+=u*vt,Bt+=u*bt,kt+=u*mt,qt+=u*Ye,Xt+=u*Tt,sr+=u*Nt,u=H[11],Ze+=u*pt,ct+=u*it,Be+=u*dt,et+=u*gt,$e+=u*ut,Ve+=u*nt,ft+=u*Rt,Ue+=u*At,Ot+=u*yt,$t+=u*Ct,Bt+=u*vt,kt+=u*bt,qt+=u*mt,Xt+=u*Ye,sr+=u*Tt,zr+=u*Nt,u=H[12],ct+=u*pt,Be+=u*it,et+=u*dt,$e+=u*gt,Ve+=u*ut,ft+=u*nt,Ue+=u*Rt,Ot+=u*At,$t+=u*yt,Bt+=u*Ct,kt+=u*vt,qt+=u*bt,Xt+=u*mt,sr+=u*Ye,zr+=u*Tt,Zt+=u*Nt,u=H[13],Be+=u*pt,et+=u*it,$e+=u*dt,Ve+=u*gt,ft+=u*ut,Ue+=u*nt,Ot+=u*Rt,$t+=u*At,Bt+=u*yt,kt+=u*Ct,qt+=u*vt,Xt+=u*bt,sr+=u*mt,zr+=u*Ye,Zt+=u*Tt,Gr+=u*Nt,u=H[14],et+=u*pt,$e+=u*it,Ve+=u*dt,ft+=u*gt,Ue+=u*ut,Ot+=u*nt,$t+=u*Rt,Bt+=u*At,kt+=u*yt,qt+=u*Ct,Xt+=u*vt,sr+=u*bt,zr+=u*mt,Zt+=u*Ye,Gr+=u*Tt,fi+=u*Nt,u=H[15],$e+=u*pt,Ve+=u*it,ft+=u*dt,Ue+=u*gt,Ot+=u*ut,$t+=u*nt,Bt+=u*Rt,kt+=u*At,qt+=u*yt,Xt+=u*Ct,sr+=u*vt,zr+=u*bt,Zt+=u*mt,Gr+=u*Ye,fi+=u*Tt,Ri+=u*Nt,ae+=38*Ve,we+=38*ft,Se+=38*Ue,Fe+=38*Ot,je+=38*$t,Ce+=38*Bt,St+=38*kt,wt+=38*qt,at+=38*Xt,qe+=38*sr,Xe+=38*zr,Ze+=38*Zt,ct+=38*Gr,Be+=38*fi,et+=38*Ri,A=1,u=ae+A+65535,A=Math.floor(u/65536),ae=u-A*65536,u=we+A+65535,A=Math.floor(u/65536),we=u-A*65536,u=Se+A+65535,A=Math.floor(u/65536),Se=u-A*65536,u=Fe+A+65535,A=Math.floor(u/65536),Fe=u-A*65536,u=je+A+65535,A=Math.floor(u/65536),je=u-A*65536,u=Ce+A+65535,A=Math.floor(u/65536),Ce=u-A*65536,u=St+A+65535,A=Math.floor(u/65536),St=u-A*65536,u=wt+A+65535,A=Math.floor(u/65536),wt=u-A*65536,u=at+A+65535,A=Math.floor(u/65536),at=u-A*65536,u=qe+A+65535,A=Math.floor(u/65536),qe=u-A*65536,u=Xe+A+65535,A=Math.floor(u/65536),Xe=u-A*65536,u=Ze+A+65535,A=Math.floor(u/65536),Ze=u-A*65536,u=ct+A+65535,A=Math.floor(u/65536),ct=u-A*65536,u=Be+A+65535,A=Math.floor(u/65536),Be=u-A*65536,u=et+A+65535,A=Math.floor(u/65536),et=u-A*65536,u=$e+A+65535,A=Math.floor(u/65536),$e=u-A*65536,ae+=A-1+37*(A-1),A=1,u=ae+A+65535,A=Math.floor(u/65536),ae=u-A*65536,u=we+A+65535,A=Math.floor(u/65536),we=u-A*65536,u=Se+A+65535,A=Math.floor(u/65536),Se=u-A*65536,u=Fe+A+65535,A=Math.floor(u/65536),Fe=u-A*65536,u=je+A+65535,A=Math.floor(u/65536),je=u-A*65536,u=Ce+A+65535,A=Math.floor(u/65536),Ce=u-A*65536,u=St+A+65535,A=Math.floor(u/65536),St=u-A*65536,u=wt+A+65535,A=Math.floor(u/65536),wt=u-A*65536,u=at+A+65535,A=Math.floor(u/65536),at=u-A*65536,u=qe+A+65535,A=Math.floor(u/65536),qe=u-A*65536,u=Xe+A+65535,A=Math.floor(u/65536),Xe=u-A*65536,u=Ze+A+65535,A=Math.floor(u/65536),Ze=u-A*65536,u=ct+A+65535,A=Math.floor(u/65536),ct=u-A*65536,u=Be+A+65535,A=Math.floor(u/65536),Be=u-A*65536,u=et+A+65535,A=Math.floor(u/65536),et=u-A*65536,u=$e+A+65535,A=Math.floor(u/65536),$e=u-A*65536,ae+=A-1+37*(A-1),B[0]=ae,B[1]=we,B[2]=Se,B[3]=Fe,B[4]=je,B[5]=Ce,B[6]=St,B[7]=wt,B[8]=at,B[9]=qe,B[10]=Xe,B[11]=Ze,B[12]=ct,B[13]=Be,B[14]=et,B[15]=$e}function $(B,H){Q(B,H,H)}function ue(B,H){const j=o();let u;for(u=0;u<16;u++)j[u]=H[u];for(u=253;u>=0;u--)$(j,j),u!==2&&u!==4&&Q(j,j,H);for(u=0;u<16;u++)B[u]=j[u]}function g(B,H){const j=o();let u;for(u=0;u<16;u++)j[u]=H[u];for(u=250;u>=0;u--)$(j,j),u!==1&&Q(j,j,H);for(u=0;u<16;u++)B[u]=j[u]}function m(B,H){const j=o(),u=o(),A=o(),ae=o(),we=o(),Se=o(),Fe=o(),je=o(),Ce=o();U(j,B[1],B[0]),U(Ce,H[1],H[0]),Q(j,j,Ce),de(u,B[0],B[1]),de(Ce,H[0],H[1]),Q(u,u,Ce),Q(A,B[3],H[3]),Q(A,A,b),Q(ae,B[2],H[2]),de(ae,ae,ae),U(we,u,j),U(Se,ae,A),de(Fe,ae,A),de(je,u,j),Q(B[0],we,Se),Q(B[1],je,Fe),Q(B[2],Fe,Se),Q(B[3],we,je)}function w(B,H,j){for(let u=0;u<4;u++)ee(B[u],H[u],j)}function R(B,H){const j=o(),u=o(),A=o();ue(A,H[2]),Q(j,H[0],A),Q(u,H[1],A),oe(B,u),B[31]^=fe(j)<<7}function l(B,H,j){K(B[0],d),K(B[1],_),K(B[2],_),K(B[3],d);for(let u=255;u>=0;--u){const A=j[u/8|0]>>(u&7)&1;w(B,H,A),m(H,B),m(B,B),w(B,H,A)}}function p(B,H){const j=[o(),o(),o(),o()];K(j[0],S),K(j[1],D),K(j[2],_),Q(j[3],S,D),l(B,j,H)}function N(B){if(B.length!==a.SEED_LENGTH)throw new Error(`ed25519: seed must be ${a.SEED_LENGTH} bytes`);const H=(0,r.hash)(B);H[0]&=248,H[31]&=127,H[31]|=64;const j=new Uint8Array(32),u=[o(),o(),o(),o()];p(u,H),R(j,u);const A=new Uint8Array(64);return A.set(B),A.set(j,32),{publicKey:j,secretKey:A}}a.generateKeyPairFromSeed=N;function V(B){const H=(0,t.randomBytes)(32,B),j=N(H);return(0,n.wipe)(H),j}a.generateKeyPair=V;function G(B){if(B.length!==a.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${a.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(B.subarray(32))}a.extractPublicKeyFromSecretKey=G;const P=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function q(B,H){let j,u,A,ae;for(u=63;u>=32;--u){for(j=0,A=u-32,ae=u-12;A<ae;++A)H[A]+=j-16*H[u]*P[A-(u-32)],j=Math.floor((H[A]+128)/256),H[A]-=j*256;H[A]+=j,H[u]=0}for(j=0,A=0;A<32;A++)H[A]+=j-(H[31]>>4)*P[A],j=H[A]>>8,H[A]&=255;for(A=0;A<32;A++)H[A]-=j*P[A];for(u=0;u<32;u++)H[u+1]+=H[u]>>8,B[u]=H[u]&255}function X(B){const H=new Float64Array(64);for(let j=0;j<64;j++)H[j]=B[j];for(let j=0;j<64;j++)B[j]=0;q(B,H)}function te(B,H){const j=new Float64Array(64),u=[o(),o(),o(),o()],A=(0,r.hash)(B.subarray(0,32));A[0]&=248,A[31]&=127,A[31]|=64;const ae=new Uint8Array(64);ae.set(A.subarray(32),32);const we=new r.SHA512;we.update(ae.subarray(32)),we.update(H);const Se=we.digest();we.clean(),X(Se),p(u,Se),R(ae,u),we.reset(),we.update(ae.subarray(0,32)),we.update(B.subarray(32)),we.update(H);const Fe=we.digest();X(Fe);for(let je=0;je<32;je++)j[je]=Se[je];for(let je=0;je<32;je++)for(let Ce=0;Ce<32;Ce++)j[je+Ce]+=Fe[je]*A[Ce];return q(ae.subarray(32),j),ae}a.sign=te;function _e(B,H){const j=o(),u=o(),A=o(),ae=o(),we=o(),Se=o(),Fe=o();return K(B[2],_),pe(B[1],H),$(A,B[1]),Q(ae,A,x),U(A,A,B[2]),de(ae,B[2],ae),$(we,ae),$(Se,we),Q(Fe,Se,we),Q(j,Fe,A),Q(j,j,ae),g(j,j),Q(j,j,A),Q(j,j,ae),Q(j,j,ae),Q(B[0],j,ae),$(u,B[0]),Q(u,u,ae),le(u,A)&&Q(B[0],B[0],M),$(u,B[0]),Q(u,u,ae),le(u,A)?-1:(fe(B[0])===H[31]>>7&&U(B[0],d,B[0]),Q(B[3],B[0],B[1]),0)}function lt(B,H,j){const u=new Uint8Array(32),A=[o(),o(),o(),o()],ae=[o(),o(),o(),o()];if(j.length!==a.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${a.SIGNATURE_LENGTH} bytes`);if(_e(ae,B))return!1;const we=new r.SHA512;we.update(j.subarray(0,32)),we.update(B),we.update(H);const Se=we.digest();return X(Se),l(A,ae,Se),p(ae,j.subarray(32)),m(A,ae),R(u,A),!he(j,u)}a.verify=lt;function be(B){let H=[o(),o(),o(),o()];if(_e(H,B))throw new Error("Ed25519: invalid public key");let j=o(),u=o(),A=H[1];de(j,_,A),U(u,_,A),ue(u,u),Q(j,j,u);let ae=new Uint8Array(32);return oe(ae,j),ae}a.convertPublicKeyToX25519=be;function Pt(B){const H=(0,r.hash)(B.subarray(0,32));H[0]&=248,H[31]&=127,H[31]|=64;const j=new Uint8Array(H.subarray(0,32));return(0,n.wipe)(H),j}a.convertSecretKeyToX25519=Pt})(Tc);const x1="EdDSA",P1="JWT",Ef=".",If="base64url",S1="utf8",O1="utf8",R1=":",A1="did",C1="key",ol="base58btc",T1="z",N1="K36",L1=32;function _o(a){return Io(Rc(ki(a),S1),If)}function xf(a){const t=Rc(N1,ol),r=T1+Io(Nm([t,a]),ol);return[A1,C1,r].join(R1)}function D1(a){return Io(a,If)}function F1(a){return Rc([_o(a.header),_o(a.payload)].join(Ef),O1)}function $1(a){return[_o(a.header),_o(a.payload),D1(a.signature)].join(Ef)}function al(a=Xl.randomBytes(L1)){return Tc.generateKeyPairFromSeed(a)}async function j1(a,t,r,n,o=ge.fromMiliseconds(Date.now())){const h={alg:x1,typ:P1},d=xf(n.publicKey),_=o+r,x={iss:d,sub:a,aud:t,iat:o,exp:_},b=F1({header:h,payload:x}),S=Tc.sign(n.secretKey,b);return $1({header:h,payload:x,signature:S})}const M1="PARSE_ERROR",q1="INVALID_REQUEST",z1="METHOD_NOT_FOUND",U1="INVALID_PARAMS",Pf="INTERNAL_ERROR",Nc="SERVER_ERROR",H1=[-32700,-32600,-32601,-32602,-32603],Xn={[M1]:{code:-32700,message:"Parse error"},[q1]:{code:-32600,message:"Invalid Request"},[z1]:{code:-32601,message:"Method not found"},[U1]:{code:-32602,message:"Invalid params"},[Pf]:{code:-32603,message:"Internal error"},[Nc]:{code:-32e3,message:"Server error"}},Sf=Nc;function B1(a){return H1.includes(a)}function cl(a){return Object.keys(Xn).includes(a)?Xn[a]:Xn[Sf]}function k1(a){const t=Object.values(Xn).find(r=>r.code===a);return t||Xn[Sf]}function Of(a,t,r){return a.message.includes("getaddrinfo ENOTFOUND")||a.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${t}`):a}var Rf={},Af={exports:{}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(a){var t,r,n,o,h,d,_,x,b,S,D,M,K,F,ee,oe,he,le,fe,pe,de,U,Q;(function($){var ue=typeof Vt=="object"?Vt:typeof self=="object"?self:typeof this=="object"?this:{};$(g(ue,g(a.exports)));function g(m,w){return m!==ue&&(typeof Object.create=="function"?Object.defineProperty(m,"__esModule",{value:!0}):m.__esModule=!0),function(R,l){return m[R]=w?w(R,l):l}}})(function($){var ue=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,m){g.__proto__=m}||function(g,m){for(var w in m)m.hasOwnProperty(w)&&(g[w]=m[w])};t=function(g,m){ue(g,m);function w(){this.constructor=g}g.prototype=m===null?Object.create(m):(w.prototype=m.prototype,new w)},r=Object.assign||function(g){for(var m,w=1,R=arguments.length;w<R;w++){m=arguments[w];for(var l in m)Object.prototype.hasOwnProperty.call(m,l)&&(g[l]=m[l])}return g},n=function(g,m){var w={};for(var R in g)Object.prototype.hasOwnProperty.call(g,R)&&m.indexOf(R)<0&&(w[R]=g[R]);if(g!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,R=Object.getOwnPropertySymbols(g);l<R.length;l++)m.indexOf(R[l])<0&&Object.prototype.propertyIsEnumerable.call(g,R[l])&&(w[R[l]]=g[R[l]]);return w},o=function(g,m,w,R){var l=arguments.length,p=l<3?m:R===null?R=Object.getOwnPropertyDescriptor(m,w):R,N;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(g,m,w,R);else for(var V=g.length-1;V>=0;V--)(N=g[V])&&(p=(l<3?N(p):l>3?N(m,w,p):N(m,w))||p);return l>3&&p&&Object.defineProperty(m,w,p),p},h=function(g,m){return function(w,R){m(w,R,g)}},d=function(g,m){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(g,m)},_=function(g,m,w,R){function l(p){return p instanceof w?p:new w(function(N){N(p)})}return new(w||(w=Promise))(function(p,N){function V(q){try{P(R.next(q))}catch(X){N(X)}}function G(q){try{P(R.throw(q))}catch(X){N(X)}}function P(q){q.done?p(q.value):l(q.value).then(V,G)}P((R=R.apply(g,m||[])).next())})},x=function(g,m){var w={label:0,sent:function(){if(p[0]&1)throw p[1];return p[1]},trys:[],ops:[]},R,l,p,N;return N={next:V(0),throw:V(1),return:V(2)},typeof Symbol=="function"&&(N[Symbol.iterator]=function(){return this}),N;function V(P){return function(q){return G([P,q])}}function G(P){if(R)throw new TypeError("Generator is already executing.");for(;w;)try{if(R=1,l&&(p=P[0]&2?l.return:P[0]?l.throw||((p=l.return)&&p.call(l),0):l.next)&&!(p=p.call(l,P[1])).done)return p;switch(l=0,p&&(P=[P[0]&2,p.value]),P[0]){case 0:case 1:p=P;break;case 4:return w.label++,{value:P[1],done:!1};case 5:w.label++,l=P[1],P=[0];continue;case 7:P=w.ops.pop(),w.trys.pop();continue;default:if(p=w.trys,!(p=p.length>0&&p[p.length-1])&&(P[0]===6||P[0]===2)){w=0;continue}if(P[0]===3&&(!p||P[1]>p[0]&&P[1]<p[3])){w.label=P[1];break}if(P[0]===6&&w.label<p[1]){w.label=p[1],p=P;break}if(p&&w.label<p[2]){w.label=p[2],w.ops.push(P);break}p[2]&&w.ops.pop(),w.trys.pop();continue}P=m.call(g,w)}catch(q){P=[6,q],l=0}finally{R=p=0}if(P[0]&5)throw P[1];return{value:P[0]?P[1]:void 0,done:!0}}},Q=function(g,m,w,R){R===void 0&&(R=w),g[R]=m[w]},b=function(g,m){for(var w in g)w!=="default"&&!m.hasOwnProperty(w)&&(m[w]=g[w])},S=function(g){var m=typeof Symbol=="function"&&Symbol.iterator,w=m&&g[m],R=0;if(w)return w.call(g);if(g&&typeof g.length=="number")return{next:function(){return g&&R>=g.length&&(g=void 0),{value:g&&g[R++],done:!g}}};throw new TypeError(m?"Object is not iterable.":"Symbol.iterator is not defined.")},D=function(g,m){var w=typeof Symbol=="function"&&g[Symbol.iterator];if(!w)return g;var R=w.call(g),l,p=[],N;try{for(;(m===void 0||m-- >0)&&!(l=R.next()).done;)p.push(l.value)}catch(V){N={error:V}}finally{try{l&&!l.done&&(w=R.return)&&w.call(R)}finally{if(N)throw N.error}}return p},M=function(){for(var g=[],m=0;m<arguments.length;m++)g=g.concat(D(arguments[m]));return g},K=function(){for(var g=0,m=0,w=arguments.length;m<w;m++)g+=arguments[m].length;for(var R=Array(g),l=0,m=0;m<w;m++)for(var p=arguments[m],N=0,V=p.length;N<V;N++,l++)R[l]=p[N];return R},F=function(g){return this instanceof F?(this.v=g,this):new F(g)},ee=function(g,m,w){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var R=w.apply(g,m||[]),l,p=[];return l={},N("next"),N("throw"),N("return"),l[Symbol.asyncIterator]=function(){return this},l;function N(te){R[te]&&(l[te]=function(_e){return new Promise(function(lt,be){p.push([te,_e,lt,be])>1||V(te,_e)})})}function V(te,_e){try{G(R[te](_e))}catch(lt){X(p[0][3],lt)}}function G(te){te.value instanceof F?Promise.resolve(te.value.v).then(P,q):X(p[0][2],te)}function P(te){V("next",te)}function q(te){V("throw",te)}function X(te,_e){te(_e),p.shift(),p.length&&V(p[0][0],p[0][1])}},oe=function(g){var m,w;return m={},R("next"),R("throw",function(l){throw l}),R("return"),m[Symbol.iterator]=function(){return this},m;function R(l,p){m[l]=g[l]?function(N){return(w=!w)?{value:F(g[l](N)),done:l==="return"}:p?p(N):N}:p}},he=function(g){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var m=g[Symbol.asyncIterator],w;return m?m.call(g):(g=typeof S=="function"?S(g):g[Symbol.iterator](),w={},R("next"),R("throw"),R("return"),w[Symbol.asyncIterator]=function(){return this},w);function R(p){w[p]=g[p]&&function(N){return new Promise(function(V,G){N=g[p](N),l(V,G,N.done,N.value)})}}function l(p,N,V,G){Promise.resolve(G).then(function(P){p({value:P,done:V})},N)}},le=function(g,m){return Object.defineProperty?Object.defineProperty(g,"raw",{value:m}):g.raw=m,g},fe=function(g){if(g&&g.__esModule)return g;var m={};if(g!=null)for(var w in g)Object.hasOwnProperty.call(g,w)&&(m[w]=g[w]);return m.default=g,m},pe=function(g){return g&&g.__esModule?g:{default:g}},de=function(g,m){if(!m.has(g))throw new TypeError("attempted to get private field on non-instance");return m.get(g)},U=function(g,m,w){if(!m.has(g))throw new TypeError("attempted to set private field on non-instance");return m.set(g,w),w},$("__extends",t),$("__assign",r),$("__rest",n),$("__decorate",o),$("__param",h),$("__metadata",d),$("__awaiter",_),$("__generator",x),$("__exportStar",b),$("__createBinding",Q),$("__values",S),$("__read",D),$("__spread",M),$("__spreadArrays",K),$("__await",F),$("__asyncGenerator",ee),$("__asyncDelegator",oe),$("__asyncValues",he),$("__makeTemplateObject",le),$("__importStar",fe),$("__importDefault",pe),$("__classPrivateFieldGet",de),$("__classPrivateFieldSet",U)})})(Af);var K1=Af.exports,si={},ul;function V1(){if(ul)return si;ul=1,Object.defineProperty(si,"__esModule",{value:!0}),si.isBrowserCryptoAvailable=si.getSubtleCrypto=si.getBrowerCrypto=void 0;function a(){return(Vt===null||Vt===void 0?void 0:Vt.crypto)||(Vt===null||Vt===void 0?void 0:Vt.msCrypto)||{}}si.getBrowerCrypto=a;function t(){const n=a();return n.subtle||n.webkitSubtle}si.getSubtleCrypto=t;function r(){return!!a()&&!!t()}return si.isBrowserCryptoAvailable=r,si}var oi={},hl;function G1(){if(hl)return oi;hl=1,Object.defineProperty(oi,"__esModule",{value:!0}),oi.isBrowser=oi.isNode=oi.isReactNative=void 0;function a(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}oi.isReactNative=a;function t(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}oi.isNode=t;function r(){return!a()&&!t()}return oi.isBrowser=r,oi}(function(a){Object.defineProperty(a,"__esModule",{value:!0});const t=K1;t.__exportStar(V1(),a),t.__exportStar(G1(),a)})(Rf);function Lc(a=3){const t=Date.now()*Math.pow(10,a),r=Math.floor(Math.random()*Math.pow(10,a));return t+r}function Cf(a=6){return BigInt(Lc(a))}function wn(a,t,r){return{id:r||Lc(),jsonrpc:"2.0",method:a,params:t}}function So(a,t){return{id:a,jsonrpc:"2.0",result:t}}function Oo(a,t,r){return{id:a,jsonrpc:"2.0",error:W1(t,r)}}function W1(a,t){return typeof a>"u"?cl(Pf):(typeof a=="string"&&(a=Object.assign(Object.assign({},cl(Nc)),{message:a})),typeof t<"u"&&(a.data=t),B1(a.code)&&(a=k1(a.code)),a)}class J1{}class Q1 extends J1{constructor(){super()}}class Y1 extends Q1{constructor(t){super()}}const X1="^https?:",Z1="^wss?:";function ew(a){const t=a.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function Tf(a,t){const r=ew(a);return typeof r>"u"?!1:new RegExp(t).test(r)}function ll(a){return Tf(a,X1)}function fl(a){return Tf(a,Z1)}function tw(a){return new RegExp("wss?://localhost(:d{2,5})?").test(a)}function Nf(a){return typeof a=="object"&&"id"in a&&"jsonrpc"in a&&a.jsonrpc==="2.0"}function Dc(a){return Nf(a)&&"method"in a}function Ro(a){return Nf(a)&&(ui(a)||qr(a))}function ui(a){return"result"in a}function qr(a){return"error"in a}class hi extends Y1{constructor(t){super(t),this.events=new wr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async request(t,r){return this.requestStrict(wn(t.method,t.params||[],t.id||Cf().toString()),r)}async requestStrict(t,r){return new Promise(async(n,o)=>{if(!this.connection.connected)try{await this.open()}catch(h){o(h)}this.events.on(`${t.id}`,h=>{qr(h)?o(h.error):n(h.result)});try{await this.connection.send(t,r)}catch(h){o(h)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),Ro(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const rw=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),iw=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",pl=a=>a.split("?")[0],dl=10,nw=rw();let sw=class{constructor(t){if(this.url=t,this.events=new wr.EventEmitter,this.registering=!1,!fl(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),t()},this.socket.close()})}async send(t){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(ki(t))}catch(r){this.onError(t.id,r)}}register(t=this.url){if(!fl(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,o)=>{this.events.once("register_error",h=>{this.resetMaxListeners(),o(h)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return o(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=t,this.registering=!0,new Promise((r,n)=>{const o=new URLSearchParams(t).get("origin"),h=Rf.isReactNative()?{headers:{origin:o}}:{rejectUnauthorized:!tw(t)},d=new nw(t,[],h);iw()?d.onerror=_=>{const x=_;n(this.emitError(x.error))}:d.on("error",_=>{n(this.emitError(_))}),d.onopen=()=>{this.onOpen(d),r(d)}})}onOpen(t){t.onmessage=r=>this.onPayload(r),t.onclose=r=>this.onClose(r),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?ts(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const n=this.parseError(r),o=n.message||n.toString(),h=Oo(t,o);this.events.emit("payload",h)}parseError(t,r=this.url){return Of(t,pl(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>dl&&this.events.setMaxListeners(dl)}emitError(t){const r=this.parseError(new Error((t==null?void 0:t.message)||`WebSocket connection failed for host: ${pl(this.url)}`));return this.events.emit("register_error",r),r}};var wo={exports:{}};wo.exports;(function(a,t){var r=200,n="__lodash_hash_undefined__",o=1,h=2,d=9007199254740991,_="[object Arguments]",x="[object Array]",b="[object AsyncFunction]",S="[object Boolean]",D="[object Date]",M="[object Error]",K="[object Function]",F="[object GeneratorFunction]",ee="[object Map]",oe="[object Number]",he="[object Null]",le="[object Object]",fe="[object Promise]",pe="[object Proxy]",de="[object RegExp]",U="[object Set]",Q="[object String]",$="[object Symbol]",ue="[object Undefined]",g="[object WeakMap]",m="[object ArrayBuffer]",w="[object DataView]",R="[object Float32Array]",l="[object Float64Array]",p="[object Int8Array]",N="[object Int16Array]",V="[object Int32Array]",G="[object Uint8Array]",P="[object Uint8ClampedArray]",q="[object Uint16Array]",X="[object Uint32Array]",te=/[\\^$.*+?()[\]{}|]/g,_e=/^\[object .+?Constructor\]$/,lt=/^(?:0|[1-9]\d*)$/,be={};be[R]=be[l]=be[p]=be[N]=be[V]=be[G]=be[P]=be[q]=be[X]=!0,be[_]=be[x]=be[m]=be[S]=be[w]=be[D]=be[M]=be[K]=be[ee]=be[oe]=be[le]=be[de]=be[U]=be[Q]=be[g]=!1;var Pt=typeof Vt=="object"&&Vt&&Vt.Object===Object&&Vt,B=typeof self=="object"&&self&&self.Object===Object&&self,H=Pt||B||Function("return this")(),j=t&&!t.nodeType&&t,u=j&&!0&&a&&!a.nodeType&&a,A=u&&u.exports===j,ae=A&&Pt.process,we=function(){try{return ae&&ae.binding&&ae.binding("util")}catch{}}(),Se=we&&we.isTypedArray;function Fe(E,C){for(var Y=-1,ie=E==null?0:E.length,We=0,Ie=[];++Y<ie;){var tt=E[Y];C(tt,Y,E)&&(Ie[We++]=tt)}return Ie}function je(E,C){for(var Y=-1,ie=C.length,We=E.length;++Y<ie;)E[We+Y]=C[Y];return E}function Ce(E,C){for(var Y=-1,ie=E==null?0:E.length;++Y<ie;)if(C(E[Y],Y,E))return!0;return!1}function St(E,C){for(var Y=-1,ie=Array(E);++Y<E;)ie[Y]=C(Y);return ie}function wt(E){return function(C){return E(C)}}function at(E,C){return E.has(C)}function qe(E,C){return E==null?void 0:E[C]}function Xe(E){var C=-1,Y=Array(E.size);return E.forEach(function(ie,We){Y[++C]=[We,ie]}),Y}function Ze(E,C){return function(Y){return E(C(Y))}}function ct(E){var C=-1,Y=Array(E.size);return E.forEach(function(ie){Y[++C]=ie}),Y}var Be=Array.prototype,et=Function.prototype,$e=Object.prototype,Ve=H["__core-js_shared__"],ft=et.toString,Ue=$e.hasOwnProperty,Ot=function(){var E=/[^.]+$/.exec(Ve&&Ve.keys&&Ve.keys.IE_PROTO||"");return E?"Symbol(src)_1."+E:""}(),$t=$e.toString,Bt=RegExp("^"+ft.call(Ue).replace(te,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),kt=A?H.Buffer:void 0,qt=H.Symbol,Xt=H.Uint8Array,sr=$e.propertyIsEnumerable,zr=Be.splice,Zt=qt?qt.toStringTag:void 0,Gr=Object.getOwnPropertySymbols,fi=kt?kt.isBuffer:void 0,Ri=Ze(Object.keys,Object),pt=dr(H,"DataView"),it=dr(H,"Map"),dt=dr(H,"Promise"),gt=dr(H,"Set"),ut=dr(H,"WeakMap"),nt=dr(Object,"create"),Rt=Jr(pt),At=Jr(it),yt=Jr(dt),Ct=Jr(gt),vt=Jr(ut),bt=qt?qt.prototype:void 0,mt=bt?bt.valueOf:void 0;function Ye(E){var C=-1,Y=E==null?0:E.length;for(this.clear();++C<Y;){var ie=E[C];this.set(ie[0],ie[1])}}function Tt(){this.__data__=nt?nt(null):{},this.size=0}function Nt(E){var C=this.has(E)&&delete this.__data__[E];return this.size-=C?1:0,C}function To(E){var C=this.__data__;if(nt){var Y=C[E];return Y===n?void 0:Y}return Ue.call(C,E)?C[E]:void 0}function No(E){var C=this.__data__;return nt?C[E]!==void 0:Ue.call(C,E)}function Lo(E,C){var Y=this.__data__;return this.size+=this.has(E)?0:1,Y[E]=nt&&C===void 0?n:C,this}Ye.prototype.clear=Tt,Ye.prototype.delete=Nt,Ye.prototype.get=To,Ye.prototype.has=No,Ye.prototype.set=Lo;function br(E){var C=-1,Y=E==null?0:E.length;for(this.clear();++C<Y;){var ie=E[C];this.set(ie[0],ie[1])}}function Do(){this.__data__=[],this.size=0}function Fo(E){var C=this.__data__,Y=Ai(C,E);if(Y<0)return!1;var ie=C.length-1;return Y==ie?C.pop():zr.call(C,Y,1),--this.size,!0}function $o(E){var C=this.__data__,Y=Ai(C,E);return Y<0?void 0:C[Y][1]}function jo(E){return Ai(this.__data__,E)>-1}function Mo(E,C){var Y=this.__data__,ie=Ai(Y,E);return ie<0?(++this.size,Y.push([E,C])):Y[ie][1]=C,this}br.prototype.clear=Do,br.prototype.delete=Fo,br.prototype.get=$o,br.prototype.has=jo,br.prototype.set=Mo;function Wr(E){var C=-1,Y=E==null?0:E.length;for(this.clear();++C<Y;){var ie=E[C];this.set(ie[0],ie[1])}}function Wi(){this.size=0,this.__data__={hash:new Ye,map:new(it||br),string:new Ye}}function qo(E){var C=pi(this,E).delete(E);return this.size-=C?1:0,C}function Ji(E){return pi(this,E).get(E)}function zo(E){return pi(this,E).has(E)}function Uo(E,C){var Y=pi(this,E),ie=Y.size;return Y.set(E,C),this.size+=Y.size==ie?0:1,this}Wr.prototype.clear=Wi,Wr.prototype.delete=qo,Wr.prototype.get=Ji,Wr.prototype.has=zo,Wr.prototype.set=Uo;function Qi(E){var C=-1,Y=E==null?0:E.length;for(this.__data__=new Wr;++C<Y;)this.add(E[C])}function is(E){return this.__data__.set(E,n),this}function ns(E){return this.__data__.has(E)}Qi.prototype.add=Qi.prototype.push=is,Qi.prototype.has=ns;function Tr(E){var C=this.__data__=new br(E);this.size=C.size}function Ho(){this.__data__=new br,this.size=0}function Bo(E){var C=this.__data__,Y=C.delete(E);return this.size=C.size,Y}function ko(E){return this.__data__.get(E)}function Ko(E){return this.__data__.has(E)}function ss(E,C){var Y=this.__data__;if(Y instanceof br){var ie=Y.__data__;if(!it||ie.length<r-1)return ie.push([E,C]),this.size=++Y.size,this;Y=this.__data__=new Wr(ie)}return Y.set(E,C),this.size=Y.size,this}Tr.prototype.clear=Ho,Tr.prototype.delete=Bo,Tr.prototype.get=ko,Tr.prototype.has=Ko,Tr.prototype.set=ss;function os(E,C){var Y=Zi(E),ie=!Y&&ms(E),We=!Y&&!ie&&Pn(E),Ie=!Y&&!ie&&!We&&bs(E),tt=Y||ie||We||Ie,Lt=tt?St(E.length,String):[],Le=Lt.length;for(var Je in E)(C||Ue.call(E,Je))&&!(tt&&(Je=="length"||We&&(Je=="offset"||Je=="parent")||Ie&&(Je=="buffer"||Je=="byteLength"||Je=="byteOffset")||ps(Je,Le)))&&Lt.push(Je);return Lt}function Ai(E,C){for(var Y=E.length;Y--;)if(vs(E[Y][0],C))return Y;return-1}function In(E,C,Y){var ie=C(E);return Zi(E)?ie:je(ie,Y(E))}function Ci(E){return E==null?E===void 0?ue:he:Zt&&Zt in Object(E)?ls(E):Wo(E)}function xn(E){return Ni(E)&&Ci(E)==_}function Ti(E,C,Y,ie,We){return E===C?!0:E==null||C==null||!Ni(E)&&!Ni(C)?E!==E&&C!==C:as(E,C,Y,ie,Ti,We)}function as(E,C,Y,ie,We,Ie){var tt=Zi(E),Lt=Zi(C),Le=tt?x:Ur(E),Je=Lt?x:Ur(C);Le=Le==_?le:Le,Je=Je==_?le:Je;var Et=Le==le,or=Je==le,Dt=Le==Je;if(Dt&&Pn(E)){if(!Pn(C))return!1;tt=!0,Et=!1}if(Dt&&!Et)return Ie||(Ie=new Tr),tt||bs(E)?Yi(E,C,Y,ie,We,Ie):Go(E,C,Le,Y,ie,We,Ie);if(!(Y&o)){var rt=Et&&Ue.call(E,"__wrapped__"),er=or&&Ue.call(C,"__wrapped__");if(rt||er){var Nr=rt?E.value():E,Er=er?C.value():C;return Ie||(Ie=new Tr),We(Nr,Er,Y,ie,Ie)}}return Dt?(Ie||(Ie=new Tr),hs(E,C,Y,ie,We,Ie)):!1}function Vo(E){if(!ws(E)||gs(E))return!1;var C=en(E)?Bt:_e;return C.test(Jr(E))}function cs(E){return Ni(E)&&_s(E.length)&&!!be[Ci(E)]}function us(E){if(!ys(E))return Ri(E);var C=[];for(var Y in Object(E))Ue.call(E,Y)&&Y!="constructor"&&C.push(Y);return C}function Yi(E,C,Y,ie,We,Ie){var tt=Y&o,Lt=E.length,Le=C.length;if(Lt!=Le&&!(tt&&Le>Lt))return!1;var Je=Ie.get(E);if(Je&&Ie.get(C))return Je==C;var Et=-1,or=!0,Dt=Y&h?new Qi:void 0;for(Ie.set(E,C),Ie.set(C,E);++Et<Lt;){var rt=E[Et],er=C[Et];if(ie)var Nr=tt?ie(er,rt,Et,C,E,Ie):ie(rt,er,Et,E,C,Ie);if(Nr!==void 0){if(Nr)continue;or=!1;break}if(Dt){if(!Ce(C,function(Er,Hr){if(!at(Dt,Hr)&&(rt===Er||We(rt,Er,Y,ie,Ie)))return Dt.push(Hr)})){or=!1;break}}else if(!(rt===er||We(rt,er,Y,ie,Ie))){or=!1;break}}return Ie.delete(E),Ie.delete(C),or}function Go(E,C,Y,ie,We,Ie,tt){switch(Y){case w:if(E.byteLength!=C.byteLength||E.byteOffset!=C.byteOffset)return!1;E=E.buffer,C=C.buffer;case m:return!(E.byteLength!=C.byteLength||!Ie(new Xt(E),new Xt(C)));case S:case D:case oe:return vs(+E,+C);case M:return E.name==C.name&&E.message==C.message;case de:case Q:return E==C+"";case ee:var Lt=Xe;case U:var Le=ie&o;if(Lt||(Lt=ct),E.size!=C.size&&!Le)return!1;var Je=tt.get(E);if(Je)return Je==C;ie|=h,tt.set(E,C);var Et=Yi(Lt(E),Lt(C),ie,We,Ie,tt);return tt.delete(E),Et;case $:if(mt)return mt.call(E)==mt.call(C)}return!1}function hs(E,C,Y,ie,We,Ie){var tt=Y&o,Lt=Xi(E),Le=Lt.length,Je=Xi(C),Et=Je.length;if(Le!=Et&&!tt)return!1;for(var or=Le;or--;){var Dt=Lt[or];if(!(tt?Dt in C:Ue.call(C,Dt)))return!1}var rt=Ie.get(E);if(rt&&Ie.get(C))return rt==C;var er=!0;Ie.set(E,C),Ie.set(C,E);for(var Nr=tt;++or<Le;){Dt=Lt[or];var Er=E[Dt],Hr=C[Dt];if(ie)var Sn=tt?ie(Hr,Er,Dt,C,E,Ie):ie(Er,Hr,Dt,E,C,Ie);if(!(Sn===void 0?Er===Hr||We(Er,Hr,Y,ie,Ie):Sn)){er=!1;break}Nr||(Nr=Dt=="constructor")}if(er&&!Nr){var Li=E.constructor,zt=C.constructor;Li!=zt&&"constructor"in E&&"constructor"in C&&!(typeof Li=="function"&&Li instanceof Li&&typeof zt=="function"&&zt instanceof zt)&&(er=!1)}return Ie.delete(E),Ie.delete(C),er}function Xi(E){return In(E,Yo,fs)}function pi(E,C){var Y=E.__data__;return ds(C)?Y[typeof C=="string"?"string":"hash"]:Y.map}function dr(E,C){var Y=qe(E,C);return Vo(Y)?Y:void 0}function ls(E){var C=Ue.call(E,Zt),Y=E[Zt];try{E[Zt]=void 0;var ie=!0}catch{}var We=$t.call(E);return ie&&(C?E[Zt]=Y:delete E[Zt]),We}var fs=Gr?function(E){return E==null?[]:(E=Object(E),Fe(Gr(E),function(C){return sr.call(E,C)}))}:Ge,Ur=Ci;(pt&&Ur(new pt(new ArrayBuffer(1)))!=w||it&&Ur(new it)!=ee||dt&&Ur(dt.resolve())!=fe||gt&&Ur(new gt)!=U||ut&&Ur(new ut)!=g)&&(Ur=function(E){var C=Ci(E),Y=C==le?E.constructor:void 0,ie=Y?Jr(Y):"";if(ie)switch(ie){case Rt:return w;case At:return ee;case yt:return fe;case Ct:return U;case vt:return g}return C});function ps(E,C){return C=C??d,!!C&&(typeof E=="number"||lt.test(E))&&E>-1&&E%1==0&&E<C}function ds(E){var C=typeof E;return C=="string"||C=="number"||C=="symbol"||C=="boolean"?E!=="__proto__":E===null}function gs(E){return!!Ot&&Ot in E}function ys(E){var C=E&&E.constructor,Y=typeof C=="function"&&C.prototype||$e;return E===Y}function Wo(E){return $t.call(E)}function Jr(E){if(E!=null){try{return ft.call(E)}catch{}try{return E+""}catch{}}return""}function vs(E,C){return E===C||E!==E&&C!==C}var ms=xn(function(){return arguments}())?xn:function(E){return Ni(E)&&Ue.call(E,"callee")&&!sr.call(E,"callee")},Zi=Array.isArray;function Jo(E){return E!=null&&_s(E.length)&&!en(E)}var Pn=fi||ke;function Qo(E,C){return Ti(E,C)}function en(E){if(!ws(E))return!1;var C=Ci(E);return C==K||C==F||C==b||C==pe}function _s(E){return typeof E=="number"&&E>-1&&E%1==0&&E<=d}function ws(E){var C=typeof E;return E!=null&&(C=="object"||C=="function")}function Ni(E){return E!=null&&typeof E=="object"}var bs=Se?wt(Se):cs;function Yo(E){return Jo(E)?os(E):us(E)}function Ge(){return[]}function ke(){return!1}a.exports=Qo})(wo,wo.exports);var ow=wo.exports;const aw=Eo(ow);function cw(a,t){return t=t||{},new Promise(function(r,n){var o=new XMLHttpRequest,h=[],d=[],_={},x=function(){return{ok:(o.status/100|0)==2,statusText:o.statusText,status:o.status,url:o.responseURL,text:function(){return Promise.resolve(o.responseText)},json:function(){return Promise.resolve(o.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([o.response]))},clone:x,headers:{keys:function(){return h},entries:function(){return d},get:function(S){return _[S.toLowerCase()]},has:function(S){return S.toLowerCase()in _}}}};for(var b in o.open(t.method||"get",a,!0),o.onload=function(){o.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(S,D,M){h.push(D=D.toLowerCase()),d.push([D,M]),_[D]=_[D]?_[D]+","+M:M}),r(x())},o.onerror=n,o.withCredentials=t.credentials=="include",t.headers)o.setRequestHeader(b,t.headers[b]);o.send(t.body||null)})}const uw=Object.freeze(Object.defineProperty({__proto__:null,default:cw},Symbol.toStringTag,{value:"Module"})),gl=Ql(uw);var hw=self.fetch||(self.fetch=gl.default||gl);const lw=Eo(hw);function fw(a,t){if(a.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<a.length;o++){var h=a.charAt(o),d=h.charCodeAt(0);if(r[d]!==255)throw new TypeError(h+" is ambiguous");r[d]=o}var _=a.length,x=a.charAt(0),b=Math.log(_)/Math.log(256),S=Math.log(256)/Math.log(_);function D(F){if(F instanceof Uint8Array||(ArrayBuffer.isView(F)?F=new Uint8Array(F.buffer,F.byteOffset,F.byteLength):Array.isArray(F)&&(F=Uint8Array.from(F))),!(F instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(F.length===0)return"";for(var ee=0,oe=0,he=0,le=F.length;he!==le&&F[he]===0;)he++,ee++;for(var fe=(le-he)*S+1>>>0,pe=new Uint8Array(fe);he!==le;){for(var de=F[he],U=0,Q=fe-1;(de!==0||U<oe)&&Q!==-1;Q--,U++)de+=256*pe[Q]>>>0,pe[Q]=de%_>>>0,de=de/_>>>0;if(de!==0)throw new Error("Non-zero carry");oe=U,he++}for(var $=fe-oe;$!==fe&&pe[$]===0;)$++;for(var ue=x.repeat(ee);$<fe;++$)ue+=a.charAt(pe[$]);return ue}function M(F){if(typeof F!="string")throw new TypeError("Expected String");if(F.length===0)return new Uint8Array;var ee=0;if(F[ee]!==" "){for(var oe=0,he=0;F[ee]===x;)oe++,ee++;for(var le=(F.length-ee)*b+1>>>0,fe=new Uint8Array(le);F[ee];){var pe=r[F.charCodeAt(ee)];if(pe===255)return;for(var de=0,U=le-1;(pe!==0||de<he)&&U!==-1;U--,de++)pe+=_*fe[U]>>>0,fe[U]=pe%256>>>0,pe=pe/256>>>0;if(pe!==0)throw new Error("Non-zero carry");he=de,ee++}if(F[ee]!==" "){for(var Q=le-he;Q!==le&&fe[Q]===0;)Q++;for(var $=new Uint8Array(oe+(le-Q)),ue=oe;Q!==le;)$[ue++]=fe[Q++];return $}}}function K(F){var ee=M(F);if(ee)return ee;throw new Error(`Non-${t} character`)}return{encode:D,decodeUnsafe:M,decode:K}}var pw=fw,dw=pw;const Lf=a=>{if(a instanceof Uint8Array&&a.constructor.name==="Uint8Array")return a;if(a instanceof ArrayBuffer)return new Uint8Array(a);if(ArrayBuffer.isView(a))return new Uint8Array(a.buffer,a.byteOffset,a.byteLength);throw new Error("Unknown type, must be binary type")},gw=a=>new TextEncoder().encode(a),yw=a=>new TextDecoder().decode(a);class vw{constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class mw{constructor(t,r,n){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Df(this,t)}}class _w{constructor(t){this.decoders=t}or(t){return Df(this,t)}decode(t){const r=t[0],n=this.decoders[r];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Df=(a,t)=>new _w({...a.decoders||{[a.prefix]:a},...t.decoders||{[t.prefix]:t}});class ww{constructor(t,r,n,o){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=o,this.encoder=new vw(t,r,n),this.decoder=new mw(t,r,o)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const Ao=({name:a,prefix:t,encode:r,decode:n})=>new ww(a,t,r,n),rs=({prefix:a,name:t,alphabet:r})=>{const{encode:n,decode:o}=dw(r,t);return Ao({prefix:a,name:t,encode:n,decode:h=>Lf(o(h))})},bw=(a,t,r,n)=>{const o={};for(let S=0;S<t.length;++S)o[t[S]]=S;let h=a.length;for(;a[h-1]==="=";)--h;const d=new Uint8Array(h*r/8|0);let _=0,x=0,b=0;for(let S=0;S<h;++S){const D=o[a[S]];if(D===void 0)throw new SyntaxError(`Non-${n} character`);x=x<<r|D,_+=r,_>=8&&(_-=8,d[b++]=255&x>>_)}if(_>=r||255&x<<8-_)throw new SyntaxError("Unexpected end of data");return d},Ew=(a,t,r)=>{const n=t[t.length-1]==="=",o=(1<<r)-1;let h="",d=0,_=0;for(let x=0;x<a.length;++x)for(_=_<<8|a[x],d+=8;d>r;)d-=r,h+=t[o&_>>d];if(d&&(h+=t[o&_<<r-d]),n)for(;h.length*r&7;)h+="=";return h},Gt=({name:a,prefix:t,bitsPerChar:r,alphabet:n})=>Ao({prefix:t,name:a,encode(o){return Ew(o,n,r)},decode(o){return bw(o,n,r,a)}}),Iw=Ao({prefix:"\0",name:"identity",encode:a=>yw(a),decode:a=>gw(a)});var xw=Object.freeze({__proto__:null,identity:Iw});const Pw=Gt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Sw=Object.freeze({__proto__:null,base2:Pw});const Ow=Gt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Rw=Object.freeze({__proto__:null,base8:Ow});const Aw=rs({prefix:"9",name:"base10",alphabet:"0123456789"});var Cw=Object.freeze({__proto__:null,base10:Aw});const Tw=Gt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Nw=Gt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Lw=Object.freeze({__proto__:null,base16:Tw,base16upper:Nw});const Dw=Gt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Fw=Gt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),$w=Gt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),jw=Gt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Mw=Gt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),qw=Gt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),zw=Gt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Uw=Gt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Hw=Gt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Bw=Object.freeze({__proto__:null,base32:Dw,base32upper:Fw,base32pad:$w,base32padupper:jw,base32hex:Mw,base32hexupper:qw,base32hexpad:zw,base32hexpadupper:Uw,base32z:Hw});const kw=rs({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Kw=rs({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Vw=Object.freeze({__proto__:null,base36:kw,base36upper:Kw});const Gw=rs({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Ww=rs({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Jw=Object.freeze({__proto__:null,base58btc:Gw,base58flickr:Ww});const Qw=Gt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Yw=Gt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Xw=Gt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Zw=Gt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var eb=Object.freeze({__proto__:null,base64:Qw,base64pad:Yw,base64url:Xw,base64urlpad:Zw});const Ff=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),tb=Ff.reduce((a,t,r)=>(a[r]=t,a),[]),rb=Ff.reduce((a,t,r)=>(a[t.codePointAt(0)]=r,a),[]);function ib(a){return a.reduce((t,r)=>(t+=tb[r],t),"")}function nb(a){const t=[];for(const r of a){const n=rb[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(n)}return new Uint8Array(t)}const sb=Ao({prefix:"🚀",name:"base256emoji",encode:ib,decode:nb});var ob=Object.freeze({__proto__:null,base256emoji:sb}),ab=$f,yl=128,cb=127,ub=~cb,hb=Math.pow(2,31);function $f(a,t,r){t=t||[],r=r||0;for(var n=r;a>=hb;)t[r++]=a&255|yl,a/=128;for(;a&ub;)t[r++]=a&255|yl,a>>>=7;return t[r]=a|0,$f.bytes=r-n+1,t}var lb=bc,fb=128,vl=127;function bc(a,n){var r=0,n=n||0,o=0,h=n,d,_=a.length;do{if(h>=_)throw bc.bytes=0,new RangeError("Could not decode varint");d=a[h++],r+=o<28?(d&vl)<<o:(d&vl)*Math.pow(2,o),o+=7}while(d>=fb);return bc.bytes=h-n,r}var pb=Math.pow(2,7),db=Math.pow(2,14),gb=Math.pow(2,21),yb=Math.pow(2,28),vb=Math.pow(2,35),mb=Math.pow(2,42),_b=Math.pow(2,49),wb=Math.pow(2,56),bb=Math.pow(2,63),Eb=function(a){return a<pb?1:a<db?2:a<gb?3:a<yb?4:a<vb?5:a<mb?6:a<_b?7:a<wb?8:a<bb?9:10},Ib={encode:ab,decode:lb,encodingLength:Eb},jf=Ib;const ml=(a,t,r=0)=>(jf.encode(a,t,r),t),_l=a=>jf.encodingLength(a),Ec=(a,t)=>{const r=t.byteLength,n=_l(a),o=n+_l(r),h=new Uint8Array(o+r);return ml(a,h,0),ml(r,h,n),h.set(t,o),new xb(a,r,t,h)};class xb{constructor(t,r,n,o){this.code=t,this.size=r,this.digest=n,this.bytes=o}}const Mf=({name:a,code:t,encode:r})=>new Pb(a,t,r);class Pb{constructor(t,r,n){this.name=t,this.code=r,this.encode=n}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?Ec(this.code,r):r.then(n=>Ec(this.code,n))}else throw Error("Unknown type, must be binary type")}}const qf=a=>async t=>new Uint8Array(await crypto.subtle.digest(a,t)),Sb=Mf({name:"sha2-256",code:18,encode:qf("SHA-256")}),Ob=Mf({name:"sha2-512",code:19,encode:qf("SHA-512")});var Rb=Object.freeze({__proto__:null,sha256:Sb,sha512:Ob});const zf=0,Ab="identity",Uf=Lf,Cb=a=>Ec(zf,Uf(a)),Tb={code:zf,name:Ab,encode:Uf,digest:Cb};var Nb=Object.freeze({__proto__:null,identity:Tb});new TextEncoder,new TextDecoder;const wl={...xw,...Sw,...Rw,...Cw,...Lw,...Bw,...Vw,...Jw,...eb,...ob};({...Rb,...Nb});function Hf(a){return globalThis.Buffer!=null?new Uint8Array(a.buffer,a.byteOffset,a.byteLength):a}function Lb(a=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Hf(globalThis.Buffer.allocUnsafe(a)):new Uint8Array(a)}function Bf(a,t,r,n){return{name:a,prefix:t,encoder:{name:a,prefix:t,encode:r},decoder:{decode:n}}}const bl=Bf("utf8","u",a=>"u"+new TextDecoder("utf8").decode(a),a=>new TextEncoder().encode(a.substring(1))),uc=Bf("ascii","a",a=>{let t="a";for(let r=0;r<a.length;r++)t+=String.fromCharCode(a[r]);return t},a=>{a=a.substring(1);const t=Lb(a.length);for(let r=0;r<a.length;r++)t[r]=a.charCodeAt(r);return t}),Db={utf8:bl,"utf-8":bl,hex:wl.base16,latin1:uc,ascii:uc,binary:uc,...wl};function Fb(a,t="utf8"){const r=Db[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Hf(globalThis.Buffer.from(a,"utf-8")):r.decoder.decode(`${r.prefix}${a}`)}const kf="wc",$b=2,Fc="core",Pi=`${kf}@2:${Fc}:`,jb={name:Fc,logger:"error"},Mb={database:":memory:"},qb="crypto",El="client_ed25519_seed",zb=ge.ONE_DAY,Ub="keychain",Hb="0.3",Bb="messages",kb="0.3",Kb=ge.SIX_HOURS,Vb="publisher",Kf="irn",Gb="error",Vf="wss://relay.walletconnect.com",Il="wss://relay.walletconnect.org",Wb="relayer",Yt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},Jb="_subscription",ai={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},Qb=ge.ONE_SECOND,Yb="2.11.0",Xb=1e4,Zb="0.3",eE="WALLETCONNECT_CLIENT_ID",jr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},tE="subscription",rE="0.3",iE=ge.FIVE_SECONDS*1e3,nE="pairing",sE="0.3",kn={wc_pairingDelete:{req:{ttl:ge.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ge.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ge.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ge.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ge.ONE_DAY,prompt:!1,tag:0},res:{ttl:ge.ONE_DAY,prompt:!1,tag:0}}},Qn={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Vr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},oE="history",aE="0.3",cE="expirer",Cr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},uE="0.3",hc="verify-api",vn="https://verify.walletconnect.com",Ic="https://verify.walletconnect.org",hE=[vn,Ic],lE="echo",fE="https://echo.walletconnect.com";class pE{constructor(t,r){this.core=t,this.logger=r,this.keychain=new Map,this.name=Ub,this.version=Hb,this.initialized=!1,this.storagePrefix=Pi,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,o)=>{this.isInitialized(),this.keychain.set(n,o),await this.persist()},this.get=n=>{this.isInitialized();const o=this.keychain.get(n);if(typeof o>"u"){const{message:h}=ne("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(h)}return o},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=t,this.logger=Ne.generateChildLogger(r,this.name)}get context(){return Ne.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,rf(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?nf(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=ne("NOT_INITIALIZED",this.name);throw new Error(t)}}}class dE{constructor(t,r,n){this.core=t,this.logger=r,this.name=qb,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),h=al(o);return xf(h.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=Fm();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const h=await this.getClientSeed(),d=al(h),_=mc();return await j1(_,o,zb,d)},this.generateSharedKey=(o,h,d)=>{this.isInitialized();const _=this.getPrivateKey(o),x=$m(_,h);return this.setSymKey(x,d)},this.setSymKey=async(o,h)=>{this.isInitialized();const d=h||jm(o);return await this.keychain.set(d,o),d},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,h,d)=>{this.isInitialized();const _=Mm(d),x=ki(h);if(qh(_)){const M=_.senderPublicKey,K=_.receiverPublicKey;o=await this.generateSharedKey(M,K)}const b=this.getSymKey(o),{type:S,senderPublicKey:D}=_;return qm({type:S,symKey:b,message:x,senderPublicKey:D})},this.decode=async(o,h,d)=>{this.isInitialized();const _=zm(h,d);if(qh(_)){const x=_.receiverPublicKey,b=_.senderPublicKey;o=await this.generateSharedKey(x,b)}try{const x=this.getSymKey(o),b=Um({symKey:x,encoded:h});return ts(b)}catch(x){this.logger.error(`Failed to decode message from topic: '${o}', clientId: '${await this.getClientId()}'`),this.logger.error(x)}},this.getPayloadType=o=>{const h=zh(o);return Hm(h.type)},this.getPayloadSenderPublicKey=o=>{const h=zh(o);return h.senderPublicKey?Io(h.senderPublicKey,Bm):void 0},this.core=t,this.logger=Ne.generateChildLogger(r,this.name),this.keychain=n||new pE(this.core,this.logger)}get context(){return Ne.getLoggerContext(this.logger)}async setPrivateKey(t,r){return await this.keychain.set(t,r),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(El)}catch{t=mc(),await this.keychain.set(El,t)}return Fb(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=ne("NOT_INITIALIZED",this.name);throw new Error(t)}}}class gE extends d1{constructor(t,r){super(t,r),this.logger=t,this.core=r,this.messages=new Map,this.name=Bb,this.version=kb,this.initialized=!1,this.storagePrefix=Pi,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,o)=>{this.isInitialized();const h=mn(o);let d=this.messages.get(n);return typeof d>"u"&&(d={}),typeof d[h]<"u"||(d[h]=o,this.messages.set(n,d),await this.persist()),h},this.get=n=>{this.isInitialized();let o=this.messages.get(n);return typeof o>"u"&&(o={}),o},this.has=(n,o)=>{this.isInitialized();const h=this.get(n),d=mn(o);return typeof h[d]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=Ne.generateChildLogger(t,this.name),this.core=r}get context(){return Ne.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,rf(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?nf(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=ne("NOT_INITIALIZED",this.name);throw new Error(t)}}}class yE extends g1{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.events=new wr.EventEmitter,this.name=Vb,this.queue=new Map,this.publishTimeout=ge.toMiliseconds(ge.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(n,o,h)=>{var d;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:o,opts:h}});try{const _=(h==null?void 0:h.ttl)||Kb,x=_c(h),b=(h==null?void 0:h.prompt)||!1,S=(h==null?void 0:h.tag)||0,D=(h==null?void 0:h.id)||Cf().toString(),M={topic:n,message:o,opts:{ttl:_,relay:x,prompt:b,tag:S,id:D}},K=setTimeout(()=>this.queue.set(D,M),this.publishTimeout);try{await await Zn(this.rpcPublish(n,o,_,x,b,S,D),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(D),this.relayer.events.emit(Yt.publish,M)}catch(F){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(d=h==null?void 0:h.internal)!=null&&d.throwOnFailedPublish)throw this.removeRequestFromQueue(D),F;return}finally{clearTimeout(K)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:o,opts:h}})}catch(_){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(_),_}},this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.relayer=t,this.logger=Ne.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Ne.getLoggerContext(this.logger)}rpcPublish(t,r,n,o,h,d,_){var x,b,S,D;const M={method:po(o.protocol).publish,params:{topic:t,message:r,ttl:n,prompt:h,tag:d},id:_};return xi((x=M.params)==null?void 0:x.prompt)&&((b=M.params)==null||delete b.prompt),xi((S=M.params)==null?void 0:S.tag)&&((D=M.params)==null||delete D.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:M}),this.relayer.request(M)}removeRequestFromQueue(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:r,message:n,opts:o}=t;await this.publish(r,n,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(En.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Yt.connection_stalled);return}this.checkQueue()}),this.relayer.on(Yt.message_ack,t=>{this.removeRequestFromQueue(t.id.toString())})}}class vE{constructor(){this.map=new Map,this.set=(t,r)=>{const n=this.get(t);this.exists(t,r)||this.map.set(t,[...n,r])},this.get=t=>this.map.get(t)||[],this.exists=(t,r)=>this.get(t).includes(r),this.delete=(t,r)=>{if(typeof r>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const n=this.get(t);if(!this.exists(t,r))return;const o=n.filter(h=>h!==r);if(!o.length){this.map.delete(t);return}this.map.set(t,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var mE=Object.defineProperty,_E=Object.defineProperties,wE=Object.getOwnPropertyDescriptors,xl=Object.getOwnPropertySymbols,bE=Object.prototype.hasOwnProperty,EE=Object.prototype.propertyIsEnumerable,Pl=(a,t,r)=>t in a?mE(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,Kn=(a,t)=>{for(var r in t||(t={}))bE.call(t,r)&&Pl(a,r,t[r]);if(xl)for(var r of xl(t))EE.call(t,r)&&Pl(a,r,t[r]);return a},lc=(a,t)=>_E(a,wE(t));class IE extends m1{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.subscriptions=new Map,this.topicMap=new vE,this.events=new wr.EventEmitter,this.name=tE,this.version=rE,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Pi,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(n,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:o}});try{const h=_c(o),d={topic:n,relay:h};this.pending.set(n,d);const _=await this.rpcSubscribe(n,h);return this.onSubscribe(_,d),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:o}}),_}catch(h){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(h),h}},this.unsubscribe=async(n,o)=>{await this.restartToComplete(),this.isInitialized(),typeof(o==null?void 0:o.id)<"u"?await this.unsubscribeById(n,o.id,o):await this.unsubscribeByTopic(n,o)},this.isSubscribed=async n=>this.topics.includes(n)?!0:await new Promise((o,h)=>{const d=new ge.Watch;d.start(this.pendingSubscriptionWatchLabel);const _=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(_),d.stop(this.pendingSubscriptionWatchLabel),o(!0)),d.elapsed(this.pendingSubscriptionWatchLabel)>=iE&&(clearInterval(_),d.stop(this.pendingSubscriptionWatchLabel),h(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=t,this.logger=Ne.generateChildLogger(r,this.name),this.clientId=""}get context(){return Ne.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,r){let n=!1;try{n=this.getSubscription(t).topic===r}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,r){const n=this.topicMap.get(t);await Promise.all(n.map(async o=>await this.unsubscribeById(t,o,r)))}async unsubscribeById(t,r,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:n}});try{const o=_c(n);await this.rpcUnsubscribe(t,r,o);const h=Qt("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,r,h),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:n}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(t,r){const n={method:po(r.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await Zn(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Yt.connection_stalled)}return mn(t+this.clientId)}async rpcBatchSubscribe(t){if(!t.length)return;const r=t[0].relay,n={method:po(r.protocol).batchSubscribe,params:{topics:t.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{return await await Zn(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Yt.connection_stalled)}}rpcUnsubscribe(t,r,n){const o={method:po(n.protocol).unsubscribe,params:{topic:t,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(t,r){this.setSubscription(t,lc(Kn({},r),{id:t})),this.pending.delete(r.topic)}onBatchSubscribe(t){t.length&&t.forEach(r=>{this.setSubscription(r.id,Kn({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(t,r,n){this.events.removeAllListeners(r),this.hasSubscription(r,t)&&this.deleteSubscription(r,n),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,r){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:r}),this.addSubscription(t,r))}addSubscription(t,r){this.subscriptions.set(t,Kn({},r)),this.topicMap.set(r.topic,t),this.events.emit(jr.created,r)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const r=this.subscriptions.get(t);if(!r){const{message:n}=ne("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(n)}return r}deleteSubscription(t,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:r});const n=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(n.topic,t),this.events.emit(jr.deleted,lc(Kn({},n),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(jr.sync)}async reset(){if(this.cached.length){const t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){const n=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(n)}}this.events.emit(jr.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:r}=ne("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){if(!t.length)return;const r=await this.rpcBatchSubscribe(t);bn(r)&&this.onBatchSubscribe(r.map((n,o)=>lc(Kn({},t[o]),{id:n})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const t=[];this.pending.forEach(r=>{t.push(r)}),await this.batchSubscribe(t)}registerEventListeners(){this.relayer.core.heartbeat.on(En.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Yt.connect,async()=>{await this.onConnect()}),this.relayer.on(Yt.disconnect,()=>{this.onDisconnect()}),this.events.on(jr.created,async t=>{const r=jr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()}),this.events.on(jr.deleted,async t=>{const r=jr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=ne("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){this.restartInProgress&&await new Promise(t=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),t())},this.pollingInterval)})}}var xE=Object.defineProperty,Sl=Object.getOwnPropertySymbols,PE=Object.prototype.hasOwnProperty,SE=Object.prototype.propertyIsEnumerable,Ol=(a,t,r)=>t in a?xE(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,OE=(a,t)=>{for(var r in t||(t={}))PE.call(t,r)&&Ol(a,r,t[r]);if(Sl)for(var r of Sl(t))SE.call(t,r)&&Ol(a,r,t[r]);return a};class RE extends y1{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new wr.EventEmitter,this.name=Wb,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(n){throw this.logger.debug("Failed to Publish Request"),this.logger.error(n),n}},this.onPayloadHandler=r=>{this.onProviderPayload(r)},this.onConnectHandler=()=>{this.events.emit(Yt.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=r=>{this.logger.error(r),this.events.emit(Yt.error,r),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(ai.payload,this.onPayloadHandler),this.provider.on(ai.connect,this.onConnectHandler),this.provider.on(ai.disconnect,this.onDisconnectHandler),this.provider.on(ai.error,this.onProviderErrorHandler)},this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?Ne.generateChildLogger(t.logger,this.name):Ne.pino(Ne.getDefaultLoggerOptions({level:t.logger||Gb})),this.messages=new gE(this.logger,t.core),this.subscriber=new IE(this,this.logger),this.publisher=new yE(this,this.logger),this.relayUrl=(t==null?void 0:t.relayUrl)||Vf,this.projectId=t.projectId,this.bundleId=km(),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${Il}...`),await this.restartTransport(Il)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},Xb)}get context(){return Ne.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,r,n){this.isInitialized(),await this.publisher.publish(t,r,n),await this.recordMessageEvent({topic:t,message:r,publishedAt:Date.now()})}async subscribe(t,r){var n;this.isInitialized();let o=((n=this.subscriber.topicMap.get(t))==null?void 0:n[0])||"";if(o)return o;let h;const d=_=>{_.topic===t&&(this.subscriber.off(jr.created,d),h())};return await Promise.all([new Promise(_=>{h=_,this.subscriber.on(jr.created,d)}),new Promise(async _=>{o=await this.subscriber.subscribe(t,r),_()})]),o}async unsubscribe(t,r){this.isInitialized(),await this.subscriber.unsubscribe(t,r)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await Zn(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(t){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){t&&t!==this.relayUrl&&(this.relayUrl=t,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(r=>{if(!this.initialized)return r();this.subscriber.once(jr.resubscribed,()=>{r()})}),new Promise(async(r,n)=>{try{await Zn(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(o){n(o);return}r()})])}catch(r){this.logger.error(r);const n=r;if(!this.isConnectionStalled(n.message))throw r;this.provider.events.emit(ai.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(t){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=t||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Uh())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(t){return this.staleConnectionErrors.some(r=>t.includes(r))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new hi(new sw(Km({sdkVersion:Yb,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(t){const{topic:r,message:n}=t;await this.messages.set(r,n)}async shouldIgnoreMessageEvent(t){const{topic:r,message:n}=t;if(!n||n.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${n}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.debug(`Ignoring message for non-subscribed topic ${r}`),!0;const o=this.messages.has(r,n);return o&&this.logger.debug(`Ignoring duplicate message: ${n}`),o}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),Dc(t)){if(!t.method.endsWith(Jb))return;const r=t.params,{topic:n,message:o,publishedAt:h}=r.data,d={topic:n,message:o,publishedAt:h};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(OE({type:"event",event:r.id},d)),this.events.emit(r.id,d),await this.acknowledgePayload(t),await this.onMessageEvent(d)}else Ro(t)&&this.events.emit(Yt.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(Yt.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const r=So(t.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(ai.payload,this.onPayloadHandler),this.provider.off(ai.connect,this.onConnectHandler),this.provider.off(ai.disconnect,this.onDisconnectHandler),this.provider.off(ai.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(Yt.connection_stalled,()=>{this.restartTransport().catch(r=>this.logger.error(r))});let t=await Uh();Vm(async r=>{this.initialized&&t!==r&&(t=r,r?await this.restartTransport().catch(n=>this.logger.error(n)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(n=>this.logger.error(n))))})}onProviderDisconnect(){this.events.emit(Yt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(t=>this.logger.error(t))},ge.toMiliseconds(Qb)))}isInitialized(){if(!this.initialized){const{message:t}=ne("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(t=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),t())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var AE=Object.defineProperty,Rl=Object.getOwnPropertySymbols,CE=Object.prototype.hasOwnProperty,TE=Object.prototype.propertyIsEnumerable,Al=(a,t,r)=>t in a?AE(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,Cl=(a,t)=>{for(var r in t||(t={}))CE.call(t,r)&&Al(a,r,t[r]);if(Rl)for(var r of Rl(t))TE.call(t,r)&&Al(a,r,t[r]);return a};class Co extends v1{constructor(t,r,n,o=Pi,h=void 0){super(t,r,n,o),this.core=t,this.logger=r,this.name=n,this.map=new Map,this.version=Zb,this.cached=[],this.initialized=!1,this.storagePrefix=Pi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(d=>{this.getKey&&d!==null&&!xi(d)?this.map.set(this.getKey(d),d):Lm(d)?this.map.set(d.id,d):Dm(d)&&this.map.set(d.topic,d)}),this.cached=[],this.initialized=!0)},this.set=async(d,_)=>{this.isInitialized(),this.map.has(d)?await this.update(d,_):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:d,value:_}),this.map.set(d,_),await this.persist())},this.get=d=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:d}),this.getData(d)),this.getAll=d=>(this.isInitialized(),d?this.values.filter(_=>Object.keys(d).every(x=>aw(_[x],d[x]))):this.values),this.update=async(d,_)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:d,update:_});const x=Cl(Cl({},this.getData(d)),_);this.map.set(d,x),await this.persist()},this.delete=async(d,_)=>{this.isInitialized(),this.map.has(d)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:d,reason:_}),this.map.delete(d),await this.persist())},this.logger=Ne.generateChildLogger(r,this.name),this.storagePrefix=o,this.getKey=h}get context(){return Ne.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const r=this.map.get(t);if(!r){const{message:n}=ne("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(n),new Error(n)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:r}=ne("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=ne("NOT_INITIALIZED",this.name);throw new Error(t)}}}class NE{constructor(t,r){this.core=t,this.logger=r,this.name=nE,this.version=sE,this.events=new Cc,this.initialized=!1,this.storagePrefix=Pi,this.ignoredPayloadTypes=[Zl],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async()=>{this.isInitialized();const n=mc(),o=await this.core.crypto.setSymKey(n),h=Mr(ge.FIVE_MINUTES),d={protocol:Kf},_={topic:o,expiry:h,relay:d,active:!1},x=Gm({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:n,relay:d});return await this.pairings.set(o,_),await this.core.relayer.subscribe(o),this.core.expirer.set(o,h),{topic:o,uri:x}},this.pair=async n=>{this.isInitialized(),this.isValidPair(n);const{topic:o,symKey:h,relay:d}=Hh(n.uri);let _;if(this.pairings.keys.includes(o)&&(_=this.pairings.get(o),_.active))throw new Error(`Pairing already exists: ${o}. Please try again with a new connection URI.`);const x=Mr(ge.FIVE_MINUTES),b={topic:o,relay:d,expiry:x,active:!1};return await this.pairings.set(o,b),this.core.expirer.set(o,x),n.activatePairing&&await this.activate({topic:o}),this.events.emit(Qn.create,b),this.core.crypto.keychain.has(o)||(await this.core.crypto.setSymKey(h,o),await this.core.relayer.subscribe(o,{relay:d})),b},this.activate=async({topic:n})=>{this.isInitialized();const o=Mr(ge.THIRTY_DAYS);await this.pairings.update(n,{active:!0,expiry:o}),this.core.expirer.set(n,o)},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:o}=n;if(this.pairings.keys.includes(o)){const h=await this.sendRequest(o,"wc_pairingPing",{}),{done:d,resolve:_,reject:x}=gn();this.events.once(Ft("pairing_ping",h),({error:b})=>{b?x(b):_()}),await d()}},this.updateExpiry=async({topic:n,expiry:o})=>{this.isInitialized(),await this.pairings.update(n,{expiry:o})},this.updateMetadata=async({topic:n,metadata:o})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:o}=n;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",Qt("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(n,o,h)=>{const d=wn(o,h),_=await this.core.crypto.encode(n,d),x=kn[o].req;return this.core.history.set(n,d),this.core.relayer.publish(n,_,x),d.id},this.sendResult=async(n,o,h)=>{const d=So(n,h),_=await this.core.crypto.encode(o,d),x=await this.core.history.get(o,n),b=kn[x.request.method].res;await this.core.relayer.publish(o,_,b),await this.core.history.resolve(d)},this.sendError=async(n,o,h)=>{const d=Oo(n,h),_=await this.core.crypto.encode(o,d),x=await this.core.history.get(o,n),b=kn[x.request.method]?kn[x.request.method].res:kn.unregistered_method.res;await this.core.relayer.publish(o,_,b),await this.core.history.resolve(d)},this.deletePairing=async(n,o)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,Qt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),o?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(o=>Ii(o.expiry));await Promise.all(n.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=n=>{const{topic:o,payload:h}=n;switch(h.method){case"wc_pairingPing":return this.onPairingPingRequest(o,h);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,h);default:return this.onUnknownRpcMethodRequest(o,h)}},this.onRelayEventResponse=async n=>{const{topic:o,payload:h}=n,d=(await this.core.history.get(o,h.id)).request.method;switch(d){case"wc_pairingPing":return this.onPairingPingResponse(o,h);default:return this.onUnknownRpcMethodResponse(d)}},this.onPairingPingRequest=async(n,o)=>{const{id:h}=o;try{this.isValidPing({topic:n}),await this.sendResult(h,n,!0),this.events.emit(Qn.ping,{id:h,topic:n})}catch(d){await this.sendError(h,n,d),this.logger.error(d)}},this.onPairingPingResponse=(n,o)=>{const{id:h}=o;setTimeout(()=>{ui(o)?this.events.emit(Ft("pairing_ping",h),{}):qr(o)&&this.events.emit(Ft("pairing_ping",h),{error:o.error})},500)},this.onPairingDeleteRequest=async(n,o)=>{const{id:h}=o;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit(Qn.delete,{id:h,topic:n})}catch(d){await this.sendError(h,n,d),this.logger.error(d)}},this.onUnknownRpcMethodRequest=async(n,o)=>{const{id:h,method:d}=o;try{if(this.registeredMethods.includes(d))return;const _=Qt("WC_METHOD_UNSUPPORTED",d);await this.sendError(h,n,_),this.logger.error(_)}catch(_){await this.sendError(h,n,_),this.logger.error(_)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(Qt("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=n=>{var o;if(!pr(n)){const{message:d}=ne("MISSING_OR_INVALID",`pair() params: ${n}`);throw new Error(d)}if(!Wm(n.uri)){const{message:d}=ne("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw new Error(d)}const h=Hh(n.uri);if(!((o=h==null?void 0:h.relay)!=null&&o.protocol)){const{message:d}=ne("MISSING_OR_INVALID","pair() uri#relay-protocol");throw new Error(d)}if(!(h!=null&&h.symKey)){const{message:d}=ne("MISSING_OR_INVALID","pair() uri#symKey");throw new Error(d)}},this.isValidPing=async n=>{if(!pr(n)){const{message:h}=ne("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(h)}const{topic:o}=n;await this.isValidPairingTopic(o)},this.isValidDisconnect=async n=>{if(!pr(n)){const{message:h}=ne("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(h)}const{topic:o}=n;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async n=>{if(!yn(n,!1)){const{message:o}=ne("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(o)}if(!this.pairings.keys.includes(n)){const{message:o}=ne("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(o)}if(Ii(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:o}=ne("EXPIRED",`pairing topic: ${n}`);throw new Error(o)}},this.core=t,this.logger=Ne.generateChildLogger(r,this.name),this.pairings=new Co(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Ne.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=ne("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(Yt.message,async t=>{const{topic:r,message:n}=t;if(!this.pairings.keys.includes(r)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const o=await this.core.crypto.decode(r,n);try{Dc(o)?(this.core.history.set(r,o),this.onRelayEventRequest({topic:r,payload:o})):Ro(o)&&(await this.core.history.resolve(o),await this.onRelayEventResponse({topic:r,payload:o}),this.core.history.delete(r,o.id))}catch(h){this.logger.error(h)}})}registerExpirerEvents(){this.core.expirer.on(Cr.expired,async t=>{const{topic:r}=ef(t.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(Qn.expire,{topic:r}))})}}class LE extends p1{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.records=new Map,this.events=new wr.EventEmitter,this.name=oE,this.version=aE,this.cached=[],this.initialized=!1,this.storagePrefix=Pi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,o,h)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:o,chainId:h}),this.records.has(o.id))return;const d={id:o.id,topic:n,request:{method:o.method,params:o.params||null},chainId:h,expiry:Mr(ge.THIRTY_DAYS)};this.records.set(d.id,d),this.events.emit(Vr.created,d)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const o=await this.getRecord(n.id);typeof o.response>"u"&&(o.response=qr(n)?{error:n.error}:{result:n.result},this.records.set(o.id,o),this.events.emit(Vr.updated,o))},this.get=async(n,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:o}),await this.getRecord(o)),this.delete=(n,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(h=>{if(h.topic===n){if(typeof o<"u"&&h.id!==o)return;this.records.delete(h.id),this.events.emit(Vr.deleted,h)}})},this.exists=async(n,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===n:!1),this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.logger=Ne.generateChildLogger(r,this.name)}get context(){return Ne.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const n={topic:r.topic,request:wn(r.request.method,r.request.params,r.id),chainId:r.chainId};return t.push(n)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const r=this.records.get(t);if(!r){const{message:n}=ne("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(n)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Vr.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:r}=ne("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(Vr.created,t=>{const r=Vr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Vr.updated,t=>{const r=Vr.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Vr.deleted,t=>{const r=Vr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.core.heartbeat.on(En.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(t=>{ge.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.delete(t.topic,t.id))})}catch(t){this.logger.warn(t)}}isInitialized(){if(!this.initialized){const{message:t}=ne("NOT_INITIALIZED",this.name);throw new Error(t)}}}class DE extends _1{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.expirations=new Map,this.events=new wr.EventEmitter,this.name=cE,this.version=uE,this.cached=[],this.initialized=!1,this.storagePrefix=Pi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const o=this.formatTarget(n);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(n,o)=>{this.isInitialized();const h=this.formatTarget(n),d={target:h,expiry:o};this.expirations.set(h,d),this.checkExpiry(h,d),this.events.emit(Cr.created,{target:h,expiration:d})},this.get=n=>{this.isInitialized();const o=this.formatTarget(n);return this.getExpiration(o)},this.del=n=>{if(this.isInitialized(),this.has(n)){const o=this.formatTarget(n),h=this.getExpiration(o);this.expirations.delete(o),this.events.emit(Cr.deleted,{target:o,expiration:h})}},this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.logger=Ne.generateChildLogger(r,this.name)}get context(){return Ne.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return Jm(t);if(typeof t=="number")return Qm(t);const{message:r}=ne("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(r)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Cr.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:r}=ne("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const r=this.expirations.get(t);if(!r){const{message:n}=ne("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(n),new Error(n)}return r}checkExpiry(t,r){const{expiry:n}=r;ge.toMiliseconds(n)-Date.now()<=0&&this.expire(t,r)}expire(t,r){this.expirations.delete(t),this.events.emit(Cr.expired,{target:t,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,r)=>this.checkExpiry(r,t))}registerEventListeners(){this.core.heartbeat.on(En.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Cr.created,t=>{const r=Cr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Cr.expired,t=>{const r=Cr.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Cr.deleted,t=>{const r=Cr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=ne("NOT_INITIALIZED",this.name);throw new Error(t)}}}class FE extends w1{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,this.name=hc,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async n=>{if(this.verifyDisabled||Ym()||!tf())return;const o=this.getVerifyUrl(n==null?void 0:n.verifyUrl);this.verifyUrl!==o&&this.removeIframe(),this.verifyUrl=o;try{await this.createIframe()}catch(h){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(h)}if(!this.initialized){this.removeIframe(),this.verifyUrl=Ic;try{await this.createIframe()}catch(h){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(h),this.verifyDisabled=!0}}},this.register=async n=>{this.initialized?this.sendPost(n.attestationId):(this.addToQueue(n.attestationId),await this.init())},this.resolve=async n=>{if(this.isDevEnv)return"";const o=this.getVerifyUrl(n==null?void 0:n.verifyUrl);let h;try{h=await this.fetchAttestation(n.attestationId,o)}catch(d){this.logger.info(`failed to resolve attestation: ${n.attestationId} from url: ${o}`),this.logger.info(d),h=await this.fetchAttestation(n.attestationId,Ic)}return h},this.fetchAttestation=async(n,o)=>{this.logger.info(`resolving attestation: ${n} from url: ${o}`);const h=this.startAbortTimer(ge.ONE_SECOND*2),d=await fetch(`${o}/attestation/${n}`,{signal:this.abortController.signal});return clearTimeout(h),d.status===200?await d.json():void 0},this.addToQueue=n=>{this.queue.push(n)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(n=>this.sendPost(n)),this.queue=[])},this.sendPost=n=>{var o;try{if(!this.iframe)return;(o=this.iframe.contentWindow)==null||o.postMessage(n,"*"),this.logger.info(`postMessage sent: ${n} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let n;const o=h=>{h.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",o),n())};await Promise.race([new Promise(h=>{if(document.getElementById(hc))return h();window.addEventListener("message",o);const d=document.createElement("iframe");d.id=hc,d.src=`${this.verifyUrl}/${this.projectId}`,d.style.display="none",document.body.append(d),this.iframe=d,n=h}),new Promise((h,d)=>setTimeout(()=>{window.removeEventListener("message",o),d("verify iframe load timeout")},ge.toMiliseconds(ge.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=n=>{let o=n||vn;return hE.includes(o)||(this.logger.info(`verify url: ${o}, not included in trusted list, assigning default: ${vn}`),o=vn),o},this.logger=Ne.generateChildLogger(r,this.name),this.verifyUrl=vn,this.abortController=new AbortController,this.isDevEnv=Xm()&&{}.IS_VITEST}get context(){return Ne.getLoggerContext(this.logger)}startAbortTimer(t){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),ge.toMiliseconds(t))}}class $E extends b1{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,this.context=lE,this.registerDeviceToken=async n=>{const{clientId:o,token:h,notificationType:d,enableEncrypted:_=!1}=n,x=`${fE}/${this.projectId}/clients`;await lw(x,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:o,type:d,token:h,always_raw:_})})},this.logger=Ne.generateChildLogger(r,this.context)}}var jE=Object.defineProperty,Tl=Object.getOwnPropertySymbols,ME=Object.prototype.hasOwnProperty,qE=Object.prototype.propertyIsEnumerable,Nl=(a,t,r)=>t in a?jE(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,Ll=(a,t)=>{for(var r in t||(t={}))ME.call(t,r)&&Nl(a,r,t[r]);if(Tl)for(var r of Tl(t))qE.call(t,r)&&Nl(a,r,t[r]);return a};class $c extends f1{constructor(t){super(t),this.protocol=kf,this.version=$b,this.name=Fc,this.events=new wr.EventEmitter,this.initialized=!1,this.on=(n,o)=>this.events.on(n,o),this.once=(n,o)=>this.events.once(n,o),this.off=(n,o)=>this.events.off(n,o),this.removeListener=(n,o)=>this.events.removeListener(n,o),this.projectId=t==null?void 0:t.projectId,this.relayUrl=(t==null?void 0:t.relayUrl)||Vf,this.customStoragePrefix=t!=null&&t.customStoragePrefix?`:${t.customStoragePrefix}`:"";const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Ne.pino(Ne.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||jb.logger}));this.logger=Ne.generateChildLogger(r,this.name),this.heartbeat=new En.HeartBeat,this.crypto=new dE(this,this.logger,t==null?void 0:t.keychain),this.history=new LE(this,this.logger),this.expirer=new DE(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new r1(Ll(Ll({},Mb),t==null?void 0:t.storageOptions)),this.relayer=new RE({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new NE(this,this.logger),this.verify=new FE(this.projectId||"",this.logger),this.echoClient=new $E(this.projectId||"",this.logger)}static async init(t){const r=new $c(t);await r.initialize();const n=await r.crypto.getClientId();return await r.storage.setItem(eE,n),r}get context(){return Ne.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}}const zE=$c,Gf="wc",Wf=2,Jf="client",jc=`${Gf}@${Wf}:${Jf}:`,fc={name:Jf,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},Dl="WALLETCONNECT_DEEPLINK_CHOICE",UE="proposal",Qf="Proposal expired",HE="session",ho=ge.SEVEN_DAYS,BE="engine",Vn={wc_sessionPropose:{req:{ttl:ge.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ge.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ge.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ge.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ge.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ge.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ge.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ge.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ge.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ge.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ge.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ge.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ge.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ge.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ge.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ge.THIRTY_SECONDS,prompt:!1,tag:1115}}},pc={min:ge.FIVE_MINUTES,max:ge.SEVEN_DAYS},ci={idle:"IDLE",active:"ACTIVE"},kE="request",KE=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var VE=Object.defineProperty,GE=Object.defineProperties,WE=Object.getOwnPropertyDescriptors,Fl=Object.getOwnPropertySymbols,JE=Object.prototype.hasOwnProperty,QE=Object.prototype.propertyIsEnumerable,$l=(a,t,r)=>t in a?VE(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,lr=(a,t)=>{for(var r in t||(t={}))JE.call(t,r)&&$l(a,r,t[r]);if(Fl)for(var r of Fl(t))QE.call(t,r)&&$l(a,r,t[r]);return a},Gn=(a,t)=>GE(a,WE(t));class YE extends I1{constructor(t){super(t),this.name=BE,this.events=new Cc,this.initialized=!1,this.ignoredPayloadTypes=[Zl],this.requestQueue={state:ci.idle,queue:[]},this.sessionRequestQueue={state:ci.idle,queue:[]},this.requestQueueDelay=ge.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(Vn)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},ge.toMiliseconds(this.requestQueueDelay)))},this.connect=async r=>{await this.isInitialized();const n=Gn(lr({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(n);const{pairingTopic:o,requiredNamespaces:h,optionalNamespaces:d,sessionProperties:_,relays:x}=n;let b=o,S,D=!1;if(b&&(D=this.client.core.pairing.pairings.get(b).active),!b||!D){const{topic:fe,uri:pe}=await this.client.core.pairing.create();b=fe,S=pe}const M=await this.client.core.crypto.generateKeyPair(),K=lr({requiredNamespaces:h,optionalNamespaces:d,relays:x??[{protocol:Kf}],proposer:{publicKey:M,metadata:this.client.metadata}},_&&{sessionProperties:_}),{reject:F,resolve:ee,done:oe}=gn(ge.FIVE_MINUTES,Qf);if(this.events.once(Ft("session_connect"),async({error:fe,session:pe})=>{if(fe)F(fe);else if(pe){pe.self.publicKey=M;const de=Gn(lr({},pe),{requiredNamespaces:pe.requiredNamespaces,optionalNamespaces:pe.optionalNamespaces});await this.client.session.set(pe.topic,de),await this.setExpiry(pe.topic,pe.expiry),b&&await this.client.core.pairing.updateMetadata({topic:b,metadata:pe.peer.metadata}),ee(de)}}),!b){const{message:fe}=ne("NO_MATCHING_KEY",`connect() pairing topic: ${b}`);throw new Error(fe)}const he=await this.sendRequest({topic:b,method:"wc_sessionPropose",params:K}),le=Mr(ge.FIVE_MINUTES);return await this.setProposal(he,lr({id:he,expiry:le},K)),{uri:S,approval:oe}},this.pair=async r=>(await this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{await this.isInitialized(),await this.isValidApprove(r);const{id:n,relayProtocol:o,namespaces:h,sessionProperties:d}=r,_=this.client.proposal.get(n);let{pairingTopic:x,proposer:b,requiredNamespaces:S,optionalNamespaces:D}=_;x=x||"",go(S)||(S=e_(h,"approve()"));const M=await this.client.core.crypto.generateKeyPair(),K=b.publicKey,F=await this.client.core.crypto.generateSharedKey(M,K);x&&n&&(await this.client.core.pairing.updateMetadata({topic:x,metadata:b.metadata}),await this.sendResult({id:n,topic:x,result:{relay:{protocol:o??"irn"},responderPublicKey:M}}),await this.client.proposal.delete(n,Qt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:x}));const ee=lr({relay:{protocol:o??"irn"},namespaces:h,requiredNamespaces:S,optionalNamespaces:D,pairingTopic:x,controller:{publicKey:M,metadata:this.client.metadata},expiry:Mr(ho)},d&&{sessionProperties:d});await this.client.core.relayer.subscribe(F),await this.sendRequest({topic:F,method:"wc_sessionSettle",params:ee,throwOnFailedPublish:!0});const oe=Gn(lr({},ee),{topic:F,pairingTopic:x,acknowledged:!1,self:ee.controller,peer:{publicKey:b.publicKey,metadata:b.metadata},controller:M});return await this.client.session.set(F,oe),await this.setExpiry(F,Mr(ho)),{topic:F,acknowledged:()=>new Promise(he=>setTimeout(()=>he(this.client.session.get(F)),500))}},this.reject=async r=>{await this.isInitialized(),await this.isValidReject(r);const{id:n,reason:o}=r,{pairingTopic:h}=this.client.proposal.get(n);h&&(await this.sendError(n,h,o),await this.client.proposal.delete(n,Qt("USER_DISCONNECTED")))},this.update=async r=>{await this.isInitialized(),await this.isValidUpdate(r);const{topic:n,namespaces:o}=r,h=await this.sendRequest({topic:n,method:"wc_sessionUpdate",params:{namespaces:o}}),{done:d,resolve:_,reject:x}=gn();return this.events.once(Ft("session_update",h),({error:b})=>{b?x(b):_()}),await this.client.session.update(n,{namespaces:o}),{acknowledged:d}},this.extend=async r=>{await this.isInitialized(),await this.isValidExtend(r);const{topic:n}=r,o=await this.sendRequest({topic:n,method:"wc_sessionExtend",params:{}}),{done:h,resolve:d,reject:_}=gn();return this.events.once(Ft("session_extend",o),({error:x})=>{x?_(x):d()}),await this.setExpiry(n,Mr(ho)),{acknowledged:h}},this.request=async r=>{await this.isInitialized(),await this.isValidRequest(r);const{chainId:n,request:o,topic:h,expiry:d}=r,_=Lc(),{done:x,resolve:b,reject:S}=gn(d,"Request expired. Please try again.");return this.events.once(Ft("session_request",_),({error:D,result:M})=>{D?S(D):b(M)}),await Promise.all([new Promise(async D=>{await this.sendRequest({clientRpcId:_,topic:h,method:"wc_sessionRequest",params:{request:o,chainId:n},expiry:d,throwOnFailedPublish:!0}).catch(M=>S(M)),this.client.events.emit("session_request_sent",{topic:h,request:o,chainId:n,id:_}),D()}),new Promise(async D=>{const M=await t_(this.client.core.storage,Dl);r_({id:_,topic:h,wcDeepLink:M}),D()}),x()]).then(D=>D[2])},this.respond=async r=>{await this.isInitialized(),await this.isValidRespond(r);const{topic:n,response:o}=r,{id:h}=o;ui(o)?await this.sendResult({id:h,topic:n,result:o.result,throwOnFailedPublish:!0}):qr(o)&&await this.sendError(h,n,o.error),this.cleanupAfterResponse(r)},this.ping=async r=>{await this.isInitialized(),await this.isValidPing(r);const{topic:n}=r;if(this.client.session.keys.includes(n)){const o=await this.sendRequest({topic:n,method:"wc_sessionPing",params:{}}),{done:h,resolve:d,reject:_}=gn();this.events.once(Ft("session_ping",o),({error:x})=>{x?_(x):d()}),await h()}else this.client.core.pairing.pairings.keys.includes(n)&&await this.client.core.pairing.ping({topic:n})},this.emit=async r=>{await this.isInitialized(),await this.isValidEmit(r);const{topic:n,event:o,chainId:h}=r;await this.sendRequest({topic:n,method:"wc_sessionEvent",params:{event:o,chainId:h}})},this.disconnect=async r=>{await this.isInitialized(),await this.isValidDisconnect(r);const{topic:n}=r;this.client.session.keys.includes(n)?(await this.sendRequest({topic:n,method:"wc_sessionDelete",params:Qt("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(n)):await this.client.core.pairing.disconnect({topic:n})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(n=>i_(n,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const n=this.client.core.pairing.pairings.get(r.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(h=>{var d,_;return((d=h.peerMetadata)==null?void 0:d.url)&&((_=h.peerMetadata)==null?void 0:_.url)===r.peer.metadata.url&&h.topic&&h.topic!==n.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(h=>this.client.core.pairing.disconnect({topic:h.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(n){this.client.logger.error(n)}},this.deleteSession=async(r,n)=>{const{self:o}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,Qt("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(o.publicKey)&&await this.client.core.crypto.deleteKeyPair(o.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),n||this.client.core.expirer.del(r),this.client.core.storage.removeItem(Dl).catch(h=>this.client.logger.warn(h)),this.getPendingSessionRequests().forEach(h=>{h.topic===r&&this.deletePendingSessionRequest(h.id,Qt("USER_DISCONNECTED"))})},this.deleteProposal=async(r,n)=>{await Promise.all([this.client.proposal.delete(r,Qt("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,n,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,n),o?Promise.resolve():this.client.core.expirer.del(r)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(h=>h.id!==r),o&&(this.sessionRequestQueue.state=ci.idle)},this.setExpiry=async(r,n)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:n}),this.client.core.expirer.set(r,n)},this.setProposal=async(r,n)=>{await this.client.proposal.set(r,n),this.client.core.expirer.set(r,n.expiry)},this.setPendingSessionRequest=async r=>{const n=Vn.wc_sessionRequest.req.ttl,{id:o,topic:h,params:d,verifyContext:_}=r;await this.client.pendingRequest.set(o,{id:o,topic:h,params:d,verifyContext:_}),n&&this.client.core.expirer.set(o,Mr(n))},this.sendRequest=async r=>{const{topic:n,method:o,params:h,expiry:d,relayRpcId:_,clientRpcId:x,throwOnFailedPublish:b}=r,S=wn(o,h,x);if(tf()&&KE.includes(o)){const K=mn(JSON.stringify(S));this.client.core.verify.register({attestationId:K})}const D=await this.client.core.crypto.encode(n,S),M=Vn[o].req;return d&&(M.ttl=d),_&&(M.id=_),this.client.core.history.set(n,S),b?(M.internal=Gn(lr({},M.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,D,M)):this.client.core.relayer.publish(n,D,M).catch(K=>this.client.logger.error(K)),S.id},this.sendResult=async r=>{const{id:n,topic:o,result:h,throwOnFailedPublish:d}=r,_=So(n,h),x=await this.client.core.crypto.encode(o,_),b=await this.client.core.history.get(o,n),S=Vn[b.request.method].res;d?(S.internal=Gn(lr({},S.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(o,x,S)):this.client.core.relayer.publish(o,x,S).catch(D=>this.client.logger.error(D)),await this.client.core.history.resolve(_)},this.sendError=async(r,n,o)=>{const h=Oo(r,o),d=await this.client.core.crypto.encode(n,h),_=await this.client.core.history.get(n,r),x=Vn[_.request.method].res;this.client.core.relayer.publish(n,d,x),await this.client.core.history.resolve(h)},this.cleanup=async()=>{const r=[],n=[];this.client.session.getAll().forEach(o=>{Ii(o.expiry)&&r.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{Ii(o.expiry)&&n.push(o.id)}),await Promise.all([...r.map(o=>this.deleteSession(o)),...n.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===ci.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=ci.active;const r=this.requestQueue.queue.shift();if(r)try{this.processRequest(r),await new Promise(n=>setTimeout(n,300))}catch(n){this.client.logger.warn(n)}}this.requestQueue.state=ci.idle},this.processRequest=r=>{const{topic:n,payload:o}=r,h=o.method;switch(h){case"wc_sessionPropose":return this.onSessionProposeRequest(n,o);case"wc_sessionSettle":return this.onSessionSettleRequest(n,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(n,o);case"wc_sessionExtend":return this.onSessionExtendRequest(n,o);case"wc_sessionPing":return this.onSessionPingRequest(n,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(n,o);case"wc_sessionRequest":return this.onSessionRequest(n,o);case"wc_sessionEvent":return this.onSessionEventRequest(n,o);default:return this.client.logger.info(`Unsupported request method ${h}`)}},this.onRelayEventResponse=async r=>{const{topic:n,payload:o}=r,h=(await this.client.core.history.get(n,o.id)).request.method;switch(h){case"wc_sessionPropose":return this.onSessionProposeResponse(n,o);case"wc_sessionSettle":return this.onSessionSettleResponse(n,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,o);case"wc_sessionExtend":return this.onSessionExtendResponse(n,o);case"wc_sessionPing":return this.onSessionPingResponse(n,o);case"wc_sessionRequest":return this.onSessionRequestResponse(n,o);default:return this.client.logger.info(`Unsupported response method ${h}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:n}=r,{message:o}=ne("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=async(r,n)=>{const{params:o,id:h}=n;try{this.isValidConnect(lr({},n.params));const d=Mr(ge.FIVE_MINUTES),_=lr({id:h,pairingTopic:r,expiry:d},o);await this.setProposal(h,_);const x=mn(JSON.stringify(n)),b=await this.getVerifyContext(x,_.proposer.metadata);this.client.events.emit("session_proposal",{id:h,params:_,verifyContext:b})}catch(d){await this.sendError(h,r,d),this.client.logger.error(d)}},this.onSessionProposeResponse=async(r,n)=>{const{id:o}=n;if(ui(n)){const{result:h}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:h});const d=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:d});const _=d.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:_});const x=h.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:x});const b=await this.client.core.crypto.generateSharedKey(_,x);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:b});const S=await this.client.core.relayer.subscribe(b);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:S}),await this.client.core.pairing.activate({topic:r})}else qr(n)&&(await this.client.proposal.delete(o,Qt("USER_DISCONNECTED")),this.events.emit(Ft("session_connect"),{error:n.error}))},this.onSessionSettleRequest=async(r,n)=>{const{id:o,params:h}=n;try{this.isValidSessionSettleRequest(h);const{relay:d,controller:_,expiry:x,namespaces:b,requiredNamespaces:S,optionalNamespaces:D,sessionProperties:M,pairingTopic:K}=n.params,F=lr({topic:r,relay:d,expiry:x,namespaces:b,acknowledged:!0,pairingTopic:K,requiredNamespaces:S,optionalNamespaces:D,controller:_.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:_.publicKey,metadata:_.metadata}},M&&{sessionProperties:M});await this.sendResult({id:n.id,topic:r,result:!0}),this.events.emit(Ft("session_connect"),{session:F}),this.cleanupDuplicatePairings(F)}catch(d){await this.sendError(o,r,d),this.client.logger.error(d)}},this.onSessionSettleResponse=async(r,n)=>{const{id:o}=n;ui(n)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Ft("session_approve",o),{})):qr(n)&&(await this.client.session.delete(r,Qt("USER_DISCONNECTED")),this.events.emit(Ft("session_approve",o),{error:n.error}))},this.onSessionUpdateRequest=async(r,n)=>{const{params:o,id:h}=n;try{const d=`${r}_session_update`,_=ao.get(d);if(_&&this.isRequestOutOfSync(_,h)){this.client.logger.info(`Discarding out of sync request - ${h}`);return}this.isValidUpdate(lr({topic:r},o)),await this.client.session.update(r,{namespaces:o.namespaces}),await this.sendResult({id:h,topic:r,result:!0}),this.client.events.emit("session_update",{id:h,topic:r,params:o}),ao.set(d,h)}catch(d){await this.sendError(h,r,d),this.client.logger.error(d)}},this.isRequestOutOfSync=(r,n)=>parseInt(n.toString().slice(0,-3))<=parseInt(r.toString().slice(0,-3)),this.onSessionUpdateResponse=(r,n)=>{const{id:o}=n;ui(n)?this.events.emit(Ft("session_update",o),{}):qr(n)&&this.events.emit(Ft("session_update",o),{error:n.error})},this.onSessionExtendRequest=async(r,n)=>{const{id:o}=n;try{this.isValidExtend({topic:r}),await this.setExpiry(r,Mr(ho)),await this.sendResult({id:o,topic:r,result:!0}),this.client.events.emit("session_extend",{id:o,topic:r})}catch(h){await this.sendError(o,r,h),this.client.logger.error(h)}},this.onSessionExtendResponse=(r,n)=>{const{id:o}=n;ui(n)?this.events.emit(Ft("session_extend",o),{}):qr(n)&&this.events.emit(Ft("session_extend",o),{error:n.error})},this.onSessionPingRequest=async(r,n)=>{const{id:o}=n;try{this.isValidPing({topic:r}),await this.sendResult({id:o,topic:r,result:!0}),this.client.events.emit("session_ping",{id:o,topic:r})}catch(h){await this.sendError(o,r,h),this.client.logger.error(h)}},this.onSessionPingResponse=(r,n)=>{const{id:o}=n;setTimeout(()=>{ui(n)?this.events.emit(Ft("session_ping",o),{}):qr(n)&&this.events.emit(Ft("session_ping",o),{error:n.error})},500)},this.onSessionDeleteRequest=async(r,n)=>{const{id:o}=n;try{this.isValidDisconnect({topic:r,reason:n.params}),await Promise.all([new Promise(h=>{this.client.core.relayer.once(Yt.publish,async()=>{h(await this.deleteSession(r))})}),this.sendResult({id:o,topic:r,result:!0})]),this.client.events.emit("session_delete",{id:o,topic:r})}catch(h){this.client.logger.error(h)}},this.onSessionRequest=async(r,n)=>{const{id:o,params:h}=n;try{this.isValidRequest(lr({topic:r},h));const d=mn(JSON.stringify(wn("wc_sessionRequest",h,o))),_=this.client.session.get(r),x=await this.getVerifyContext(d,_.peer.metadata),b={id:o,topic:r,params:h,verifyContext:x};await this.setPendingSessionRequest(b),this.addSessionRequestToSessionRequestQueue(b),this.processSessionRequestQueue()}catch(d){await this.sendError(o,r,d),this.client.logger.error(d)}},this.onSessionRequestResponse=(r,n)=>{const{id:o}=n;ui(n)?this.events.emit(Ft("session_request",o),{result:n.result}):qr(n)&&this.events.emit(Ft("session_request",o),{error:n.error})},this.onSessionEventRequest=async(r,n)=>{const{id:o,params:h}=n;try{const d=`${r}_session_event_${h.event.name}`,_=ao.get(d);if(_&&this.isRequestOutOfSync(_,o)){this.client.logger.info(`Discarding out of sync request - ${o}`);return}this.isValidEmit(lr({topic:r},h)),this.client.events.emit("session_event",{id:o,topic:r,params:h}),ao.set(d,o)}catch(d){await this.sendError(o,r,d),this.client.logger.error(d)}},this.addSessionRequestToSessionRequestQueue=r=>{this.sessionRequestQueue.queue.push(r)},this.cleanupAfterResponse=r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=ci.idle,this.processSessionRequestQueue()},ge.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===ci.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=ci.active,this.client.events.emit("session_request",r)}catch(n){this.client.logger.error(n)}},this.onPairingCreated=r=>{if(r.active)return;const n=this.client.proposal.getAll().find(o=>o.pairingTopic===r.topic);n&&this.onSessionProposeRequest(r.topic,wn("wc_sessionPropose",{requiredNamespaces:n.requiredNamespaces,optionalNamespaces:n.optionalNamespaces,relays:n.relays,proposer:n.proposer,sessionProperties:n.sessionProperties},n.id))},this.isValidConnect=async r=>{if(!pr(r)){const{message:x}=ne("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(x)}const{pairingTopic:n,requiredNamespaces:o,optionalNamespaces:h,sessionProperties:d,relays:_}=r;if(xi(n)||await this.isValidPairingTopic(n),!n_(_,!0)){const{message:x}=ne("MISSING_OR_INVALID",`connect() relays: ${_}`);throw new Error(x)}!xi(o)&&go(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!xi(h)&&go(h)!==0&&this.validateNamespaces(h,"optionalNamespaces"),xi(d)||this.validateSessionProps(d,"sessionProperties")},this.validateNamespaces=(r,n)=>{const o=s_(r,"connect()",n);if(o)throw new Error(o.message)},this.isValidApprove=async r=>{if(!pr(r))throw new Error(ne("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:n,namespaces:o,relayProtocol:h,sessionProperties:d}=r;await this.isValidProposalId(n);const _=this.client.proposal.get(n),x=tc(o,"approve()");if(x)throw new Error(x.message);const b=Bh(_.requiredNamespaces,o,"approve()");if(b)throw new Error(b.message);if(!yn(h,!0)){const{message:S}=ne("MISSING_OR_INVALID",`approve() relayProtocol: ${h}`);throw new Error(S)}xi(d)||this.validateSessionProps(d,"sessionProperties")},this.isValidReject=async r=>{if(!pr(r)){const{message:h}=ne("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(h)}const{id:n,reason:o}=r;if(await this.isValidProposalId(n),!o_(o)){const{message:h}=ne("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(h)}},this.isValidSessionSettleRequest=r=>{if(!pr(r)){const{message:b}=ne("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(b)}const{relay:n,controller:o,namespaces:h,expiry:d}=r;if(!a_(n)){const{message:b}=ne("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(b)}const _=c_(o,"onSessionSettleRequest()");if(_)throw new Error(_.message);const x=tc(h,"onSessionSettleRequest()");if(x)throw new Error(x.message);if(Ii(d)){const{message:b}=ne("EXPIRED","onSessionSettleRequest()");throw new Error(b)}},this.isValidUpdate=async r=>{if(!pr(r)){const{message:x}=ne("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(x)}const{topic:n,namespaces:o}=r;await this.isValidSessionTopic(n);const h=this.client.session.get(n),d=tc(o,"update()");if(d)throw new Error(d.message);const _=Bh(h.requiredNamespaces,o,"update()");if(_)throw new Error(_.message)},this.isValidExtend=async r=>{if(!pr(r)){const{message:o}=ne("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(o)}const{topic:n}=r;await this.isValidSessionTopic(n)},this.isValidRequest=async r=>{if(!pr(r)){const{message:x}=ne("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(x)}const{topic:n,request:o,chainId:h,expiry:d}=r;await this.isValidSessionTopic(n);const{namespaces:_}=this.client.session.get(n);if(!kh(_,h)){const{message:x}=ne("MISSING_OR_INVALID",`request() chainId: ${h}`);throw new Error(x)}if(!u_(o)){const{message:x}=ne("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(x)}if(!h_(_,h,o.method)){const{message:x}=ne("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(x)}if(d&&!l_(d,pc)){const{message:x}=ne("MISSING_OR_INVALID",`request() expiry: ${d}. Expiry must be a number (in seconds) between ${pc.min} and ${pc.max}`);throw new Error(x)}},this.isValidRespond=async r=>{var n;if(!pr(r)){const{message:d}=ne("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(d)}const{topic:o,response:h}=r;try{await this.isValidSessionTopic(o)}catch(d){throw(n=r==null?void 0:r.response)!=null&&n.id&&this.cleanupAfterResponse(r),d}if(!f_(h)){const{message:d}=ne("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(h)}`);throw new Error(d)}},this.isValidPing=async r=>{if(!pr(r)){const{message:o}=ne("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(o)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)},this.isValidEmit=async r=>{if(!pr(r)){const{message:_}=ne("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(_)}const{topic:n,event:o,chainId:h}=r;await this.isValidSessionTopic(n);const{namespaces:d}=this.client.session.get(n);if(!kh(d,h)){const{message:_}=ne("MISSING_OR_INVALID",`emit() chainId: ${h}`);throw new Error(_)}if(!p_(o)){const{message:_}=ne("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(_)}if(!d_(d,h,o.name)){const{message:_}=ne("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(_)}},this.isValidDisconnect=async r=>{if(!pr(r)){const{message:o}=ne("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(o)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)},this.getVerifyContext=async(r,n)=>{const o={verified:{verifyUrl:n.verifyUrl||vn,validation:"UNKNOWN",origin:n.url||""}};try{const h=await this.client.core.verify.resolve({attestationId:r,verifyUrl:n.verifyUrl});h&&(o.verified.origin=h.origin,o.verified.isScam=h.isScam,o.verified.validation=h.origin===new URL(n.url).origin?"VALID":"INVALID")}catch(h){this.client.logger.info(h)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(r,n)=>{Object.values(r).forEach(o=>{if(!yn(o,!1)){const{message:h}=ne("MISSING_OR_INVALID",`${n} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(h)}})}}async isInitialized(){if(!this.initialized){const{message:t}=ne("NOT_INITIALIZED",this.name);throw new Error(t)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Yt.message,async t=>{const{topic:r,message:n}=t;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(n)))return;const o=await this.client.core.crypto.decode(r,n);try{Dc(o)?(this.client.core.history.set(r,o),this.onRelayEventRequest({topic:r,payload:o})):Ro(o)?(await this.client.core.history.resolve(o),await this.onRelayEventResponse({topic:r,payload:o}),this.client.core.history.delete(r,o.id)):this.onRelayEventUnknownPayload({topic:r,payload:o})}catch(h){this.client.logger.error(h)}})}registerExpirerEvents(){this.client.core.expirer.on(Cr.expired,async t=>{const{topic:r,id:n}=ef(t.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,ne("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}registerPairingEvents(){this.client.core.pairing.events.on(Qn.create,t=>this.onPairingCreated(t))}isValidPairingTopic(t){if(!yn(t,!1)){const{message:r}=ne("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:r}=ne("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(r)}if(Ii(this.client.core.pairing.pairings.get(t).expiry)){const{message:r}=ne("EXPIRED",`pairing topic: ${t}`);throw new Error(r)}}async isValidSessionTopic(t){if(!yn(t,!1)){const{message:r}=ne("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(r)}if(!this.client.session.keys.includes(t)){const{message:r}=ne("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(r)}if(Ii(this.client.session.get(t).expiry)){await this.deleteSession(t);const{message:r}=ne("EXPIRED",`session topic: ${t}`);throw new Error(r)}}async isValidSessionOrPairingTopic(t){if(this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(yn(t,!1)){const{message:r}=ne("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(r)}else{const{message:r}=ne("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(r)}}async isValidProposalId(t){if(!g_(t)){const{message:r}=ne("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(r)}if(!this.client.proposal.keys.includes(t)){const{message:r}=ne("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(r)}if(Ii(this.client.proposal.get(t).expiry)){await this.deleteProposal(t);const{message:r}=ne("EXPIRED",`proposal id: ${t}`);throw new Error(r)}}}class XE extends Co{constructor(t,r){super(t,r,UE,jc),this.core=t,this.logger=r}}class ZE extends Co{constructor(t,r){super(t,r,HE,jc),this.core=t,this.logger=r}}class eI extends Co{constructor(t,r){super(t,r,kE,jc,n=>n.id),this.core=t,this.logger=r}}let tI=class Yf extends E1{constructor(t){super(t),this.protocol=Gf,this.version=Wf,this.name=fc.name,this.events=new wr.EventEmitter,this.on=(n,o)=>this.events.on(n,o),this.once=(n,o)=>this.events.once(n,o),this.off=(n,o)=>this.events.off(n,o),this.removeListener=(n,o)=>this.events.removeListener(n,o),this.removeAllListeners=n=>this.events.removeAllListeners(n),this.connect=async n=>{try{return await this.engine.connect(n)}catch(o){throw this.logger.error(o.message),o}},this.pair=async n=>{try{return await this.engine.pair(n)}catch(o){throw this.logger.error(o.message),o}},this.approve=async n=>{try{return await this.engine.approve(n)}catch(o){throw this.logger.error(o.message),o}},this.reject=async n=>{try{return await this.engine.reject(n)}catch(o){throw this.logger.error(o.message),o}},this.update=async n=>{try{return await this.engine.update(n)}catch(o){throw this.logger.error(o.message),o}},this.extend=async n=>{try{return await this.engine.extend(n)}catch(o){throw this.logger.error(o.message),o}},this.request=async n=>{try{return await this.engine.request(n)}catch(o){throw this.logger.error(o.message),o}},this.respond=async n=>{try{return await this.engine.respond(n)}catch(o){throw this.logger.error(o.message),o}},this.ping=async n=>{try{return await this.engine.ping(n)}catch(o){throw this.logger.error(o.message),o}},this.emit=async n=>{try{return await this.engine.emit(n)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async n=>{try{return await this.engine.disconnect(n)}catch(o){throw this.logger.error(o.message),o}},this.find=n=>{try{return this.engine.find(n)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}},this.name=(t==null?void 0:t.name)||fc.name,this.metadata=(t==null?void 0:t.metadata)||Zm();const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Ne.pino(Ne.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||fc.logger}));this.core=(t==null?void 0:t.core)||new zE(t),this.logger=Ne.generateChildLogger(r,this.name),this.session=new ZE(this.core,this.logger),this.proposal=new XE(this.core,this.logger),this.pendingRequest=new eI(this.core,this.logger),this.engine=new YE(this)}static async init(t){const r=new Yf(t);return await r.initialize(),r}get context(){return Ne.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}};var xc={exports:{}};(function(a,t){var r=typeof self<"u"?self:Vt,n=function(){function h(){this.fetch=!1,this.DOMException=r.DOMException}return h.prototype=r,new h}();(function(h){(function(d){var _={searchParams:"URLSearchParams"in h,iterable:"Symbol"in h&&"iterator"in Symbol,blob:"FileReader"in h&&"Blob"in h&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in h,arrayBuffer:"ArrayBuffer"in h};function x(l){return l&&DataView.prototype.isPrototypeOf(l)}if(_.arrayBuffer)var b=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],S=ArrayBuffer.isView||function(l){return l&&b.indexOf(Object.prototype.toString.call(l))>-1};function D(l){if(typeof l!="string"&&(l=String(l)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(l))throw new TypeError("Invalid character in header field name");return l.toLowerCase()}function M(l){return typeof l!="string"&&(l=String(l)),l}function K(l){var p={next:function(){var N=l.shift();return{done:N===void 0,value:N}}};return _.iterable&&(p[Symbol.iterator]=function(){return p}),p}function F(l){this.map={},l instanceof F?l.forEach(function(p,N){this.append(N,p)},this):Array.isArray(l)?l.forEach(function(p){this.append(p[0],p[1])},this):l&&Object.getOwnPropertyNames(l).forEach(function(p){this.append(p,l[p])},this)}F.prototype.append=function(l,p){l=D(l),p=M(p);var N=this.map[l];this.map[l]=N?N+", "+p:p},F.prototype.delete=function(l){delete this.map[D(l)]},F.prototype.get=function(l){return l=D(l),this.has(l)?this.map[l]:null},F.prototype.has=function(l){return this.map.hasOwnProperty(D(l))},F.prototype.set=function(l,p){this.map[D(l)]=M(p)},F.prototype.forEach=function(l,p){for(var N in this.map)this.map.hasOwnProperty(N)&&l.call(p,this.map[N],N,this)},F.prototype.keys=function(){var l=[];return this.forEach(function(p,N){l.push(N)}),K(l)},F.prototype.values=function(){var l=[];return this.forEach(function(p){l.push(p)}),K(l)},F.prototype.entries=function(){var l=[];return this.forEach(function(p,N){l.push([N,p])}),K(l)},_.iterable&&(F.prototype[Symbol.iterator]=F.prototype.entries);function ee(l){if(l.bodyUsed)return Promise.reject(new TypeError("Already read"));l.bodyUsed=!0}function oe(l){return new Promise(function(p,N){l.onload=function(){p(l.result)},l.onerror=function(){N(l.error)}})}function he(l){var p=new FileReader,N=oe(p);return p.readAsArrayBuffer(l),N}function le(l){var p=new FileReader,N=oe(p);return p.readAsText(l),N}function fe(l){for(var p=new Uint8Array(l),N=new Array(p.length),V=0;V<p.length;V++)N[V]=String.fromCharCode(p[V]);return N.join("")}function pe(l){if(l.slice)return l.slice(0);var p=new Uint8Array(l.byteLength);return p.set(new Uint8Array(l)),p.buffer}function de(){return this.bodyUsed=!1,this._initBody=function(l){this._bodyInit=l,l?typeof l=="string"?this._bodyText=l:_.blob&&Blob.prototype.isPrototypeOf(l)?this._bodyBlob=l:_.formData&&FormData.prototype.isPrototypeOf(l)?this._bodyFormData=l:_.searchParams&&URLSearchParams.prototype.isPrototypeOf(l)?this._bodyText=l.toString():_.arrayBuffer&&_.blob&&x(l)?(this._bodyArrayBuffer=pe(l.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):_.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(l)||S(l))?this._bodyArrayBuffer=pe(l):this._bodyText=l=Object.prototype.toString.call(l):this._bodyText="",this.headers.get("content-type")||(typeof l=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):_.searchParams&&URLSearchParams.prototype.isPrototypeOf(l)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},_.blob&&(this.blob=function(){var l=ee(this);if(l)return l;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?ee(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(he)}),this.text=function(){var l=ee(this);if(l)return l;if(this._bodyBlob)return le(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(fe(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},_.formData&&(this.formData=function(){return this.text().then(ue)}),this.json=function(){return this.text().then(JSON.parse)},this}var U=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function Q(l){var p=l.toUpperCase();return U.indexOf(p)>-1?p:l}function $(l,p){p=p||{};var N=p.body;if(l instanceof $){if(l.bodyUsed)throw new TypeError("Already read");this.url=l.url,this.credentials=l.credentials,p.headers||(this.headers=new F(l.headers)),this.method=l.method,this.mode=l.mode,this.signal=l.signal,!N&&l._bodyInit!=null&&(N=l._bodyInit,l.bodyUsed=!0)}else this.url=String(l);if(this.credentials=p.credentials||this.credentials||"same-origin",(p.headers||!this.headers)&&(this.headers=new F(p.headers)),this.method=Q(p.method||this.method||"GET"),this.mode=p.mode||this.mode||null,this.signal=p.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&N)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(N)}$.prototype.clone=function(){return new $(this,{body:this._bodyInit})};function ue(l){var p=new FormData;return l.trim().split("&").forEach(function(N){if(N){var V=N.split("="),G=V.shift().replace(/\+/g," "),P=V.join("=").replace(/\+/g," ");p.append(decodeURIComponent(G),decodeURIComponent(P))}}),p}function g(l){var p=new F,N=l.replace(/\r?\n[\t ]+/g," ");return N.split(/\r?\n/).forEach(function(V){var G=V.split(":"),P=G.shift().trim();if(P){var q=G.join(":").trim();p.append(P,q)}}),p}de.call($.prototype);function m(l,p){p||(p={}),this.type="default",this.status=p.status===void 0?200:p.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in p?p.statusText:"OK",this.headers=new F(p.headers),this.url=p.url||"",this._initBody(l)}de.call(m.prototype),m.prototype.clone=function(){return new m(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new F(this.headers),url:this.url})},m.error=function(){var l=new m(null,{status:0,statusText:""});return l.type="error",l};var w=[301,302,303,307,308];m.redirect=function(l,p){if(w.indexOf(p)===-1)throw new RangeError("Invalid status code");return new m(null,{status:p,headers:{location:l}})},d.DOMException=h.DOMException;try{new d.DOMException}catch{d.DOMException=function(p,N){this.message=p,this.name=N;var V=Error(p);this.stack=V.stack},d.DOMException.prototype=Object.create(Error.prototype),d.DOMException.prototype.constructor=d.DOMException}function R(l,p){return new Promise(function(N,V){var G=new $(l,p);if(G.signal&&G.signal.aborted)return V(new d.DOMException("Aborted","AbortError"));var P=new XMLHttpRequest;function q(){P.abort()}P.onload=function(){var X={status:P.status,statusText:P.statusText,headers:g(P.getAllResponseHeaders()||"")};X.url="responseURL"in P?P.responseURL:X.headers.get("X-Request-URL");var te="response"in P?P.response:P.responseText;N(new m(te,X))},P.onerror=function(){V(new TypeError("Network request failed"))},P.ontimeout=function(){V(new TypeError("Network request failed"))},P.onabort=function(){V(new d.DOMException("Aborted","AbortError"))},P.open(G.method,G.url,!0),G.credentials==="include"?P.withCredentials=!0:G.credentials==="omit"&&(P.withCredentials=!1),"responseType"in P&&_.blob&&(P.responseType="blob"),G.headers.forEach(function(X,te){P.setRequestHeader(te,X)}),G.signal&&(G.signal.addEventListener("abort",q),P.onreadystatechange=function(){P.readyState===4&&G.signal.removeEventListener("abort",q)}),P.send(typeof G._bodyInit>"u"?null:G._bodyInit)})}return R.polyfill=!0,h.fetch||(h.fetch=R,h.Headers=F,h.Request=$,h.Response=m),d.Headers=F,d.Request=$,d.Response=m,d.fetch=R,Object.defineProperty(d,"__esModule",{value:!0}),d})({})})(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var o=n;t=o.fetch,t.default=o.fetch,t.fetch=o.fetch,t.Headers=o.Headers,t.Request=o.Request,t.Response=o.Response,a.exports=t})(xc,xc.exports);var rI=xc.exports;const jl=Eo(rI),iI={Accept:"application/json","Content-Type":"application/json"},nI="POST",Ml={headers:iI,method:nI},ql=10;class Oi{constructor(t,r=!1){if(this.url=t,this.disableProviderPing=r,this.events=new wr.EventEmitter,this.isAvailable=!1,this.registering=!1,!ll(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);this.url=t,this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(t,r){this.isAvailable||await this.register();try{const n=ki(t),h=await(await jl(this.url,Object.assign(Object.assign({},Ml),{body:n}))).json();this.onPayload({data:h})}catch(n){this.onError(t.id,n)}}async register(t=this.url){if(!ll(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,o)=>{this.events.once("register_error",h=>{this.resetMaxListeners(),o(h)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));n()})})}this.url=t,this.registering=!0;try{if(!this.disableProviderPing){const r=ki({id:1,jsonrpc:"2.0",method:"test",params:[]});await jl(t,Object.assign(Object.assign({},Ml),{body:r}))}this.onOpen()}catch(r){const n=this.parseError(r);throw this.events.emit("register_error",n),this.onClose(),n}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?ts(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const n=this.parseError(r),o=n.message||n.toString(),h=Oo(t,o);this.events.emit("payload",h)}parseError(t,r=this.url){return Of(t,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>ql&&this.events.setMaxListeners(ql)}}const zl="error",sI="wss://relay.walletconnect.com",oI="wc",aI="universal_provider",Ul=`${oI}@2:${aI}:`,cI="https://rpc.walletconnect.com/v1/",li={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var Wn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Pc={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(a,t){(function(){var r,n="4.17.21",o=200,h="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",d="Expected a function",_="Invalid `variable` option passed into `_.template`",x="__lodash_hash_undefined__",b=500,S="__lodash_placeholder__",D=1,M=2,K=4,F=1,ee=2,oe=1,he=2,le=4,fe=8,pe=16,de=32,U=64,Q=128,$=256,ue=512,g=30,m="...",w=800,R=16,l=1,p=2,N=3,V=1/0,G=9007199254740991,P=17976931348623157e292,q=0/0,X=4294967295,te=X-1,_e=X>>>1,lt=[["ary",Q],["bind",oe],["bindKey",he],["curry",fe],["curryRight",pe],["flip",ue],["partial",de],["partialRight",U],["rearg",$]],be="[object Arguments]",Pt="[object Array]",B="[object AsyncFunction]",H="[object Boolean]",j="[object Date]",u="[object DOMException]",A="[object Error]",ae="[object Function]",we="[object GeneratorFunction]",Se="[object Map]",Fe="[object Number]",je="[object Null]",Ce="[object Object]",St="[object Promise]",wt="[object Proxy]",at="[object RegExp]",qe="[object Set]",Xe="[object String]",Ze="[object Symbol]",ct="[object Undefined]",Be="[object WeakMap]",et="[object WeakSet]",$e="[object ArrayBuffer]",Ve="[object DataView]",ft="[object Float32Array]",Ue="[object Float64Array]",Ot="[object Int8Array]",$t="[object Int16Array]",Bt="[object Int32Array]",kt="[object Uint8Array]",qt="[object Uint8ClampedArray]",Xt="[object Uint16Array]",sr="[object Uint32Array]",zr=/\b__p \+= '';/g,Zt=/\b(__p \+=) '' \+/g,Gr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,fi=/&(?:amp|lt|gt|quot|#39);/g,Ri=/[&<>"']/g,pt=RegExp(fi.source),it=RegExp(Ri.source),dt=/<%-([\s\S]+?)%>/g,gt=/<%([\s\S]+?)%>/g,ut=/<%=([\s\S]+?)%>/g,nt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Rt=/^\w*$/,At=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,yt=/[\\^$.*+?()[\]{}|]/g,Ct=RegExp(yt.source),vt=/^\s+/,bt=/\s/,mt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Ye=/\{\n\/\* \[wrapped with (.+)\] \*/,Tt=/,? & /,Nt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,To=/[()=,{}\[\]\/\s]/,No=/\\(\\)?/g,Lo=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,br=/\w*$/,Do=/^[-+]0x[0-9a-f]+$/i,Fo=/^0b[01]+$/i,$o=/^\[object .+?Constructor\]$/,jo=/^0o[0-7]+$/i,Mo=/^(?:0|[1-9]\d*)$/,Wr=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Wi=/($^)/,qo=/['\n\r\u2028\u2029\\]/g,Ji="\\ud800-\\udfff",zo="\\u0300-\\u036f",Uo="\\ufe20-\\ufe2f",Qi="\\u20d0-\\u20ff",is=zo+Uo+Qi,ns="\\u2700-\\u27bf",Tr="a-z\\xdf-\\xf6\\xf8-\\xff",Ho="\\xac\\xb1\\xd7\\xf7",Bo="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ko="\\u2000-\\u206f",Ko=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ss="A-Z\\xc0-\\xd6\\xd8-\\xde",os="\\ufe0e\\ufe0f",Ai=Ho+Bo+ko+Ko,In="['’]",Ci="["+Ji+"]",xn="["+Ai+"]",Ti="["+is+"]",as="\\d+",Vo="["+ns+"]",cs="["+Tr+"]",us="[^"+Ji+Ai+as+ns+Tr+ss+"]",Yi="\\ud83c[\\udffb-\\udfff]",Go="(?:"+Ti+"|"+Yi+")",hs="[^"+Ji+"]",Xi="(?:\\ud83c[\\udde6-\\uddff]){2}",pi="[\\ud800-\\udbff][\\udc00-\\udfff]",dr="["+ss+"]",ls="\\u200d",fs="(?:"+cs+"|"+us+")",Ur="(?:"+dr+"|"+us+")",ps="(?:"+In+"(?:d|ll|m|re|s|t|ve))?",ds="(?:"+In+"(?:D|LL|M|RE|S|T|VE))?",gs=Go+"?",ys="["+os+"]?",Wo="(?:"+ls+"(?:"+[hs,Xi,pi].join("|")+")"+ys+gs+")*",Jr="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",vs="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",ms=ys+gs+Wo,Zi="(?:"+[Vo,Xi,pi].join("|")+")"+ms,Jo="(?:"+[hs+Ti+"?",Ti,Xi,pi,Ci].join("|")+")",Pn=RegExp(In,"g"),Qo=RegExp(Ti,"g"),en=RegExp(Yi+"(?="+Yi+")|"+Jo+ms,"g"),_s=RegExp([dr+"?"+cs+"+"+ps+"(?="+[xn,dr,"$"].join("|")+")",Ur+"+"+ds+"(?="+[xn,dr+fs,"$"].join("|")+")",dr+"?"+fs+"+"+ps,dr+"+"+ds,vs,Jr,as,Zi].join("|"),"g"),ws=RegExp("["+ls+Ji+is+os+"]"),Ni=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,bs=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Yo=-1,Ge={};Ge[ft]=Ge[Ue]=Ge[Ot]=Ge[$t]=Ge[Bt]=Ge[kt]=Ge[qt]=Ge[Xt]=Ge[sr]=!0,Ge[be]=Ge[Pt]=Ge[$e]=Ge[H]=Ge[Ve]=Ge[j]=Ge[A]=Ge[ae]=Ge[Se]=Ge[Fe]=Ge[Ce]=Ge[at]=Ge[qe]=Ge[Xe]=Ge[Be]=!1;var ke={};ke[be]=ke[Pt]=ke[$e]=ke[Ve]=ke[H]=ke[j]=ke[ft]=ke[Ue]=ke[Ot]=ke[$t]=ke[Bt]=ke[Se]=ke[Fe]=ke[Ce]=ke[at]=ke[qe]=ke[Xe]=ke[Ze]=ke[kt]=ke[qt]=ke[Xt]=ke[sr]=!0,ke[A]=ke[ae]=ke[Be]=!1;var E={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},C={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Y={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},ie={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},We=parseFloat,Ie=parseInt,tt=typeof Wn=="object"&&Wn&&Wn.Object===Object&&Wn,Lt=typeof self=="object"&&self&&self.Object===Object&&self,Le=tt||Lt||Function("return this")(),Je=t&&!t.nodeType&&t,Et=Je&&!0&&a&&!a.nodeType&&a,or=Et&&Et.exports===Je,Dt=or&&tt.process,rt=function(){try{var T=Et&&Et.require&&Et.require("util").types;return T||Dt&&Dt.binding&&Dt.binding("util")}catch{}}(),er=rt&&rt.isArrayBuffer,Nr=rt&&rt.isDate,Er=rt&&rt.isMap,Hr=rt&&rt.isRegExp,Sn=rt&&rt.isSet,Li=rt&&rt.isTypedArray;function zt(T,k,z){switch(z.length){case 0:return T.call(k);case 1:return T.call(k,z[0]);case 2:return T.call(k,z[0],z[1]);case 3:return T.call(k,z[0],z[1],z[2])}return T.apply(k,z)}function ep(T,k,z,se){for(var Ee=-1,Me=T==null?0:T.length;++Ee<Me;){var jt=T[Ee];k(se,jt,z(jt),T)}return se}function Ir(T,k){for(var z=-1,se=T==null?0:T.length;++z<se&&k(T[z],z,T)!==!1;);return T}function tp(T,k){for(var z=T==null?0:T.length;z--&&k(T[z],z,T)!==!1;);return T}function zc(T,k){for(var z=-1,se=T==null?0:T.length;++z<se;)if(!k(T[z],z,T))return!1;return!0}function di(T,k){for(var z=-1,se=T==null?0:T.length,Ee=0,Me=[];++z<se;){var jt=T[z];k(jt,z,T)&&(Me[Ee++]=jt)}return Me}function Es(T,k){var z=T==null?0:T.length;return!!z&&tn(T,k,0)>-1}function Xo(T,k,z){for(var se=-1,Ee=T==null?0:T.length;++se<Ee;)if(z(k,T[se]))return!0;return!1}function st(T,k){for(var z=-1,se=T==null?0:T.length,Ee=Array(se);++z<se;)Ee[z]=k(T[z],z,T);return Ee}function gi(T,k){for(var z=-1,se=k.length,Ee=T.length;++z<se;)T[Ee+z]=k[z];return T}function Zo(T,k,z,se){var Ee=-1,Me=T==null?0:T.length;for(se&&Me&&(z=T[++Ee]);++Ee<Me;)z=k(z,T[Ee],Ee,T);return z}function rp(T,k,z,se){var Ee=T==null?0:T.length;for(se&&Ee&&(z=T[--Ee]);Ee--;)z=k(z,T[Ee],Ee,T);return z}function ea(T,k){for(var z=-1,se=T==null?0:T.length;++z<se;)if(k(T[z],z,T))return!0;return!1}var ip=ta("length");function np(T){return T.split("")}function sp(T){return T.match(Nt)||[]}function Uc(T,k,z){var se;return z(T,function(Ee,Me,jt){if(k(Ee,Me,jt))return se=Me,!1}),se}function Is(T,k,z,se){for(var Ee=T.length,Me=z+(se?1:-1);se?Me--:++Me<Ee;)if(k(T[Me],Me,T))return Me;return-1}function tn(T,k,z){return k===k?vp(T,k,z):Is(T,Hc,z)}function op(T,k,z,se){for(var Ee=z-1,Me=T.length;++Ee<Me;)if(se(T[Ee],k))return Ee;return-1}function Hc(T){return T!==T}function Bc(T,k){var z=T==null?0:T.length;return z?ia(T,k)/z:q}function ta(T){return function(k){return k==null?r:k[T]}}function ra(T){return function(k){return T==null?r:T[k]}}function kc(T,k,z,se,Ee){return Ee(T,function(Me,jt,Qe){z=se?(se=!1,Me):k(z,Me,jt,Qe)}),z}function ap(T,k){var z=T.length;for(T.sort(k);z--;)T[z]=T[z].value;return T}function ia(T,k){for(var z,se=-1,Ee=T.length;++se<Ee;){var Me=k(T[se]);Me!==r&&(z=z===r?Me:z+Me)}return z}function na(T,k){for(var z=-1,se=Array(T);++z<T;)se[z]=k(z);return se}function cp(T,k){return st(k,function(z){return[z,T[z]]})}function Kc(T){return T&&T.slice(0,Jc(T)+1).replace(vt,"")}function gr(T){return function(k){return T(k)}}function sa(T,k){return st(k,function(z){return T[z]})}function On(T,k){return T.has(k)}function Vc(T,k){for(var z=-1,se=T.length;++z<se&&tn(k,T[z],0)>-1;);return z}function Gc(T,k){for(var z=T.length;z--&&tn(k,T[z],0)>-1;);return z}function up(T,k){for(var z=T.length,se=0;z--;)T[z]===k&&++se;return se}var hp=ra(E),lp=ra(C);function fp(T){return"\\"+ie[T]}function pp(T,k){return T==null?r:T[k]}function rn(T){return ws.test(T)}function dp(T){return Ni.test(T)}function gp(T){for(var k,z=[];!(k=T.next()).done;)z.push(k.value);return z}function oa(T){var k=-1,z=Array(T.size);return T.forEach(function(se,Ee){z[++k]=[Ee,se]}),z}function Wc(T,k){return function(z){return T(k(z))}}function yi(T,k){for(var z=-1,se=T.length,Ee=0,Me=[];++z<se;){var jt=T[z];(jt===k||jt===S)&&(T[z]=S,Me[Ee++]=z)}return Me}function xs(T){var k=-1,z=Array(T.size);return T.forEach(function(se){z[++k]=se}),z}function yp(T){var k=-1,z=Array(T.size);return T.forEach(function(se){z[++k]=[se,se]}),z}function vp(T,k,z){for(var se=z-1,Ee=T.length;++se<Ee;)if(T[se]===k)return se;return-1}function mp(T,k,z){for(var se=z+1;se--;)if(T[se]===k)return se;return se}function nn(T){return rn(T)?wp(T):ip(T)}function Lr(T){return rn(T)?bp(T):np(T)}function Jc(T){for(var k=T.length;k--&&bt.test(T.charAt(k)););return k}var _p=ra(Y);function wp(T){for(var k=en.lastIndex=0;en.test(T);)++k;return k}function bp(T){return T.match(en)||[]}function Ep(T){return T.match(_s)||[]}var Ip=function T(k){k=k==null?Le:sn.defaults(Le.Object(),k,sn.pick(Le,bs));var z=k.Array,se=k.Date,Ee=k.Error,Me=k.Function,jt=k.Math,Qe=k.Object,aa=k.RegExp,xp=k.String,xr=k.TypeError,Ps=z.prototype,Pp=Me.prototype,on=Qe.prototype,Ss=k["__core-js_shared__"],Os=Pp.toString,He=on.hasOwnProperty,Sp=0,Qc=function(){var e=/[^.]+$/.exec(Ss&&Ss.keys&&Ss.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Rs=on.toString,Op=Os.call(Qe),Rp=Le._,Ap=aa("^"+Os.call(He).replace(yt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),As=or?k.Buffer:r,vi=k.Symbol,Cs=k.Uint8Array,Yc=As?As.allocUnsafe:r,Ts=Wc(Qe.getPrototypeOf,Qe),Xc=Qe.create,Zc=on.propertyIsEnumerable,Ns=Ps.splice,eu=vi?vi.isConcatSpreadable:r,Rn=vi?vi.iterator:r,Di=vi?vi.toStringTag:r,Ls=function(){try{var e=qi(Qe,"defineProperty");return e({},"",{}),e}catch{}}(),Cp=k.clearTimeout!==Le.clearTimeout&&k.clearTimeout,Tp=se&&se.now!==Le.Date.now&&se.now,Np=k.setTimeout!==Le.setTimeout&&k.setTimeout,Ds=jt.ceil,Fs=jt.floor,ca=Qe.getOwnPropertySymbols,Lp=As?As.isBuffer:r,tu=k.isFinite,Dp=Ps.join,Fp=Wc(Qe.keys,Qe),Mt=jt.max,Wt=jt.min,$p=se.now,jp=k.parseInt,ru=jt.random,Mp=Ps.reverse,ua=qi(k,"DataView"),An=qi(k,"Map"),ha=qi(k,"Promise"),an=qi(k,"Set"),Cn=qi(k,"WeakMap"),Tn=qi(Qe,"create"),$s=Cn&&new Cn,cn={},qp=zi(ua),zp=zi(An),Up=zi(ha),Hp=zi(an),Bp=zi(Cn),js=vi?vi.prototype:r,Nn=js?js.valueOf:r,iu=js?js.toString:r;function y(e){if(_t(e)&&!xe(e)&&!(e instanceof Te)){if(e instanceof Pr)return e;if(He.call(e,"__wrapped__"))return nh(e)}return new Pr(e)}var un=function(){function e(){}return function(i){if(!ht(i))return{};if(Xc)return Xc(i);e.prototype=i;var s=new e;return e.prototype=r,s}}();function Ms(){}function Pr(e,i){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=r}y.templateSettings={escape:dt,evaluate:gt,interpolate:ut,variable:"",imports:{_:y}},y.prototype=Ms.prototype,y.prototype.constructor=y,Pr.prototype=un(Ms.prototype),Pr.prototype.constructor=Pr;function Te(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=X,this.__views__=[]}function kp(){var e=new Te(this.__wrapped__);return e.__actions__=ar(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=ar(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=ar(this.__views__),e}function Kp(){if(this.__filtered__){var e=new Te(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function Vp(){var e=this.__wrapped__.value(),i=this.__dir__,s=xe(e),c=i<0,f=s?e.length:0,v=ng(0,f,this.__views__),I=v.start,O=v.end,L=O-I,W=c?O:I-1,J=this.__iteratees__,Z=J.length,re=0,ce=Wt(L,this.__takeCount__);if(!s||!c&&f==L&&ce==L)return Ou(e,this.__actions__);var ve=[];e:for(;L--&&re<ce;){W+=i;for(var Oe=-1,me=e[W];++Oe<Z;){var Ae=J[Oe],De=Ae.iteratee,mr=Ae.type,ir=De(me);if(mr==p)me=ir;else if(!ir){if(mr==l)continue e;break e}}ve[re++]=me}return ve}Te.prototype=un(Ms.prototype),Te.prototype.constructor=Te;function Fi(e){var i=-1,s=e==null?0:e.length;for(this.clear();++i<s;){var c=e[i];this.set(c[0],c[1])}}function Gp(){this.__data__=Tn?Tn(null):{},this.size=0}function Wp(e){var i=this.has(e)&&delete this.__data__[e];return this.size-=i?1:0,i}function Jp(e){var i=this.__data__;if(Tn){var s=i[e];return s===x?r:s}return He.call(i,e)?i[e]:r}function Qp(e){var i=this.__data__;return Tn?i[e]!==r:He.call(i,e)}function Yp(e,i){var s=this.__data__;return this.size+=this.has(e)?0:1,s[e]=Tn&&i===r?x:i,this}Fi.prototype.clear=Gp,Fi.prototype.delete=Wp,Fi.prototype.get=Jp,Fi.prototype.has=Qp,Fi.prototype.set=Yp;function Qr(e){var i=-1,s=e==null?0:e.length;for(this.clear();++i<s;){var c=e[i];this.set(c[0],c[1])}}function Xp(){this.__data__=[],this.size=0}function Zp(e){var i=this.__data__,s=qs(i,e);if(s<0)return!1;var c=i.length-1;return s==c?i.pop():Ns.call(i,s,1),--this.size,!0}function ed(e){var i=this.__data__,s=qs(i,e);return s<0?r:i[s][1]}function td(e){return qs(this.__data__,e)>-1}function rd(e,i){var s=this.__data__,c=qs(s,e);return c<0?(++this.size,s.push([e,i])):s[c][1]=i,this}Qr.prototype.clear=Xp,Qr.prototype.delete=Zp,Qr.prototype.get=ed,Qr.prototype.has=td,Qr.prototype.set=rd;function Yr(e){var i=-1,s=e==null?0:e.length;for(this.clear();++i<s;){var c=e[i];this.set(c[0],c[1])}}function id(){this.size=0,this.__data__={hash:new Fi,map:new(An||Qr),string:new Fi}}function nd(e){var i=Ys(this,e).delete(e);return this.size-=i?1:0,i}function sd(e){return Ys(this,e).get(e)}function od(e){return Ys(this,e).has(e)}function ad(e,i){var s=Ys(this,e),c=s.size;return s.set(e,i),this.size+=s.size==c?0:1,this}Yr.prototype.clear=id,Yr.prototype.delete=nd,Yr.prototype.get=sd,Yr.prototype.has=od,Yr.prototype.set=ad;function $i(e){var i=-1,s=e==null?0:e.length;for(this.__data__=new Yr;++i<s;)this.add(e[i])}function cd(e){return this.__data__.set(e,x),this}function ud(e){return this.__data__.has(e)}$i.prototype.add=$i.prototype.push=cd,$i.prototype.has=ud;function Dr(e){var i=this.__data__=new Qr(e);this.size=i.size}function hd(){this.__data__=new Qr,this.size=0}function ld(e){var i=this.__data__,s=i.delete(e);return this.size=i.size,s}function fd(e){return this.__data__.get(e)}function pd(e){return this.__data__.has(e)}function dd(e,i){var s=this.__data__;if(s instanceof Qr){var c=s.__data__;if(!An||c.length<o-1)return c.push([e,i]),this.size=++s.size,this;s=this.__data__=new Yr(c)}return s.set(e,i),this.size=s.size,this}Dr.prototype.clear=hd,Dr.prototype.delete=ld,Dr.prototype.get=fd,Dr.prototype.has=pd,Dr.prototype.set=dd;function nu(e,i){var s=xe(e),c=!s&&Ui(e),f=!s&&!c&&Ei(e),v=!s&&!c&&!f&&pn(e),I=s||c||f||v,O=I?na(e.length,xp):[],L=O.length;for(var W in e)(i||He.call(e,W))&&!(I&&(W=="length"||f&&(W=="offset"||W=="parent")||v&&(W=="buffer"||W=="byteLength"||W=="byteOffset")||ti(W,L)))&&O.push(W);return O}function su(e){var i=e.length;return i?e[ba(0,i-1)]:r}function gd(e,i){return Xs(ar(e),ji(i,0,e.length))}function yd(e){return Xs(ar(e))}function la(e,i,s){(s!==r&&!Fr(e[i],s)||s===r&&!(i in e))&&Xr(e,i,s)}function Ln(e,i,s){var c=e[i];(!(He.call(e,i)&&Fr(c,s))||s===r&&!(i in e))&&Xr(e,i,s)}function qs(e,i){for(var s=e.length;s--;)if(Fr(e[s][0],i))return s;return-1}function vd(e,i,s,c){return mi(e,function(f,v,I){i(c,f,s(f),I)}),c}function ou(e,i){return e&&kr(i,Ut(i),e)}function md(e,i){return e&&kr(i,ur(i),e)}function Xr(e,i,s){i=="__proto__"&&Ls?Ls(e,i,{configurable:!0,enumerable:!0,value:s,writable:!0}):e[i]=s}function fa(e,i){for(var s=-1,c=i.length,f=z(c),v=e==null;++s<c;)f[s]=v?r:Va(e,i[s]);return f}function ji(e,i,s){return e===e&&(s!==r&&(e=e<=s?e:s),i!==r&&(e=e>=i?e:i)),e}function Sr(e,i,s,c,f,v){var I,O=i&D,L=i&M,W=i&K;if(s&&(I=f?s(e,c,f,v):s(e)),I!==r)return I;if(!ht(e))return e;var J=xe(e);if(J){if(I=og(e),!O)return ar(e,I)}else{var Z=Jt(e),re=Z==ae||Z==we;if(Ei(e))return Cu(e,O);if(Z==Ce||Z==be||re&&!f){if(I=L||re?{}:Ju(e),!O)return L?Jd(e,md(I,e)):Wd(e,ou(I,e))}else{if(!ke[Z])return f?e:{};I=ag(e,Z,O)}}v||(v=new Dr);var ce=v.get(e);if(ce)return ce;v.set(e,I),xh(e)?e.forEach(function(me){I.add(Sr(me,i,s,me,e,v))}):Eh(e)&&e.forEach(function(me,Ae){I.set(Ae,Sr(me,i,s,Ae,e,v))});var ve=W?L?Na:Ta:L?ur:Ut,Oe=J?r:ve(e);return Ir(Oe||e,function(me,Ae){Oe&&(Ae=me,me=e[Ae]),Ln(I,Ae,Sr(me,i,s,Ae,e,v))}),I}function _d(e){var i=Ut(e);return function(s){return au(s,e,i)}}function au(e,i,s){var c=s.length;if(e==null)return!c;for(e=Qe(e);c--;){var f=s[c],v=i[f],I=e[f];if(I===r&&!(f in e)||!v(I))return!1}return!0}function cu(e,i,s){if(typeof e!="function")throw new xr(d);return zn(function(){e.apply(r,s)},i)}function Dn(e,i,s,c){var f=-1,v=Es,I=!0,O=e.length,L=[],W=i.length;if(!O)return L;s&&(i=st(i,gr(s))),c?(v=Xo,I=!1):i.length>=o&&(v=On,I=!1,i=new $i(i));e:for(;++f<O;){var J=e[f],Z=s==null?J:s(J);if(J=c||J!==0?J:0,I&&Z===Z){for(var re=W;re--;)if(i[re]===Z)continue e;L.push(J)}else v(i,Z,c)||L.push(J)}return L}var mi=Fu(Br),uu=Fu(da,!0);function wd(e,i){var s=!0;return mi(e,function(c,f,v){return s=!!i(c,f,v),s}),s}function zs(e,i,s){for(var c=-1,f=e.length;++c<f;){var v=e[c],I=i(v);if(I!=null&&(O===r?I===I&&!vr(I):s(I,O)))var O=I,L=v}return L}function bd(e,i,s,c){var f=e.length;for(s=Pe(s),s<0&&(s=-s>f?0:f+s),c=c===r||c>f?f:Pe(c),c<0&&(c+=f),c=s>c?0:Sh(c);s<c;)e[s++]=i;return e}function hu(e,i){var s=[];return mi(e,function(c,f,v){i(c,f,v)&&s.push(c)}),s}function Kt(e,i,s,c,f){var v=-1,I=e.length;for(s||(s=ug),f||(f=[]);++v<I;){var O=e[v];i>0&&s(O)?i>1?Kt(O,i-1,s,c,f):gi(f,O):c||(f[f.length]=O)}return f}var pa=$u(),lu=$u(!0);function Br(e,i){return e&&pa(e,i,Ut)}function da(e,i){return e&&lu(e,i,Ut)}function Us(e,i){return di(i,function(s){return ri(e[s])})}function Mi(e,i){i=wi(i,e);for(var s=0,c=i.length;e!=null&&s<c;)e=e[Kr(i[s++])];return s&&s==c?e:r}function fu(e,i,s){var c=i(e);return xe(e)?c:gi(c,s(e))}function tr(e){return e==null?e===r?ct:je:Di&&Di in Qe(e)?ig(e):yg(e)}function ga(e,i){return e>i}function Ed(e,i){return e!=null&&He.call(e,i)}function Id(e,i){return e!=null&&i in Qe(e)}function xd(e,i,s){return e>=Wt(i,s)&&e<Mt(i,s)}function ya(e,i,s){for(var c=s?Xo:Es,f=e[0].length,v=e.length,I=v,O=z(v),L=1/0,W=[];I--;){var J=e[I];I&&i&&(J=st(J,gr(i))),L=Wt(J.length,L),O[I]=!s&&(i||f>=120&&J.length>=120)?new $i(I&&J):r}J=e[0];var Z=-1,re=O[0];e:for(;++Z<f&&W.length<L;){var ce=J[Z],ve=i?i(ce):ce;if(ce=s||ce!==0?ce:0,!(re?On(re,ve):c(W,ve,s))){for(I=v;--I;){var Oe=O[I];if(!(Oe?On(Oe,ve):c(e[I],ve,s)))continue e}re&&re.push(ve),W.push(ce)}}return W}function Pd(e,i,s,c){return Br(e,function(f,v,I){i(c,s(f),v,I)}),c}function Fn(e,i,s){i=wi(i,e),e=Zu(e,i);var c=e==null?e:e[Kr(Rr(i))];return c==null?r:zt(c,e,s)}function pu(e){return _t(e)&&tr(e)==be}function Sd(e){return _t(e)&&tr(e)==$e}function Od(e){return _t(e)&&tr(e)==j}function $n(e,i,s,c,f){return e===i?!0:e==null||i==null||!_t(e)&&!_t(i)?e!==e&&i!==i:Rd(e,i,s,c,$n,f)}function Rd(e,i,s,c,f,v){var I=xe(e),O=xe(i),L=I?Pt:Jt(e),W=O?Pt:Jt(i);L=L==be?Ce:L,W=W==be?Ce:W;var J=L==Ce,Z=W==Ce,re=L==W;if(re&&Ei(e)){if(!Ei(i))return!1;I=!0,J=!1}if(re&&!J)return v||(v=new Dr),I||pn(e)?Vu(e,i,s,c,f,v):tg(e,i,L,s,c,f,v);if(!(s&F)){var ce=J&&He.call(e,"__wrapped__"),ve=Z&&He.call(i,"__wrapped__");if(ce||ve){var Oe=ce?e.value():e,me=ve?i.value():i;return v||(v=new Dr),f(Oe,me,s,c,v)}}return re?(v||(v=new Dr),rg(e,i,s,c,f,v)):!1}function Ad(e){return _t(e)&&Jt(e)==Se}function va(e,i,s,c){var f=s.length,v=f,I=!c;if(e==null)return!v;for(e=Qe(e);f--;){var O=s[f];if(I&&O[2]?O[1]!==e[O[0]]:!(O[0]in e))return!1}for(;++f<v;){O=s[f];var L=O[0],W=e[L],J=O[1];if(I&&O[2]){if(W===r&&!(L in e))return!1}else{var Z=new Dr;if(c)var re=c(W,J,L,e,i,Z);if(!(re===r?$n(J,W,F|ee,c,Z):re))return!1}}return!0}function du(e){if(!ht(e)||lg(e))return!1;var i=ri(e)?Ap:$o;return i.test(zi(e))}function Cd(e){return _t(e)&&tr(e)==at}function Td(e){return _t(e)&&Jt(e)==qe}function Nd(e){return _t(e)&&no(e.length)&&!!Ge[tr(e)]}function gu(e){return typeof e=="function"?e:e==null?hr:typeof e=="object"?xe(e)?mu(e[0],e[1]):vu(e):jh(e)}function ma(e){if(!qn(e))return Fp(e);var i=[];for(var s in Qe(e))He.call(e,s)&&s!="constructor"&&i.push(s);return i}function Ld(e){if(!ht(e))return gg(e);var i=qn(e),s=[];for(var c in e)c=="constructor"&&(i||!He.call(e,c))||s.push(c);return s}function _a(e,i){return e<i}function yu(e,i){var s=-1,c=cr(e)?z(e.length):[];return mi(e,function(f,v,I){c[++s]=i(f,v,I)}),c}function vu(e){var i=Da(e);return i.length==1&&i[0][2]?Yu(i[0][0],i[0][1]):function(s){return s===e||va(s,e,i)}}function mu(e,i){return $a(e)&&Qu(i)?Yu(Kr(e),i):function(s){var c=Va(s,e);return c===r&&c===i?Ga(s,e):$n(i,c,F|ee)}}function Hs(e,i,s,c,f){e!==i&&pa(i,function(v,I){if(f||(f=new Dr),ht(v))Dd(e,i,I,s,Hs,c,f);else{var O=c?c(Ma(e,I),v,I+"",e,i,f):r;O===r&&(O=v),la(e,I,O)}},ur)}function Dd(e,i,s,c,f,v,I){var O=Ma(e,s),L=Ma(i,s),W=I.get(L);if(W){la(e,s,W);return}var J=v?v(O,L,s+"",e,i,I):r,Z=J===r;if(Z){var re=xe(L),ce=!re&&Ei(L),ve=!re&&!ce&&pn(L);J=L,re||ce||ve?xe(O)?J=O:It(O)?J=ar(O):ce?(Z=!1,J=Cu(L,!0)):ve?(Z=!1,J=Tu(L,!0)):J=[]:Un(L)||Ui(L)?(J=O,Ui(O)?J=Oh(O):(!ht(O)||ri(O))&&(J=Ju(L))):Z=!1}Z&&(I.set(L,J),f(J,L,c,v,I),I.delete(L)),la(e,s,J)}function _u(e,i){var s=e.length;if(s)return i+=i<0?s:0,ti(i,s)?e[i]:r}function wu(e,i,s){i.length?i=st(i,function(v){return xe(v)?function(I){return Mi(I,v.length===1?v[0]:v)}:v}):i=[hr];var c=-1;i=st(i,gr(ye()));var f=yu(e,function(v,I,O){var L=st(i,function(W){return W(v)});return{criteria:L,index:++c,value:v}});return ap(f,function(v,I){return Gd(v,I,s)})}function Fd(e,i){return bu(e,i,function(s,c){return Ga(e,c)})}function bu(e,i,s){for(var c=-1,f=i.length,v={};++c<f;){var I=i[c],O=Mi(e,I);s(O,I)&&jn(v,wi(I,e),O)}return v}function $d(e){return function(i){return Mi(i,e)}}function wa(e,i,s,c){var f=c?op:tn,v=-1,I=i.length,O=e;for(e===i&&(i=ar(i)),s&&(O=st(e,gr(s)));++v<I;)for(var L=0,W=i[v],J=s?s(W):W;(L=f(O,J,L,c))>-1;)O!==e&&Ns.call(O,L,1),Ns.call(e,L,1);return e}function Eu(e,i){for(var s=e?i.length:0,c=s-1;s--;){var f=i[s];if(s==c||f!==v){var v=f;ti(f)?Ns.call(e,f,1):xa(e,f)}}return e}function ba(e,i){return e+Fs(ru()*(i-e+1))}function jd(e,i,s,c){for(var f=-1,v=Mt(Ds((i-e)/(s||1)),0),I=z(v);v--;)I[c?v:++f]=e,e+=s;return I}function Ea(e,i){var s="";if(!e||i<1||i>G)return s;do i%2&&(s+=e),i=Fs(i/2),i&&(e+=e);while(i);return s}function Re(e,i){return qa(Xu(e,i,hr),e+"")}function Md(e){return su(dn(e))}function qd(e,i){var s=dn(e);return Xs(s,ji(i,0,s.length))}function jn(e,i,s,c){if(!ht(e))return e;i=wi(i,e);for(var f=-1,v=i.length,I=v-1,O=e;O!=null&&++f<v;){var L=Kr(i[f]),W=s;if(L==="__proto__"||L==="constructor"||L==="prototype")return e;if(f!=I){var J=O[L];W=c?c(J,L,O):r,W===r&&(W=ht(J)?J:ti(i[f+1])?[]:{})}Ln(O,L,W),O=O[L]}return e}var Iu=$s?function(e,i){return $s.set(e,i),e}:hr,zd=Ls?function(e,i){return Ls(e,"toString",{configurable:!0,enumerable:!1,value:Ja(i),writable:!0})}:hr;function Ud(e){return Xs(dn(e))}function Or(e,i,s){var c=-1,f=e.length;i<0&&(i=-i>f?0:f+i),s=s>f?f:s,s<0&&(s+=f),f=i>s?0:s-i>>>0,i>>>=0;for(var v=z(f);++c<f;)v[c]=e[c+i];return v}function Hd(e,i){var s;return mi(e,function(c,f,v){return s=i(c,f,v),!s}),!!s}function Bs(e,i,s){var c=0,f=e==null?c:e.length;if(typeof i=="number"&&i===i&&f<=_e){for(;c<f;){var v=c+f>>>1,I=e[v];I!==null&&!vr(I)&&(s?I<=i:I<i)?c=v+1:f=v}return f}return Ia(e,i,hr,s)}function Ia(e,i,s,c){var f=0,v=e==null?0:e.length;if(v===0)return 0;i=s(i);for(var I=i!==i,O=i===null,L=vr(i),W=i===r;f<v;){var J=Fs((f+v)/2),Z=s(e[J]),re=Z!==r,ce=Z===null,ve=Z===Z,Oe=vr(Z);if(I)var me=c||ve;else W?me=ve&&(c||re):O?me=ve&&re&&(c||!ce):L?me=ve&&re&&!ce&&(c||!Oe):ce||Oe?me=!1:me=c?Z<=i:Z<i;me?f=J+1:v=J}return Wt(v,te)}function xu(e,i){for(var s=-1,c=e.length,f=0,v=[];++s<c;){var I=e[s],O=i?i(I):I;if(!s||!Fr(O,L)){var L=O;v[f++]=I===0?0:I}}return v}function Pu(e){return typeof e=="number"?e:vr(e)?q:+e}function yr(e){if(typeof e=="string")return e;if(xe(e))return st(e,yr)+"";if(vr(e))return iu?iu.call(e):"";var i=e+"";return i=="0"&&1/e==-V?"-0":i}function _i(e,i,s){var c=-1,f=Es,v=e.length,I=!0,O=[],L=O;if(s)I=!1,f=Xo;else if(v>=o){var W=i?null:Zd(e);if(W)return xs(W);I=!1,f=On,L=new $i}else L=i?[]:O;e:for(;++c<v;){var J=e[c],Z=i?i(J):J;if(J=s||J!==0?J:0,I&&Z===Z){for(var re=L.length;re--;)if(L[re]===Z)continue e;i&&L.push(Z),O.push(J)}else f(L,Z,s)||(L!==O&&L.push(Z),O.push(J))}return O}function xa(e,i){return i=wi(i,e),e=Zu(e,i),e==null||delete e[Kr(Rr(i))]}function Su(e,i,s,c){return jn(e,i,s(Mi(e,i)),c)}function ks(e,i,s,c){for(var f=e.length,v=c?f:-1;(c?v--:++v<f)&&i(e[v],v,e););return s?Or(e,c?0:v,c?v+1:f):Or(e,c?v+1:0,c?f:v)}function Ou(e,i){var s=e;return s instanceof Te&&(s=s.value()),Zo(i,function(c,f){return f.func.apply(f.thisArg,gi([c],f.args))},s)}function Pa(e,i,s){var c=e.length;if(c<2)return c?_i(e[0]):[];for(var f=-1,v=z(c);++f<c;)for(var I=e[f],O=-1;++O<c;)O!=f&&(v[f]=Dn(v[f]||I,e[O],i,s));return _i(Kt(v,1),i,s)}function Ru(e,i,s){for(var c=-1,f=e.length,v=i.length,I={};++c<f;){var O=c<v?i[c]:r;s(I,e[c],O)}return I}function Sa(e){return It(e)?e:[]}function Oa(e){return typeof e=="function"?e:hr}function wi(e,i){return xe(e)?e:$a(e,i)?[e]:ih(ze(e))}var Bd=Re;function bi(e,i,s){var c=e.length;return s=s===r?c:s,!i&&s>=c?e:Or(e,i,s)}var Au=Cp||function(e){return Le.clearTimeout(e)};function Cu(e,i){if(i)return e.slice();var s=e.length,c=Yc?Yc(s):new e.constructor(s);return e.copy(c),c}function Ra(e){var i=new e.constructor(e.byteLength);return new Cs(i).set(new Cs(e)),i}function kd(e,i){var s=i?Ra(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.byteLength)}function Kd(e){var i=new e.constructor(e.source,br.exec(e));return i.lastIndex=e.lastIndex,i}function Vd(e){return Nn?Qe(Nn.call(e)):{}}function Tu(e,i){var s=i?Ra(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.length)}function Nu(e,i){if(e!==i){var s=e!==r,c=e===null,f=e===e,v=vr(e),I=i!==r,O=i===null,L=i===i,W=vr(i);if(!O&&!W&&!v&&e>i||v&&I&&L&&!O&&!W||c&&I&&L||!s&&L||!f)return 1;if(!c&&!v&&!W&&e<i||W&&s&&f&&!c&&!v||O&&s&&f||!I&&f||!L)return-1}return 0}function Gd(e,i,s){for(var c=-1,f=e.criteria,v=i.criteria,I=f.length,O=s.length;++c<I;){var L=Nu(f[c],v[c]);if(L){if(c>=O)return L;var W=s[c];return L*(W=="desc"?-1:1)}}return e.index-i.index}function Lu(e,i,s,c){for(var f=-1,v=e.length,I=s.length,O=-1,L=i.length,W=Mt(v-I,0),J=z(L+W),Z=!c;++O<L;)J[O]=i[O];for(;++f<I;)(Z||f<v)&&(J[s[f]]=e[f]);for(;W--;)J[O++]=e[f++];return J}function Du(e,i,s,c){for(var f=-1,v=e.length,I=-1,O=s.length,L=-1,W=i.length,J=Mt(v-O,0),Z=z(J+W),re=!c;++f<J;)Z[f]=e[f];for(var ce=f;++L<W;)Z[ce+L]=i[L];for(;++I<O;)(re||f<v)&&(Z[ce+s[I]]=e[f++]);return Z}function ar(e,i){var s=-1,c=e.length;for(i||(i=z(c));++s<c;)i[s]=e[s];return i}function kr(e,i,s,c){var f=!s;s||(s={});for(var v=-1,I=i.length;++v<I;){var O=i[v],L=c?c(s[O],e[O],O,s,e):r;L===r&&(L=e[O]),f?Xr(s,O,L):Ln(s,O,L)}return s}function Wd(e,i){return kr(e,Fa(e),i)}function Jd(e,i){return kr(e,Gu(e),i)}function Ks(e,i){return function(s,c){var f=xe(s)?ep:vd,v=i?i():{};return f(s,e,ye(c,2),v)}}function hn(e){return Re(function(i,s){var c=-1,f=s.length,v=f>1?s[f-1]:r,I=f>2?s[2]:r;for(v=e.length>3&&typeof v=="function"?(f--,v):r,I&&rr(s[0],s[1],I)&&(v=f<3?r:v,f=1),i=Qe(i);++c<f;){var O=s[c];O&&e(i,O,c,v)}return i})}function Fu(e,i){return function(s,c){if(s==null)return s;if(!cr(s))return e(s,c);for(var f=s.length,v=i?f:-1,I=Qe(s);(i?v--:++v<f)&&c(I[v],v,I)!==!1;);return s}}function $u(e){return function(i,s,c){for(var f=-1,v=Qe(i),I=c(i),O=I.length;O--;){var L=I[e?O:++f];if(s(v[L],L,v)===!1)break}return i}}function Qd(e,i,s){var c=i&oe,f=Mn(e);function v(){var I=this&&this!==Le&&this instanceof v?f:e;return I.apply(c?s:this,arguments)}return v}function ju(e){return function(i){i=ze(i);var s=rn(i)?Lr(i):r,c=s?s[0]:i.charAt(0),f=s?bi(s,1).join(""):i.slice(1);return c[e]()+f}}function ln(e){return function(i){return Zo(Fh(Dh(i).replace(Pn,"")),e,"")}}function Mn(e){return function(){var i=arguments;switch(i.length){case 0:return new e;case 1:return new e(i[0]);case 2:return new e(i[0],i[1]);case 3:return new e(i[0],i[1],i[2]);case 4:return new e(i[0],i[1],i[2],i[3]);case 5:return new e(i[0],i[1],i[2],i[3],i[4]);case 6:return new e(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new e(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var s=un(e.prototype),c=e.apply(s,i);return ht(c)?c:s}}function Yd(e,i,s){var c=Mn(e);function f(){for(var v=arguments.length,I=z(v),O=v,L=fn(f);O--;)I[O]=arguments[O];var W=v<3&&I[0]!==L&&I[v-1]!==L?[]:yi(I,L);if(v-=W.length,v<s)return Hu(e,i,Vs,f.placeholder,r,I,W,r,r,s-v);var J=this&&this!==Le&&this instanceof f?c:e;return zt(J,this,I)}return f}function Mu(e){return function(i,s,c){var f=Qe(i);if(!cr(i)){var v=ye(s,3);i=Ut(i),s=function(O){return v(f[O],O,f)}}var I=e(i,s,c);return I>-1?f[v?i[I]:I]:r}}function qu(e){return ei(function(i){var s=i.length,c=s,f=Pr.prototype.thru;for(e&&i.reverse();c--;){var v=i[c];if(typeof v!="function")throw new xr(d);if(f&&!I&&Qs(v)=="wrapper")var I=new Pr([],!0)}for(c=I?c:s;++c<s;){v=i[c];var O=Qs(v),L=O=="wrapper"?La(v):r;L&&ja(L[0])&&L[1]==(Q|fe|de|$)&&!L[4].length&&L[9]==1?I=I[Qs(L[0])].apply(I,L[3]):I=v.length==1&&ja(v)?I[O]():I.thru(v)}return function(){var W=arguments,J=W[0];if(I&&W.length==1&&xe(J))return I.plant(J).value();for(var Z=0,re=s?i[Z].apply(this,W):J;++Z<s;)re=i[Z].call(this,re);return re}})}function Vs(e,i,s,c,f,v,I,O,L,W){var J=i&Q,Z=i&oe,re=i&he,ce=i&(fe|pe),ve=i&ue,Oe=re?r:Mn(e);function me(){for(var Ae=arguments.length,De=z(Ae),mr=Ae;mr--;)De[mr]=arguments[mr];if(ce)var ir=fn(me),_r=up(De,ir);if(c&&(De=Lu(De,c,f,ce)),v&&(De=Du(De,v,I,ce)),Ae-=_r,ce&&Ae<W){var xt=yi(De,ir);return Hu(e,i,Vs,me.placeholder,s,De,xt,O,L,W-Ae)}var $r=Z?s:this,ni=re?$r[e]:e;return Ae=De.length,O?De=vg(De,O):ve&&Ae>1&&De.reverse(),J&&L<Ae&&(De.length=L),this&&this!==Le&&this instanceof me&&(ni=Oe||Mn(ni)),ni.apply($r,De)}return me}function zu(e,i){return function(s,c){return Pd(s,e,i(c),{})}}function Gs(e,i){return function(s,c){var f;if(s===r&&c===r)return i;if(s!==r&&(f=s),c!==r){if(f===r)return c;typeof s=="string"||typeof c=="string"?(s=yr(s),c=yr(c)):(s=Pu(s),c=Pu(c)),f=e(s,c)}return f}}function Aa(e){return ei(function(i){return i=st(i,gr(ye())),Re(function(s){var c=this;return e(i,function(f){return zt(f,c,s)})})})}function Ws(e,i){i=i===r?" ":yr(i);var s=i.length;if(s<2)return s?Ea(i,e):i;var c=Ea(i,Ds(e/nn(i)));return rn(i)?bi(Lr(c),0,e).join(""):c.slice(0,e)}function Xd(e,i,s,c){var f=i&oe,v=Mn(e);function I(){for(var O=-1,L=arguments.length,W=-1,J=c.length,Z=z(J+L),re=this&&this!==Le&&this instanceof I?v:e;++W<J;)Z[W]=c[W];for(;L--;)Z[W++]=arguments[++O];return zt(re,f?s:this,Z)}return I}function Uu(e){return function(i,s,c){return c&&typeof c!="number"&&rr(i,s,c)&&(s=c=r),i=ii(i),s===r?(s=i,i=0):s=ii(s),c=c===r?i<s?1:-1:ii(c),jd(i,s,c,e)}}function Js(e){return function(i,s){return typeof i=="string"&&typeof s=="string"||(i=Ar(i),s=Ar(s)),e(i,s)}}function Hu(e,i,s,c,f,v,I,O,L,W){var J=i&fe,Z=J?I:r,re=J?r:I,ce=J?v:r,ve=J?r:v;i|=J?de:U,i&=~(J?U:de),i&le||(i&=~(oe|he));var Oe=[e,i,f,ce,Z,ve,re,O,L,W],me=s.apply(r,Oe);return ja(e)&&eh(me,Oe),me.placeholder=c,th(me,e,i)}function Ca(e){var i=jt[e];return function(s,c){if(s=Ar(s),c=c==null?0:Wt(Pe(c),292),c&&tu(s)){var f=(ze(s)+"e").split("e"),v=i(f[0]+"e"+(+f[1]+c));return f=(ze(v)+"e").split("e"),+(f[0]+"e"+(+f[1]-c))}return i(s)}}var Zd=an&&1/xs(new an([,-0]))[1]==V?function(e){return new an(e)}:Xa;function Bu(e){return function(i){var s=Jt(i);return s==Se?oa(i):s==qe?yp(i):cp(i,e(i))}}function Zr(e,i,s,c,f,v,I,O){var L=i&he;if(!L&&typeof e!="function")throw new xr(d);var W=c?c.length:0;if(W||(i&=~(de|U),c=f=r),I=I===r?I:Mt(Pe(I),0),O=O===r?O:Pe(O),W-=f?f.length:0,i&U){var J=c,Z=f;c=f=r}var re=L?r:La(e),ce=[e,i,s,c,f,J,Z,v,I,O];if(re&&dg(ce,re),e=ce[0],i=ce[1],s=ce[2],c=ce[3],f=ce[4],O=ce[9]=ce[9]===r?L?0:e.length:Mt(ce[9]-W,0),!O&&i&(fe|pe)&&(i&=~(fe|pe)),!i||i==oe)var ve=Qd(e,i,s);else i==fe||i==pe?ve=Yd(e,i,O):(i==de||i==(oe|de))&&!f.length?ve=Xd(e,i,s,c):ve=Vs.apply(r,ce);var Oe=re?Iu:eh;return th(Oe(ve,ce),e,i)}function ku(e,i,s,c){return e===r||Fr(e,on[s])&&!He.call(c,s)?i:e}function Ku(e,i,s,c,f,v){return ht(e)&&ht(i)&&(v.set(i,e),Hs(e,i,r,Ku,v),v.delete(i)),e}function eg(e){return Un(e)?r:e}function Vu(e,i,s,c,f,v){var I=s&F,O=e.length,L=i.length;if(O!=L&&!(I&&L>O))return!1;var W=v.get(e),J=v.get(i);if(W&&J)return W==i&&J==e;var Z=-1,re=!0,ce=s&ee?new $i:r;for(v.set(e,i),v.set(i,e);++Z<O;){var ve=e[Z],Oe=i[Z];if(c)var me=I?c(Oe,ve,Z,i,e,v):c(ve,Oe,Z,e,i,v);if(me!==r){if(me)continue;re=!1;break}if(ce){if(!ea(i,function(Ae,De){if(!On(ce,De)&&(ve===Ae||f(ve,Ae,s,c,v)))return ce.push(De)})){re=!1;break}}else if(!(ve===Oe||f(ve,Oe,s,c,v))){re=!1;break}}return v.delete(e),v.delete(i),re}function tg(e,i,s,c,f,v,I){switch(s){case Ve:if(e.byteLength!=i.byteLength||e.byteOffset!=i.byteOffset)return!1;e=e.buffer,i=i.buffer;case $e:return!(e.byteLength!=i.byteLength||!v(new Cs(e),new Cs(i)));case H:case j:case Fe:return Fr(+e,+i);case A:return e.name==i.name&&e.message==i.message;case at:case Xe:return e==i+"";case Se:var O=oa;case qe:var L=c&F;if(O||(O=xs),e.size!=i.size&&!L)return!1;var W=I.get(e);if(W)return W==i;c|=ee,I.set(e,i);var J=Vu(O(e),O(i),c,f,v,I);return I.delete(e),J;case Ze:if(Nn)return Nn.call(e)==Nn.call(i)}return!1}function rg(e,i,s,c,f,v){var I=s&F,O=Ta(e),L=O.length,W=Ta(i),J=W.length;if(L!=J&&!I)return!1;for(var Z=L;Z--;){var re=O[Z];if(!(I?re in i:He.call(i,re)))return!1}var ce=v.get(e),ve=v.get(i);if(ce&&ve)return ce==i&&ve==e;var Oe=!0;v.set(e,i),v.set(i,e);for(var me=I;++Z<L;){re=O[Z];var Ae=e[re],De=i[re];if(c)var mr=I?c(De,Ae,re,i,e,v):c(Ae,De,re,e,i,v);if(!(mr===r?Ae===De||f(Ae,De,s,c,v):mr)){Oe=!1;break}me||(me=re=="constructor")}if(Oe&&!me){var ir=e.constructor,_r=i.constructor;ir!=_r&&"constructor"in e&&"constructor"in i&&!(typeof ir=="function"&&ir instanceof ir&&typeof _r=="function"&&_r instanceof _r)&&(Oe=!1)}return v.delete(e),v.delete(i),Oe}function ei(e){return qa(Xu(e,r,ah),e+"")}function Ta(e){return fu(e,Ut,Fa)}function Na(e){return fu(e,ur,Gu)}var La=$s?function(e){return $s.get(e)}:Xa;function Qs(e){for(var i=e.name+"",s=cn[i],c=He.call(cn,i)?s.length:0;c--;){var f=s[c],v=f.func;if(v==null||v==e)return f.name}return i}function fn(e){var i=He.call(y,"placeholder")?y:e;return i.placeholder}function ye(){var e=y.iteratee||Qa;return e=e===Qa?gu:e,arguments.length?e(arguments[0],arguments[1]):e}function Ys(e,i){var s=e.__data__;return hg(i)?s[typeof i=="string"?"string":"hash"]:s.map}function Da(e){for(var i=Ut(e),s=i.length;s--;){var c=i[s],f=e[c];i[s]=[c,f,Qu(f)]}return i}function qi(e,i){var s=pp(e,i);return du(s)?s:r}function ig(e){var i=He.call(e,Di),s=e[Di];try{e[Di]=r;var c=!0}catch{}var f=Rs.call(e);return c&&(i?e[Di]=s:delete e[Di]),f}var Fa=ca?function(e){return e==null?[]:(e=Qe(e),di(ca(e),function(i){return Zc.call(e,i)}))}:Za,Gu=ca?function(e){for(var i=[];e;)gi(i,Fa(e)),e=Ts(e);return i}:Za,Jt=tr;(ua&&Jt(new ua(new ArrayBuffer(1)))!=Ve||An&&Jt(new An)!=Se||ha&&Jt(ha.resolve())!=St||an&&Jt(new an)!=qe||Cn&&Jt(new Cn)!=Be)&&(Jt=function(e){var i=tr(e),s=i==Ce?e.constructor:r,c=s?zi(s):"";if(c)switch(c){case qp:return Ve;case zp:return Se;case Up:return St;case Hp:return qe;case Bp:return Be}return i});function ng(e,i,s){for(var c=-1,f=s.length;++c<f;){var v=s[c],I=v.size;switch(v.type){case"drop":e+=I;break;case"dropRight":i-=I;break;case"take":i=Wt(i,e+I);break;case"takeRight":e=Mt(e,i-I);break}}return{start:e,end:i}}function sg(e){var i=e.match(Ye);return i?i[1].split(Tt):[]}function Wu(e,i,s){i=wi(i,e);for(var c=-1,f=i.length,v=!1;++c<f;){var I=Kr(i[c]);if(!(v=e!=null&&s(e,I)))break;e=e[I]}return v||++c!=f?v:(f=e==null?0:e.length,!!f&&no(f)&&ti(I,f)&&(xe(e)||Ui(e)))}function og(e){var i=e.length,s=new e.constructor(i);return i&&typeof e[0]=="string"&&He.call(e,"index")&&(s.index=e.index,s.input=e.input),s}function Ju(e){return typeof e.constructor=="function"&&!qn(e)?un(Ts(e)):{}}function ag(e,i,s){var c=e.constructor;switch(i){case $e:return Ra(e);case H:case j:return new c(+e);case Ve:return kd(e,s);case ft:case Ue:case Ot:case $t:case Bt:case kt:case qt:case Xt:case sr:return Tu(e,s);case Se:return new c;case Fe:case Xe:return new c(e);case at:return Kd(e);case qe:return new c;case Ze:return Vd(e)}}function cg(e,i){var s=i.length;if(!s)return e;var c=s-1;return i[c]=(s>1?"& ":"")+i[c],i=i.join(s>2?", ":" "),e.replace(mt,`{
/* [wrapped with `+i+`] */
`)}function ug(e){return xe(e)||Ui(e)||!!(eu&&e&&e[eu])}function ti(e,i){var s=typeof e;return i=i??G,!!i&&(s=="number"||s!="symbol"&&Mo.test(e))&&e>-1&&e%1==0&&e<i}function rr(e,i,s){if(!ht(s))return!1;var c=typeof i;return(c=="number"?cr(s)&&ti(i,s.length):c=="string"&&i in s)?Fr(s[i],e):!1}function $a(e,i){if(xe(e))return!1;var s=typeof e;return s=="number"||s=="symbol"||s=="boolean"||e==null||vr(e)?!0:Rt.test(e)||!nt.test(e)||i!=null&&e in Qe(i)}function hg(e){var i=typeof e;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?e!=="__proto__":e===null}function ja(e){var i=Qs(e),s=y[i];if(typeof s!="function"||!(i in Te.prototype))return!1;if(e===s)return!0;var c=La(s);return!!c&&e===c[0]}function lg(e){return!!Qc&&Qc in e}var fg=Ss?ri:ec;function qn(e){var i=e&&e.constructor,s=typeof i=="function"&&i.prototype||on;return e===s}function Qu(e){return e===e&&!ht(e)}function Yu(e,i){return function(s){return s==null?!1:s[e]===i&&(i!==r||e in Qe(s))}}function pg(e){var i=ro(e,function(c){return s.size===b&&s.clear(),c}),s=i.cache;return i}function dg(e,i){var s=e[1],c=i[1],f=s|c,v=f<(oe|he|Q),I=c==Q&&s==fe||c==Q&&s==$&&e[7].length<=i[8]||c==(Q|$)&&i[7].length<=i[8]&&s==fe;if(!(v||I))return e;c&oe&&(e[2]=i[2],f|=s&oe?0:le);var O=i[3];if(O){var L=e[3];e[3]=L?Lu(L,O,i[4]):O,e[4]=L?yi(e[3],S):i[4]}return O=i[5],O&&(L=e[5],e[5]=L?Du(L,O,i[6]):O,e[6]=L?yi(e[5],S):i[6]),O=i[7],O&&(e[7]=O),c&Q&&(e[8]=e[8]==null?i[8]:Wt(e[8],i[8])),e[9]==null&&(e[9]=i[9]),e[0]=i[0],e[1]=f,e}function gg(e){var i=[];if(e!=null)for(var s in Qe(e))i.push(s);return i}function yg(e){return Rs.call(e)}function Xu(e,i,s){return i=Mt(i===r?e.length-1:i,0),function(){for(var c=arguments,f=-1,v=Mt(c.length-i,0),I=z(v);++f<v;)I[f]=c[i+f];f=-1;for(var O=z(i+1);++f<i;)O[f]=c[f];return O[i]=s(I),zt(e,this,O)}}function Zu(e,i){return i.length<2?e:Mi(e,Or(i,0,-1))}function vg(e,i){for(var s=e.length,c=Wt(i.length,s),f=ar(e);c--;){var v=i[c];e[c]=ti(v,s)?f[v]:r}return e}function Ma(e,i){if(!(i==="constructor"&&typeof e[i]=="function")&&i!="__proto__")return e[i]}var eh=rh(Iu),zn=Np||function(e,i){return Le.setTimeout(e,i)},qa=rh(zd);function th(e,i,s){var c=i+"";return qa(e,cg(c,mg(sg(c),s)))}function rh(e){var i=0,s=0;return function(){var c=$p(),f=R-(c-s);if(s=c,f>0){if(++i>=w)return arguments[0]}else i=0;return e.apply(r,arguments)}}function Xs(e,i){var s=-1,c=e.length,f=c-1;for(i=i===r?c:i;++s<i;){var v=ba(s,f),I=e[v];e[v]=e[s],e[s]=I}return e.length=i,e}var ih=pg(function(e){var i=[];return e.charCodeAt(0)===46&&i.push(""),e.replace(At,function(s,c,f,v){i.push(f?v.replace(No,"$1"):c||s)}),i});function Kr(e){if(typeof e=="string"||vr(e))return e;var i=e+"";return i=="0"&&1/e==-V?"-0":i}function zi(e){if(e!=null){try{return Os.call(e)}catch{}try{return e+""}catch{}}return""}function mg(e,i){return Ir(lt,function(s){var c="_."+s[0];i&s[1]&&!Es(e,c)&&e.push(c)}),e.sort()}function nh(e){if(e instanceof Te)return e.clone();var i=new Pr(e.__wrapped__,e.__chain__);return i.__actions__=ar(e.__actions__),i.__index__=e.__index__,i.__values__=e.__values__,i}function _g(e,i,s){(s?rr(e,i,s):i===r)?i=1:i=Mt(Pe(i),0);var c=e==null?0:e.length;if(!c||i<1)return[];for(var f=0,v=0,I=z(Ds(c/i));f<c;)I[v++]=Or(e,f,f+=i);return I}function wg(e){for(var i=-1,s=e==null?0:e.length,c=0,f=[];++i<s;){var v=e[i];v&&(f[c++]=v)}return f}function bg(){var e=arguments.length;if(!e)return[];for(var i=z(e-1),s=arguments[0],c=e;c--;)i[c-1]=arguments[c];return gi(xe(s)?ar(s):[s],Kt(i,1))}var Eg=Re(function(e,i){return It(e)?Dn(e,Kt(i,1,It,!0)):[]}),Ig=Re(function(e,i){var s=Rr(i);return It(s)&&(s=r),It(e)?Dn(e,Kt(i,1,It,!0),ye(s,2)):[]}),xg=Re(function(e,i){var s=Rr(i);return It(s)&&(s=r),It(e)?Dn(e,Kt(i,1,It,!0),r,s):[]});function Pg(e,i,s){var c=e==null?0:e.length;return c?(i=s||i===r?1:Pe(i),Or(e,i<0?0:i,c)):[]}function Sg(e,i,s){var c=e==null?0:e.length;return c?(i=s||i===r?1:Pe(i),i=c-i,Or(e,0,i<0?0:i)):[]}function Og(e,i){return e&&e.length?ks(e,ye(i,3),!0,!0):[]}function Rg(e,i){return e&&e.length?ks(e,ye(i,3),!0):[]}function Ag(e,i,s,c){var f=e==null?0:e.length;return f?(s&&typeof s!="number"&&rr(e,i,s)&&(s=0,c=f),bd(e,i,s,c)):[]}function sh(e,i,s){var c=e==null?0:e.length;if(!c)return-1;var f=s==null?0:Pe(s);return f<0&&(f=Mt(c+f,0)),Is(e,ye(i,3),f)}function oh(e,i,s){var c=e==null?0:e.length;if(!c)return-1;var f=c-1;return s!==r&&(f=Pe(s),f=s<0?Mt(c+f,0):Wt(f,c-1)),Is(e,ye(i,3),f,!0)}function ah(e){var i=e==null?0:e.length;return i?Kt(e,1):[]}function Cg(e){var i=e==null?0:e.length;return i?Kt(e,V):[]}function Tg(e,i){var s=e==null?0:e.length;return s?(i=i===r?1:Pe(i),Kt(e,i)):[]}function Ng(e){for(var i=-1,s=e==null?0:e.length,c={};++i<s;){var f=e[i];c[f[0]]=f[1]}return c}function ch(e){return e&&e.length?e[0]:r}function Lg(e,i,s){var c=e==null?0:e.length;if(!c)return-1;var f=s==null?0:Pe(s);return f<0&&(f=Mt(c+f,0)),tn(e,i,f)}function Dg(e){var i=e==null?0:e.length;return i?Or(e,0,-1):[]}var Fg=Re(function(e){var i=st(e,Sa);return i.length&&i[0]===e[0]?ya(i):[]}),$g=Re(function(e){var i=Rr(e),s=st(e,Sa);return i===Rr(s)?i=r:s.pop(),s.length&&s[0]===e[0]?ya(s,ye(i,2)):[]}),jg=Re(function(e){var i=Rr(e),s=st(e,Sa);return i=typeof i=="function"?i:r,i&&s.pop(),s.length&&s[0]===e[0]?ya(s,r,i):[]});function Mg(e,i){return e==null?"":Dp.call(e,i)}function Rr(e){var i=e==null?0:e.length;return i?e[i-1]:r}function qg(e,i,s){var c=e==null?0:e.length;if(!c)return-1;var f=c;return s!==r&&(f=Pe(s),f=f<0?Mt(c+f,0):Wt(f,c-1)),i===i?mp(e,i,f):Is(e,Hc,f,!0)}function zg(e,i){return e&&e.length?_u(e,Pe(i)):r}var Ug=Re(uh);function uh(e,i){return e&&e.length&&i&&i.length?wa(e,i):e}function Hg(e,i,s){return e&&e.length&&i&&i.length?wa(e,i,ye(s,2)):e}function Bg(e,i,s){return e&&e.length&&i&&i.length?wa(e,i,r,s):e}var kg=ei(function(e,i){var s=e==null?0:e.length,c=fa(e,i);return Eu(e,st(i,function(f){return ti(f,s)?+f:f}).sort(Nu)),c});function Kg(e,i){var s=[];if(!(e&&e.length))return s;var c=-1,f=[],v=e.length;for(i=ye(i,3);++c<v;){var I=e[c];i(I,c,e)&&(s.push(I),f.push(c))}return Eu(e,f),s}function za(e){return e==null?e:Mp.call(e)}function Vg(e,i,s){var c=e==null?0:e.length;return c?(s&&typeof s!="number"&&rr(e,i,s)?(i=0,s=c):(i=i==null?0:Pe(i),s=s===r?c:Pe(s)),Or(e,i,s)):[]}function Gg(e,i){return Bs(e,i)}function Wg(e,i,s){return Ia(e,i,ye(s,2))}function Jg(e,i){var s=e==null?0:e.length;if(s){var c=Bs(e,i);if(c<s&&Fr(e[c],i))return c}return-1}function Qg(e,i){return Bs(e,i,!0)}function Yg(e,i,s){return Ia(e,i,ye(s,2),!0)}function Xg(e,i){var s=e==null?0:e.length;if(s){var c=Bs(e,i,!0)-1;if(Fr(e[c],i))return c}return-1}function Zg(e){return e&&e.length?xu(e):[]}function ey(e,i){return e&&e.length?xu(e,ye(i,2)):[]}function ty(e){var i=e==null?0:e.length;return i?Or(e,1,i):[]}function ry(e,i,s){return e&&e.length?(i=s||i===r?1:Pe(i),Or(e,0,i<0?0:i)):[]}function iy(e,i,s){var c=e==null?0:e.length;return c?(i=s||i===r?1:Pe(i),i=c-i,Or(e,i<0?0:i,c)):[]}function ny(e,i){return e&&e.length?ks(e,ye(i,3),!1,!0):[]}function sy(e,i){return e&&e.length?ks(e,ye(i,3)):[]}var oy=Re(function(e){return _i(Kt(e,1,It,!0))}),ay=Re(function(e){var i=Rr(e);return It(i)&&(i=r),_i(Kt(e,1,It,!0),ye(i,2))}),cy=Re(function(e){var i=Rr(e);return i=typeof i=="function"?i:r,_i(Kt(e,1,It,!0),r,i)});function uy(e){return e&&e.length?_i(e):[]}function hy(e,i){return e&&e.length?_i(e,ye(i,2)):[]}function ly(e,i){return i=typeof i=="function"?i:r,e&&e.length?_i(e,r,i):[]}function Ua(e){if(!(e&&e.length))return[];var i=0;return e=di(e,function(s){if(It(s))return i=Mt(s.length,i),!0}),na(i,function(s){return st(e,ta(s))})}function hh(e,i){if(!(e&&e.length))return[];var s=Ua(e);return i==null?s:st(s,function(c){return zt(i,r,c)})}var fy=Re(function(e,i){return It(e)?Dn(e,i):[]}),py=Re(function(e){return Pa(di(e,It))}),dy=Re(function(e){var i=Rr(e);return It(i)&&(i=r),Pa(di(e,It),ye(i,2))}),gy=Re(function(e){var i=Rr(e);return i=typeof i=="function"?i:r,Pa(di(e,It),r,i)}),yy=Re(Ua);function vy(e,i){return Ru(e||[],i||[],Ln)}function my(e,i){return Ru(e||[],i||[],jn)}var _y=Re(function(e){var i=e.length,s=i>1?e[i-1]:r;return s=typeof s=="function"?(e.pop(),s):r,hh(e,s)});function lh(e){var i=y(e);return i.__chain__=!0,i}function wy(e,i){return i(e),e}function Zs(e,i){return i(e)}var by=ei(function(e){var i=e.length,s=i?e[0]:0,c=this.__wrapped__,f=function(v){return fa(v,e)};return i>1||this.__actions__.length||!(c instanceof Te)||!ti(s)?this.thru(f):(c=c.slice(s,+s+(i?1:0)),c.__actions__.push({func:Zs,args:[f],thisArg:r}),new Pr(c,this.__chain__).thru(function(v){return i&&!v.length&&v.push(r),v}))});function Ey(){return lh(this)}function Iy(){return new Pr(this.value(),this.__chain__)}function xy(){this.__values__===r&&(this.__values__=Ph(this.value()));var e=this.__index__>=this.__values__.length,i=e?r:this.__values__[this.__index__++];return{done:e,value:i}}function Py(){return this}function Sy(e){for(var i,s=this;s instanceof Ms;){var c=nh(s);c.__index__=0,c.__values__=r,i?f.__wrapped__=c:i=c;var f=c;s=s.__wrapped__}return f.__wrapped__=e,i}function Oy(){var e=this.__wrapped__;if(e instanceof Te){var i=e;return this.__actions__.length&&(i=new Te(this)),i=i.reverse(),i.__actions__.push({func:Zs,args:[za],thisArg:r}),new Pr(i,this.__chain__)}return this.thru(za)}function Ry(){return Ou(this.__wrapped__,this.__actions__)}var Ay=Ks(function(e,i,s){He.call(e,s)?++e[s]:Xr(e,s,1)});function Cy(e,i,s){var c=xe(e)?zc:wd;return s&&rr(e,i,s)&&(i=r),c(e,ye(i,3))}function Ty(e,i){var s=xe(e)?di:hu;return s(e,ye(i,3))}var Ny=Mu(sh),Ly=Mu(oh);function Dy(e,i){return Kt(eo(e,i),1)}function Fy(e,i){return Kt(eo(e,i),V)}function $y(e,i,s){return s=s===r?1:Pe(s),Kt(eo(e,i),s)}function fh(e,i){var s=xe(e)?Ir:mi;return s(e,ye(i,3))}function ph(e,i){var s=xe(e)?tp:uu;return s(e,ye(i,3))}var jy=Ks(function(e,i,s){He.call(e,s)?e[s].push(i):Xr(e,s,[i])});function My(e,i,s,c){e=cr(e)?e:dn(e),s=s&&!c?Pe(s):0;var f=e.length;return s<0&&(s=Mt(f+s,0)),so(e)?s<=f&&e.indexOf(i,s)>-1:!!f&&tn(e,i,s)>-1}var qy=Re(function(e,i,s){var c=-1,f=typeof i=="function",v=cr(e)?z(e.length):[];return mi(e,function(I){v[++c]=f?zt(i,I,s):Fn(I,i,s)}),v}),zy=Ks(function(e,i,s){Xr(e,s,i)});function eo(e,i){var s=xe(e)?st:yu;return s(e,ye(i,3))}function Uy(e,i,s,c){return e==null?[]:(xe(i)||(i=i==null?[]:[i]),s=c?r:s,xe(s)||(s=s==null?[]:[s]),wu(e,i,s))}var Hy=Ks(function(e,i,s){e[s?0:1].push(i)},function(){return[[],[]]});function By(e,i,s){var c=xe(e)?Zo:kc,f=arguments.length<3;return c(e,ye(i,4),s,f,mi)}function ky(e,i,s){var c=xe(e)?rp:kc,f=arguments.length<3;return c(e,ye(i,4),s,f,uu)}function Ky(e,i){var s=xe(e)?di:hu;return s(e,io(ye(i,3)))}function Vy(e){var i=xe(e)?su:Md;return i(e)}function Gy(e,i,s){(s?rr(e,i,s):i===r)?i=1:i=Pe(i);var c=xe(e)?gd:qd;return c(e,i)}function Wy(e){var i=xe(e)?yd:Ud;return i(e)}function Jy(e){if(e==null)return 0;if(cr(e))return so(e)?nn(e):e.length;var i=Jt(e);return i==Se||i==qe?e.size:ma(e).length}function Qy(e,i,s){var c=xe(e)?ea:Hd;return s&&rr(e,i,s)&&(i=r),c(e,ye(i,3))}var Yy=Re(function(e,i){if(e==null)return[];var s=i.length;return s>1&&rr(e,i[0],i[1])?i=[]:s>2&&rr(i[0],i[1],i[2])&&(i=[i[0]]),wu(e,Kt(i,1),[])}),to=Tp||function(){return Le.Date.now()};function Xy(e,i){if(typeof i!="function")throw new xr(d);return e=Pe(e),function(){if(--e<1)return i.apply(this,arguments)}}function dh(e,i,s){return i=s?r:i,i=e&&i==null?e.length:i,Zr(e,Q,r,r,r,r,i)}function gh(e,i){var s;if(typeof i!="function")throw new xr(d);return e=Pe(e),function(){return--e>0&&(s=i.apply(this,arguments)),e<=1&&(i=r),s}}var Ha=Re(function(e,i,s){var c=oe;if(s.length){var f=yi(s,fn(Ha));c|=de}return Zr(e,c,i,s,f)}),yh=Re(function(e,i,s){var c=oe|he;if(s.length){var f=yi(s,fn(yh));c|=de}return Zr(i,c,e,s,f)});function vh(e,i,s){i=s?r:i;var c=Zr(e,fe,r,r,r,r,r,i);return c.placeholder=vh.placeholder,c}function mh(e,i,s){i=s?r:i;var c=Zr(e,pe,r,r,r,r,r,i);return c.placeholder=mh.placeholder,c}function _h(e,i,s){var c,f,v,I,O,L,W=0,J=!1,Z=!1,re=!0;if(typeof e!="function")throw new xr(d);i=Ar(i)||0,ht(s)&&(J=!!s.leading,Z="maxWait"in s,v=Z?Mt(Ar(s.maxWait)||0,i):v,re="trailing"in s?!!s.trailing:re);function ce(xt){var $r=c,ni=f;return c=f=r,W=xt,I=e.apply(ni,$r),I}function ve(xt){return W=xt,O=zn(Ae,i),J?ce(xt):I}function Oe(xt){var $r=xt-L,ni=xt-W,Mh=i-$r;return Z?Wt(Mh,v-ni):Mh}function me(xt){var $r=xt-L,ni=xt-W;return L===r||$r>=i||$r<0||Z&&ni>=v}function Ae(){var xt=to();if(me(xt))return De(xt);O=zn(Ae,Oe(xt))}function De(xt){return O=r,re&&c?ce(xt):(c=f=r,I)}function mr(){O!==r&&Au(O),W=0,c=L=f=O=r}function ir(){return O===r?I:De(to())}function _r(){var xt=to(),$r=me(xt);if(c=arguments,f=this,L=xt,$r){if(O===r)return ve(L);if(Z)return Au(O),O=zn(Ae,i),ce(L)}return O===r&&(O=zn(Ae,i)),I}return _r.cancel=mr,_r.flush=ir,_r}var Zy=Re(function(e,i){return cu(e,1,i)}),ev=Re(function(e,i,s){return cu(e,Ar(i)||0,s)});function tv(e){return Zr(e,ue)}function ro(e,i){if(typeof e!="function"||i!=null&&typeof i!="function")throw new xr(d);var s=function(){var c=arguments,f=i?i.apply(this,c):c[0],v=s.cache;if(v.has(f))return v.get(f);var I=e.apply(this,c);return s.cache=v.set(f,I)||v,I};return s.cache=new(ro.Cache||Yr),s}ro.Cache=Yr;function io(e){if(typeof e!="function")throw new xr(d);return function(){var i=arguments;switch(i.length){case 0:return!e.call(this);case 1:return!e.call(this,i[0]);case 2:return!e.call(this,i[0],i[1]);case 3:return!e.call(this,i[0],i[1],i[2])}return!e.apply(this,i)}}function rv(e){return gh(2,e)}var iv=Bd(function(e,i){i=i.length==1&&xe(i[0])?st(i[0],gr(ye())):st(Kt(i,1),gr(ye()));var s=i.length;return Re(function(c){for(var f=-1,v=Wt(c.length,s);++f<v;)c[f]=i[f].call(this,c[f]);return zt(e,this,c)})}),Ba=Re(function(e,i){var s=yi(i,fn(Ba));return Zr(e,de,r,i,s)}),wh=Re(function(e,i){var s=yi(i,fn(wh));return Zr(e,U,r,i,s)}),nv=ei(function(e,i){return Zr(e,$,r,r,r,i)});function sv(e,i){if(typeof e!="function")throw new xr(d);return i=i===r?i:Pe(i),Re(e,i)}function ov(e,i){if(typeof e!="function")throw new xr(d);return i=i==null?0:Mt(Pe(i),0),Re(function(s){var c=s[i],f=bi(s,0,i);return c&&gi(f,c),zt(e,this,f)})}function av(e,i,s){var c=!0,f=!0;if(typeof e!="function")throw new xr(d);return ht(s)&&(c="leading"in s?!!s.leading:c,f="trailing"in s?!!s.trailing:f),_h(e,i,{leading:c,maxWait:i,trailing:f})}function cv(e){return dh(e,1)}function uv(e,i){return Ba(Oa(i),e)}function hv(){if(!arguments.length)return[];var e=arguments[0];return xe(e)?e:[e]}function lv(e){return Sr(e,K)}function fv(e,i){return i=typeof i=="function"?i:r,Sr(e,K,i)}function pv(e){return Sr(e,D|K)}function dv(e,i){return i=typeof i=="function"?i:r,Sr(e,D|K,i)}function gv(e,i){return i==null||au(e,i,Ut(i))}function Fr(e,i){return e===i||e!==e&&i!==i}var yv=Js(ga),vv=Js(function(e,i){return e>=i}),Ui=pu(function(){return arguments}())?pu:function(e){return _t(e)&&He.call(e,"callee")&&!Zc.call(e,"callee")},xe=z.isArray,mv=er?gr(er):Sd;function cr(e){return e!=null&&no(e.length)&&!ri(e)}function It(e){return _t(e)&&cr(e)}function _v(e){return e===!0||e===!1||_t(e)&&tr(e)==H}var Ei=Lp||ec,wv=Nr?gr(Nr):Od;function bv(e){return _t(e)&&e.nodeType===1&&!Un(e)}function Ev(e){if(e==null)return!0;if(cr(e)&&(xe(e)||typeof e=="string"||typeof e.splice=="function"||Ei(e)||pn(e)||Ui(e)))return!e.length;var i=Jt(e);if(i==Se||i==qe)return!e.size;if(qn(e))return!ma(e).length;for(var s in e)if(He.call(e,s))return!1;return!0}function Iv(e,i){return $n(e,i)}function xv(e,i,s){s=typeof s=="function"?s:r;var c=s?s(e,i):r;return c===r?$n(e,i,r,s):!!c}function ka(e){if(!_t(e))return!1;var i=tr(e);return i==A||i==u||typeof e.message=="string"&&typeof e.name=="string"&&!Un(e)}function Pv(e){return typeof e=="number"&&tu(e)}function ri(e){if(!ht(e))return!1;var i=tr(e);return i==ae||i==we||i==B||i==wt}function bh(e){return typeof e=="number"&&e==Pe(e)}function no(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=G}function ht(e){var i=typeof e;return e!=null&&(i=="object"||i=="function")}function _t(e){return e!=null&&typeof e=="object"}var Eh=Er?gr(Er):Ad;function Sv(e,i){return e===i||va(e,i,Da(i))}function Ov(e,i,s){return s=typeof s=="function"?s:r,va(e,i,Da(i),s)}function Rv(e){return Ih(e)&&e!=+e}function Av(e){if(fg(e))throw new Ee(h);return du(e)}function Cv(e){return e===null}function Tv(e){return e==null}function Ih(e){return typeof e=="number"||_t(e)&&tr(e)==Fe}function Un(e){if(!_t(e)||tr(e)!=Ce)return!1;var i=Ts(e);if(i===null)return!0;var s=He.call(i,"constructor")&&i.constructor;return typeof s=="function"&&s instanceof s&&Os.call(s)==Op}var Ka=Hr?gr(Hr):Cd;function Nv(e){return bh(e)&&e>=-G&&e<=G}var xh=Sn?gr(Sn):Td;function so(e){return typeof e=="string"||!xe(e)&&_t(e)&&tr(e)==Xe}function vr(e){return typeof e=="symbol"||_t(e)&&tr(e)==Ze}var pn=Li?gr(Li):Nd;function Lv(e){return e===r}function Dv(e){return _t(e)&&Jt(e)==Be}function Fv(e){return _t(e)&&tr(e)==et}var $v=Js(_a),jv=Js(function(e,i){return e<=i});function Ph(e){if(!e)return[];if(cr(e))return so(e)?Lr(e):ar(e);if(Rn&&e[Rn])return gp(e[Rn]());var i=Jt(e),s=i==Se?oa:i==qe?xs:dn;return s(e)}function ii(e){if(!e)return e===0?e:0;if(e=Ar(e),e===V||e===-V){var i=e<0?-1:1;return i*P}return e===e?e:0}function Pe(e){var i=ii(e),s=i%1;return i===i?s?i-s:i:0}function Sh(e){return e?ji(Pe(e),0,X):0}function Ar(e){if(typeof e=="number")return e;if(vr(e))return q;if(ht(e)){var i=typeof e.valueOf=="function"?e.valueOf():e;e=ht(i)?i+"":i}if(typeof e!="string")return e===0?e:+e;e=Kc(e);var s=Fo.test(e);return s||jo.test(e)?Ie(e.slice(2),s?2:8):Do.test(e)?q:+e}function Oh(e){return kr(e,ur(e))}function Mv(e){return e?ji(Pe(e),-G,G):e===0?e:0}function ze(e){return e==null?"":yr(e)}var qv=hn(function(e,i){if(qn(i)||cr(i)){kr(i,Ut(i),e);return}for(var s in i)He.call(i,s)&&Ln(e,s,i[s])}),Rh=hn(function(e,i){kr(i,ur(i),e)}),oo=hn(function(e,i,s,c){kr(i,ur(i),e,c)}),zv=hn(function(e,i,s,c){kr(i,Ut(i),e,c)}),Uv=ei(fa);function Hv(e,i){var s=un(e);return i==null?s:ou(s,i)}var Bv=Re(function(e,i){e=Qe(e);var s=-1,c=i.length,f=c>2?i[2]:r;for(f&&rr(i[0],i[1],f)&&(c=1);++s<c;)for(var v=i[s],I=ur(v),O=-1,L=I.length;++O<L;){var W=I[O],J=e[W];(J===r||Fr(J,on[W])&&!He.call(e,W))&&(e[W]=v[W])}return e}),kv=Re(function(e){return e.push(r,Ku),zt(Ah,r,e)});function Kv(e,i){return Uc(e,ye(i,3),Br)}function Vv(e,i){return Uc(e,ye(i,3),da)}function Gv(e,i){return e==null?e:pa(e,ye(i,3),ur)}function Wv(e,i){return e==null?e:lu(e,ye(i,3),ur)}function Jv(e,i){return e&&Br(e,ye(i,3))}function Qv(e,i){return e&&da(e,ye(i,3))}function Yv(e){return e==null?[]:Us(e,Ut(e))}function Xv(e){return e==null?[]:Us(e,ur(e))}function Va(e,i,s){var c=e==null?r:Mi(e,i);return c===r?s:c}function Zv(e,i){return e!=null&&Wu(e,i,Ed)}function Ga(e,i){return e!=null&&Wu(e,i,Id)}var e0=zu(function(e,i,s){i!=null&&typeof i.toString!="function"&&(i=Rs.call(i)),e[i]=s},Ja(hr)),t0=zu(function(e,i,s){i!=null&&typeof i.toString!="function"&&(i=Rs.call(i)),He.call(e,i)?e[i].push(s):e[i]=[s]},ye),r0=Re(Fn);function Ut(e){return cr(e)?nu(e):ma(e)}function ur(e){return cr(e)?nu(e,!0):Ld(e)}function i0(e,i){var s={};return i=ye(i,3),Br(e,function(c,f,v){Xr(s,i(c,f,v),c)}),s}function n0(e,i){var s={};return i=ye(i,3),Br(e,function(c,f,v){Xr(s,f,i(c,f,v))}),s}var s0=hn(function(e,i,s){Hs(e,i,s)}),Ah=hn(function(e,i,s,c){Hs(e,i,s,c)}),o0=ei(function(e,i){var s={};if(e==null)return s;var c=!1;i=st(i,function(v){return v=wi(v,e),c||(c=v.length>1),v}),kr(e,Na(e),s),c&&(s=Sr(s,D|M|K,eg));for(var f=i.length;f--;)xa(s,i[f]);return s});function a0(e,i){return Ch(e,io(ye(i)))}var c0=ei(function(e,i){return e==null?{}:Fd(e,i)});function Ch(e,i){if(e==null)return{};var s=st(Na(e),function(c){return[c]});return i=ye(i),bu(e,s,function(c,f){return i(c,f[0])})}function u0(e,i,s){i=wi(i,e);var c=-1,f=i.length;for(f||(f=1,e=r);++c<f;){var v=e==null?r:e[Kr(i[c])];v===r&&(c=f,v=s),e=ri(v)?v.call(e):v}return e}function h0(e,i,s){return e==null?e:jn(e,i,s)}function l0(e,i,s,c){return c=typeof c=="function"?c:r,e==null?e:jn(e,i,s,c)}var Th=Bu(Ut),Nh=Bu(ur);function f0(e,i,s){var c=xe(e),f=c||Ei(e)||pn(e);if(i=ye(i,4),s==null){var v=e&&e.constructor;f?s=c?new v:[]:ht(e)?s=ri(v)?un(Ts(e)):{}:s={}}return(f?Ir:Br)(e,function(I,O,L){return i(s,I,O,L)}),s}function p0(e,i){return e==null?!0:xa(e,i)}function d0(e,i,s){return e==null?e:Su(e,i,Oa(s))}function g0(e,i,s,c){return c=typeof c=="function"?c:r,e==null?e:Su(e,i,Oa(s),c)}function dn(e){return e==null?[]:sa(e,Ut(e))}function y0(e){return e==null?[]:sa(e,ur(e))}function v0(e,i,s){return s===r&&(s=i,i=r),s!==r&&(s=Ar(s),s=s===s?s:0),i!==r&&(i=Ar(i),i=i===i?i:0),ji(Ar(e),i,s)}function m0(e,i,s){return i=ii(i),s===r?(s=i,i=0):s=ii(s),e=Ar(e),xd(e,i,s)}function _0(e,i,s){if(s&&typeof s!="boolean"&&rr(e,i,s)&&(i=s=r),s===r&&(typeof i=="boolean"?(s=i,i=r):typeof e=="boolean"&&(s=e,e=r)),e===r&&i===r?(e=0,i=1):(e=ii(e),i===r?(i=e,e=0):i=ii(i)),e>i){var c=e;e=i,i=c}if(s||e%1||i%1){var f=ru();return Wt(e+f*(i-e+We("1e-"+((f+"").length-1))),i)}return ba(e,i)}var w0=ln(function(e,i,s){return i=i.toLowerCase(),e+(s?Lh(i):i)});function Lh(e){return Wa(ze(e).toLowerCase())}function Dh(e){return e=ze(e),e&&e.replace(Wr,hp).replace(Qo,"")}function b0(e,i,s){e=ze(e),i=yr(i);var c=e.length;s=s===r?c:ji(Pe(s),0,c);var f=s;return s-=i.length,s>=0&&e.slice(s,f)==i}function E0(e){return e=ze(e),e&&it.test(e)?e.replace(Ri,lp):e}function I0(e){return e=ze(e),e&&Ct.test(e)?e.replace(yt,"\\$&"):e}var x0=ln(function(e,i,s){return e+(s?"-":"")+i.toLowerCase()}),P0=ln(function(e,i,s){return e+(s?" ":"")+i.toLowerCase()}),S0=ju("toLowerCase");function O0(e,i,s){e=ze(e),i=Pe(i);var c=i?nn(e):0;if(!i||c>=i)return e;var f=(i-c)/2;return Ws(Fs(f),s)+e+Ws(Ds(f),s)}function R0(e,i,s){e=ze(e),i=Pe(i);var c=i?nn(e):0;return i&&c<i?e+Ws(i-c,s):e}function A0(e,i,s){e=ze(e),i=Pe(i);var c=i?nn(e):0;return i&&c<i?Ws(i-c,s)+e:e}function C0(e,i,s){return s||i==null?i=0:i&&(i=+i),jp(ze(e).replace(vt,""),i||0)}function T0(e,i,s){return(s?rr(e,i,s):i===r)?i=1:i=Pe(i),Ea(ze(e),i)}function N0(){var e=arguments,i=ze(e[0]);return e.length<3?i:i.replace(e[1],e[2])}var L0=ln(function(e,i,s){return e+(s?"_":"")+i.toLowerCase()});function D0(e,i,s){return s&&typeof s!="number"&&rr(e,i,s)&&(i=s=r),s=s===r?X:s>>>0,s?(e=ze(e),e&&(typeof i=="string"||i!=null&&!Ka(i))&&(i=yr(i),!i&&rn(e))?bi(Lr(e),0,s):e.split(i,s)):[]}var F0=ln(function(e,i,s){return e+(s?" ":"")+Wa(i)});function $0(e,i,s){return e=ze(e),s=s==null?0:ji(Pe(s),0,e.length),i=yr(i),e.slice(s,s+i.length)==i}function j0(e,i,s){var c=y.templateSettings;s&&rr(e,i,s)&&(i=r),e=ze(e),i=oo({},i,c,ku);var f=oo({},i.imports,c.imports,ku),v=Ut(f),I=sa(f,v),O,L,W=0,J=i.interpolate||Wi,Z="__p += '",re=aa((i.escape||Wi).source+"|"+J.source+"|"+(J===ut?Lo:Wi).source+"|"+(i.evaluate||Wi).source+"|$","g"),ce="//# sourceURL="+(He.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Yo+"]")+`
`;e.replace(re,function(me,Ae,De,mr,ir,_r){return De||(De=mr),Z+=e.slice(W,_r).replace(qo,fp),Ae&&(O=!0,Z+=`' +
__e(`+Ae+`) +
'`),ir&&(L=!0,Z+=`';
`+ir+`;
__p += '`),De&&(Z+=`' +
((__t = (`+De+`)) == null ? '' : __t) +
'`),W=_r+me.length,me}),Z+=`';
`;var ve=He.call(i,"variable")&&i.variable;if(!ve)Z=`with (obj) {
`+Z+`
}
`;else if(To.test(ve))throw new Ee(_);Z=(L?Z.replace(zr,""):Z).replace(Zt,"$1").replace(Gr,"$1;"),Z="function("+(ve||"obj")+`) {
`+(ve?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(O?", __e = _.escape":"")+(L?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Z+`return __p
}`;var Oe=$h(function(){return Me(v,ce+"return "+Z).apply(r,I)});if(Oe.source=Z,ka(Oe))throw Oe;return Oe}function M0(e){return ze(e).toLowerCase()}function q0(e){return ze(e).toUpperCase()}function z0(e,i,s){if(e=ze(e),e&&(s||i===r))return Kc(e);if(!e||!(i=yr(i)))return e;var c=Lr(e),f=Lr(i),v=Vc(c,f),I=Gc(c,f)+1;return bi(c,v,I).join("")}function U0(e,i,s){if(e=ze(e),e&&(s||i===r))return e.slice(0,Jc(e)+1);if(!e||!(i=yr(i)))return e;var c=Lr(e),f=Gc(c,Lr(i))+1;return bi(c,0,f).join("")}function H0(e,i,s){if(e=ze(e),e&&(s||i===r))return e.replace(vt,"");if(!e||!(i=yr(i)))return e;var c=Lr(e),f=Vc(c,Lr(i));return bi(c,f).join("")}function B0(e,i){var s=g,c=m;if(ht(i)){var f="separator"in i?i.separator:f;s="length"in i?Pe(i.length):s,c="omission"in i?yr(i.omission):c}e=ze(e);var v=e.length;if(rn(e)){var I=Lr(e);v=I.length}if(s>=v)return e;var O=s-nn(c);if(O<1)return c;var L=I?bi(I,0,O).join(""):e.slice(0,O);if(f===r)return L+c;if(I&&(O+=L.length-O),Ka(f)){if(e.slice(O).search(f)){var W,J=L;for(f.global||(f=aa(f.source,ze(br.exec(f))+"g")),f.lastIndex=0;W=f.exec(J);)var Z=W.index;L=L.slice(0,Z===r?O:Z)}}else if(e.indexOf(yr(f),O)!=O){var re=L.lastIndexOf(f);re>-1&&(L=L.slice(0,re))}return L+c}function k0(e){return e=ze(e),e&&pt.test(e)?e.replace(fi,_p):e}var K0=ln(function(e,i,s){return e+(s?" ":"")+i.toUpperCase()}),Wa=ju("toUpperCase");function Fh(e,i,s){return e=ze(e),i=s?r:i,i===r?dp(e)?Ep(e):sp(e):e.match(i)||[]}var $h=Re(function(e,i){try{return zt(e,r,i)}catch(s){return ka(s)?s:new Ee(s)}}),V0=ei(function(e,i){return Ir(i,function(s){s=Kr(s),Xr(e,s,Ha(e[s],e))}),e});function G0(e){var i=e==null?0:e.length,s=ye();return e=i?st(e,function(c){if(typeof c[1]!="function")throw new xr(d);return[s(c[0]),c[1]]}):[],Re(function(c){for(var f=-1;++f<i;){var v=e[f];if(zt(v[0],this,c))return zt(v[1],this,c)}})}function W0(e){return _d(Sr(e,D))}function Ja(e){return function(){return e}}function J0(e,i){return e==null||e!==e?i:e}var Q0=qu(),Y0=qu(!0);function hr(e){return e}function Qa(e){return gu(typeof e=="function"?e:Sr(e,D))}function X0(e){return vu(Sr(e,D))}function Z0(e,i){return mu(e,Sr(i,D))}var em=Re(function(e,i){return function(s){return Fn(s,e,i)}}),tm=Re(function(e,i){return function(s){return Fn(e,s,i)}});function Ya(e,i,s){var c=Ut(i),f=Us(i,c);s==null&&!(ht(i)&&(f.length||!c.length))&&(s=i,i=e,e=this,f=Us(i,Ut(i)));var v=!(ht(s)&&"chain"in s)||!!s.chain,I=ri(e);return Ir(f,function(O){var L=i[O];e[O]=L,I&&(e.prototype[O]=function(){var W=this.__chain__;if(v||W){var J=e(this.__wrapped__),Z=J.__actions__=ar(this.__actions__);return Z.push({func:L,args:arguments,thisArg:e}),J.__chain__=W,J}return L.apply(e,gi([this.value()],arguments))})}),e}function rm(){return Le._===this&&(Le._=Rp),this}function Xa(){}function im(e){return e=Pe(e),Re(function(i){return _u(i,e)})}var nm=Aa(st),sm=Aa(zc),om=Aa(ea);function jh(e){return $a(e)?ta(Kr(e)):$d(e)}function am(e){return function(i){return e==null?r:Mi(e,i)}}var cm=Uu(),um=Uu(!0);function Za(){return[]}function ec(){return!1}function hm(){return{}}function lm(){return""}function fm(){return!0}function pm(e,i){if(e=Pe(e),e<1||e>G)return[];var s=X,c=Wt(e,X);i=ye(i),e-=X;for(var f=na(c,i);++s<e;)i(s);return f}function dm(e){return xe(e)?st(e,Kr):vr(e)?[e]:ar(ih(ze(e)))}function gm(e){var i=++Sp;return ze(e)+i}var ym=Gs(function(e,i){return e+i},0),vm=Ca("ceil"),mm=Gs(function(e,i){return e/i},1),_m=Ca("floor");function wm(e){return e&&e.length?zs(e,hr,ga):r}function bm(e,i){return e&&e.length?zs(e,ye(i,2),ga):r}function Em(e){return Bc(e,hr)}function Im(e,i){return Bc(e,ye(i,2))}function xm(e){return e&&e.length?zs(e,hr,_a):r}function Pm(e,i){return e&&e.length?zs(e,ye(i,2),_a):r}var Sm=Gs(function(e,i){return e*i},1),Om=Ca("round"),Rm=Gs(function(e,i){return e-i},0);function Am(e){return e&&e.length?ia(e,hr):0}function Cm(e,i){return e&&e.length?ia(e,ye(i,2)):0}return y.after=Xy,y.ary=dh,y.assign=qv,y.assignIn=Rh,y.assignInWith=oo,y.assignWith=zv,y.at=Uv,y.before=gh,y.bind=Ha,y.bindAll=V0,y.bindKey=yh,y.castArray=hv,y.chain=lh,y.chunk=_g,y.compact=wg,y.concat=bg,y.cond=G0,y.conforms=W0,y.constant=Ja,y.countBy=Ay,y.create=Hv,y.curry=vh,y.curryRight=mh,y.debounce=_h,y.defaults=Bv,y.defaultsDeep=kv,y.defer=Zy,y.delay=ev,y.difference=Eg,y.differenceBy=Ig,y.differenceWith=xg,y.drop=Pg,y.dropRight=Sg,y.dropRightWhile=Og,y.dropWhile=Rg,y.fill=Ag,y.filter=Ty,y.flatMap=Dy,y.flatMapDeep=Fy,y.flatMapDepth=$y,y.flatten=ah,y.flattenDeep=Cg,y.flattenDepth=Tg,y.flip=tv,y.flow=Q0,y.flowRight=Y0,y.fromPairs=Ng,y.functions=Yv,y.functionsIn=Xv,y.groupBy=jy,y.initial=Dg,y.intersection=Fg,y.intersectionBy=$g,y.intersectionWith=jg,y.invert=e0,y.invertBy=t0,y.invokeMap=qy,y.iteratee=Qa,y.keyBy=zy,y.keys=Ut,y.keysIn=ur,y.map=eo,y.mapKeys=i0,y.mapValues=n0,y.matches=X0,y.matchesProperty=Z0,y.memoize=ro,y.merge=s0,y.mergeWith=Ah,y.method=em,y.methodOf=tm,y.mixin=Ya,y.negate=io,y.nthArg=im,y.omit=o0,y.omitBy=a0,y.once=rv,y.orderBy=Uy,y.over=nm,y.overArgs=iv,y.overEvery=sm,y.overSome=om,y.partial=Ba,y.partialRight=wh,y.partition=Hy,y.pick=c0,y.pickBy=Ch,y.property=jh,y.propertyOf=am,y.pull=Ug,y.pullAll=uh,y.pullAllBy=Hg,y.pullAllWith=Bg,y.pullAt=kg,y.range=cm,y.rangeRight=um,y.rearg=nv,y.reject=Ky,y.remove=Kg,y.rest=sv,y.reverse=za,y.sampleSize=Gy,y.set=h0,y.setWith=l0,y.shuffle=Wy,y.slice=Vg,y.sortBy=Yy,y.sortedUniq=Zg,y.sortedUniqBy=ey,y.split=D0,y.spread=ov,y.tail=ty,y.take=ry,y.takeRight=iy,y.takeRightWhile=ny,y.takeWhile=sy,y.tap=wy,y.throttle=av,y.thru=Zs,y.toArray=Ph,y.toPairs=Th,y.toPairsIn=Nh,y.toPath=dm,y.toPlainObject=Oh,y.transform=f0,y.unary=cv,y.union=oy,y.unionBy=ay,y.unionWith=cy,y.uniq=uy,y.uniqBy=hy,y.uniqWith=ly,y.unset=p0,y.unzip=Ua,y.unzipWith=hh,y.update=d0,y.updateWith=g0,y.values=dn,y.valuesIn=y0,y.without=fy,y.words=Fh,y.wrap=uv,y.xor=py,y.xorBy=dy,y.xorWith=gy,y.zip=yy,y.zipObject=vy,y.zipObjectDeep=my,y.zipWith=_y,y.entries=Th,y.entriesIn=Nh,y.extend=Rh,y.extendWith=oo,Ya(y,y),y.add=ym,y.attempt=$h,y.camelCase=w0,y.capitalize=Lh,y.ceil=vm,y.clamp=v0,y.clone=lv,y.cloneDeep=pv,y.cloneDeepWith=dv,y.cloneWith=fv,y.conformsTo=gv,y.deburr=Dh,y.defaultTo=J0,y.divide=mm,y.endsWith=b0,y.eq=Fr,y.escape=E0,y.escapeRegExp=I0,y.every=Cy,y.find=Ny,y.findIndex=sh,y.findKey=Kv,y.findLast=Ly,y.findLastIndex=oh,y.findLastKey=Vv,y.floor=_m,y.forEach=fh,y.forEachRight=ph,y.forIn=Gv,y.forInRight=Wv,y.forOwn=Jv,y.forOwnRight=Qv,y.get=Va,y.gt=yv,y.gte=vv,y.has=Zv,y.hasIn=Ga,y.head=ch,y.identity=hr,y.includes=My,y.indexOf=Lg,y.inRange=m0,y.invoke=r0,y.isArguments=Ui,y.isArray=xe,y.isArrayBuffer=mv,y.isArrayLike=cr,y.isArrayLikeObject=It,y.isBoolean=_v,y.isBuffer=Ei,y.isDate=wv,y.isElement=bv,y.isEmpty=Ev,y.isEqual=Iv,y.isEqualWith=xv,y.isError=ka,y.isFinite=Pv,y.isFunction=ri,y.isInteger=bh,y.isLength=no,y.isMap=Eh,y.isMatch=Sv,y.isMatchWith=Ov,y.isNaN=Rv,y.isNative=Av,y.isNil=Tv,y.isNull=Cv,y.isNumber=Ih,y.isObject=ht,y.isObjectLike=_t,y.isPlainObject=Un,y.isRegExp=Ka,y.isSafeInteger=Nv,y.isSet=xh,y.isString=so,y.isSymbol=vr,y.isTypedArray=pn,y.isUndefined=Lv,y.isWeakMap=Dv,y.isWeakSet=Fv,y.join=Mg,y.kebabCase=x0,y.last=Rr,y.lastIndexOf=qg,y.lowerCase=P0,y.lowerFirst=S0,y.lt=$v,y.lte=jv,y.max=wm,y.maxBy=bm,y.mean=Em,y.meanBy=Im,y.min=xm,y.minBy=Pm,y.stubArray=Za,y.stubFalse=ec,y.stubObject=hm,y.stubString=lm,y.stubTrue=fm,y.multiply=Sm,y.nth=zg,y.noConflict=rm,y.noop=Xa,y.now=to,y.pad=O0,y.padEnd=R0,y.padStart=A0,y.parseInt=C0,y.random=_0,y.reduce=By,y.reduceRight=ky,y.repeat=T0,y.replace=N0,y.result=u0,y.round=Om,y.runInContext=T,y.sample=Vy,y.size=Jy,y.snakeCase=L0,y.some=Qy,y.sortedIndex=Gg,y.sortedIndexBy=Wg,y.sortedIndexOf=Jg,y.sortedLastIndex=Qg,y.sortedLastIndexBy=Yg,y.sortedLastIndexOf=Xg,y.startCase=F0,y.startsWith=$0,y.subtract=Rm,y.sum=Am,y.sumBy=Cm,y.template=j0,y.times=pm,y.toFinite=ii,y.toInteger=Pe,y.toLength=Sh,y.toLower=M0,y.toNumber=Ar,y.toSafeInteger=Mv,y.toString=ze,y.toUpper=q0,y.trim=z0,y.trimEnd=U0,y.trimStart=H0,y.truncate=B0,y.unescape=k0,y.uniqueId=gm,y.upperCase=K0,y.upperFirst=Wa,y.each=fh,y.eachRight=ph,y.first=ch,Ya(y,function(){var e={};return Br(y,function(i,s){He.call(y.prototype,s)||(e[s]=i)}),e}(),{chain:!1}),y.VERSION=n,Ir(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){y[e].placeholder=y}),Ir(["drop","take"],function(e,i){Te.prototype[e]=function(s){s=s===r?1:Mt(Pe(s),0);var c=this.__filtered__&&!i?new Te(this):this.clone();return c.__filtered__?c.__takeCount__=Wt(s,c.__takeCount__):c.__views__.push({size:Wt(s,X),type:e+(c.__dir__<0?"Right":"")}),c},Te.prototype[e+"Right"]=function(s){return this.reverse()[e](s).reverse()}}),Ir(["filter","map","takeWhile"],function(e,i){var s=i+1,c=s==l||s==N;Te.prototype[e]=function(f){var v=this.clone();return v.__iteratees__.push({iteratee:ye(f,3),type:s}),v.__filtered__=v.__filtered__||c,v}}),Ir(["head","last"],function(e,i){var s="take"+(i?"Right":"");Te.prototype[e]=function(){return this[s](1).value()[0]}}),Ir(["initial","tail"],function(e,i){var s="drop"+(i?"":"Right");Te.prototype[e]=function(){return this.__filtered__?new Te(this):this[s](1)}}),Te.prototype.compact=function(){return this.filter(hr)},Te.prototype.find=function(e){return this.filter(e).head()},Te.prototype.findLast=function(e){return this.reverse().find(e)},Te.prototype.invokeMap=Re(function(e,i){return typeof e=="function"?new Te(this):this.map(function(s){return Fn(s,e,i)})}),Te.prototype.reject=function(e){return this.filter(io(ye(e)))},Te.prototype.slice=function(e,i){e=Pe(e);var s=this;return s.__filtered__&&(e>0||i<0)?new Te(s):(e<0?s=s.takeRight(-e):e&&(s=s.drop(e)),i!==r&&(i=Pe(i),s=i<0?s.dropRight(-i):s.take(i-e)),s)},Te.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Te.prototype.toArray=function(){return this.take(X)},Br(Te.prototype,function(e,i){var s=/^(?:filter|find|map|reject)|While$/.test(i),c=/^(?:head|last)$/.test(i),f=y[c?"take"+(i=="last"?"Right":""):i],v=c||/^find/.test(i);f&&(y.prototype[i]=function(){var I=this.__wrapped__,O=c?[1]:arguments,L=I instanceof Te,W=O[0],J=L||xe(I),Z=function(Ae){var De=f.apply(y,gi([Ae],O));return c&&re?De[0]:De};J&&s&&typeof W=="function"&&W.length!=1&&(L=J=!1);var re=this.__chain__,ce=!!this.__actions__.length,ve=v&&!re,Oe=L&&!ce;if(!v&&J){I=Oe?I:new Te(this);var me=e.apply(I,O);return me.__actions__.push({func:Zs,args:[Z],thisArg:r}),new Pr(me,re)}return ve&&Oe?e.apply(this,O):(me=this.thru(Z),ve?c?me.value()[0]:me.value():me)})}),Ir(["pop","push","shift","sort","splice","unshift"],function(e){var i=Ps[e],s=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",c=/^(?:pop|shift)$/.test(e);y.prototype[e]=function(){var f=arguments;if(c&&!this.__chain__){var v=this.value();return i.apply(xe(v)?v:[],f)}return this[s](function(I){return i.apply(xe(I)?I:[],f)})}}),Br(Te.prototype,function(e,i){var s=y[i];if(s){var c=s.name+"";He.call(cn,c)||(cn[c]=[]),cn[c].push({name:i,func:s})}}),cn[Vs(r,he).name]=[{name:"wrapper",func:r}],Te.prototype.clone=kp,Te.prototype.reverse=Kp,Te.prototype.value=Vp,y.prototype.at=by,y.prototype.chain=Ey,y.prototype.commit=Iy,y.prototype.next=xy,y.prototype.plant=Sy,y.prototype.reverse=Oy,y.prototype.toJSON=y.prototype.valueOf=y.prototype.value=Ry,y.prototype.first=y.prototype.head,Rn&&(y.prototype[Rn]=Py),y},sn=Ip();Et?((Et.exports=sn)._=sn,Je._=sn):Le._=sn}).call(Wn)})(Pc,Pc.exports);var uI=Object.defineProperty,hI=Object.defineProperties,lI=Object.getOwnPropertyDescriptors,Hl=Object.getOwnPropertySymbols,fI=Object.prototype.hasOwnProperty,pI=Object.prototype.propertyIsEnumerable,Bl=(a,t,r)=>t in a?uI(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,lo=(a,t)=>{for(var r in t||(t={}))fI.call(t,r)&&Bl(a,r,t[r]);if(Hl)for(var r of Hl(t))pI.call(t,r)&&Bl(a,r,t[r]);return a},dI=(a,t)=>hI(a,lI(t));function Si(a,t,r){var n;const o=y_(a);return((n=t.rpcMap)==null?void 0:n[o.reference])||`${cI}?chainId=${o.namespace}:${o.reference}&projectId=${r}`}function Gi(a){return a.includes(":")?a.split(":")[1]:a}function Xf(a){return a.map(t=>`${t.split(":")[0]}:${t.split(":")[1]}`)}function gI(a,t){const r=Object.keys(t.namespaces).filter(o=>o.includes(a));if(!r.length)return[];const n=[];return r.forEach(o=>{const h=t.namespaces[o].accounts;n.push(...h)}),n}function yI(a={},t={}){const r=kl(a),n=kl(t);return Pc.exports.merge(r,n)}function kl(a){var t,r,n,o;const h={};if(!go(a))return h;for(const[d,_]of Object.entries(a)){const x=sf(d)?[d]:_.chains,b=_.methods||[],S=_.events||[],D=_.rpcMap||{},M=Jn(d);h[M]=dI(lo(lo({},h[M]),_),{chains:rc(x,(t=h[M])==null?void 0:t.chains),methods:rc(b,(r=h[M])==null?void 0:r.methods),events:rc(S,(n=h[M])==null?void 0:n.events),rpcMap:lo(lo({},D),(o=h[M])==null?void 0:o.rpcMap)})}return h}function vI(a){return a.includes(":")?a.split(":")[2]:a}function mI(a){const t={};for(const[r,n]of Object.entries(a)){const o=n.methods||[],h=n.events||[],d=n.accounts||[],_=sf(r)?[r]:n.chains?n.chains:Xf(n.accounts);t[r]={chains:_,methods:o,events:h,accounts:d}}return t}function dc(a){return typeof a=="number"?a:a.includes("0x")?parseInt(a,16):a.includes(":")?Number(a.split(":")[1]):Number(a)}const Zf={},ot=a=>Zf[a],gc=(a,t)=>{Zf[a]=t};class _I{constructor(t){this.name="polkadot",this.namespace=t.namespace,this.events=ot("events"),this.client=ot("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(li.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const o=Gi(r);t[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||Si(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new hi(new Oi(n,ot("disableProviderPing")))}}class wI{constructor(t){this.name="eip155",this.namespace=t.namespace,this.events=ot("events"),this.client=ot("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(t){switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(t);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(t.request.method)?await this.client.request(t):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(parseInt(t),r),this.chainId=parseInt(t),this.events.emit(li.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,r){const n=r||Si(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new hi(new Oi(n,ot("disableProviderPing")))}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const o=parseInt(Gi(r));t[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const t=this.chainId,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}async handleSwitchChain(t){var r,n;let o=t.request.params?(r=t.request.params[0])==null?void 0:r.chainId:"0x0";o=o.startsWith("0x")?o:`0x${o}`;const h=parseInt(o,16);if(this.isChainApproved(h))this.setDefaultChain(`${h}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:t.topic,request:{method:t.request.method,params:[{chainId:o}]},chainId:(n=this.namespace.chains)==null?void 0:n[0]}),this.setDefaultChain(`${h}`);else throw new Error(`Failed to switch to chain 'eip155:${h}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(t){return this.namespace.chains.includes(`${this.name}:${t}`)}}class bI{constructor(t){this.name="solana",this.namespace=t.namespace,this.events=ot("events"),this.client=ot("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(li.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const o=Gi(r);t[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||Si(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new hi(new Oi(n,ot("disableProviderPing")))}}class EI{constructor(t){this.name="cosmos",this.namespace=t.namespace,this.events=ot("events"),this.client=ot("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(li.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const o=Gi(r);t[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||Si(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new hi(new Oi(n,ot("disableProviderPing")))}}class II{constructor(t){this.name="cip34",this.namespace=t.namespace,this.events=ot("events"),this.client=ot("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(li.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{const n=this.getCardanoRPCUrl(r),o=Gi(r);t[o]=this.createHttpProvider(o,n)}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}getCardanoRPCUrl(t){const r=this.namespace.rpcMap;if(r)return r[t]}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||this.getCardanoRPCUrl(t);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new hi(new Oi(n,ot("disableProviderPing")))}}class xI{constructor(t){this.name="elrond",this.namespace=t.namespace,this.events=ot("events"),this.client=ot("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(li.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const o=Gi(r);t[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||Si(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new hi(new Oi(n,ot("disableProviderPing")))}}class PI{constructor(t){this.name="multiversx",this.namespace=t.namespace,this.events=ot("events"),this.client=ot("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(li.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const o=Gi(r);t[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||Si(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new hi(new Oi(n,ot("disableProviderPing")))}}class SI{constructor(t){this.name="near",this.namespace=t.namespace,this.events=ot("events"),this.client=ot("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const n=r||Si(`${this.name}:${t}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,n)}this.events.emit(li.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;t[r]=this.createHttpProvider(r,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||Si(t,this.namespace);return typeof n>"u"?void 0:new hi(new Oi(n,ot("disableProviderPing")))}}var OI=Object.defineProperty,RI=Object.defineProperties,AI=Object.getOwnPropertyDescriptors,Kl=Object.getOwnPropertySymbols,CI=Object.prototype.hasOwnProperty,TI=Object.prototype.propertyIsEnumerable,Vl=(a,t,r)=>t in a?OI(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,fo=(a,t)=>{for(var r in t||(t={}))CI.call(t,r)&&Vl(a,r,t[r]);if(Kl)for(var r of Kl(t))TI.call(t,r)&&Vl(a,r,t[r]);return a},yc=(a,t)=>RI(a,AI(t));class Mc{constructor(t){this.events=new Cc,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=t,this.logger=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Ne.pino(Ne.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||zl})),this.disableProviderPing=(t==null?void 0:t.disableProviderPing)||!1}static async init(t){const r=new Mc(t);return await r.initialize(),r}async request(t,r){const[n,o]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(n).request({request:fo({},t),chainId:`${n}:${o}`,topic:this.session.topic})}sendAsync(t,r,n){const o=new Date().getTime();this.request(t,n).then(h=>r(null,So(o,h))).catch(h=>r(h,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:Qt("USER_DISCONNECTED")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),await this.cleanupPendingPairings(),!t.skipPairing)return await this.pair(t.pairingTopic)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}removeListener(t,r){this.events.removeListener(t,r)}off(t,r){this.events.off(t,r)}get isWalletConnect(){return!0}async pair(t){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:n,approval:o}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});n&&(this.uri=n,this.events.emit("display_uri",n)),await o().then(h=>{this.session=h,this.namespaces||(this.namespaces=mI(h.namespaces),this.persist("namespaces",this.namespaces))}).catch(h=>{if(h.message!==Qf)throw h;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(t,r){try{if(!this.session)return;const[n,o]=this.validateChain(t);this.getProvider(n).setDefaultChain(o,r)}catch(n){if(!/Please call connect/.test(n.message))throw n}}async cleanupPendingPairings(t={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(bn(r)){for(const n of r)t.deletePairings?this.client.core.expirer.set(n.topic,0):await this.client.core.relayer.subscriber.unsubscribe(n.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await tI.init({logger:this.providerOpts.logger||zl,relayUrl:this.providerOpts.relayUrl||sI,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const t=[...new Set(Object.keys(this.session.namespaces).map(r=>Jn(r)))];gc("client",this.client),gc("events",this.events),gc("disableProviderPing",this.disableProviderPing),t.forEach(r=>{if(!this.session)return;const n=gI(r,this.session),o=Xf(n),h=yI(this.namespaces,this.optionalNamespaces),d=yc(fo({},h[r]),{accounts:n,chains:o});switch(r){case"eip155":this.rpcProviders[r]=new wI({namespace:d});break;case"solana":this.rpcProviders[r]=new bI({namespace:d});break;case"cosmos":this.rpcProviders[r]=new EI({namespace:d});break;case"polkadot":this.rpcProviders[r]=new _I({namespace:d});break;case"cip34":this.rpcProviders[r]=new II({namespace:d});break;case"elrond":this.rpcProviders[r]=new xI({namespace:d});break;case"multiversx":this.rpcProviders[r]=new PI({namespace:d});break;case"near":this.rpcProviders[r]=new SI({namespace:d});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",t=>{this.events.emit("session_ping",t)}),this.client.on("session_event",t=>{const{params:r}=t,{event:n}=r;if(n.name==="accountsChanged"){const o=n.data;o&&bn(o)&&this.events.emit("accountsChanged",o.map(vI))}else if(n.name==="chainChanged"){const o=r.chainId,h=r.event.data,d=Jn(o),_=dc(o)!==dc(h)?`${d}:${dc(h)}`:o;this.onChainChanged(_)}else this.events.emit(n.name,n.data);this.events.emit("session_event",t)}),this.client.on("session_update",({topic:t,params:r})=>{var n;const{namespaces:o}=r,h=(n=this.client)==null?void 0:n.session.get(t);this.session=yc(fo({},h),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:r})}),this.client.on("session_delete",async t=>{await this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",yc(fo({},Qt("USER_DISCONNECTED")),{data:t.topic}))}),this.on(li.DEFAULT_CHAIN_CHANGED,t=>{this.onChainChanged(t,!0)})}getProvider(t){if(!this.rpcProviders[t])throw new Error(`Provider not found: ${t}`);return this.rpcProviders[t]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var r;this.getProvider(t).updateNamespace((r=this.session)==null?void 0:r.namespaces[t])})}setNamespaces(t){const{namespaces:r,optionalNamespaces:n,sessionProperties:o}=t;r&&Object.keys(r).length&&(this.namespaces=r),n&&Object.keys(n).length&&(this.optionalNamespaces=n),this.sessionProperties=o,this.persist("namespaces",r),this.persist("optionalNamespaces",n)}validateChain(t){const[r,n]=(t==null?void 0:t.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,n];if(r&&!Object.keys(this.namespaces||{}).map(d=>Jn(d)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&n)return[r,n];const o=Jn(Object.keys(this.namespaces)[0]),h=this.rpcProviders[o].getDefaultChain();return[o,h]}async requestAccounts(){const[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}onChainChanged(t,r=!1){var n;if(!this.namespaces)return;const[o,h]=this.validateChain(t);r||this.getProvider(o).setDefaultChain(h),((n=this.namespaces[o])!=null?n:this.namespaces[`${o}:${h}`]).defaultChain=h,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",h)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(t,r){this.client.core.storage.setItem(`${Ul}/${t}`,r)}async getFromStore(t){return await this.client.core.storage.getItem(`${Ul}/${t}`)}}const NI=Mc,LI="wc",DI="ethereum_provider",FI=`${LI}@2:${DI}:`,$I="https://rpc.walletconnect.com/v1/",Sc=["eth_sendTransaction","personal_sign"],jI=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],Oc=["chainChanged","accountsChanged"],MI=["chainChanged","accountsChanged","message","disconnect","connect"];var qI=Object.defineProperty,zI=Object.defineProperties,UI=Object.getOwnPropertyDescriptors,Gl=Object.getOwnPropertySymbols,HI=Object.prototype.hasOwnProperty,BI=Object.prototype.propertyIsEnumerable,Wl=(a,t,r)=>t in a?qI(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,Yn=(a,t)=>{for(var r in t||(t={}))HI.call(t,r)&&Wl(a,r,t[r]);if(Gl)for(var r of Gl(t))BI.call(t,r)&&Wl(a,r,t[r]);return a},Jl=(a,t)=>zI(a,UI(t));function bo(a){return Number(a[0].split(":")[1])}function vc(a){return`0x${a.toString(16)}`}function kI(a){const{chains:t,optionalChains:r,methods:n,optionalMethods:o,events:h,optionalEvents:d,rpcMap:_}=a;if(!bn(t))throw new Error("Invalid chains");const x={chains:t,methods:n||Sc,events:h||Oc,rpcMap:Yn({},t.length?{[bo(t)]:_[bo(t)]}:{})},b=h==null?void 0:h.filter(K=>!Oc.includes(K)),S=n==null?void 0:n.filter(K=>!Sc.includes(K));if(!r&&!d&&!o&&!(b!=null&&b.length)&&!(S!=null&&S.length))return{required:t.length?x:void 0};const D=(b==null?void 0:b.length)&&(S==null?void 0:S.length)||!r,M={chains:[...new Set(D?x.chains.concat(r||[]):r)],methods:[...new Set(x.methods.concat(o!=null&&o.length?o:jI))],events:[...new Set(x.events.concat(d!=null&&d.length?d:MI))],rpcMap:_};return{required:t.length?x:void 0,optional:r.length?M:void 0}}class qc{constructor(){this.events=new wr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=FI,this.on=(t,r)=>(this.events.on(t,r),this),this.once=(t,r)=>(this.events.once(t,r),this),this.removeListener=(t,r)=>(this.events.removeListener(t,r),this),this.off=(t,r)=>(this.events.off(t,r),this),this.parseAccount=t=>this.isCompatibleChainId(t)?this.parseAccountId(t).address:t,this.signer={},this.rpc={}}static async init(t){const r=new qc;return await r.initialize(t),r}async request(t){return await this.signer.request(t,this.formatChainId(this.chainId))}sendAsync(t,r){this.signer.sendAsync(t,r,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(t);const{required:r,optional:n}=kI(this.rpc);try{const o=await new Promise(async(d,_)=>{var x;this.rpc.showQrModal&&((x=this.modal)==null||x.subscribeModal(b=>{!b.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),_(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(Jl(Yn({namespaces:Yn({},r&&{[this.namespace]:r})},n&&{optionalNamespaces:{[this.namespace]:n}}),{pairingTopic:t==null?void 0:t.pairingTopic})).then(b=>{d(b)}).catch(b=>{_(new Error(b.message))})});if(!o)return;const h=v_(o.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:h),this.setAccounts(h),this.events.emit("connect",{chainId:vc(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",t=>{const{params:r}=t,{event:n}=r;n.name==="accountsChanged"?(this.accounts=this.parseAccounts(n.data),this.events.emit("accountsChanged",this.accounts)):n.name==="chainChanged"?this.setChainId(this.formatChainId(n.data)):this.events.emit(n.name,n.data),this.events.emit("session_event",t)}),this.signer.on("chainChanged",t=>{const r=parseInt(t);this.chainId=r,this.events.emit("chainChanged",vc(this.chainId)),this.persist()}),this.signer.on("session_update",t=>{this.events.emit("session_update",t)}),this.signer.on("session_delete",t=>{this.reset(),this.events.emit("session_delete",t),this.events.emit("disconnect",Jl(Yn({},Qt("USER_DISCONNECTED")),{data:t.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",t=>{var r,n;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(n=this.modal)==null||n.openModal({uri:t})),this.events.emit("display_uri",t)})}switchEthereumChain(t){this.request({method:"wallet_switchEthereumChain",params:[{chainId:t.toString(16)}]})}isCompatibleChainId(t){return typeof t=="string"?t.startsWith(`${this.namespace}:`):!1}formatChainId(t){return`${this.namespace}:${t}`}parseChainId(t){return Number(t.split(":")[1])}setChainIds(t){const r=t.filter(n=>this.isCompatibleChainId(n)).map(n=>this.parseChainId(n));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",vc(this.chainId)),this.persist())}setChainId(t){if(this.isCompatibleChainId(t)){const r=this.parseChainId(t);this.chainId=r,this.switchEthereumChain(r)}}parseAccountId(t){const[r,n,o]=t.split(":");return{chainId:`${r}:${n}`,address:o}}setAccounts(t){this.accounts=t.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(t){var r,n;const o=(r=t==null?void 0:t.chains)!=null?r:[],h=(n=t==null?void 0:t.optionalChains)!=null?n:[],d=o.concat(h);if(!d.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const _=o.length?(t==null?void 0:t.methods)||Sc:[],x=o.length?(t==null?void 0:t.events)||Oc:[],b=(t==null?void 0:t.optionalMethods)||[],S=(t==null?void 0:t.optionalEvents)||[],D=(t==null?void 0:t.rpcMap)||this.buildRpcMap(d,t.projectId),M=(t==null?void 0:t.qrModalOptions)||void 0;return{chains:o==null?void 0:o.map(K=>this.formatChainId(K)),optionalChains:h.map(K=>this.formatChainId(K)),methods:_,events:x,optionalMethods:b,optionalEvents:S,rpcMap:D,showQrModal:!!(t!=null&&t.showQrModal),qrModalOptions:M,projectId:t.projectId,metadata:t.metadata}}buildRpcMap(t,r){const n={};return t.forEach(o=>{n[o]=this.getRpcUrl(o,r)}),n}async initialize(t){if(this.rpc=this.getRpcConfig(t),this.chainId=this.rpc.chains.length?bo(this.rpc.chains):bo(this.rpc.optionalChains),this.signer=await NI.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:t.disableProviderPing,relayUrl:t.relayUrl,storageOptions:t.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let r;try{const{WalletConnectModal:n}=await m_(()=>import("./index-05eff706.js").then(o=>o.i),["assets/index-05eff706.js","assets/index-5349c5c9.js","assets/index-8c31665f.css"]);r=n}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(r)try{this.modal=new r(Yn({projectId:this.rpc.projectId},this.rpc.qrModalOptions))}catch(n){throw this.signer.logger.error(n),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(t){if(!t)return;const{chains:r,optionalChains:n,rpcMap:o}=t;r&&bn(r)&&(this.rpc.chains=r.map(h=>this.formatChainId(h)),r.forEach(h=>{this.rpc.rpcMap[h]=(o==null?void 0:o[h])||this.getRpcUrl(h)})),n&&bn(n)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=n==null?void 0:n.map(h=>this.formatChainId(h)),n.forEach(h=>{this.rpc.rpcMap[h]=(o==null?void 0:o[h])||this.getRpcUrl(h)}))}getRpcUrl(t,r){var n;return((n=this.rpc.rpcMap)==null?void 0:n[t])||`${$I}?chainId=eip155:${t}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const t=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),r=this.session.namespaces[`${this.namespace}:${t}`]?this.session.namespaces[`${this.namespace}:${t}`]:this.session.namespaces[this.namespace];this.setChainIds(t?[this.formatChainId(t)]:r==null?void 0:r.accounts),this.setAccounts(r==null?void 0:r.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(t){return typeof t=="string"||t instanceof String?[this.parseAccount(t)]:t.map(r=>this.parseAccount(r))}}const ox=qc;export{ox as EthereumProvider,MI as OPTIONAL_EVENTS,jI as OPTIONAL_METHODS,Oc as REQUIRED_EVENTS,Sc as REQUIRED_METHODS,qc as default};
