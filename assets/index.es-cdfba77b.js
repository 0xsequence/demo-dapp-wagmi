import{i as w1,b as b1,a as _1,c as E1,d as I1,e as x1,f as S1,g as P1,h as O1,j as A1,k as Kc,s as R1,l as C1,m as T1,n as N1,o as $1,p as Vc,q as Lf,r as ce,x as Df,t as Mo,H as L1,u as Ff,v as D1,w as F1,y as j1,z as Rn,A as M1,B as jf,C as Br,_ as U1}from"./index-2d27a8d2.js";function Wc(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function Mf(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Wc(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function Nc(n,t){t||(t=n.reduce((a,u)=>a+u.length,0));const r=Mf(t);let s=0;for(const a of n)r.set(a,s),s+=a.length;return Wc(r)}const hl={...w1,...b1,..._1,...E1,...I1,...x1,...S1,...P1,...O1,...A1};function Uf(n,t,r,s){return{name:n,prefix:t,encoder:{name:n,prefix:t,encode:r},decoder:{decode:s}}}const ll=Uf("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),pc=Uf("ascii","a",n=>{let t="a";for(let r=0;r<n.length;r++)t+=String.fromCharCode(n[r]);return t},n=>{n=n.substring(1);const t=Mf(n.length);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}),qf={utf8:ll,"utf-8":ll,hex:hl.base16,latin1:pc,ascii:pc,binary:pc,...hl};function yr(n,t="utf8"){const r=qf[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Wc(globalThis.Buffer.from(n,"utf-8")):r.decoder.decode(`${r.prefix}${n}`)}function or(n,t="utf8"){const r=qf[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(n.buffer,n.byteOffset,n.byteLength).toString("utf8"):r.encoder.encode(n).substring(1)}var fl=globalThis&&globalThis.__spreadArray||function(n,t,r){if(r||arguments.length===2)for(var s=0,a=t.length,u;s<a;s++)(u||!(s in t))&&(u||(u=Array.prototype.slice.call(t,0,s)),u[s]=t[s]);return n.concat(u||Array.prototype.slice.call(t))},q1=function(){function n(t,r,s){this.name=t,this.version=r,this.os=s,this.type="browser"}return n}(),z1=function(){function n(t){this.version=t,this.type="node",this.name="node",this.os=process.platform}return n}(),k1=function(){function n(t,r,s,a){this.name=t,this.version=r,this.os=s,this.bot=a,this.type="bot-device"}return n}(),H1=function(){function n(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return n}(),B1=function(){function n(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return n}(),K1=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,V1=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,dl=3,W1=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",K1]],pl=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function G1(n){return n?gl(n):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new B1:typeof navigator<"u"?gl(navigator.userAgent):Y1()}function J1(n){return n!==""&&W1.reduce(function(t,r){var s=r[0],a=r[1];if(t)return t;var u=a.exec(n);return!!u&&[s,u]},!1)}function gl(n){var t=J1(n);if(!t)return null;var r=t[0],s=t[1];if(r==="searchbot")return new H1;var a=s[1]&&s[1].split(".").join("_").split("_").slice(0,3);a?a.length<dl&&(a=fl(fl([],a,!0),X1(dl-a.length),!0)):a=[];var u=a.join("."),f=Q1(n),g=V1.exec(n);return g&&g[1]?new k1(r,u,f,g[1]):new q1(r,u,f)}function Q1(n){for(var t=0,r=pl.length;t<r;t++){var s=pl[t],a=s[0],u=s[1],f=u.exec(n);if(f)return a}return null}function Y1(){var n=typeof process<"u"&&process.version;return n?new z1(process.version.slice(1)):null}function X1(n){for(var t=[],r=0;r<n;r++)t.push("0");return t}const Z1={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}};var Gc={exports:{}},Sn=typeof Reflect=="object"?Reflect:null,yl=Sn&&typeof Sn.apply=="function"?Sn.apply:function(t,r,s){return Function.prototype.apply.call(t,r,s)},Ao;Sn&&typeof Sn.ownKeys=="function"?Ao=Sn.ownKeys:Object.getOwnPropertySymbols?Ao=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Ao=function(t){return Object.getOwnPropertyNames(t)};function ew(n){console&&console.warn&&console.warn(n)}var zf=Number.isNaN||function(t){return t!==t};function He(){He.init.call(this)}Gc.exports=He;Gc.exports.once=nw;He.EventEmitter=He;He.prototype._events=void 0;He.prototype._eventsCount=0;He.prototype._maxListeners=void 0;var vl=10;function Uo(n){if(typeof n!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n)}Object.defineProperty(He,"defaultMaxListeners",{enumerable:!0,get:function(){return vl},set:function(n){if(typeof n!="number"||n<0||zf(n))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+n+".");vl=n}});He.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};He.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||zf(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function kf(n){return n._maxListeners===void 0?He.defaultMaxListeners:n._maxListeners}He.prototype.getMaxListeners=function(){return kf(this)};He.prototype.emit=function(t){for(var r=[],s=1;s<arguments.length;s++)r.push(arguments[s]);var a=t==="error",u=this._events;if(u!==void 0)a=a&&u.error===void 0;else if(!a)return!1;if(a){var f;if(r.length>0&&(f=r[0]),f instanceof Error)throw f;var g=new Error("Unhandled error."+(f?" ("+f.message+")":""));throw g.context=f,g}var b=u[t];if(b===void 0)return!1;if(typeof b=="function")yl(b,this,r);else for(var y=b.length,_=Wf(b,y),s=0;s<y;++s)yl(_[s],this,r);return!0};function Hf(n,t,r,s){var a,u,f;if(Uo(r),u=n._events,u===void 0?(u=n._events=Object.create(null),n._eventsCount=0):(u.newListener!==void 0&&(n.emit("newListener",t,r.listener?r.listener:r),u=n._events),f=u[t]),f===void 0)f=u[t]=r,++n._eventsCount;else if(typeof f=="function"?f=u[t]=s?[r,f]:[f,r]:s?f.unshift(r):f.push(r),a=kf(n),a>0&&f.length>a&&!f.warned){f.warned=!0;var g=new Error("Possible EventEmitter memory leak detected. "+f.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");g.name="MaxListenersExceededWarning",g.emitter=n,g.type=t,g.count=f.length,ew(g)}return n}He.prototype.addListener=function(t,r){return Hf(this,t,r,!1)};He.prototype.on=He.prototype.addListener;He.prototype.prependListener=function(t,r){return Hf(this,t,r,!0)};function tw(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Bf(n,t,r){var s={fired:!1,wrapFn:void 0,target:n,type:t,listener:r},a=tw.bind(s);return a.listener=r,s.wrapFn=a,a}He.prototype.once=function(t,r){return Uo(r),this.on(t,Bf(this,t,r)),this};He.prototype.prependOnceListener=function(t,r){return Uo(r),this.prependListener(t,Bf(this,t,r)),this};He.prototype.removeListener=function(t,r){var s,a,u,f,g;if(Uo(r),a=this._events,a===void 0)return this;if(s=a[t],s===void 0)return this;if(s===r||s.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete a[t],a.removeListener&&this.emit("removeListener",t,s.listener||r));else if(typeof s!="function"){for(u=-1,f=s.length-1;f>=0;f--)if(s[f]===r||s[f].listener===r){g=s[f].listener,u=f;break}if(u<0)return this;u===0?s.shift():rw(s,u),s.length===1&&(a[t]=s[0]),a.removeListener!==void 0&&this.emit("removeListener",t,g||r)}return this};He.prototype.off=He.prototype.removeListener;He.prototype.removeAllListeners=function(t){var r,s,a;if(s=this._events,s===void 0)return this;if(s.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):s[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete s[t]),this;if(arguments.length===0){var u=Object.keys(s),f;for(a=0;a<u.length;++a)f=u[a],f!=="removeListener"&&this.removeAllListeners(f);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=s[t],typeof r=="function")this.removeListener(t,r);else if(r!==void 0)for(a=r.length-1;a>=0;a--)this.removeListener(t,r[a]);return this};function Kf(n,t,r){var s=n._events;if(s===void 0)return[];var a=s[t];return a===void 0?[]:typeof a=="function"?r?[a.listener||a]:[a]:r?iw(a):Wf(a,a.length)}He.prototype.listeners=function(t){return Kf(this,t,!0)};He.prototype.rawListeners=function(t){return Kf(this,t,!1)};He.listenerCount=function(n,t){return typeof n.listenerCount=="function"?n.listenerCount(t):Vf.call(n,t)};He.prototype.listenerCount=Vf;function Vf(n){var t=this._events;if(t!==void 0){var r=t[n];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}He.prototype.eventNames=function(){return this._eventsCount>0?Ao(this._events):[]};function Wf(n,t){for(var r=new Array(t),s=0;s<t;++s)r[s]=n[s];return r}function rw(n,t){for(;t+1<n.length;t++)n[t]=n[t+1];n.pop()}function iw(n){for(var t=new Array(n.length),r=0;r<t.length;++r)t[r]=n[r].listener||n[r];return t}function nw(n,t){return new Promise(function(r,s){function a(f){n.removeListener(t,u),s(f)}function u(){typeof n.removeListener=="function"&&n.removeListener("error",a),r([].slice.call(arguments))}Gf(n,t,u,{once:!0}),t!=="error"&&sw(n,a,{once:!0})})}function sw(n,t,r){typeof n.on=="function"&&Gf(n,"error",t,r)}function Gf(n,t,r,s){if(typeof n.on=="function")s.once?n.once(t,r):n.on(t,r);else if(typeof n.addEventListener=="function")n.addEventListener(t,function a(u){s.once&&n.removeEventListener(t,a),r(u)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof n)}var xr=Gc.exports;const Jc=Kc(xr);var hs={};(function(n){const t=T1,r=N1,s=R1,a=C1,u=C=>C==null,f=Symbol("encodeFragmentIdentifier");function g(C){switch(C.arrayFormat){case"index":return D=>(q,U)=>{const x=q.length;return U===void 0||C.skipNull&&U===null||C.skipEmptyString&&U===""?q:U===null?[...q,[_(D,C),"[",x,"]"].join("")]:[...q,[_(D,C),"[",_(x,C),"]=",_(U,C)].join("")]};case"bracket":return D=>(q,U)=>U===void 0||C.skipNull&&U===null||C.skipEmptyString&&U===""?q:U===null?[...q,[_(D,C),"[]"].join("")]:[...q,[_(D,C),"[]=",_(U,C)].join("")];case"colon-list-separator":return D=>(q,U)=>U===void 0||C.skipNull&&U===null||C.skipEmptyString&&U===""?q:U===null?[...q,[_(D,C),":list="].join("")]:[...q,[_(D,C),":list=",_(U,C)].join("")];case"comma":case"separator":case"bracket-separator":{const D=C.arrayFormat==="bracket-separator"?"[]=":"=";return q=>(U,x)=>x===void 0||C.skipNull&&x===null||C.skipEmptyString&&x===""?U:(x=x===null?"":x,U.length===0?[[_(q,C),D,_(x,C)].join("")]:[[U,_(x,C)].join(C.arrayFormatSeparator)])}default:return D=>(q,U)=>U===void 0||C.skipNull&&U===null||C.skipEmptyString&&U===""?q:U===null?[...q,_(D,C)]:[...q,[_(D,C),"=",_(U,C)].join("")]}}function b(C){let D;switch(C.arrayFormat){case"index":return(q,U,x)=>{if(D=/\[(\d*)\]$/.exec(q),q=q.replace(/\[\d*\]$/,""),!D){x[q]=U;return}x[q]===void 0&&(x[q]={}),x[q][D[1]]=U};case"bracket":return(q,U,x)=>{if(D=/(\[\])$/.exec(q),q=q.replace(/\[\]$/,""),!D){x[q]=U;return}if(x[q]===void 0){x[q]=[U];return}x[q]=[].concat(x[q],U)};case"colon-list-separator":return(q,U,x)=>{if(D=/(:list)$/.exec(q),q=q.replace(/:list$/,""),!D){x[q]=U;return}if(x[q]===void 0){x[q]=[U];return}x[q]=[].concat(x[q],U)};case"comma":case"separator":return(q,U,x)=>{const j=typeof U=="string"&&U.includes(C.arrayFormatSeparator),k=typeof U=="string"&&!j&&P(U,C).includes(C.arrayFormatSeparator);U=k?P(U,C):U;const ue=j||k?U.split(C.arrayFormatSeparator).map(ae=>P(ae,C)):U===null?U:P(U,C);x[q]=ue};case"bracket-separator":return(q,U,x)=>{const j=/(\[\])$/.test(q);if(q=q.replace(/\[\]$/,""),!j){x[q]=U&&P(U,C);return}const k=U===null?[]:U.split(C.arrayFormatSeparator).map(ue=>P(ue,C));if(x[q]===void 0){x[q]=k;return}x[q]=[].concat(x[q],k)};default:return(q,U,x)=>{if(x[q]===void 0){x[q]=U;return}x[q]=[].concat(x[q],U)}}}function y(C){if(typeof C!="string"||C.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function _(C,D){return D.encode?D.strict?t(C):encodeURIComponent(C):C}function P(C,D){return D.decode?r(C):C}function N(C){return Array.isArray(C)?C.sort():typeof C=="object"?N(Object.keys(C)).sort((D,q)=>Number(D)-Number(q)).map(D=>C[D]):C}function H(C){const D=C.indexOf("#");return D!==-1&&(C=C.slice(0,D)),C}function $(C){let D="";const q=C.indexOf("#");return q!==-1&&(D=C.slice(q)),D}function Q(C){C=H(C);const D=C.indexOf("?");return D===-1?"":C.slice(D+1)}function se(C,D){return D.parseNumbers&&!Number.isNaN(Number(C))&&typeof C=="string"&&C.trim()!==""?C=Number(C):D.parseBooleans&&C!==null&&(C.toLowerCase()==="true"||C.toLowerCase()==="false")&&(C=C.toLowerCase()==="true"),C}function le(C,D){D=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},D),y(D.arrayFormatSeparator);const q=b(D),U=Object.create(null);if(typeof C!="string"||(C=C.trim().replace(/^[?#&]/,""),!C))return U;for(const x of C.split("&")){if(x==="")continue;let[j,k]=s(D.decode?x.replace(/\+/g," "):x,"=");k=k===void 0?null:["comma","separator","bracket-separator"].includes(D.arrayFormat)?k:P(k,D),q(P(j,D),k,U)}for(const x of Object.keys(U)){const j=U[x];if(typeof j=="object"&&j!==null)for(const k of Object.keys(j))j[k]=se(j[k],D);else U[x]=se(j,D)}return D.sort===!1?U:(D.sort===!0?Object.keys(U).sort():Object.keys(U).sort(D.sort)).reduce((x,j)=>{const k=U[j];return k&&typeof k=="object"&&!Array.isArray(k)?x[j]=N(k):x[j]=k,x},Object.create(null))}n.extract=Q,n.parse=le,n.stringify=(C,D)=>{if(!C)return"";D=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},D),y(D.arrayFormatSeparator);const q=k=>D.skipNull&&u(C[k])||D.skipEmptyString&&C[k]==="",U=g(D),x={};for(const k of Object.keys(C))q(k)||(x[k]=C[k]);const j=Object.keys(x);return D.sort!==!1&&j.sort(D.sort),j.map(k=>{const ue=C[k];return ue===void 0?"":ue===null?_(k,D):Array.isArray(ue)?ue.length===0&&D.arrayFormat==="bracket-separator"?_(k,D)+"[]":ue.reduce(U(k),[]).join("&"):_(k,D)+"="+_(ue,D)}).filter(k=>k.length>0).join("&")},n.parseUrl=(C,D)=>{D=Object.assign({decode:!0},D);const[q,U]=s(C,"#");return Object.assign({url:q.split("?")[0]||"",query:le(Q(C),D)},D&&D.parseFragmentIdentifier&&U?{fragmentIdentifier:P(U,D)}:{})},n.stringifyUrl=(C,D)=>{D=Object.assign({encode:!0,strict:!0,[f]:!0},D);const q=H(C.url).split("?")[0]||"",U=n.extract(C.url),x=n.parse(U,{sort:!1}),j=Object.assign(x,C.query);let k=n.stringify(j,D);k&&(k=`?${k}`);let ue=$(C.url);return C.fragmentIdentifier&&(ue=`#${D[f]?_(C.fragmentIdentifier,D):C.fragmentIdentifier}`),`${q}${k}${ue}`},n.pick=(C,D,q)=>{q=Object.assign({parseFragmentIdentifier:!0,[f]:!1},q);const{url:U,query:x,fragmentIdentifier:j}=n.parseUrl(C,q);return n.stringifyUrl({url:U,query:a(x,D),fragmentIdentifier:j},q)},n.exclude=(C,D,q)=>{const U=Array.isArray(D)?x=>!D.includes(x):(x,j)=>!D(x,j);return n.pick(C,U,q)}})(hs);const ow=":";function aw(n){const[t,r]=n.split(ow);return{namespace:t,reference:r}}function cw(n,t=[]){const r=[];return Object.keys(n).forEach(s=>{if(t.length&&!t.includes(s))return;const a=n[s];r.push(...a.accounts)}),r}function Jf(n,t){return n.includes(":")?[n]:t.chains||[]}const Qf="base10",sr="base16",$c="base64pad",Qc="utf8",Yf=0,Xi=1,uw=0,ml=1,Lc=12,Yc=32;function hw(){const n=Df.generateKeyPair();return{privateKey:or(n.secretKey,sr),publicKey:or(n.publicKey,sr)}}function Dc(){const n=Mo.randomBytes(Yc);return or(n,sr)}function lw(n,t){const r=Df.sharedKey(yr(n,sr),yr(t,sr),!0),s=new L1(Vc.SHA256,r).expand(Yc);return or(s,sr)}function fw(n){const t=Vc.hash(yr(n,sr));return or(t,sr)}function Pn(n){const t=Vc.hash(yr(n,Qc));return or(t,sr)}function dw(n){return yr(`${n}`,Qf)}function fs(n){return Number(or(n,Qf))}function pw(n){const t=dw(typeof n.type<"u"?n.type:Yf);if(fs(t)===Xi&&typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof n.senderPublicKey<"u"?yr(n.senderPublicKey,sr):void 0,s=typeof n.iv<"u"?yr(n.iv,sr):Mo.randomBytes(Lc),a=new Ff.ChaCha20Poly1305(yr(n.symKey,sr)).seal(s,yr(n.message,Qc));return yw({type:t,sealed:a,iv:s,senderPublicKey:r})}function gw(n){const t=new Ff.ChaCha20Poly1305(yr(n.symKey,sr)),{sealed:r,iv:s}=$o(n.encoded),a=t.open(s,r);if(a===null)throw new Error("Failed to decrypt");return or(a,Qc)}function yw(n){if(fs(n.type)===Xi){if(typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return or(Nc([n.type,n.senderPublicKey,n.iv,n.sealed]),$c)}return or(Nc([n.type,n.iv,n.sealed]),$c)}function $o(n){const t=yr(n,$c),r=t.slice(uw,ml),s=ml;if(fs(r)===Xi){const g=s+Yc,b=g+Lc,y=t.slice(s,g),_=t.slice(g,b),P=t.slice(b);return{type:r,sealed:P,iv:_,senderPublicKey:y}}const a=s+Lc,u=t.slice(s,a),f=t.slice(a);return{type:r,sealed:f,iv:u}}function vw(n,t){const r=$o(n);return Xf({type:fs(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?or(r.senderPublicKey,sr):void 0,receiverPublicKey:t==null?void 0:t.receiverPublicKey})}function Xf(n){const t=(n==null?void 0:n.type)||Yf;if(t===Xi){if(typeof(n==null?void 0:n.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(n==null?void 0:n.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:n==null?void 0:n.senderPublicKey,receiverPublicKey:n==null?void 0:n.receiverPublicKey}}function wl(n){return n.type===Xi&&typeof n.senderPublicKey=="string"&&typeof n.receiverPublicKey=="string"}var mw=Object.defineProperty,bl=Object.getOwnPropertySymbols,ww=Object.prototype.hasOwnProperty,bw=Object.prototype.propertyIsEnumerable,_l=(n,t,r)=>t in n?mw(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,El=(n,t)=>{for(var r in t||(t={}))ww.call(t,r)&&_l(n,r,t[r]);if(bl)for(var r of bl(t))bw.call(t,r)&&_l(n,r,t[r]);return n};const _w="ReactNative",Ir={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},Ew="js";function Xc(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Cn(){return!D1()&&!!Lf()&&navigator.product===_w}function Tn(){return!Xc()&&!!Lf()}function ds(){return Cn()?Ir.reactNative:Xc()?Ir.node:Tn()?Ir.browser:Ir.unknown}function Iw(){var n;try{return Cn()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(n=global.Application)==null?void 0:n.applicationId:void 0}catch{return}}function xw(n,t){let r=hs.parse(n);return r=El(El({},r),t),n=hs.stringify(r),n}function Sw(){return $1()||{name:"",description:"",url:"",icons:[""]}}function Pw(){if(ds()===Ir.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:r,Version:s}=global.Platform;return[r,s].join("-")}const n=G1();if(n===null)return"unknown";const t=n.os?n.os.replace(" ","").toLowerCase():"unknown";return n.type==="browser"?[t,n.name,n.version].join("-"):[t,n.version].join("-")}function Ow(){var n;const t=ds();return t===Ir.browser?[t,((n=F1())==null?void 0:n.host)||"unknown"].join(":"):t}function Aw(n,t,r){const s=Pw(),a=Ow();return[[n,t].join("-"),[Ew,r].join("-"),s,a].join("/")}function Rw({protocol:n,version:t,relayUrl:r,sdkVersion:s,auth:a,projectId:u,useOnCloseEvent:f,bundleId:g}){const b=r.split("?"),y=Aw(n,t,s),_={auth:a,ua:y,projectId:u,useOnCloseEvent:f||void 0,origin:g||void 0},P=xw(b[1]||"",_);return b[0]+"?"+P}function Qi(n,t){return n.filter(r=>t.includes(r)).length===n.length}function Zf(n){return Object.fromEntries(n.entries())}function ed(n){return new Map(Object.entries(n))}function In(n=ce.FIVE_MINUTES,t){const r=ce.toMiliseconds(n||ce.FIVE_MINUTES);let s,a,u;return{resolve:f=>{u&&s&&(clearTimeout(u),s(f))},reject:f=>{u&&a&&(clearTimeout(u),a(f))},done:()=>new Promise((f,g)=>{u=setTimeout(()=>{g(new Error(t))},r),s=f,a=g})}}function ls(n,t,r){return new Promise(async(s,a)=>{const u=setTimeout(()=>a(new Error(r)),t);try{const f=await n;s(f)}catch(f){a(f)}clearTimeout(u)})}function td(n,t){if(typeof t=="string"&&t.startsWith(`${n}:`))return t;if(n.toLowerCase()==="topic"){if(typeof t!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}else if(n.toLowerCase()==="id"){if(typeof t!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${n}`)}function Cw(n){return td("topic",n)}function Tw(n){return td("id",n)}function rd(n){const[t,r]=n.split(":"),s={id:void 0,topic:void 0};if(t==="topic"&&typeof r=="string")s.topic=r;else if(t==="id"&&Number.isInteger(Number(r)))s.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);return s}function kr(n,t){return ce.fromMiliseconds((t||Date.now())+ce.toMiliseconds(n))}function Ci(n){return Date.now()>=ce.toMiliseconds(n)}function Dt(n,t){return`${n}${t?`:${t}`:""}`}function gc(n=[],t=[]){return[...new Set([...n,...t])]}async function Nw({id:n,topic:t,wcDeepLink:r}){try{if(!r)return;const s=typeof r=="string"?JSON.parse(r):r;let a=s==null?void 0:s.href;if(typeof a!="string")return;a.endsWith("/")&&(a=a.slice(0,-1));const u=`${a}/wc?requestId=${n}&sessionTopic=${t}`,f=ds();f===Ir.browser?u.startsWith("https://")?window.open(u,"_blank","noreferrer noopener"):window.open(u,"_self","noreferrer noopener"):f===Ir.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(u)}catch(s){console.error(s)}}async function $w(n,t){try{return await n.getItem(t)||(Tn()?localStorage.getItem(t):void 0)}catch(r){console.error(r)}}const Lw="irn";function Fc(n){return(n==null?void 0:n.relay)||{protocol:Lw}}function Ro(n){const t=Z1[n];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${n}`);return t}var Dw=Object.defineProperty,Il=Object.getOwnPropertySymbols,Fw=Object.prototype.hasOwnProperty,jw=Object.prototype.propertyIsEnumerable,xl=(n,t,r)=>t in n?Dw(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Mw=(n,t)=>{for(var r in t||(t={}))Fw.call(t,r)&&xl(n,r,t[r]);if(Il)for(var r of Il(t))jw.call(t,r)&&xl(n,r,t[r]);return n};function Uw(n,t="-"){const r={},s="relay"+t;return Object.keys(n).forEach(a=>{if(a.startsWith(s)){const u=a.replace(s,""),f=n[a];r[u]=f}}),r}function Sl(n){n=n.includes("wc://")?n.replace("wc://",""):n,n=n.includes("wc:")?n.replace("wc:",""):n;const t=n.indexOf(":"),r=n.indexOf("?")!==-1?n.indexOf("?"):void 0,s=n.substring(0,t),a=n.substring(t+1,r).split("@"),u=typeof r<"u"?n.substring(r):"",f=hs.parse(u);return{protocol:s,topic:qw(a[0]),version:parseInt(a[1],10),symKey:f.symKey,relay:Uw(f)}}function qw(n){return n.startsWith("//")?n.substring(2):n}function zw(n,t="-"){const r="relay",s={};return Object.keys(n).forEach(a=>{const u=r+t+a;n[a]&&(s[u]=n[a])}),s}function kw(n){return`${n.protocol}:${n.topic}@${n.version}?`+hs.stringify(Mw({symKey:n.symKey},zw(n.relay)))}function Nn(n){const t=[];return n.forEach(r=>{const[s,a]=r.split(":");t.push(`${s}:${a}`)}),t}function Hw(n){const t=[];return Object.values(n).forEach(r=>{t.push(...Nn(r.accounts))}),t}function Bw(n,t){const r=[];return Object.values(n).forEach(s=>{Nn(s.accounts).includes(t)&&r.push(...s.methods)}),r}function Kw(n,t){const r=[];return Object.values(n).forEach(s=>{Nn(s.accounts).includes(t)&&r.push(...s.events)}),r}function Vw(n,t){const r=Co(n,t);if(r)throw new Error(r.message);const s={};for(const[a,u]of Object.entries(n))s[a]={methods:u.methods,events:u.events,chains:u.accounts.map(f=>`${f.split(":")[0]}:${f.split(":")[1]}`)};return s}function Zc(n){return n.includes(":")}function os(n){return Zc(n)?n.split(":")[0]:n}const Ww={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Gw={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function Z(n,t){const{message:r,code:s}=Gw[n];return{message:t?`${r} ${t}`:r,code:s}}function xt(n,t){const{message:r,code:s}=Ww[n];return{message:t?`${r} ${t}`:r,code:s}}function Zr(n,t){return Array.isArray(n)?typeof t<"u"&&n.length?n.every(t):!0:!1}function On(n){return Object.getPrototypeOf(n)===Object.prototype&&Object.keys(n).length}function nr(n){return typeof n>"u"}function Ht(n,t){return t&&nr(n)?!0:typeof n=="string"&&!!n.trim().length}function eu(n,t){return t&&nr(n)?!0:typeof n=="number"&&!isNaN(n)}function Jw(n,t){const{requiredNamespaces:r}=t,s=Object.keys(n.namespaces),a=Object.keys(r);let u=!0;return Qi(a,s)?(s.forEach(f=>{const{accounts:g,methods:b,events:y}=n.namespaces[f],_=Nn(g),P=r[f];(!Qi(Jf(f,P),_)||!Qi(P.methods,b)||!Qi(P.events,y))&&(u=!1)}),u):!1}function Lo(n){return Ht(n,!1)&&n.includes(":")?n.split(":").length===2:!1}function Qw(n){if(Ht(n,!1)&&n.includes(":")){const t=n.split(":");if(t.length===3){const r=t[0]+":"+t[1];return!!t[2]&&Lo(r)}}return!1}function Yw(n){if(Ht(n,!1))try{return typeof new URL(n)<"u"}catch{return!1}return!1}function Xw(n){var t;return(t=n==null?void 0:n.proposer)==null?void 0:t.publicKey}function Zw(n){return n==null?void 0:n.topic}function eb(n,t){let r=null;return Ht(n==null?void 0:n.publicKey,!1)||(r=Z("MISSING_OR_INVALID",`${t} controller public key should be a string`)),r}function Pl(n){let t=!0;return Zr(n)?n.length&&(t=n.every(r=>Ht(r,!1))):t=!1,t}function tb(n,t,r){let s=null;return Zr(t)&&t.length?t.forEach(a=>{s||Lo(a)||(s=xt("UNSUPPORTED_CHAINS",`${r}, chain ${a} should be a string and conform to "namespace:chainId" format`))}):Lo(n)||(s=xt("UNSUPPORTED_CHAINS",`${r}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),s}function rb(n,t,r){let s=null;return Object.entries(n).forEach(([a,u])=>{if(s)return;const f=tb(a,Jf(a,u),`${t} ${r}`);f&&(s=f)}),s}function ib(n,t){let r=null;return Zr(n)?n.forEach(s=>{r||Qw(s)||(r=xt("UNSUPPORTED_ACCOUNTS",`${t}, account ${s} should be a string and conform to "namespace:chainId:address" format`))}):r=xt("UNSUPPORTED_ACCOUNTS",`${t}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function nb(n,t){let r=null;return Object.values(n).forEach(s=>{if(r)return;const a=ib(s==null?void 0:s.accounts,`${t} namespace`);a&&(r=a)}),r}function sb(n,t){let r=null;return Pl(n==null?void 0:n.methods)?Pl(n==null?void 0:n.events)||(r=xt("UNSUPPORTED_EVENTS",`${t}, events should be an array of strings or empty array for no events`)):r=xt("UNSUPPORTED_METHODS",`${t}, methods should be an array of strings or empty array for no methods`),r}function id(n,t){let r=null;return Object.values(n).forEach(s=>{if(r)return;const a=sb(s,`${t}, namespace`);a&&(r=a)}),r}function ob(n,t,r){let s=null;if(n&&On(n)){const a=id(n,t);a&&(s=a);const u=rb(n,t,r);u&&(s=u)}else s=Z("MISSING_OR_INVALID",`${t}, ${r} should be an object with data`);return s}function Co(n,t){let r=null;if(n&&On(n)){const s=id(n,t);s&&(r=s);const a=nb(n,t);a&&(r=a)}else r=Z("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return r}function nd(n){return Ht(n.protocol,!0)}function ab(n,t){let r=!1;return t&&!n?r=!0:n&&Zr(n)&&n.length&&n.forEach(s=>{r=nd(s)}),r}function cb(n){return typeof n=="number"}function gr(n){return typeof n<"u"&&typeof n!==null}function ub(n){return!(!n||typeof n!="object"||!n.code||!eu(n.code,!1)||!n.message||!Ht(n.message,!1))}function hb(n){return!(nr(n)||!Ht(n.method,!1))}function lb(n){return!(nr(n)||nr(n.result)&&nr(n.error)||!eu(n.id,!1)||!Ht(n.jsonrpc,!1))}function fb(n){return!(nr(n)||!Ht(n.name,!1))}function Ol(n,t){return!(!Lo(t)||!Hw(n).includes(t))}function db(n,t,r){return Ht(r,!1)?Bw(n,t).includes(r):!1}function pb(n,t,r){return Ht(r,!1)?Kw(n,t).includes(r):!1}function Al(n,t,r){let s=null;const a=gb(n),u=yb(t),f=Object.keys(a),g=Object.keys(u),b=Rl(Object.keys(n)),y=Rl(Object.keys(t)),_=b.filter(P=>!y.includes(P));return _.length&&(s=Z("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${_.toString()}
      Received: ${Object.keys(t).toString()}`)),Qi(f,g)||(s=Z("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${f.toString()}
      Approved: ${g.toString()}`)),Object.keys(t).forEach(P=>{if(!P.includes(":")||s)return;const N=Nn(t[P].accounts);N.includes(P)||(s=Z("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${P}
        Required: ${P}
        Approved: ${N.toString()}`))}),f.forEach(P=>{s||(Qi(a[P].methods,u[P].methods)?Qi(a[P].events,u[P].events)||(s=Z("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${P}`)):s=Z("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${P}`))}),s}function gb(n){const t={};return Object.keys(n).forEach(r=>{var s;r.includes(":")?t[r]=n[r]:(s=n[r].chains)==null||s.forEach(a=>{t[a]={methods:n[r].methods,events:n[r].events}})}),t}function Rl(n){return[...new Set(n.map(t=>t.includes(":")?t.split(":")[0]:t))]}function yb(n){const t={};return Object.keys(n).forEach(r=>{if(r.includes(":"))t[r]=n[r];else{const s=Nn(n[r].accounts);s==null||s.forEach(a=>{t[a]={accounts:n[r].accounts.filter(u=>u.includes(`${a}:`)),methods:n[r].methods,events:n[r].events}})}}),t}function vb(n,t){return eu(n,!1)&&n<=t.max&&n>=t.min}function Cl(){const n=ds();return new Promise(t=>{switch(n){case Ir.browser:t(mb());break;case Ir.reactNative:t(wb());break;case Ir.node:t(bb());break;default:t(!0)}})}function mb(){return Tn()&&(navigator==null?void 0:navigator.onLine)}async function wb(){if(Cn()&&typeof global<"u"&&global!=null&&global.NetInfo){const n=await(global==null?void 0:global.NetInfo.fetch());return n==null?void 0:n.isConnected}return!0}function bb(){return!0}function _b(n){switch(ds()){case Ir.browser:Eb(n);break;case Ir.reactNative:Ib(n);break}}function Eb(n){!Cn()&&Tn()&&(window.addEventListener("online",()=>n(!0)),window.addEventListener("offline",()=>n(!1)))}function Ib(n){Cn()&&typeof global<"u"&&global!=null&&global.NetInfo&&(global==null||global.NetInfo.addEventListener(t=>n(t==null?void 0:t.isConnected)))}const yc={};let Eo=class{static get(t){return yc[t]}static set(t,r){yc[t]=r}static delete(t){delete yc[t]}};const xb=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,Sb=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,Pb=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function Ob(n,t){if(n==="__proto__"||n==="constructor"&&t&&typeof t=="object"&&"prototype"in t){Ab(n);return}return t}function Ab(n){console.warn(`[destr] Dropping "${n}" key to prevent prototype pollution.`)}function Io(n,t={}){if(typeof n!="string")return n;const r=n.trim();if(n[0]==='"'&&n.at(-1)==='"'&&!n.includes("\\"))return r.slice(1,-1);if(r.length<=9){const s=r.toLowerCase();if(s==="true")return!0;if(s==="false")return!1;if(s==="undefined")return;if(s==="null")return null;if(s==="nan")return Number.NaN;if(s==="infinity")return Number.POSITIVE_INFINITY;if(s==="-infinity")return Number.NEGATIVE_INFINITY}if(!Pb.test(n)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return n}try{if(xb.test(n)||Sb.test(n)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(n,Ob)}return JSON.parse(n)}catch(s){if(t.strict)throw s;return n}}function Rb(n){return!n||typeof n.then!="function"?Promise.resolve(n):n}function kt(n,...t){try{return Rb(n(...t))}catch(r){return Promise.reject(r)}}function Cb(n){const t=typeof n;return n===null||t!=="object"&&t!=="function"}function Tb(n){const t=Object.getPrototypeOf(n);return!t||t.isPrototypeOf(Object)}function To(n){if(Cb(n))return String(n);if(Tb(n)||Array.isArray(n))return JSON.stringify(n);if(typeof n.toJSON=="function")return To(n.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function sd(){if(typeof Buffer===void 0)throw new TypeError("[unstorage] Buffer is not supported!")}const jc="base64:";function Nb(n){if(typeof n=="string")return n;sd();const t=Buffer.from(n).toString("base64");return jc+t}function $b(n){return typeof n!="string"||!n.startsWith(jc)?n:(sd(),Buffer.from(n.slice(jc.length),"base64"))}function pr(n){return n?n.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function Lb(...n){return pr(n.join(":"))}function xo(n){return n=pr(n),n?n+":":""}const Db="memory",Fb=()=>{const n=new Map;return{name:Db,options:{},hasItem(t){return n.has(t)},getItem(t){return n.get(t)??null},getItemRaw(t){return n.get(t)??null},setItem(t,r){n.set(t,r)},setItemRaw(t,r){n.set(t,r)},removeItem(t){n.delete(t)},getKeys(){return Array.from(n.keys())},clear(){n.clear()},dispose(){n.clear()}}};function jb(n={}){const t={mounts:{"":n.driver||Fb()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=y=>{for(const _ of t.mountpoints)if(y.startsWith(_))return{base:_,relativeKey:y.slice(_.length),driver:t.mounts[_]};return{base:"",relativeKey:y,driver:t.mounts[""]}},s=(y,_)=>t.mountpoints.filter(P=>P.startsWith(y)||_&&y.startsWith(P)).map(P=>({relativeBase:y.length>P.length?y.slice(P.length):void 0,mountpoint:P,driver:t.mounts[P]})),a=(y,_)=>{if(t.watching){_=pr(_);for(const P of t.watchListeners)P(y,_)}},u=async()=>{if(!t.watching){t.watching=!0;for(const y in t.mounts)t.unwatch[y]=await Tl(t.mounts[y],a,y)}},f=async()=>{if(t.watching){for(const y in t.unwatch)await t.unwatch[y]();t.unwatch={},t.watching=!1}},g=(y,_,P)=>{const N=new Map,H=$=>{let Q=N.get($.base);return Q||(Q={driver:$.driver,base:$.base,items:[]},N.set($.base,Q)),Q};for(const $ of y){const Q=typeof $=="string",se=pr(Q?$:$.key),le=Q?void 0:$.value,C=Q||!$.options?_:{..._,...$.options},D=r(se);H(D).items.push({key:se,value:le,relativeKey:D.relativeKey,options:C})}return Promise.all([...N.values()].map($=>P($))).then($=>$.flat())},b={hasItem(y,_={}){y=pr(y);const{relativeKey:P,driver:N}=r(y);return kt(N.hasItem,P,_)},getItem(y,_={}){y=pr(y);const{relativeKey:P,driver:N}=r(y);return kt(N.getItem,P,_).then(H=>Io(H))},getItems(y,_){return g(y,_,P=>P.driver.getItems?kt(P.driver.getItems,P.items.map(N=>({key:N.relativeKey,options:N.options})),_).then(N=>N.map(H=>({key:Lb(P.base,H.key),value:Io(H.value)}))):Promise.all(P.items.map(N=>kt(P.driver.getItem,N.relativeKey,N.options).then(H=>({key:N.key,value:Io(H)})))))},getItemRaw(y,_={}){y=pr(y);const{relativeKey:P,driver:N}=r(y);return N.getItemRaw?kt(N.getItemRaw,P,_):kt(N.getItem,P,_).then(H=>$b(H))},async setItem(y,_,P={}){if(_===void 0)return b.removeItem(y);y=pr(y);const{relativeKey:N,driver:H}=r(y);H.setItem&&(await kt(H.setItem,N,To(_),P),H.watch||a("update",y))},async setItems(y,_){await g(y,_,async P=>{P.driver.setItems&&await kt(P.driver.setItems,P.items.map(N=>({key:N.relativeKey,value:To(N.value),options:N.options})),_),P.driver.setItem&&await Promise.all(P.items.map(N=>kt(P.driver.setItem,N.relativeKey,To(N.value),N.options)))})},async setItemRaw(y,_,P={}){if(_===void 0)return b.removeItem(y,P);y=pr(y);const{relativeKey:N,driver:H}=r(y);if(H.setItemRaw)await kt(H.setItemRaw,N,_,P);else if(H.setItem)await kt(H.setItem,N,Nb(_),P);else return;H.watch||a("update",y)},async removeItem(y,_={}){typeof _=="boolean"&&(_={removeMeta:_}),y=pr(y);const{relativeKey:P,driver:N}=r(y);N.removeItem&&(await kt(N.removeItem,P,_),(_.removeMeta||_.removeMata)&&await kt(N.removeItem,P+"$",_),N.watch||a("remove",y))},async getMeta(y,_={}){typeof _=="boolean"&&(_={nativeOnly:_}),y=pr(y);const{relativeKey:P,driver:N}=r(y),H=Object.create(null);if(N.getMeta&&Object.assign(H,await kt(N.getMeta,P,_)),!_.nativeOnly){const $=await kt(N.getItem,P+"$",_).then(Q=>Io(Q));$&&typeof $=="object"&&(typeof $.atime=="string"&&($.atime=new Date($.atime)),typeof $.mtime=="string"&&($.mtime=new Date($.mtime)),Object.assign(H,$))}return H},setMeta(y,_,P={}){return this.setItem(y+"$",_,P)},removeMeta(y,_={}){return this.removeItem(y+"$",_)},async getKeys(y,_={}){y=xo(y);const P=s(y,!0);let N=[];const H=[];for(const $ of P){const se=(await kt($.driver.getKeys,$.relativeBase,_)).map(le=>$.mountpoint+pr(le)).filter(le=>!N.some(C=>le.startsWith(C)));H.push(...se),N=[$.mountpoint,...N.filter(le=>!le.startsWith($.mountpoint))]}return y?H.filter($=>$.startsWith(y)&&!$.endsWith("$")):H.filter($=>!$.endsWith("$"))},async clear(y,_={}){y=xo(y),await Promise.all(s(y,!1).map(async P=>{if(P.driver.clear)return kt(P.driver.clear,P.relativeBase,_);if(P.driver.removeItem){const N=await P.driver.getKeys(P.relativeBase||"",_);return Promise.all(N.map(H=>P.driver.removeItem(H,_)))}}))},async dispose(){await Promise.all(Object.values(t.mounts).map(y=>Nl(y)))},async watch(y){return await u(),t.watchListeners.push(y),async()=>{t.watchListeners=t.watchListeners.filter(_=>_!==y),t.watchListeners.length===0&&await f()}},async unwatch(){t.watchListeners=[],await f()},mount(y,_){if(y=xo(y),y&&t.mounts[y])throw new Error(`already mounted at ${y}`);return y&&(t.mountpoints.push(y),t.mountpoints.sort((P,N)=>N.length-P.length)),t.mounts[y]=_,t.watching&&Promise.resolve(Tl(_,a,y)).then(P=>{t.unwatch[y]=P}).catch(console.error),b},async unmount(y,_=!0){y=xo(y),!(!y||!t.mounts[y])&&(t.watching&&y in t.unwatch&&(t.unwatch[y](),delete t.unwatch[y]),_&&await Nl(t.mounts[y]),t.mountpoints=t.mountpoints.filter(P=>P!==y),delete t.mounts[y])},getMount(y=""){y=pr(y)+":";const _=r(y);return{driver:_.driver,base:_.base}},getMounts(y="",_={}){return y=pr(y),s(y,_.parents).map(N=>({driver:N.driver,base:N.mountpoint}))}};return b}function Tl(n,t,r){return n.watch?n.watch((s,a)=>t(s,r+a)):()=>{}}async function Nl(n){typeof n.dispose=="function"&&await kt(n.dispose)}function Zi(n){return new Promise((t,r)=>{n.oncomplete=n.onsuccess=()=>t(n.result),n.onabort=n.onerror=()=>r(n.error)})}function od(n,t){const r=indexedDB.open(n);r.onupgradeneeded=()=>r.result.createObjectStore(t);const s=Zi(r);return(a,u)=>s.then(f=>u(f.transaction(t,a).objectStore(t)))}let vc;function ps(){return vc||(vc=od("keyval-store","keyval")),vc}function $l(n,t=ps()){return t("readonly",r=>Zi(r.get(n)))}function Mb(n,t,r=ps()){return r("readwrite",s=>(s.put(t,n),Zi(s.transaction)))}function Ub(n,t=ps()){return t("readwrite",r=>(r.delete(n),Zi(r.transaction)))}function qb(n=ps()){return n("readwrite",t=>(t.clear(),Zi(t.transaction)))}function zb(n,t){return n.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},Zi(n.transaction)}function kb(n=ps()){return n("readonly",t=>{if(t.getAllKeys)return Zi(t.getAllKeys());const r=[];return zb(t,s=>r.push(s.key)).then(()=>r)})}const Hb=n=>JSON.stringify(n,(t,r)=>typeof r=="bigint"?r.toString()+"n":r),Bb=n=>{const t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=n.replace(t,'$1"$2n"$3');return JSON.parse(r,(s,a)=>typeof a=="string"&&a.match(/^\d+n$/)?BigInt(a.substring(0,a.length-1)):a)};function gs(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return Bb(n)}catch{return n}}function Yi(n){return typeof n=="string"?n:Hb(n)||""}const Kb="idb-keyval";var Vb=(n={})=>{const t=n.base&&n.base.length>0?`${n.base}:`:"",r=a=>t+a;let s;return n.dbName&&n.storeName&&(s=od(n.dbName,n.storeName)),{name:Kb,options:n,async hasItem(a){return!(typeof await $l(r(a),s)>"u")},async getItem(a){return await $l(r(a),s)??null},setItem(a,u){return Mb(r(a),u,s)},removeItem(a){return Ub(r(a),s)},getKeys(){return kb(s)},clear(){return qb(s)}}};const Wb="WALLET_CONNECT_V2_INDEXED_DB",Gb="keyvaluestorage";let Jb=class{constructor(){this.indexedDb=jb({driver:Vb({dbName:Wb,storeName:Gb})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(t=>[t.key,t.value])}async getItem(t){const r=await this.indexedDb.getItem(t);if(r!==null)return r}async setItem(t,r){await this.indexedDb.setItem(t,Yi(r))}async removeItem(t){await this.indexedDb.removeItem(t)}};var mc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},No={exports:{}};(function(){let n;function t(){}n=t,n.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},n.prototype.setItem=function(r,s){this[r]=String(s)},n.prototype.removeItem=function(r){delete this[r]},n.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(s){r[s]=void 0,delete r[s]})},n.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},n.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof mc<"u"&&mc.localStorage?No.exports=mc.localStorage:typeof window<"u"&&window.localStorage?No.exports=window.localStorage:No.exports=new t})();function Qb(n){var t;return[n[0],gs((t=n[1])!=null?t:"")]}class Yb{constructor(){this.localStorage=No.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(Qb)}async getItem(t){const r=this.localStorage.getItem(t);if(r!==null)return gs(r)}async setItem(t,r){this.localStorage.setItem(t,Yi(r))}async removeItem(t){this.localStorage.removeItem(t)}}const Xb="wc_storage_version",Ll=1,Zb=async(n,t,r)=>{const s=Xb,a=await t.getItem(s);if(a&&a>=Ll){r(t);return}const u=await n.getKeys();if(!u.length){r(t);return}const f=[];for(;u.length;){const g=u.shift();if(!g)continue;const b=g.toLowerCase();if(b.includes("wc@")||b.includes("walletconnect")||b.includes("wc_")||b.includes("wallet_connect")){const y=await n.getItem(g);await t.setItem(g,y),f.push(g)}}await t.setItem(s,Ll),r(t),e_(n,f)},e_=async(n,t)=>{t.length&&t.forEach(async r=>{await n.removeItem(r)})};let t_=class{constructor(){this.initialized=!1,this.setInitialized=r=>{this.storage=r,this.initialized=!0};const t=new Yb;this.storage=t;try{const r=new Jb;Zb(t,r,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(t){return await this.initialize(),this.storage.getItem(t)}async setItem(t,r){return await this.initialize(),this.storage.setItem(t,r)}async removeItem(t){return await this.initialize(),this.storage.removeItem(t)}async initialize(){this.initialized||await new Promise(t=>{const r=setInterval(()=>{this.initialized&&(clearInterval(r),t())},20)})}};var $n={},Zn={},wc={},es={};let en=class{};const r_=Object.freeze(Object.defineProperty({__proto__:null,IEvents:en},Symbol.toStringTag,{value:"Module"})),i_=j1(r_);var Dl;function n_(){if(Dl)return es;Dl=1,Object.defineProperty(es,"__esModule",{value:!0}),es.IHeartBeat=void 0;const n=i_;class t extends n.IEvents{constructor(s){super()}}return es.IHeartBeat=t,es}var Fl;function ad(){return Fl||(Fl=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),Rn.__exportStar(n_(),n)}(wc)),wc}var bc={},Gi={},jl;function s_(){if(jl)return Gi;jl=1,Object.defineProperty(Gi,"__esModule",{value:!0}),Gi.HEARTBEAT_EVENTS=Gi.HEARTBEAT_INTERVAL=void 0;const n=ce;return Gi.HEARTBEAT_INTERVAL=n.FIVE_SECONDS,Gi.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Gi}var Ml;function cd(){return Ml||(Ml=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),Rn.__exportStar(s_(),n)}(bc)),bc}var Ul;function o_(){if(Ul)return Zn;Ul=1,Object.defineProperty(Zn,"__esModule",{value:!0}),Zn.HeartBeat=void 0;const n=Rn,t=xr,r=ce,s=ad(),a=cd();class u extends s.IHeartBeat{constructor(g){super(g),this.events=new t.EventEmitter,this.interval=a.HEARTBEAT_INTERVAL,this.interval=(g==null?void 0:g.interval)||a.HEARTBEAT_INTERVAL}static init(g){return n.__awaiter(this,void 0,void 0,function*(){const b=new u(g);return yield b.init(),b})}init(){return n.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(g,b){this.events.on(g,b)}once(g,b){this.events.once(g,b)}off(g,b){this.events.off(g,b)}removeListener(g,b){this.events.removeListener(g,b)}initialize(){return n.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(a.HEARTBEAT_EVENTS.pulse)}}return Zn.HeartBeat=u,Zn}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=Rn;t.__exportStar(o_(),n),t.__exportStar(ad(),n),t.__exportStar(cd(),n)})($n);var Ce={},_c,ql;function a_(){if(ql)return _c;ql=1;function n(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}_c=t;function t(r,s,a){var u=a&&a.stringify||n,f=1;if(typeof r=="object"&&r!==null){var g=s.length+f;if(g===1)return r;var b=new Array(g);b[0]=u(r);for(var y=1;y<g;y++)b[y]=u(s[y]);return b.join(" ")}if(typeof r!="string")return r;var _=s.length;if(_===0)return r;for(var P="",N=1-f,H=-1,$=r&&r.length||0,Q=0;Q<$;){if(r.charCodeAt(Q)===37&&Q+1<$){switch(H=H>-1?H:0,r.charCodeAt(Q+1)){case 100:case 102:if(N>=_||s[N]==null)break;H<Q&&(P+=r.slice(H,Q)),P+=Number(s[N]),H=Q+2,Q++;break;case 105:if(N>=_||s[N]==null)break;H<Q&&(P+=r.slice(H,Q)),P+=Math.floor(Number(s[N])),H=Q+2,Q++;break;case 79:case 111:case 106:if(N>=_||s[N]===void 0)break;H<Q&&(P+=r.slice(H,Q));var se=typeof s[N];if(se==="string"){P+="'"+s[N]+"'",H=Q+2,Q++;break}if(se==="function"){P+=s[N].name||"<anonymous>",H=Q+2,Q++;break}P+=u(s[N]),H=Q+2,Q++;break;case 115:if(N>=_)break;H<Q&&(P+=r.slice(H,Q)),P+=String(s[N]),H=Q+2,Q++;break;case 37:H<Q&&(P+=r.slice(H,Q)),P+="%",H=Q+2,Q++,N--;break}++N}++Q}return H===-1?r:(H<$&&(P+=r.slice(H)),P)}return _c}var Ec,zl;function c_(){if(zl)return Ec;zl=1;const n=a_();Ec=a;const t=U().console||{},r={mapHttpRequest:$,mapHttpResponse:$,wrapRequestSerializer:Q,wrapResponseSerializer:Q,wrapErrorSerializer:Q,req:$,res:$,err:N};function s(x,j){return Array.isArray(x)?x.filter(function(ue){return ue!=="!stdSerializers.err"}):x===!0?Object.keys(j):!1}function a(x){x=x||{},x.browser=x.browser||{};const j=x.browser.transmit;if(j&&typeof j.send!="function")throw Error("pino: transmit option must have a send function");const k=x.browser.write||t;x.browser.write&&(x.browser.asObject=!0);const ue=x.serializers||{},ae=s(x.browser.serialize,ue);let ge=x.browser.serialize;Array.isArray(x.browser.serialize)&&x.browser.serialize.indexOf("!stdSerializers.err")>-1&&(ge=!1);const Te=["error","fatal","warn","info","debug","trace"];typeof k=="function"&&(k.error=k.fatal=k.warn=k.info=k.debug=k.trace=k),x.enabled===!1&&(x.level="silent");const qe=x.level||"info",m=Object.create(k);m.log||(m.log=se),Object.defineProperty(m,"levelVal",{get:re}),Object.defineProperty(m,"level",{get:pe,set:Y});const S={transmit:j,serialize:ae,asObject:x.browser.asObject,levels:Te,timestamp:H(x)};m.levels=a.levels,m.level=qe,m.setMaxListeners=m.getMaxListeners=m.emit=m.addListener=m.on=m.prependListener=m.once=m.prependOnceListener=m.removeListener=m.removeAllListeners=m.listeners=m.listenerCount=m.eventNames=m.write=m.flush=se,m.serializers=ue,m._serialize=ae,m._stdErrSerialize=ge,m.child=W,j&&(m._logEvent=P());function re(){return this.level==="silent"?1/0:this.levels.values[this.level]}function pe(){return this._level}function Y(J){if(J!=="silent"&&!this.levels.values[J])throw Error("unknown level "+J);this._level=J,u(S,m,"error","log"),u(S,m,"fatal","error"),u(S,m,"warn","error"),u(S,m,"info","log"),u(S,m,"debug","log"),u(S,m,"trace","log")}function W(J,X){if(!J)throw new Error("missing bindings for child Pino");X=X||{},ae&&J.serializers&&(X.serializers=J.serializers);const Qe=X.serializers;if(ae&&Qe){var Be=Object.assign({},ue,Qe),Kr=x.browser.serialize===!0?Object.keys(Be):ae;delete J.serializers,b([J],Kr,Be,this._stdErrSerialize)}function Ie(St){this._childLevel=(St._childLevel|0)+1,this.error=y(St,J,"error"),this.fatal=y(St,J,"fatal"),this.warn=y(St,J,"warn"),this.info=y(St,J,"info"),this.debug=y(St,J,"debug"),this.trace=y(St,J,"trace"),Be&&(this.serializers=Be,this._serialize=Kr),j&&(this._logEvent=P([].concat(St._logEvent.bindings,J)))}return Ie.prototype=this,new Ie(this)}return m}a.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},a.stdSerializers=r,a.stdTimeFunctions=Object.assign({},{nullTime:le,epochTime:C,unixTime:D,isoTime:q});function u(x,j,k,ue){const ae=Object.getPrototypeOf(j);j[k]=j.levelVal>j.levels.values[k]?se:ae[k]?ae[k]:t[k]||t[ue]||se,f(x,j,k)}function f(x,j,k){!x.transmit&&j[k]===se||(j[k]=function(ue){return function(){const ge=x.timestamp(),Te=new Array(arguments.length),qe=Object.getPrototypeOf&&Object.getPrototypeOf(this)===t?t:this;for(var m=0;m<Te.length;m++)Te[m]=arguments[m];if(x.serialize&&!x.asObject&&b(Te,this._serialize,this.serializers,this._stdErrSerialize),x.asObject?ue.call(qe,g(this,k,Te,ge)):ue.apply(qe,Te),x.transmit){const S=x.transmit.level||j.level,re=a.levels.values[S],pe=a.levels.values[k];if(pe<re)return;_(this,{ts:ge,methodLevel:k,methodValue:pe,transmitLevel:S,transmitValue:a.levels.values[x.transmit.level||j.level],send:x.transmit.send,val:j.levelVal},Te)}}}(j[k]))}function g(x,j,k,ue){x._serialize&&b(k,x._serialize,x.serializers,x._stdErrSerialize);const ae=k.slice();let ge=ae[0];const Te={};ue&&(Te.time=ue),Te.level=a.levels.values[j];let qe=(x._childLevel|0)+1;if(qe<1&&(qe=1),ge!==null&&typeof ge=="object"){for(;qe--&&typeof ae[0]=="object";)Object.assign(Te,ae.shift());ge=ae.length?n(ae.shift(),ae):void 0}else typeof ge=="string"&&(ge=n(ae.shift(),ae));return ge!==void 0&&(Te.msg=ge),Te}function b(x,j,k,ue){for(const ae in x)if(ue&&x[ae]instanceof Error)x[ae]=a.stdSerializers.err(x[ae]);else if(typeof x[ae]=="object"&&!Array.isArray(x[ae]))for(const ge in x[ae])j&&j.indexOf(ge)>-1&&ge in k&&(x[ae][ge]=k[ge](x[ae][ge]))}function y(x,j,k){return function(){const ue=new Array(1+arguments.length);ue[0]=j;for(var ae=1;ae<ue.length;ae++)ue[ae]=arguments[ae-1];return x[k].apply(this,ue)}}function _(x,j,k){const ue=j.send,ae=j.ts,ge=j.methodLevel,Te=j.methodValue,qe=j.val,m=x._logEvent.bindings;b(k,x._serialize||Object.keys(x.serializers),x.serializers,x._stdErrSerialize===void 0?!0:x._stdErrSerialize),x._logEvent.ts=ae,x._logEvent.messages=k.filter(function(S){return m.indexOf(S)===-1}),x._logEvent.level.label=ge,x._logEvent.level.value=Te,ue(ge,x._logEvent,qe),x._logEvent=P(m)}function P(x){return{ts:0,messages:[],bindings:x||[],level:{label:"",value:0}}}function N(x){const j={type:x.constructor.name,msg:x.message,stack:x.stack};for(const k in x)j[k]===void 0&&(j[k]=x[k]);return j}function H(x){return typeof x.timestamp=="function"?x.timestamp:x.timestamp===!1?le:C}function $(){return{}}function Q(x){return x}function se(){}function le(){return!1}function C(){return Date.now()}function D(){return Math.round(Date.now()/1e3)}function q(){return new Date(Date.now()).toISOString()}function U(){function x(j){return typeof j<"u"&&j}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return x(self)||x(window)||x(this)||{}}}return Ec}var Ji={},kl;function ud(){return kl||(kl=1,Object.defineProperty(Ji,"__esModule",{value:!0}),Ji.PINO_CUSTOM_CONTEXT_KEY=Ji.PINO_LOGGER_DEFAULTS=void 0,Ji.PINO_LOGGER_DEFAULTS={level:"info"},Ji.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Ji}var ir={},Hl;function u_(){if(Hl)return ir;Hl=1,Object.defineProperty(ir,"__esModule",{value:!0}),ir.generateChildLogger=ir.formatChildLoggerContext=ir.getLoggerContext=ir.setBrowserLoggerContext=ir.getBrowserLoggerContext=ir.getDefaultLoggerOptions=void 0;const n=ud();function t(g){return Object.assign(Object.assign({},g),{level:(g==null?void 0:g.level)||n.PINO_LOGGER_DEFAULTS.level})}ir.getDefaultLoggerOptions=t;function r(g,b=n.PINO_CUSTOM_CONTEXT_KEY){return g[b]||""}ir.getBrowserLoggerContext=r;function s(g,b,y=n.PINO_CUSTOM_CONTEXT_KEY){return g[y]=b,g}ir.setBrowserLoggerContext=s;function a(g,b=n.PINO_CUSTOM_CONTEXT_KEY){let y="";return typeof g.bindings>"u"?y=r(g,b):y=g.bindings().context||"",y}ir.getLoggerContext=a;function u(g,b,y=n.PINO_CUSTOM_CONTEXT_KEY){const _=a(g,y);return _.trim()?`${_}/${b}`:b}ir.formatChildLoggerContext=u;function f(g,b,y=n.PINO_CUSTOM_CONTEXT_KEY){const _=u(g,b,y),P=g.child({context:_});return s(P,_,y)}return ir.generateChildLogger=f,ir}(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.pino=void 0;const t=Rn,r=t.__importDefault(c_());Object.defineProperty(n,"pino",{enumerable:!0,get:function(){return r.default}}),t.__exportStar(ud(),n),t.__exportStar(u_(),n)})(Ce);class h_ extends en{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}}let l_=class extends en{constructor(t,r){super(),this.core=t,this.logger=r,this.records=new Map}},f_=class{constructor(t,r){this.logger=t,this.core=r}},d_=class extends en{constructor(t,r){super(),this.relayer=t,this.logger=r}},p_=class extends en{constructor(t){super()}},g_=class{constructor(t,r,s,a){this.core=t,this.logger=r,this.name=s}};class y_ extends en{constructor(t,r){super(),this.relayer=t,this.logger=r}}let v_=class extends en{constructor(t,r){super(),this.core=t,this.logger=r}},m_=class{constructor(t,r){this.projectId=t,this.logger=r}},w_=class{constructor(t){this.opts=t,this.protocol="wc",this.version=2}},b_=class{constructor(t){this.client=t}};var tu={},hd={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=M1,r=jf;n.DIGEST_LENGTH=64,n.BLOCK_SIZE=128;var s=function(){function g(){this.digestLength=n.DIGEST_LENGTH,this.blockSize=n.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return g.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},g.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},g.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},g.prototype.update=function(b,y){if(y===void 0&&(y=b.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var _=0;if(this._bytesHashed+=y,this._bufferLength>0){for(;this._bufferLength<n.BLOCK_SIZE&&y>0;)this._buffer[this._bufferLength++]=b[_++],y--;this._bufferLength===this.blockSize&&(u(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(y>=this.blockSize&&(_=u(this._tempHi,this._tempLo,this._stateHi,this._stateLo,b,_,y),y%=this.blockSize);y>0;)this._buffer[this._bufferLength++]=b[_++],y--;return this},g.prototype.finish=function(b){if(!this._finished){var y=this._bytesHashed,_=this._bufferLength,P=y/536870912|0,N=y<<3,H=y%128<112?128:256;this._buffer[_]=128;for(var $=_+1;$<H-8;$++)this._buffer[$]=0;t.writeUint32BE(P,this._buffer,H-8),t.writeUint32BE(N,this._buffer,H-4),u(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,H),this._finished=!0}for(var $=0;$<this.digestLength/8;$++)t.writeUint32BE(this._stateHi[$],b,$*8),t.writeUint32BE(this._stateLo[$],b,$*8+4);return this},g.prototype.digest=function(){var b=new Uint8Array(this.digestLength);return this.finish(b),b},g.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},g.prototype.restoreState=function(b){return this._stateHi.set(b.stateHi),this._stateLo.set(b.stateLo),this._bufferLength=b.bufferLength,b.buffer&&this._buffer.set(b.buffer),this._bytesHashed=b.bytesHashed,this._finished=!1,this},g.prototype.cleanSavedState=function(b){r.wipe(b.stateHi),r.wipe(b.stateLo),b.buffer&&r.wipe(b.buffer),b.bufferLength=0,b.bytesHashed=0},g}();n.SHA512=s;var a=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function u(g,b,y,_,P,N,H){for(var $=y[0],Q=y[1],se=y[2],le=y[3],C=y[4],D=y[5],q=y[6],U=y[7],x=_[0],j=_[1],k=_[2],ue=_[3],ae=_[4],ge=_[5],Te=_[6],qe=_[7],m,S,re,pe,Y,W,J,X;H>=128;){for(var Qe=0;Qe<16;Qe++){var Be=8*Qe+N;g[Qe]=t.readUint32BE(P,Be),b[Qe]=t.readUint32BE(P,Be+4)}for(var Qe=0;Qe<80;Qe++){var Kr=$,Ie=Q,St=se,M=le,F=C,T=D,h=q,I=U,ne=x,ye=j,_e=k,Ne=ue,Le=ae,Pe=ge,Pt=Te,wt=qe;if(m=U,S=qe,Y=S&65535,W=S>>>16,J=m&65535,X=m>>>16,m=(C>>>14|ae<<32-14)^(C>>>18|ae<<32-18)^(ae>>>41-32|C<<32-(41-32)),S=(ae>>>14|C<<32-14)^(ae>>>18|C<<32-18)^(C>>>41-32|ae<<32-(41-32)),Y+=S&65535,W+=S>>>16,J+=m&65535,X+=m>>>16,m=C&D^~C&q,S=ae&ge^~ae&Te,Y+=S&65535,W+=S>>>16,J+=m&65535,X+=m>>>16,m=a[Qe*2],S=a[Qe*2+1],Y+=S&65535,W+=S>>>16,J+=m&65535,X+=m>>>16,m=g[Qe%16],S=b[Qe%16],Y+=S&65535,W+=S>>>16,J+=m&65535,X+=m>>>16,W+=Y>>>16,J+=W>>>16,X+=J>>>16,re=J&65535|X<<16,pe=Y&65535|W<<16,m=re,S=pe,Y=S&65535,W=S>>>16,J=m&65535,X=m>>>16,m=($>>>28|x<<32-28)^(x>>>34-32|$<<32-(34-32))^(x>>>39-32|$<<32-(39-32)),S=(x>>>28|$<<32-28)^($>>>34-32|x<<32-(34-32))^($>>>39-32|x<<32-(39-32)),Y+=S&65535,W+=S>>>16,J+=m&65535,X+=m>>>16,m=$&Q^$&se^Q&se,S=x&j^x&k^j&k,Y+=S&65535,W+=S>>>16,J+=m&65535,X+=m>>>16,W+=Y>>>16,J+=W>>>16,X+=J>>>16,I=J&65535|X<<16,wt=Y&65535|W<<16,m=M,S=Ne,Y=S&65535,W=S>>>16,J=m&65535,X=m>>>16,m=re,S=pe,Y+=S&65535,W+=S>>>16,J+=m&65535,X+=m>>>16,W+=Y>>>16,J+=W>>>16,X+=J>>>16,M=J&65535|X<<16,Ne=Y&65535|W<<16,Q=Kr,se=Ie,le=St,C=M,D=F,q=T,U=h,$=I,j=ne,k=ye,ue=_e,ae=Ne,ge=Le,Te=Pe,qe=Pt,x=wt,Qe%16===15)for(var Be=0;Be<16;Be++)m=g[Be],S=b[Be],Y=S&65535,W=S>>>16,J=m&65535,X=m>>>16,m=g[(Be+9)%16],S=b[(Be+9)%16],Y+=S&65535,W+=S>>>16,J+=m&65535,X+=m>>>16,re=g[(Be+1)%16],pe=b[(Be+1)%16],m=(re>>>1|pe<<32-1)^(re>>>8|pe<<32-8)^re>>>7,S=(pe>>>1|re<<32-1)^(pe>>>8|re<<32-8)^(pe>>>7|re<<32-7),Y+=S&65535,W+=S>>>16,J+=m&65535,X+=m>>>16,re=g[(Be+14)%16],pe=b[(Be+14)%16],m=(re>>>19|pe<<32-19)^(pe>>>61-32|re<<32-(61-32))^re>>>6,S=(pe>>>19|re<<32-19)^(re>>>61-32|pe<<32-(61-32))^(pe>>>6|re<<32-6),Y+=S&65535,W+=S>>>16,J+=m&65535,X+=m>>>16,W+=Y>>>16,J+=W>>>16,X+=J>>>16,g[Be]=J&65535|X<<16,b[Be]=Y&65535|W<<16}m=$,S=x,Y=S&65535,W=S>>>16,J=m&65535,X=m>>>16,m=y[0],S=_[0],Y+=S&65535,W+=S>>>16,J+=m&65535,X+=m>>>16,W+=Y>>>16,J+=W>>>16,X+=J>>>16,y[0]=$=J&65535|X<<16,_[0]=x=Y&65535|W<<16,m=Q,S=j,Y=S&65535,W=S>>>16,J=m&65535,X=m>>>16,m=y[1],S=_[1],Y+=S&65535,W+=S>>>16,J+=m&65535,X+=m>>>16,W+=Y>>>16,J+=W>>>16,X+=J>>>16,y[1]=Q=J&65535|X<<16,_[1]=j=Y&65535|W<<16,m=se,S=k,Y=S&65535,W=S>>>16,J=m&65535,X=m>>>16,m=y[2],S=_[2],Y+=S&65535,W+=S>>>16,J+=m&65535,X+=m>>>16,W+=Y>>>16,J+=W>>>16,X+=J>>>16,y[2]=se=J&65535|X<<16,_[2]=k=Y&65535|W<<16,m=le,S=ue,Y=S&65535,W=S>>>16,J=m&65535,X=m>>>16,m=y[3],S=_[3],Y+=S&65535,W+=S>>>16,J+=m&65535,X+=m>>>16,W+=Y>>>16,J+=W>>>16,X+=J>>>16,y[3]=le=J&65535|X<<16,_[3]=ue=Y&65535|W<<16,m=C,S=ae,Y=S&65535,W=S>>>16,J=m&65535,X=m>>>16,m=y[4],S=_[4],Y+=S&65535,W+=S>>>16,J+=m&65535,X+=m>>>16,W+=Y>>>16,J+=W>>>16,X+=J>>>16,y[4]=C=J&65535|X<<16,_[4]=ae=Y&65535|W<<16,m=D,S=ge,Y=S&65535,W=S>>>16,J=m&65535,X=m>>>16,m=y[5],S=_[5],Y+=S&65535,W+=S>>>16,J+=m&65535,X+=m>>>16,W+=Y>>>16,J+=W>>>16,X+=J>>>16,y[5]=D=J&65535|X<<16,_[5]=ge=Y&65535|W<<16,m=q,S=Te,Y=S&65535,W=S>>>16,J=m&65535,X=m>>>16,m=y[6],S=_[6],Y+=S&65535,W+=S>>>16,J+=m&65535,X+=m>>>16,W+=Y>>>16,J+=W>>>16,X+=J>>>16,y[6]=q=J&65535|X<<16,_[6]=Te=Y&65535|W<<16,m=U,S=qe,Y=S&65535,W=S>>>16,J=m&65535,X=m>>>16,m=y[7],S=_[7],Y+=S&65535,W+=S>>>16,J+=m&65535,X+=m>>>16,W+=Y>>>16,J+=W>>>16,X+=J>>>16,y[7]=U=J&65535|X<<16,_[7]=qe=Y&65535|W<<16,N+=128,H-=128}return N}function f(g){var b=new s;b.update(g);var y=b.digest();return b.clean(),y}n.hash=f})(hd);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.convertSecretKeyToX25519=n.convertPublicKeyToX25519=n.verify=n.sign=n.extractPublicKeyFromSecretKey=n.generateKeyPair=n.generateKeyPairFromSeed=n.SEED_LENGTH=n.SECRET_KEY_LENGTH=n.PUBLIC_KEY_LENGTH=n.SIGNATURE_LENGTH=void 0;const t=Mo,r=hd,s=jf;n.SIGNATURE_LENGTH=64,n.PUBLIC_KEY_LENGTH=32,n.SECRET_KEY_LENGTH=64,n.SEED_LENGTH=32;function a(M){const F=new Float64Array(16);if(M)for(let T=0;T<M.length;T++)F[T]=M[T];return F}const u=new Uint8Array(32);u[0]=9;const f=a(),g=a([1]),b=a([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),y=a([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),_=a([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),P=a([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),N=a([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function H(M,F){for(let T=0;T<16;T++)M[T]=F[T]|0}function $(M){let F=1;for(let T=0;T<16;T++){let h=M[T]+F+65535;F=Math.floor(h/65536),M[T]=h-F*65536}M[0]+=F-1+37*(F-1)}function Q(M,F,T){const h=~(T-1);for(let I=0;I<16;I++){const ne=h&(M[I]^F[I]);M[I]^=ne,F[I]^=ne}}function se(M,F){const T=a(),h=a();for(let I=0;I<16;I++)h[I]=F[I];$(h),$(h),$(h);for(let I=0;I<2;I++){T[0]=h[0]-65517;for(let ye=1;ye<15;ye++)T[ye]=h[ye]-65535-(T[ye-1]>>16&1),T[ye-1]&=65535;T[15]=h[15]-32767-(T[14]>>16&1);const ne=T[15]>>16&1;T[14]&=65535,Q(h,T,1-ne)}for(let I=0;I<16;I++)M[2*I]=h[I]&255,M[2*I+1]=h[I]>>8}function le(M,F){let T=0;for(let h=0;h<32;h++)T|=M[h]^F[h];return(1&T-1>>>8)-1}function C(M,F){const T=new Uint8Array(32),h=new Uint8Array(32);return se(T,M),se(h,F),le(T,h)}function D(M){const F=new Uint8Array(32);return se(F,M),F[0]&1}function q(M,F){for(let T=0;T<16;T++)M[T]=F[2*T]+(F[2*T+1]<<8);M[15]&=32767}function U(M,F,T){for(let h=0;h<16;h++)M[h]=F[h]+T[h]}function x(M,F,T){for(let h=0;h<16;h++)M[h]=F[h]-T[h]}function j(M,F,T){let h,I,ne=0,ye=0,_e=0,Ne=0,Le=0,Pe=0,Pt=0,wt=0,at=0,Fe=0,Xe=0,Ze=0,ct=0,ze=0,et=0,$e=0,Ke=0,lt=0,Me=0,Ot=0,Ft=0,Bt=0,Kt=0,Ut=0,Yt=0,ar=0,Vr=0,Xt=0,ei=0,wi=0,Li=0,ft=T[0],it=T[1],dt=T[2],pt=T[3],ut=T[4],nt=T[5],At=T[6],Rt=T[7],gt=T[8],Ct=T[9],yt=T[10],bt=T[11],vt=T[12],Ye=T[13],Tt=T[14],Nt=T[15];h=F[0],ne+=h*ft,ye+=h*it,_e+=h*dt,Ne+=h*pt,Le+=h*ut,Pe+=h*nt,Pt+=h*At,wt+=h*Rt,at+=h*gt,Fe+=h*Ct,Xe+=h*yt,Ze+=h*bt,ct+=h*vt,ze+=h*Ye,et+=h*Tt,$e+=h*Nt,h=F[1],ye+=h*ft,_e+=h*it,Ne+=h*dt,Le+=h*pt,Pe+=h*ut,Pt+=h*nt,wt+=h*At,at+=h*Rt,Fe+=h*gt,Xe+=h*Ct,Ze+=h*yt,ct+=h*bt,ze+=h*vt,et+=h*Ye,$e+=h*Tt,Ke+=h*Nt,h=F[2],_e+=h*ft,Ne+=h*it,Le+=h*dt,Pe+=h*pt,Pt+=h*ut,wt+=h*nt,at+=h*At,Fe+=h*Rt,Xe+=h*gt,Ze+=h*Ct,ct+=h*yt,ze+=h*bt,et+=h*vt,$e+=h*Ye,Ke+=h*Tt,lt+=h*Nt,h=F[3],Ne+=h*ft,Le+=h*it,Pe+=h*dt,Pt+=h*pt,wt+=h*ut,at+=h*nt,Fe+=h*At,Xe+=h*Rt,Ze+=h*gt,ct+=h*Ct,ze+=h*yt,et+=h*bt,$e+=h*vt,Ke+=h*Ye,lt+=h*Tt,Me+=h*Nt,h=F[4],Le+=h*ft,Pe+=h*it,Pt+=h*dt,wt+=h*pt,at+=h*ut,Fe+=h*nt,Xe+=h*At,Ze+=h*Rt,ct+=h*gt,ze+=h*Ct,et+=h*yt,$e+=h*bt,Ke+=h*vt,lt+=h*Ye,Me+=h*Tt,Ot+=h*Nt,h=F[5],Pe+=h*ft,Pt+=h*it,wt+=h*dt,at+=h*pt,Fe+=h*ut,Xe+=h*nt,Ze+=h*At,ct+=h*Rt,ze+=h*gt,et+=h*Ct,$e+=h*yt,Ke+=h*bt,lt+=h*vt,Me+=h*Ye,Ot+=h*Tt,Ft+=h*Nt,h=F[6],Pt+=h*ft,wt+=h*it,at+=h*dt,Fe+=h*pt,Xe+=h*ut,Ze+=h*nt,ct+=h*At,ze+=h*Rt,et+=h*gt,$e+=h*Ct,Ke+=h*yt,lt+=h*bt,Me+=h*vt,Ot+=h*Ye,Ft+=h*Tt,Bt+=h*Nt,h=F[7],wt+=h*ft,at+=h*it,Fe+=h*dt,Xe+=h*pt,Ze+=h*ut,ct+=h*nt,ze+=h*At,et+=h*Rt,$e+=h*gt,Ke+=h*Ct,lt+=h*yt,Me+=h*bt,Ot+=h*vt,Ft+=h*Ye,Bt+=h*Tt,Kt+=h*Nt,h=F[8],at+=h*ft,Fe+=h*it,Xe+=h*dt,Ze+=h*pt,ct+=h*ut,ze+=h*nt,et+=h*At,$e+=h*Rt,Ke+=h*gt,lt+=h*Ct,Me+=h*yt,Ot+=h*bt,Ft+=h*vt,Bt+=h*Ye,Kt+=h*Tt,Ut+=h*Nt,h=F[9],Fe+=h*ft,Xe+=h*it,Ze+=h*dt,ct+=h*pt,ze+=h*ut,et+=h*nt,$e+=h*At,Ke+=h*Rt,lt+=h*gt,Me+=h*Ct,Ot+=h*yt,Ft+=h*bt,Bt+=h*vt,Kt+=h*Ye,Ut+=h*Tt,Yt+=h*Nt,h=F[10],Xe+=h*ft,Ze+=h*it,ct+=h*dt,ze+=h*pt,et+=h*ut,$e+=h*nt,Ke+=h*At,lt+=h*Rt,Me+=h*gt,Ot+=h*Ct,Ft+=h*yt,Bt+=h*bt,Kt+=h*vt,Ut+=h*Ye,Yt+=h*Tt,ar+=h*Nt,h=F[11],Ze+=h*ft,ct+=h*it,ze+=h*dt,et+=h*pt,$e+=h*ut,Ke+=h*nt,lt+=h*At,Me+=h*Rt,Ot+=h*gt,Ft+=h*Ct,Bt+=h*yt,Kt+=h*bt,Ut+=h*vt,Yt+=h*Ye,ar+=h*Tt,Vr+=h*Nt,h=F[12],ct+=h*ft,ze+=h*it,et+=h*dt,$e+=h*pt,Ke+=h*ut,lt+=h*nt,Me+=h*At,Ot+=h*Rt,Ft+=h*gt,Bt+=h*Ct,Kt+=h*yt,Ut+=h*bt,Yt+=h*vt,ar+=h*Ye,Vr+=h*Tt,Xt+=h*Nt,h=F[13],ze+=h*ft,et+=h*it,$e+=h*dt,Ke+=h*pt,lt+=h*ut,Me+=h*nt,Ot+=h*At,Ft+=h*Rt,Bt+=h*gt,Kt+=h*Ct,Ut+=h*yt,Yt+=h*bt,ar+=h*vt,Vr+=h*Ye,Xt+=h*Tt,ei+=h*Nt,h=F[14],et+=h*ft,$e+=h*it,Ke+=h*dt,lt+=h*pt,Me+=h*ut,Ot+=h*nt,Ft+=h*At,Bt+=h*Rt,Kt+=h*gt,Ut+=h*Ct,Yt+=h*yt,ar+=h*bt,Vr+=h*vt,Xt+=h*Ye,ei+=h*Tt,wi+=h*Nt,h=F[15],$e+=h*ft,Ke+=h*it,lt+=h*dt,Me+=h*pt,Ot+=h*ut,Ft+=h*nt,Bt+=h*At,Kt+=h*Rt,Ut+=h*gt,Yt+=h*Ct,ar+=h*yt,Vr+=h*bt,Xt+=h*vt,ei+=h*Ye,wi+=h*Tt,Li+=h*Nt,ne+=38*Ke,ye+=38*lt,_e+=38*Me,Ne+=38*Ot,Le+=38*Ft,Pe+=38*Bt,Pt+=38*Kt,wt+=38*Ut,at+=38*Yt,Fe+=38*ar,Xe+=38*Vr,Ze+=38*Xt,ct+=38*ei,ze+=38*wi,et+=38*Li,I=1,h=ne+I+65535,I=Math.floor(h/65536),ne=h-I*65536,h=ye+I+65535,I=Math.floor(h/65536),ye=h-I*65536,h=_e+I+65535,I=Math.floor(h/65536),_e=h-I*65536,h=Ne+I+65535,I=Math.floor(h/65536),Ne=h-I*65536,h=Le+I+65535,I=Math.floor(h/65536),Le=h-I*65536,h=Pe+I+65535,I=Math.floor(h/65536),Pe=h-I*65536,h=Pt+I+65535,I=Math.floor(h/65536),Pt=h-I*65536,h=wt+I+65535,I=Math.floor(h/65536),wt=h-I*65536,h=at+I+65535,I=Math.floor(h/65536),at=h-I*65536,h=Fe+I+65535,I=Math.floor(h/65536),Fe=h-I*65536,h=Xe+I+65535,I=Math.floor(h/65536),Xe=h-I*65536,h=Ze+I+65535,I=Math.floor(h/65536),Ze=h-I*65536,h=ct+I+65535,I=Math.floor(h/65536),ct=h-I*65536,h=ze+I+65535,I=Math.floor(h/65536),ze=h-I*65536,h=et+I+65535,I=Math.floor(h/65536),et=h-I*65536,h=$e+I+65535,I=Math.floor(h/65536),$e=h-I*65536,ne+=I-1+37*(I-1),I=1,h=ne+I+65535,I=Math.floor(h/65536),ne=h-I*65536,h=ye+I+65535,I=Math.floor(h/65536),ye=h-I*65536,h=_e+I+65535,I=Math.floor(h/65536),_e=h-I*65536,h=Ne+I+65535,I=Math.floor(h/65536),Ne=h-I*65536,h=Le+I+65535,I=Math.floor(h/65536),Le=h-I*65536,h=Pe+I+65535,I=Math.floor(h/65536),Pe=h-I*65536,h=Pt+I+65535,I=Math.floor(h/65536),Pt=h-I*65536,h=wt+I+65535,I=Math.floor(h/65536),wt=h-I*65536,h=at+I+65535,I=Math.floor(h/65536),at=h-I*65536,h=Fe+I+65535,I=Math.floor(h/65536),Fe=h-I*65536,h=Xe+I+65535,I=Math.floor(h/65536),Xe=h-I*65536,h=Ze+I+65535,I=Math.floor(h/65536),Ze=h-I*65536,h=ct+I+65535,I=Math.floor(h/65536),ct=h-I*65536,h=ze+I+65535,I=Math.floor(h/65536),ze=h-I*65536,h=et+I+65535,I=Math.floor(h/65536),et=h-I*65536,h=$e+I+65535,I=Math.floor(h/65536),$e=h-I*65536,ne+=I-1+37*(I-1),M[0]=ne,M[1]=ye,M[2]=_e,M[3]=Ne,M[4]=Le,M[5]=Pe,M[6]=Pt,M[7]=wt,M[8]=at,M[9]=Fe,M[10]=Xe,M[11]=Ze,M[12]=ct,M[13]=ze,M[14]=et,M[15]=$e}function k(M,F){j(M,F,F)}function ue(M,F){const T=a();let h;for(h=0;h<16;h++)T[h]=F[h];for(h=253;h>=0;h--)k(T,T),h!==2&&h!==4&&j(T,T,F);for(h=0;h<16;h++)M[h]=T[h]}function ae(M,F){const T=a();let h;for(h=0;h<16;h++)T[h]=F[h];for(h=250;h>=0;h--)k(T,T),h!==1&&j(T,T,F);for(h=0;h<16;h++)M[h]=T[h]}function ge(M,F){const T=a(),h=a(),I=a(),ne=a(),ye=a(),_e=a(),Ne=a(),Le=a(),Pe=a();x(T,M[1],M[0]),x(Pe,F[1],F[0]),j(T,T,Pe),U(h,M[0],M[1]),U(Pe,F[0],F[1]),j(h,h,Pe),j(I,M[3],F[3]),j(I,I,y),j(ne,M[2],F[2]),U(ne,ne,ne),x(ye,h,T),x(_e,ne,I),U(Ne,ne,I),U(Le,h,T),j(M[0],ye,_e),j(M[1],Le,Ne),j(M[2],Ne,_e),j(M[3],ye,Le)}function Te(M,F,T){for(let h=0;h<4;h++)Q(M[h],F[h],T)}function qe(M,F){const T=a(),h=a(),I=a();ue(I,F[2]),j(T,F[0],I),j(h,F[1],I),se(M,h),M[31]^=D(T)<<7}function m(M,F,T){H(M[0],f),H(M[1],g),H(M[2],g),H(M[3],f);for(let h=255;h>=0;--h){const I=T[h/8|0]>>(h&7)&1;Te(M,F,I),ge(F,M),ge(M,M),Te(M,F,I)}}function S(M,F){const T=[a(),a(),a(),a()];H(T[0],_),H(T[1],P),H(T[2],g),j(T[3],_,P),m(M,T,F)}function re(M){if(M.length!==n.SEED_LENGTH)throw new Error(`ed25519: seed must be ${n.SEED_LENGTH} bytes`);const F=(0,r.hash)(M);F[0]&=248,F[31]&=127,F[31]|=64;const T=new Uint8Array(32),h=[a(),a(),a(),a()];S(h,F),qe(T,h);const I=new Uint8Array(64);return I.set(M),I.set(T,32),{publicKey:T,secretKey:I}}n.generateKeyPairFromSeed=re;function pe(M){const F=(0,t.randomBytes)(32,M),T=re(F);return(0,s.wipe)(F),T}n.generateKeyPair=pe;function Y(M){if(M.length!==n.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${n.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(M.subarray(32))}n.extractPublicKeyFromSecretKey=Y;const W=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function J(M,F){let T,h,I,ne;for(h=63;h>=32;--h){for(T=0,I=h-32,ne=h-12;I<ne;++I)F[I]+=T-16*F[h]*W[I-(h-32)],T=Math.floor((F[I]+128)/256),F[I]-=T*256;F[I]+=T,F[h]=0}for(T=0,I=0;I<32;I++)F[I]+=T-(F[31]>>4)*W[I],T=F[I]>>8,F[I]&=255;for(I=0;I<32;I++)F[I]-=T*W[I];for(h=0;h<32;h++)F[h+1]+=F[h]>>8,M[h]=F[h]&255}function X(M){const F=new Float64Array(64);for(let T=0;T<64;T++)F[T]=M[T];for(let T=0;T<64;T++)M[T]=0;J(M,F)}function Qe(M,F){const T=new Float64Array(64),h=[a(),a(),a(),a()],I=(0,r.hash)(M.subarray(0,32));I[0]&=248,I[31]&=127,I[31]|=64;const ne=new Uint8Array(64);ne.set(I.subarray(32),32);const ye=new r.SHA512;ye.update(ne.subarray(32)),ye.update(F);const _e=ye.digest();ye.clean(),X(_e),S(h,_e),qe(ne,h),ye.reset(),ye.update(ne.subarray(0,32)),ye.update(M.subarray(32)),ye.update(F);const Ne=ye.digest();X(Ne);for(let Le=0;Le<32;Le++)T[Le]=_e[Le];for(let Le=0;Le<32;Le++)for(let Pe=0;Pe<32;Pe++)T[Le+Pe]+=Ne[Le]*I[Pe];return J(ne.subarray(32),T),ne}n.sign=Qe;function Be(M,F){const T=a(),h=a(),I=a(),ne=a(),ye=a(),_e=a(),Ne=a();return H(M[2],g),q(M[1],F),k(I,M[1]),j(ne,I,b),x(I,I,M[2]),U(ne,M[2],ne),k(ye,ne),k(_e,ye),j(Ne,_e,ye),j(T,Ne,I),j(T,T,ne),ae(T,T),j(T,T,I),j(T,T,ne),j(T,T,ne),j(M[0],T,ne),k(h,M[0]),j(h,h,ne),C(h,I)&&j(M[0],M[0],N),k(h,M[0]),j(h,h,ne),C(h,I)?-1:(D(M[0])===F[31]>>7&&x(M[0],f,M[0]),j(M[3],M[0],M[1]),0)}function Kr(M,F,T){const h=new Uint8Array(32),I=[a(),a(),a(),a()],ne=[a(),a(),a(),a()];if(T.length!==n.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${n.SIGNATURE_LENGTH} bytes`);if(Be(ne,M))return!1;const ye=new r.SHA512;ye.update(T.subarray(0,32)),ye.update(M),ye.update(F);const _e=ye.digest();return X(_e),m(I,ne,_e),S(ne,T.subarray(32)),ge(I,ne),qe(h,I),!le(T,h)}n.verify=Kr;function Ie(M){let F=[a(),a(),a(),a()];if(Be(F,M))throw new Error("Ed25519: invalid public key");let T=a(),h=a(),I=F[1];U(T,g,I),x(h,g,I),ue(h,h),j(T,T,h);let ne=new Uint8Array(32);return se(ne,T),ne}n.convertPublicKeyToX25519=Ie;function St(M){const F=(0,r.hash)(M.subarray(0,32));F[0]&=248,F[31]&=127,F[31]|=64;const T=new Uint8Array(F.subarray(0,32));return(0,s.wipe)(F),T}n.convertSecretKeyToX25519=St})(tu);const __="EdDSA",E_="JWT",ld=".",fd="base64url",I_="utf8",x_="utf8",S_=":",P_="did",O_="key",Bl="base58btc",A_="z",R_="K36",C_=32;function Do(n){return or(yr(Yi(n),I_),fd)}function dd(n){const t=yr(R_,Bl),r=A_+or(Nc([t,n]),Bl);return[P_,O_,r].join(S_)}function T_(n){return or(n,fd)}function N_(n){return yr([Do(n.header),Do(n.payload)].join(ld),x_)}function $_(n){return[Do(n.header),Do(n.payload),T_(n.signature)].join(ld)}function Kl(n=Mo.randomBytes(C_)){return tu.generateKeyPairFromSeed(n)}async function L_(n,t,r,s,a=ce.fromMiliseconds(Date.now())){const u={alg:__,typ:E_},f=dd(s.publicKey),g=a+r,b={iss:f,sub:n,aud:t,iat:a,exp:g},y=N_({header:u,payload:b}),_=tu.sign(s.secretKey,y);return $_({header:u,payload:b,signature:_})}const D_="PARSE_ERROR",F_="INVALID_REQUEST",j_="METHOD_NOT_FOUND",M_="INVALID_PARAMS",pd="INTERNAL_ERROR",ru="SERVER_ERROR",U_=[-32700,-32600,-32601,-32602,-32603],us={[D_]:{code:-32700,message:"Parse error"},[F_]:{code:-32600,message:"Invalid Request"},[j_]:{code:-32601,message:"Method not found"},[M_]:{code:-32602,message:"Invalid params"},[pd]:{code:-32603,message:"Internal error"},[ru]:{code:-32e3,message:"Server error"}},gd=ru;function q_(n){return U_.includes(n)}function Vl(n){return Object.keys(us).includes(n)?us[n]:us[gd]}function z_(n){const t=Object.values(us).find(r=>r.code===n);return t||us[gd]}function yd(n,t,r){return n.message.includes("getaddrinfo ENOTFOUND")||n.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${t}`):n}var vd={},fi={},Wl;function k_(){if(Wl)return fi;Wl=1,Object.defineProperty(fi,"__esModule",{value:!0}),fi.isBrowserCryptoAvailable=fi.getSubtleCrypto=fi.getBrowerCrypto=void 0;function n(){return(Br===null||Br===void 0?void 0:Br.crypto)||(Br===null||Br===void 0?void 0:Br.msCrypto)||{}}fi.getBrowerCrypto=n;function t(){const s=n();return s.subtle||s.webkitSubtle}fi.getSubtleCrypto=t;function r(){return!!n()&&!!t()}return fi.isBrowserCryptoAvailable=r,fi}var di={},Gl;function H_(){if(Gl)return di;Gl=1,Object.defineProperty(di,"__esModule",{value:!0}),di.isBrowser=di.isNode=di.isReactNative=void 0;function n(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}di.isReactNative=n;function t(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}di.isNode=t;function r(){return!n()&&!t()}return di.isBrowser=r,di}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=Rn;t.__exportStar(k_(),n),t.__exportStar(H_(),n)})(vd);function iu(n=3){const t=Date.now()*Math.pow(10,n),r=Math.floor(Math.random()*Math.pow(10,n));return t+r}function md(n=6){return BigInt(iu(n))}function An(n,t,r){return{id:r||iu(),jsonrpc:"2.0",method:n,params:t}}function nu(n,t){return{id:n,jsonrpc:"2.0",result:t}}function qo(n,t,r){return{id:n,jsonrpc:"2.0",error:B_(t,r)}}function B_(n,t){return typeof n>"u"?Vl(pd):(typeof n=="string"&&(n=Object.assign(Object.assign({},Vl(ru)),{message:n})),typeof t<"u"&&(n.data=t),q_(n.code)&&(n=z_(n.code)),n)}class K_{}class V_ extends K_{constructor(){super()}}class W_ extends V_{constructor(t){super()}}const G_="^https?:",J_="^wss?:";function Q_(n){const t=n.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function wd(n,t){const r=Q_(n);return typeof r>"u"?!1:new RegExp(t).test(r)}function Jl(n){return wd(n,G_)}function Ql(n){return wd(n,J_)}function Y_(n){return new RegExp("wss?://localhost(:d{2,5})?").test(n)}function bd(n){return typeof n=="object"&&"id"in n&&"jsonrpc"in n&&n.jsonrpc==="2.0"}function su(n){return bd(n)&&"method"in n}function zo(n){return bd(n)&&(yi(n)||Hr(n))}function yi(n){return"result"in n}function Hr(n){return"error"in n}class vi extends W_{constructor(t){super(t),this.events=new xr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async request(t,r){return this.requestStrict(An(t.method,t.params||[],t.id||md().toString()),r)}async requestStrict(t,r){return new Promise(async(s,a)=>{if(!this.connection.connected)try{await this.open()}catch(u){a(u)}this.events.on(`${t.id}`,u=>{Hr(u)?a(u.error):s(u.result)});try{await this.connection.send(t,r)}catch(u){a(u)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),zo(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const X_=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),Z_=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",Yl=n=>n.split("?")[0],Xl=10,eE=X_();let tE=class{constructor(t){if(this.url=t,this.events=new xr.EventEmitter,this.registering=!1,!Ql(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),t()},this.socket.close()})}async send(t){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Yi(t))}catch(r){this.onError(t.id,r)}}register(t=this.url){if(!Ql(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,a)=>{this.events.once("register_error",u=>{this.resetMaxListeners(),a(u)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return a(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=t,this.registering=!0,new Promise((r,s)=>{const a=new URLSearchParams(t).get("origin"),u=vd.isReactNative()?{headers:{origin:a}}:{rejectUnauthorized:!Y_(t)},f=new eE(t,[],u);Z_()?f.onerror=g=>{const b=g;s(this.emitError(b.error))}:f.on("error",g=>{s(this.emitError(g))}),f.onopen=()=>{this.onOpen(f),r(f)}})}onOpen(t){t.onmessage=r=>this.onPayload(r),t.onclose=r=>this.onClose(r),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?gs(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const s=this.parseError(r),a=s.message||s.toString(),u=qo(t,a);this.events.emit("payload",u)}parseError(t,r=this.url){return yd(t,Yl(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Xl&&this.events.setMaxListeners(Xl)}emitError(t){const r=this.parseError(new Error((t==null?void 0:t.message)||`WebSocket connection failed for host: ${Yl(this.url)}`));return this.events.emit("register_error",r),r}};var Fo={exports:{}};Fo.exports;(function(n,t){var r=200,s="__lodash_hash_undefined__",a=1,u=2,f=9007199254740991,g="[object Arguments]",b="[object Array]",y="[object AsyncFunction]",_="[object Boolean]",P="[object Date]",N="[object Error]",H="[object Function]",$="[object GeneratorFunction]",Q="[object Map]",se="[object Number]",le="[object Null]",C="[object Object]",D="[object Promise]",q="[object Proxy]",U="[object RegExp]",x="[object Set]",j="[object String]",k="[object Symbol]",ue="[object Undefined]",ae="[object WeakMap]",ge="[object ArrayBuffer]",Te="[object DataView]",qe="[object Float32Array]",m="[object Float64Array]",S="[object Int8Array]",re="[object Int16Array]",pe="[object Int32Array]",Y="[object Uint8Array]",W="[object Uint8ClampedArray]",J="[object Uint16Array]",X="[object Uint32Array]",Qe=/[\\^$.*+?()[\]{}|]/g,Be=/^\[object .+?Constructor\]$/,Kr=/^(?:0|[1-9]\d*)$/,Ie={};Ie[qe]=Ie[m]=Ie[S]=Ie[re]=Ie[pe]=Ie[Y]=Ie[W]=Ie[J]=Ie[X]=!0,Ie[g]=Ie[b]=Ie[ge]=Ie[_]=Ie[Te]=Ie[P]=Ie[N]=Ie[H]=Ie[Q]=Ie[se]=Ie[C]=Ie[U]=Ie[x]=Ie[j]=Ie[ae]=!1;var St=typeof Br=="object"&&Br&&Br.Object===Object&&Br,M=typeof self=="object"&&self&&self.Object===Object&&self,F=St||M||Function("return this")(),T=t&&!t.nodeType&&t,h=T&&!0&&n&&!n.nodeType&&n,I=h&&h.exports===T,ne=I&&St.process,ye=function(){try{return ne&&ne.binding&&ne.binding("util")}catch{}}(),_e=ye&&ye.isTypedArray;function Ne(v,O){for(var V=-1,te=v==null?0:v.length,We=0,me=[];++V<te;){var tt=v[V];O(tt,V,v)&&(me[We++]=tt)}return me}function Le(v,O){for(var V=-1,te=O.length,We=v.length;++V<te;)v[We+V]=O[V];return v}function Pe(v,O){for(var V=-1,te=v==null?0:v.length;++V<te;)if(O(v[V],V,v))return!0;return!1}function Pt(v,O){for(var V=-1,te=Array(v);++V<v;)te[V]=O(V);return te}function wt(v){return function(O){return v(O)}}function at(v,O){return v.has(O)}function Fe(v,O){return v==null?void 0:v[O]}function Xe(v){var O=-1,V=Array(v.size);return v.forEach(function(te,We){V[++O]=[We,te]}),V}function Ze(v,O){return function(V){return v(O(V))}}function ct(v){var O=-1,V=Array(v.size);return v.forEach(function(te){V[++O]=te}),V}var ze=Array.prototype,et=Function.prototype,$e=Object.prototype,Ke=F["__core-js_shared__"],lt=et.toString,Me=$e.hasOwnProperty,Ot=function(){var v=/[^.]+$/.exec(Ke&&Ke.keys&&Ke.keys.IE_PROTO||"");return v?"Symbol(src)_1."+v:""}(),Ft=$e.toString,Bt=RegExp("^"+lt.call(Me).replace(Qe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Kt=I?F.Buffer:void 0,Ut=F.Symbol,Yt=F.Uint8Array,ar=$e.propertyIsEnumerable,Vr=ze.splice,Xt=Ut?Ut.toStringTag:void 0,ei=Object.getOwnPropertySymbols,wi=Kt?Kt.isBuffer:void 0,Li=Ze(Object.keys,Object),ft=vr(F,"DataView"),it=vr(F,"Map"),dt=vr(F,"Promise"),pt=vr(F,"Set"),ut=vr(F,"WeakMap"),nt=vr(Object,"create"),At=ri(ft),Rt=ri(it),gt=ri(dt),Ct=ri(pt),yt=ri(ut),bt=Ut?Ut.prototype:void 0,vt=bt?bt.valueOf:void 0;function Ye(v){var O=-1,V=v==null?0:v.length;for(this.clear();++O<V;){var te=v[O];this.set(te[0],te[1])}}function Tt(){this.__data__=nt?nt(null):{},this.size=0}function Nt(v){var O=this.has(v)&&delete this.__data__[v];return this.size-=O?1:0,O}function Bo(v){var O=this.__data__;if(nt){var V=O[v];return V===s?void 0:V}return Me.call(O,v)?O[v]:void 0}function Ko(v){var O=this.__data__;return nt?O[v]!==void 0:Me.call(O,v)}function Vo(v,O){var V=this.__data__;return this.size+=this.has(v)?0:1,V[v]=nt&&O===void 0?s:O,this}Ye.prototype.clear=Tt,Ye.prototype.delete=Nt,Ye.prototype.get=Bo,Ye.prototype.has=Ko,Ye.prototype.set=Vo;function Sr(v){var O=-1,V=v==null?0:v.length;for(this.clear();++O<V;){var te=v[O];this.set(te[0],te[1])}}function Wo(){this.__data__=[],this.size=0}function Go(v){var O=this.__data__,V=Di(O,v);if(V<0)return!1;var te=O.length-1;return V==te?O.pop():Vr.call(O,V,1),--this.size,!0}function Jo(v){var O=this.__data__,V=Di(O,v);return V<0?void 0:O[V][1]}function Qo(v){return Di(this.__data__,v)>-1}function Yo(v,O){var V=this.__data__,te=Di(V,v);return te<0?(++this.size,V.push([v,O])):V[te][1]=O,this}Sr.prototype.clear=Wo,Sr.prototype.delete=Go,Sr.prototype.get=Jo,Sr.prototype.has=Qo,Sr.prototype.set=Yo;function ti(v){var O=-1,V=v==null?0:v.length;for(this.clear();++O<V;){var te=v[O];this.set(te[0],te[1])}}function rn(){this.size=0,this.__data__={hash:new Ye,map:new(it||Sr),string:new Ye}}function Xo(v){var O=bi(this,v).delete(v);return this.size-=O?1:0,O}function nn(v){return bi(this,v).get(v)}function Zo(v){return bi(this,v).has(v)}function ea(v,O){var V=bi(this,v),te=V.size;return V.set(v,O),this.size+=V.size==te?0:1,this}ti.prototype.clear=rn,ti.prototype.delete=Xo,ti.prototype.get=nn,ti.prototype.has=Zo,ti.prototype.set=ea;function sn(v){var O=-1,V=v==null?0:v.length;for(this.__data__=new ti;++O<V;)this.add(v[O])}function vs(v){return this.__data__.set(v,s),this}function ms(v){return this.__data__.has(v)}sn.prototype.add=sn.prototype.push=vs,sn.prototype.has=ms;function Dr(v){var O=this.__data__=new Sr(v);this.size=O.size}function ta(){this.__data__=new Sr,this.size=0}function ra(v){var O=this.__data__,V=O.delete(v);return this.size=O.size,V}function ia(v){return this.__data__.get(v)}function na(v){return this.__data__.has(v)}function ws(v,O){var V=this.__data__;if(V instanceof Sr){var te=V.__data__;if(!it||te.length<r-1)return te.push([v,O]),this.size=++V.size,this;V=this.__data__=new ti(te)}return V.set(v,O),this.size=V.size,this}Dr.prototype.clear=ta,Dr.prototype.delete=ra,Dr.prototype.get=ia,Dr.prototype.has=na,Dr.prototype.set=ws;function bs(v,O){var V=cn(v),te=!V&&Ns(v),We=!V&&!te&&Fn(v),me=!V&&!te&&!We&&Ds(v),tt=V||te||We||me,$t=tt?Pt(v.length,String):[],Ae=$t.length;for(var Ge in v)(O||Me.call(v,Ge))&&!(tt&&(Ge=="length"||We&&(Ge=="offset"||Ge=="parent")||me&&(Ge=="buffer"||Ge=="byteLength"||Ge=="byteOffset")||Os(Ge,Ae)))&&$t.push(Ge);return $t}function Di(v,O){for(var V=v.length;V--;)if(Ts(v[V][0],O))return V;return-1}function Ln(v,O,V){var te=O(v);return cn(v)?te:Le(te,V(v))}function Fi(v){return v==null?v===void 0?ue:le:Xt&&Xt in Object(v)?Ss(v):aa(v)}function Dn(v){return Mi(v)&&Fi(v)==g}function ji(v,O,V,te,We){return v===O?!0:v==null||O==null||!Mi(v)&&!Mi(O)?v!==v&&O!==O:_s(v,O,V,te,ji,We)}function _s(v,O,V,te,We,me){var tt=cn(v),$t=cn(O),Ae=tt?b:Wr(v),Ge=$t?b:Wr(O);Ae=Ae==g?C:Ae,Ge=Ge==g?C:Ge;var _t=Ae==C,cr=Ge==C,Lt=Ae==Ge;if(Lt&&Fn(v)){if(!Fn(O))return!1;tt=!0,_t=!1}if(Lt&&!_t)return me||(me=new Dr),tt||Ds(v)?on(v,O,V,te,We,me):oa(v,O,Ae,V,te,We,me);if(!(V&a)){var rt=_t&&Me.call(v,"__wrapped__"),Zt=cr&&Me.call(O,"__wrapped__");if(rt||Zt){var Fr=rt?v.value():v,Pr=Zt?O.value():O;return me||(me=new Dr),We(Fr,Pr,V,te,me)}}return Lt?(me||(me=new Dr),xs(v,O,V,te,We,me)):!1}function sa(v){if(!Ls(v)||Rs(v))return!1;var O=un(v)?Bt:Be;return O.test(ri(v))}function Es(v){return Mi(v)&&$s(v.length)&&!!Ie[Fi(v)]}function Is(v){if(!Cs(v))return Li(v);var O=[];for(var V in Object(v))Me.call(v,V)&&V!="constructor"&&O.push(V);return O}function on(v,O,V,te,We,me){var tt=V&a,$t=v.length,Ae=O.length;if($t!=Ae&&!(tt&&Ae>$t))return!1;var Ge=me.get(v);if(Ge&&me.get(O))return Ge==O;var _t=-1,cr=!0,Lt=V&u?new sn:void 0;for(me.set(v,O),me.set(O,v);++_t<$t;){var rt=v[_t],Zt=O[_t];if(te)var Fr=tt?te(Zt,rt,_t,O,v,me):te(rt,Zt,_t,v,O,me);if(Fr!==void 0){if(Fr)continue;cr=!1;break}if(Lt){if(!Pe(O,function(Pr,Gr){if(!at(Lt,Gr)&&(rt===Pr||We(rt,Pr,V,te,me)))return Lt.push(Gr)})){cr=!1;break}}else if(!(rt===Zt||We(rt,Zt,V,te,me))){cr=!1;break}}return me.delete(v),me.delete(O),cr}function oa(v,O,V,te,We,me,tt){switch(V){case Te:if(v.byteLength!=O.byteLength||v.byteOffset!=O.byteOffset)return!1;v=v.buffer,O=O.buffer;case ge:return!(v.byteLength!=O.byteLength||!me(new Yt(v),new Yt(O)));case _:case P:case se:return Ts(+v,+O);case N:return v.name==O.name&&v.message==O.message;case U:case j:return v==O+"";case Q:var $t=Xe;case x:var Ae=te&a;if($t||($t=ct),v.size!=O.size&&!Ae)return!1;var Ge=tt.get(v);if(Ge)return Ge==O;te|=u,tt.set(v,O);var _t=on($t(v),$t(O),te,We,me,tt);return tt.delete(v),_t;case k:if(vt)return vt.call(v)==vt.call(O)}return!1}function xs(v,O,V,te,We,me){var tt=V&a,$t=an(v),Ae=$t.length,Ge=an(O),_t=Ge.length;if(Ae!=_t&&!tt)return!1;for(var cr=Ae;cr--;){var Lt=$t[cr];if(!(tt?Lt in O:Me.call(O,Lt)))return!1}var rt=me.get(v);if(rt&&me.get(O))return rt==O;var Zt=!0;me.set(v,O),me.set(O,v);for(var Fr=tt;++cr<Ae;){Lt=$t[cr];var Pr=v[Lt],Gr=O[Lt];if(te)var jn=tt?te(Gr,Pr,Lt,O,v,me):te(Pr,Gr,Lt,v,O,me);if(!(jn===void 0?Pr===Gr||We(Pr,Gr,V,te,me):jn)){Zt=!1;break}Fr||(Fr=Lt=="constructor")}if(Zt&&!Fr){var Ui=v.constructor,qt=O.constructor;Ui!=qt&&"constructor"in v&&"constructor"in O&&!(typeof Ui=="function"&&Ui instanceof Ui&&typeof qt=="function"&&qt instanceof qt)&&(Zt=!1)}return me.delete(v),me.delete(O),Zt}function an(v){return Ln(v,ha,Ps)}function bi(v,O){var V=v.__data__;return As(O)?V[typeof O=="string"?"string":"hash"]:V.map}function vr(v,O){var V=Fe(v,O);return sa(V)?V:void 0}function Ss(v){var O=Me.call(v,Xt),V=v[Xt];try{v[Xt]=void 0;var te=!0}catch{}var We=Ft.call(v);return te&&(O?v[Xt]=V:delete v[Xt]),We}var Ps=ei?function(v){return v==null?[]:(v=Object(v),Ne(ei(v),function(O){return ar.call(v,O)}))}:Ve,Wr=Fi;(ft&&Wr(new ft(new ArrayBuffer(1)))!=Te||it&&Wr(new it)!=Q||dt&&Wr(dt.resolve())!=D||pt&&Wr(new pt)!=x||ut&&Wr(new ut)!=ae)&&(Wr=function(v){var O=Fi(v),V=O==C?v.constructor:void 0,te=V?ri(V):"";if(te)switch(te){case At:return Te;case Rt:return Q;case gt:return D;case Ct:return x;case yt:return ae}return O});function Os(v,O){return O=O??f,!!O&&(typeof v=="number"||Kr.test(v))&&v>-1&&v%1==0&&v<O}function As(v){var O=typeof v;return O=="string"||O=="number"||O=="symbol"||O=="boolean"?v!=="__proto__":v===null}function Rs(v){return!!Ot&&Ot in v}function Cs(v){var O=v&&v.constructor,V=typeof O=="function"&&O.prototype||$e;return v===V}function aa(v){return Ft.call(v)}function ri(v){if(v!=null){try{return lt.call(v)}catch{}try{return v+""}catch{}}return""}function Ts(v,O){return v===O||v!==v&&O!==O}var Ns=Dn(function(){return arguments}())?Dn:function(v){return Mi(v)&&Me.call(v,"callee")&&!ar.call(v,"callee")},cn=Array.isArray;function ca(v){return v!=null&&$s(v.length)&&!un(v)}var Fn=wi||ke;function ua(v,O){return ji(v,O)}function un(v){if(!Ls(v))return!1;var O=Fi(v);return O==H||O==$||O==y||O==q}function $s(v){return typeof v=="number"&&v>-1&&v%1==0&&v<=f}function Ls(v){var O=typeof v;return v!=null&&(O=="object"||O=="function")}function Mi(v){return v!=null&&typeof v=="object"}var Ds=_e?wt(_e):Es;function ha(v){return ca(v)?bs(v):Is(v)}function Ve(){return[]}function ke(){return!1}n.exports=ua})(Fo,Fo.exports);var rE=Fo.exports;const iE=Kc(rE);function nE(n,t){if(n.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),s=0;s<r.length;s++)r[s]=255;for(var a=0;a<n.length;a++){var u=n.charAt(a),f=u.charCodeAt(0);if(r[f]!==255)throw new TypeError(u+" is ambiguous");r[f]=a}var g=n.length,b=n.charAt(0),y=Math.log(g)/Math.log(256),_=Math.log(256)/Math.log(g);function P($){if($ instanceof Uint8Array||(ArrayBuffer.isView($)?$=new Uint8Array($.buffer,$.byteOffset,$.byteLength):Array.isArray($)&&($=Uint8Array.from($))),!($ instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if($.length===0)return"";for(var Q=0,se=0,le=0,C=$.length;le!==C&&$[le]===0;)le++,Q++;for(var D=(C-le)*_+1>>>0,q=new Uint8Array(D);le!==C;){for(var U=$[le],x=0,j=D-1;(U!==0||x<se)&&j!==-1;j--,x++)U+=256*q[j]>>>0,q[j]=U%g>>>0,U=U/g>>>0;if(U!==0)throw new Error("Non-zero carry");se=x,le++}for(var k=D-se;k!==D&&q[k]===0;)k++;for(var ue=b.repeat(Q);k<D;++k)ue+=n.charAt(q[k]);return ue}function N($){if(typeof $!="string")throw new TypeError("Expected String");if($.length===0)return new Uint8Array;var Q=0;if($[Q]!==" "){for(var se=0,le=0;$[Q]===b;)se++,Q++;for(var C=($.length-Q)*y+1>>>0,D=new Uint8Array(C);$[Q];){var q=r[$.charCodeAt(Q)];if(q===255)return;for(var U=0,x=C-1;(q!==0||U<le)&&x!==-1;x--,U++)q+=g*D[x]>>>0,D[x]=q%256>>>0,q=q/256>>>0;if(q!==0)throw new Error("Non-zero carry");le=U,Q++}if($[Q]!==" "){for(var j=C-le;j!==C&&D[j]===0;)j++;for(var k=new Uint8Array(se+(C-j)),ue=se;j!==C;)k[ue++]=D[j++];return k}}}function H($){var Q=N($);if(Q)return Q;throw new Error(`Non-${t} character`)}return{encode:P,decodeUnsafe:N,decode:H}}var sE=nE,oE=sE;const _d=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},aE=n=>new TextEncoder().encode(n),cE=n=>new TextDecoder().decode(n);class uE{constructor(t,r,s){this.name=t,this.prefix=r,this.baseEncode=s}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class hE{constructor(t,r,s){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=s}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Ed(this,t)}}let lE=class{constructor(t){this.decoders=t}or(t){return Ed(this,t)}decode(t){const r=t[0],s=this.decoders[r];if(s)return s.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const Ed=(n,t)=>new lE({...n.decoders||{[n.prefix]:n},...t.decoders||{[t.prefix]:t}});class fE{constructor(t,r,s,a){this.name=t,this.prefix=r,this.baseEncode=s,this.baseDecode=a,this.encoder=new uE(t,r,s),this.decoder=new hE(t,r,a)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const ko=({name:n,prefix:t,encode:r,decode:s})=>new fE(n,t,r,s),ys=({prefix:n,name:t,alphabet:r})=>{const{encode:s,decode:a}=oE(r,t);return ko({prefix:n,name:t,encode:s,decode:u=>_d(a(u))})},dE=(n,t,r,s)=>{const a={};for(let _=0;_<t.length;++_)a[t[_]]=_;let u=n.length;for(;n[u-1]==="=";)--u;const f=new Uint8Array(u*r/8|0);let g=0,b=0,y=0;for(let _=0;_<u;++_){const P=a[n[_]];if(P===void 0)throw new SyntaxError(`Non-${s} character`);b=b<<r|P,g+=r,g>=8&&(g-=8,f[y++]=255&b>>g)}if(g>=r||255&b<<8-g)throw new SyntaxError("Unexpected end of data");return f},pE=(n,t,r)=>{const s=t[t.length-1]==="=",a=(1<<r)-1;let u="",f=0,g=0;for(let b=0;b<n.length;++b)for(g=g<<8|n[b],f+=8;f>r;)f-=r,u+=t[a&g>>f];if(f&&(u+=t[a&g<<r-f]),s)for(;u.length*r&7;)u+="=";return u},Wt=({name:n,prefix:t,bitsPerChar:r,alphabet:s})=>ko({prefix:t,name:n,encode(a){return pE(a,s,r)},decode(a){return dE(a,s,r,n)}}),gE=ko({prefix:"\0",name:"identity",encode:n=>cE(n),decode:n=>aE(n)});var yE=Object.freeze({__proto__:null,identity:gE});const vE=Wt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var mE=Object.freeze({__proto__:null,base2:vE});const wE=Wt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var bE=Object.freeze({__proto__:null,base8:wE});const _E=ys({prefix:"9",name:"base10",alphabet:"0123456789"});var EE=Object.freeze({__proto__:null,base10:_E});const IE=Wt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),xE=Wt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var SE=Object.freeze({__proto__:null,base16:IE,base16upper:xE});const PE=Wt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),OE=Wt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),AE=Wt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),RE=Wt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),CE=Wt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),TE=Wt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),NE=Wt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),$E=Wt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),LE=Wt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var DE=Object.freeze({__proto__:null,base32:PE,base32upper:OE,base32pad:AE,base32padupper:RE,base32hex:CE,base32hexupper:TE,base32hexpad:NE,base32hexpadupper:$E,base32z:LE});const FE=ys({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),jE=ys({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var ME=Object.freeze({__proto__:null,base36:FE,base36upper:jE});const UE=ys({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),qE=ys({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var zE=Object.freeze({__proto__:null,base58btc:UE,base58flickr:qE});const kE=Wt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),HE=Wt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),BE=Wt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),KE=Wt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var VE=Object.freeze({__proto__:null,base64:kE,base64pad:HE,base64url:BE,base64urlpad:KE});const Id=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),WE=Id.reduce((n,t,r)=>(n[r]=t,n),[]),GE=Id.reduce((n,t,r)=>(n[t.codePointAt(0)]=r,n),[]);function JE(n){return n.reduce((t,r)=>(t+=WE[r],t),"")}function QE(n){const t=[];for(const r of n){const s=GE[r.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(s)}return new Uint8Array(t)}const YE=ko({prefix:"🚀",name:"base256emoji",encode:JE,decode:QE});var XE=Object.freeze({__proto__:null,base256emoji:YE}),ZE=xd,Zl=128,eI=127,tI=~eI,rI=Math.pow(2,31);function xd(n,t,r){t=t||[],r=r||0;for(var s=r;n>=rI;)t[r++]=n&255|Zl,n/=128;for(;n&tI;)t[r++]=n&255|Zl,n>>>=7;return t[r]=n|0,xd.bytes=r-s+1,t}var iI=Mc,nI=128,ef=127;function Mc(n,s){var r=0,s=s||0,a=0,u=s,f,g=n.length;do{if(u>=g)throw Mc.bytes=0,new RangeError("Could not decode varint");f=n[u++],r+=a<28?(f&ef)<<a:(f&ef)*Math.pow(2,a),a+=7}while(f>=nI);return Mc.bytes=u-s,r}var sI=Math.pow(2,7),oI=Math.pow(2,14),aI=Math.pow(2,21),cI=Math.pow(2,28),uI=Math.pow(2,35),hI=Math.pow(2,42),lI=Math.pow(2,49),fI=Math.pow(2,56),dI=Math.pow(2,63),pI=function(n){return n<sI?1:n<oI?2:n<aI?3:n<cI?4:n<uI?5:n<hI?6:n<lI?7:n<fI?8:n<dI?9:10},gI={encode:ZE,decode:iI,encodingLength:pI},Sd=gI;const tf=(n,t,r=0)=>(Sd.encode(n,t,r),t),rf=n=>Sd.encodingLength(n),Uc=(n,t)=>{const r=t.byteLength,s=rf(n),a=s+rf(r),u=new Uint8Array(a+r);return tf(n,u,0),tf(r,u,s),u.set(t,a),new yI(n,r,t,u)};class yI{constructor(t,r,s,a){this.code=t,this.size=r,this.digest=s,this.bytes=a}}const Pd=({name:n,code:t,encode:r})=>new vI(n,t,r);class vI{constructor(t,r,s){this.name=t,this.code=r,this.encode=s}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?Uc(this.code,r):r.then(s=>Uc(this.code,s))}else throw Error("Unknown type, must be binary type")}}const Od=n=>async t=>new Uint8Array(await crypto.subtle.digest(n,t)),mI=Pd({name:"sha2-256",code:18,encode:Od("SHA-256")}),wI=Pd({name:"sha2-512",code:19,encode:Od("SHA-512")});var bI=Object.freeze({__proto__:null,sha256:mI,sha512:wI});const Ad=0,_I="identity",Rd=_d,EI=n=>Uc(Ad,Rd(n)),II={code:Ad,name:_I,encode:Rd,digest:EI};var xI=Object.freeze({__proto__:null,identity:II});new TextEncoder,new TextDecoder;const nf={...yE,...mE,...bE,...EE,...SE,...DE,...ME,...zE,...VE,...XE};({...bI,...xI});function Cd(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function SI(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Cd(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function Td(n,t,r,s){return{name:n,prefix:t,encoder:{name:n,prefix:t,encode:r},decoder:{decode:s}}}const sf=Td("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),Ic=Td("ascii","a",n=>{let t="a";for(let r=0;r<n.length;r++)t+=String.fromCharCode(n[r]);return t},n=>{n=n.substring(1);const t=SI(n.length);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}),PI={utf8:sf,"utf-8":sf,hex:nf.base16,latin1:Ic,ascii:Ic,binary:Ic,...nf};function OI(n,t="utf8"){const r=PI[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Cd(globalThis.Buffer.from(n,"utf-8")):r.decoder.decode(`${r.prefix}${n}`)}const Nd="wc",AI=2,ou="core",Ti=`${Nd}@2:${ou}:`,RI={name:ou,logger:"error"},CI={database:":memory:"},TI="crypto",of="client_ed25519_seed",NI=ce.ONE_DAY,$I="keychain",LI="0.3",DI="messages",FI="0.3",jI=ce.SIX_HOURS,MI="publisher",$d="irn",UI="error",Ld="wss://relay.walletconnect.com",af="wss://relay.walletconnect.org",qI="relayer",Qt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},zI="_subscription",pi={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},kI=ce.ONE_SECOND,HI="2.10.6",BI=1e4,KI="0.3",VI="WALLETCONNECT_CLIENT_ID",zr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},WI="subscription",GI="0.3",JI=ce.FIVE_SECONDS*1e3,QI="pairing",YI="0.3",ts={wc_pairingDelete:{req:{ttl:ce.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ce.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ce.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ce.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ce.ONE_DAY,prompt:!1,tag:0},res:{ttl:ce.ONE_DAY,prompt:!1,tag:0}}},as={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Xr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},XI="history",ZI="0.3",ex="expirer",Lr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},tx="0.3",xc="verify-api",xn="https://verify.walletconnect.com",qc="https://verify.walletconnect.org",rx=[xn,qc];class ix{constructor(t,r){this.core=t,this.logger=r,this.keychain=new Map,this.name=$I,this.version=LI,this.initialized=!1,this.storagePrefix=Ti,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,a)=>{this.isInitialized(),this.keychain.set(s,a),await this.persist()},this.get=s=>{this.isInitialized();const a=this.keychain.get(s);if(typeof a>"u"){const{message:u}=Z("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(u)}return a},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=t,this.logger=Ce.generateChildLogger(r,this.name)}get context(){return Ce.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,Zf(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?ed(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=Z("NOT_INITIALIZED",this.name);throw new Error(t)}}}class nx{constructor(t,r,s){this.core=t,this.logger=r,this.name=TI,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=a=>(this.isInitialized(),this.keychain.has(a)),this.getClientId=async()=>{this.isInitialized();const a=await this.getClientSeed(),u=Kl(a);return dd(u.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const a=hw();return this.setPrivateKey(a.publicKey,a.privateKey)},this.signJWT=async a=>{this.isInitialized();const u=await this.getClientSeed(),f=Kl(u),g=Dc();return await L_(g,a,NI,f)},this.generateSharedKey=(a,u,f)=>{this.isInitialized();const g=this.getPrivateKey(a),b=lw(g,u);return this.setSymKey(b,f)},this.setSymKey=async(a,u)=>{this.isInitialized();const f=u||fw(a);return await this.keychain.set(f,a),f},this.deleteKeyPair=async a=>{this.isInitialized(),await this.keychain.del(a)},this.deleteSymKey=async a=>{this.isInitialized(),await this.keychain.del(a)},this.encode=async(a,u,f)=>{this.isInitialized();const g=Xf(f),b=Yi(u);if(wl(g)){const N=g.senderPublicKey,H=g.receiverPublicKey;a=await this.generateSharedKey(N,H)}const y=this.getSymKey(a),{type:_,senderPublicKey:P}=g;return pw({type:_,symKey:y,message:b,senderPublicKey:P})},this.decode=async(a,u,f)=>{this.isInitialized();const g=vw(u,f);if(wl(g)){const b=g.receiverPublicKey,y=g.senderPublicKey;a=await this.generateSharedKey(b,y)}try{const b=this.getSymKey(a),y=gw({symKey:b,encoded:u});return gs(y)}catch(b){this.logger.error(`Failed to decode message from topic: '${a}', clientId: '${await this.getClientId()}'`),this.logger.error(b)}},this.getPayloadType=a=>{const u=$o(a);return fs(u.type)},this.getPayloadSenderPublicKey=a=>{const u=$o(a);return u.senderPublicKey?or(u.senderPublicKey,sr):void 0},this.core=t,this.logger=Ce.generateChildLogger(r,this.name),this.keychain=s||new ix(this.core,this.logger)}get context(){return Ce.getLoggerContext(this.logger)}async setPrivateKey(t,r){return await this.keychain.set(t,r),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(of)}catch{t=Dc(),await this.keychain.set(of,t)}return OI(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=Z("NOT_INITIALIZED",this.name);throw new Error(t)}}}class sx extends f_{constructor(t,r){super(t,r),this.logger=t,this.core=r,this.messages=new Map,this.name=DI,this.version=FI,this.initialized=!1,this.storagePrefix=Ti,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,a)=>{this.isInitialized();const u=Pn(a);let f=this.messages.get(s);return typeof f>"u"&&(f={}),typeof f[u]<"u"||(f[u]=a,this.messages.set(s,f),await this.persist()),u},this.get=s=>{this.isInitialized();let a=this.messages.get(s);return typeof a>"u"&&(a={}),a},this.has=(s,a)=>{this.isInitialized();const u=this.get(s),f=Pn(a);return typeof u[f]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=Ce.generateChildLogger(t,this.name),this.core=r}get context(){return Ce.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,Zf(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?ed(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=Z("NOT_INITIALIZED",this.name);throw new Error(t)}}}class ox extends d_{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.events=new xr.EventEmitter,this.name=MI,this.queue=new Map,this.publishTimeout=ce.toMiliseconds(ce.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(s,a,u)=>{var f;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:a,opts:u}});try{const g=(u==null?void 0:u.ttl)||jI,b=Fc(u),y=(u==null?void 0:u.prompt)||!1,_=(u==null?void 0:u.tag)||0,P=(u==null?void 0:u.id)||md().toString(),N={topic:s,message:a,opts:{ttl:g,relay:b,prompt:y,tag:_,id:P}},H=setTimeout(()=>this.queue.set(P,N),this.publishTimeout);try{await await ls(this.rpcPublish(s,a,g,b,y,_,P),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(P),this.relayer.events.emit(Qt.publish,N)}catch($){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(f=u==null?void 0:u.internal)!=null&&f.throwOnFailedPublish)throw this.removeRequestFromQueue(P),$;return}finally{clearTimeout(H)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:a,opts:u}})}catch(g){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(g),g}},this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.relayer=t,this.logger=Ce.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Ce.getLoggerContext(this.logger)}rpcPublish(t,r,s,a,u,f,g){var b,y,_,P;const N={method:Ro(a.protocol).publish,params:{topic:t,message:r,ttl:s,prompt:u,tag:f},id:g};return nr((b=N.params)==null?void 0:b.prompt)&&((y=N.params)==null||delete y.prompt),nr((_=N.params)==null?void 0:_.tag)&&((P=N.params)==null||delete P.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:N}),this.relayer.request(N)}removeRequestFromQueue(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:r,message:s,opts:a}=t;await this.publish(r,s,a)})}registerEventListeners(){this.relayer.core.heartbeat.on($n.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Qt.connection_stalled);return}this.checkQueue()}),this.relayer.on(Qt.message_ack,t=>{this.removeRequestFromQueue(t.id.toString())})}}class ax{constructor(){this.map=new Map,this.set=(t,r)=>{const s=this.get(t);this.exists(t,r)||this.map.set(t,[...s,r])},this.get=t=>this.map.get(t)||[],this.exists=(t,r)=>this.get(t).includes(r),this.delete=(t,r)=>{if(typeof r>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const s=this.get(t);if(!this.exists(t,r))return;const a=s.filter(u=>u!==r);if(!a.length){this.map.delete(t);return}this.map.set(t,a)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var cx=Object.defineProperty,ux=Object.defineProperties,hx=Object.getOwnPropertyDescriptors,cf=Object.getOwnPropertySymbols,lx=Object.prototype.hasOwnProperty,fx=Object.prototype.propertyIsEnumerable,uf=(n,t,r)=>t in n?cx(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,rs=(n,t)=>{for(var r in t||(t={}))lx.call(t,r)&&uf(n,r,t[r]);if(cf)for(var r of cf(t))fx.call(t,r)&&uf(n,r,t[r]);return n},Sc=(n,t)=>ux(n,hx(t));class dx extends y_{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.subscriptions=new Map,this.topicMap=new ax,this.events=new xr.EventEmitter,this.name=WI,this.version=GI,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Ti,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,a)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:a}});try{const u=Fc(a),f={topic:s,relay:u};this.pending.set(s,f);const g=await this.rpcSubscribe(s,u);return this.onSubscribe(g,f),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:a}}),g}catch(u){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(u),u}},this.unsubscribe=async(s,a)=>{await this.restartToComplete(),this.isInitialized(),typeof(a==null?void 0:a.id)<"u"?await this.unsubscribeById(s,a.id,a):await this.unsubscribeByTopic(s,a)},this.isSubscribed=async s=>this.topics.includes(s)?!0:await new Promise((a,u)=>{const f=new ce.Watch;f.start(this.pendingSubscriptionWatchLabel);const g=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(g),f.stop(this.pendingSubscriptionWatchLabel),a(!0)),f.elapsed(this.pendingSubscriptionWatchLabel)>=JI&&(clearInterval(g),f.stop(this.pendingSubscriptionWatchLabel),u(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=t,this.logger=Ce.generateChildLogger(r,this.name),this.clientId=""}get context(){return Ce.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,r){let s=!1;try{s=this.getSubscription(t).topic===r}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,r){const s=this.topicMap.get(t);await Promise.all(s.map(async a=>await this.unsubscribeById(t,a,r)))}async unsubscribeById(t,r,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:s}});try{const a=Fc(s);await this.rpcUnsubscribe(t,r,a);const u=xt("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,r,u),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:s}})}catch(a){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(a),a}}async rpcSubscribe(t,r){const s={method:Ro(r.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await ls(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Qt.connection_stalled)}return Pn(t+this.clientId)}async rpcBatchSubscribe(t){if(!t.length)return;const r=t[0].relay,s={method:Ro(r.protocol).batchSubscribe,params:{topics:t.map(a=>a.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await ls(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Qt.connection_stalled)}}rpcUnsubscribe(t,r,s){const a={method:Ro(s.protocol).unsubscribe,params:{topic:t,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a}),this.relayer.request(a)}onSubscribe(t,r){this.setSubscription(t,Sc(rs({},r),{id:t})),this.pending.delete(r.topic)}onBatchSubscribe(t){t.length&&t.forEach(r=>{this.setSubscription(r.id,rs({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(t,r,s){this.events.removeAllListeners(r),this.hasSubscription(r,t)&&this.deleteSubscription(r,s),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,r){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:r}),this.addSubscription(t,r))}addSubscription(t,r){this.subscriptions.set(t,rs({},r)),this.topicMap.set(r.topic,t),this.events.emit(zr.created,r)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const r=this.subscriptions.get(t);if(!r){const{message:s}=Z("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return r}deleteSubscription(t,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:r});const s=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(s.topic,t),this.events.emit(zr.deleted,Sc(rs({},s),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(zr.sync)}async reset(){if(this.cached.length){const t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(zr.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:r}=Z("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){if(!t.length)return;const r=await this.rpcBatchSubscribe(t);Zr(r)&&this.onBatchSubscribe(r.map((s,a)=>Sc(rs({},t[a]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const t=[];this.pending.forEach(r=>{t.push(r)}),await this.batchSubscribe(t)}registerEventListeners(){this.relayer.core.heartbeat.on($n.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Qt.connect,async()=>{await this.onConnect()}),this.relayer.on(Qt.disconnect,()=>{this.onDisconnect()}),this.events.on(zr.created,async t=>{const r=zr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()}),this.events.on(zr.deleted,async t=>{const r=zr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=Z("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){this.restartInProgress&&await new Promise(t=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),t())},this.pollingInterval)})}}var px=Object.defineProperty,hf=Object.getOwnPropertySymbols,gx=Object.prototype.hasOwnProperty,yx=Object.prototype.propertyIsEnumerable,lf=(n,t,r)=>t in n?px(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,vx=(n,t)=>{for(var r in t||(t={}))gx.call(t,r)&&lf(n,r,t[r]);if(hf)for(var r of hf(t))yx.call(t,r)&&lf(n,r,t[r]);return n};class mx extends p_{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new xr.EventEmitter,this.name=qI,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(s){throw this.logger.debug("Failed to Publish Request"),this.logger.error(s),s}},this.onPayloadHandler=r=>{this.onProviderPayload(r)},this.onConnectHandler=()=>{this.events.emit(Qt.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=r=>{this.logger.error(r),this.events.emit(Qt.error,r),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(pi.payload,this.onPayloadHandler),this.provider.on(pi.connect,this.onConnectHandler),this.provider.on(pi.disconnect,this.onDisconnectHandler),this.provider.on(pi.error,this.onProviderErrorHandler)},this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?Ce.generateChildLogger(t.logger,this.name):Ce.pino(Ce.getDefaultLoggerOptions({level:t.logger||UI})),this.messages=new sx(this.logger,t.core),this.subscriber=new dx(this,this.logger),this.publisher=new ox(this,this.logger),this.relayUrl=(t==null?void 0:t.relayUrl)||Ld,this.projectId=t.projectId,this.bundleId=Iw(),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${af}...`),await this.restartTransport(af)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},BI)}get context(){return Ce.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,r,s){this.isInitialized(),await this.publisher.publish(t,r,s),await this.recordMessageEvent({topic:t,message:r,publishedAt:Date.now()})}async subscribe(t,r){var s;this.isInitialized();let a=((s=this.subscriber.topicMap.get(t))==null?void 0:s[0])||"";if(a)return a;let u;const f=g=>{g.topic===t&&(this.subscriber.off(zr.created,f),u())};return await Promise.all([new Promise(g=>{u=g,this.subscriber.on(zr.created,f)}),new Promise(async g=>{a=await this.subscriber.subscribe(t,r),g()})]),a}async unsubscribe(t,r){this.isInitialized(),await this.subscriber.unsubscribe(t,r)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await ls(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(t){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){t&&t!==this.relayUrl&&(this.relayUrl=t,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(r=>{if(!this.initialized)return r();this.subscriber.once(zr.resubscribed,()=>{r()})}),new Promise(async(r,s)=>{try{await ls(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(a){s(a);return}r()})])}catch(r){this.logger.error(r);const s=r;if(!this.isConnectionStalled(s.message))throw r;this.provider.events.emit(pi.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(t){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=t||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Cl())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(t){return this.staleConnectionErrors.some(r=>t.includes(r))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new vi(new tE(Rw({sdkVersion:HI,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(t){const{topic:r,message:s}=t;await this.messages.set(r,s)}async shouldIgnoreMessageEvent(t){const{topic:r,message:s}=t;if(!s||s.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${s}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.debug(`Ignoring message for non-subscribed topic ${r}`),!0;const a=this.messages.has(r,s);return a&&this.logger.debug(`Ignoring duplicate message: ${s}`),a}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),su(t)){if(!t.method.endsWith(zI))return;const r=t.params,{topic:s,message:a,publishedAt:u}=r.data,f={topic:s,message:a,publishedAt:u};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(vx({type:"event",event:r.id},f)),this.events.emit(r.id,f),await this.acknowledgePayload(t),await this.onMessageEvent(f)}else zo(t)&&this.events.emit(Qt.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(Qt.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const r=nu(t.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(pi.payload,this.onPayloadHandler),this.provider.off(pi.connect,this.onConnectHandler),this.provider.off(pi.disconnect,this.onDisconnectHandler),this.provider.off(pi.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(Qt.connection_stalled,()=>{this.restartTransport().catch(r=>this.logger.error(r))});let t=await Cl();_b(async r=>{this.initialized&&t!==r&&(t=r,r?await this.restartTransport().catch(s=>this.logger.error(s)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(s=>this.logger.error(s))))})}onProviderDisconnect(){this.events.emit(Qt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(t=>this.logger.error(t))},ce.toMiliseconds(kI)))}isInitialized(){if(!this.initialized){const{message:t}=Z("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(t=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),t())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var wx=Object.defineProperty,ff=Object.getOwnPropertySymbols,bx=Object.prototype.hasOwnProperty,_x=Object.prototype.propertyIsEnumerable,df=(n,t,r)=>t in n?wx(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,pf=(n,t)=>{for(var r in t||(t={}))bx.call(t,r)&&df(n,r,t[r]);if(ff)for(var r of ff(t))_x.call(t,r)&&df(n,r,t[r]);return n};class Ho extends g_{constructor(t,r,s,a=Ti,u=void 0){super(t,r,s,a),this.core=t,this.logger=r,this.name=s,this.map=new Map,this.version=KI,this.cached=[],this.initialized=!1,this.storagePrefix=Ti,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(f=>{this.getKey&&f!==null&&!nr(f)?this.map.set(this.getKey(f),f):Xw(f)?this.map.set(f.id,f):Zw(f)&&this.map.set(f.topic,f)}),this.cached=[],this.initialized=!0)},this.set=async(f,g)=>{this.isInitialized(),this.map.has(f)?await this.update(f,g):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:f,value:g}),this.map.set(f,g),await this.persist())},this.get=f=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:f}),this.getData(f)),this.getAll=f=>(this.isInitialized(),f?this.values.filter(g=>Object.keys(f).every(b=>iE(g[b],f[b]))):this.values),this.update=async(f,g)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:f,update:g});const b=pf(pf({},this.getData(f)),g);this.map.set(f,b),await this.persist()},this.delete=async(f,g)=>{this.isInitialized(),this.map.has(f)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:f,reason:g}),this.map.delete(f),await this.persist())},this.logger=Ce.generateChildLogger(r,this.name),this.storagePrefix=a,this.getKey=u}get context(){return Ce.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const r=this.map.get(t);if(!r){const{message:s}=Z("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:r}=Z("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=Z("NOT_INITIALIZED",this.name);throw new Error(t)}}}class Ex{constructor(t,r){this.core=t,this.logger=r,this.name=QI,this.version=YI,this.events=new Jc,this.initialized=!1,this.storagePrefix=Ti,this.ignoredPayloadTypes=[Xi],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=Dc(),a=await this.core.crypto.setSymKey(s),u=kr(ce.FIVE_MINUTES),f={protocol:$d},g={topic:a,expiry:u,relay:f,active:!1},b=kw({protocol:this.core.protocol,version:this.core.version,topic:a,symKey:s,relay:f});return await this.pairings.set(a,g),await this.core.relayer.subscribe(a),this.core.expirer.set(a,u),{topic:a,uri:b}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:a,symKey:u,relay:f}=Sl(s.uri);let g;if(this.pairings.keys.includes(a)&&(g=this.pairings.get(a),g.active))throw new Error(`Pairing already exists: ${a}. Please try again with a new connection URI.`);const b=kr(ce.FIVE_MINUTES),y={topic:a,relay:f,expiry:b,active:!1};return await this.pairings.set(a,y),this.core.expirer.set(a,b),s.activatePairing&&await this.activate({topic:a}),this.events.emit(as.create,y),this.core.crypto.keychain.has(a)||(await this.core.crypto.setSymKey(u,a),await this.core.relayer.subscribe(a,{relay:f})),y},this.activate=async({topic:s})=>{this.isInitialized();const a=kr(ce.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:a}),this.core.expirer.set(s,a)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:a}=s;if(this.pairings.keys.includes(a)){const u=await this.sendRequest(a,"wc_pairingPing",{}),{done:f,resolve:g,reject:b}=In();this.events.once(Dt("pairing_ping",u),({error:y})=>{y?b(y):g()}),await f()}},this.updateExpiry=async({topic:s,expiry:a})=>{this.isInitialized(),await this.pairings.update(s,{expiry:a})},this.updateMetadata=async({topic:s,metadata:a})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:a})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:a}=s;this.pairings.keys.includes(a)&&(await this.sendRequest(a,"wc_pairingDelete",xt("USER_DISCONNECTED")),await this.deletePairing(a))},this.sendRequest=async(s,a,u)=>{const f=An(a,u),g=await this.core.crypto.encode(s,f),b=ts[a].req;return this.core.history.set(s,f),this.core.relayer.publish(s,g,b),f.id},this.sendResult=async(s,a,u)=>{const f=nu(s,u),g=await this.core.crypto.encode(a,f),b=await this.core.history.get(a,s),y=ts[b.request.method].res;await this.core.relayer.publish(a,g,y),await this.core.history.resolve(f)},this.sendError=async(s,a,u)=>{const f=qo(s,u),g=await this.core.crypto.encode(a,f),b=await this.core.history.get(a,s),y=ts[b.request.method]?ts[b.request.method].res:ts.unregistered_method.res;await this.core.relayer.publish(a,g,y),await this.core.history.resolve(f)},this.deletePairing=async(s,a)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,xt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),a?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(a=>Ci(a.expiry));await Promise.all(s.map(a=>this.deletePairing(a.topic)))},this.onRelayEventRequest=s=>{const{topic:a,payload:u}=s;switch(u.method){case"wc_pairingPing":return this.onPairingPingRequest(a,u);case"wc_pairingDelete":return this.onPairingDeleteRequest(a,u);default:return this.onUnknownRpcMethodRequest(a,u)}},this.onRelayEventResponse=async s=>{const{topic:a,payload:u}=s,f=(await this.core.history.get(a,u.id)).request.method;switch(f){case"wc_pairingPing":return this.onPairingPingResponse(a,u);default:return this.onUnknownRpcMethodResponse(f)}},this.onPairingPingRequest=async(s,a)=>{const{id:u}=a;try{this.isValidPing({topic:s}),await this.sendResult(u,s,!0),this.events.emit(as.ping,{id:u,topic:s})}catch(f){await this.sendError(u,s,f),this.logger.error(f)}},this.onPairingPingResponse=(s,a)=>{const{id:u}=a;setTimeout(()=>{yi(a)?this.events.emit(Dt("pairing_ping",u),{}):Hr(a)&&this.events.emit(Dt("pairing_ping",u),{error:a.error})},500)},this.onPairingDeleteRequest=async(s,a)=>{const{id:u}=a;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit(as.delete,{id:u,topic:s})}catch(f){await this.sendError(u,s,f),this.logger.error(f)}},this.onUnknownRpcMethodRequest=async(s,a)=>{const{id:u,method:f}=a;try{if(this.registeredMethods.includes(f))return;const g=xt("WC_METHOD_UNSUPPORTED",f);await this.sendError(u,s,g),this.logger.error(g)}catch(g){await this.sendError(u,s,g),this.logger.error(g)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(xt("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{var a;if(!gr(s)){const{message:f}=Z("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(f)}if(!Yw(s.uri)){const{message:f}=Z("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(f)}const u=Sl(s.uri);if(!((a=u==null?void 0:u.relay)!=null&&a.protocol)){const{message:f}=Z("MISSING_OR_INVALID","pair() uri#relay-protocol");throw new Error(f)}if(!(u!=null&&u.symKey)){const{message:f}=Z("MISSING_OR_INVALID","pair() uri#symKey");throw new Error(f)}},this.isValidPing=async s=>{if(!gr(s)){const{message:u}=Z("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(u)}const{topic:a}=s;await this.isValidPairingTopic(a)},this.isValidDisconnect=async s=>{if(!gr(s)){const{message:u}=Z("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(u)}const{topic:a}=s;await this.isValidPairingTopic(a)},this.isValidPairingTopic=async s=>{if(!Ht(s,!1)){const{message:a}=Z("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(a)}if(!this.pairings.keys.includes(s)){const{message:a}=Z("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(a)}if(Ci(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:a}=Z("EXPIRED",`pairing topic: ${s}`);throw new Error(a)}},this.core=t,this.logger=Ce.generateChildLogger(r,this.name),this.pairings=new Ho(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Ce.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=Z("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(Qt.message,async t=>{const{topic:r,message:s}=t;if(!this.pairings.keys.includes(r)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const a=await this.core.crypto.decode(r,s);try{su(a)?(this.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):zo(a)&&(await this.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.core.history.delete(r,a.id))}catch(u){this.logger.error(u)}})}registerExpirerEvents(){this.core.expirer.on(Lr.expired,async t=>{const{topic:r}=rd(t.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(as.expire,{topic:r}))})}}class Ix extends l_{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.records=new Map,this.events=new xr.EventEmitter,this.name=XI,this.version=ZI,this.cached=[],this.initialized=!1,this.storagePrefix=Ti,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,a,u)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:a,chainId:u}),this.records.has(a.id))return;const f={id:a.id,topic:s,request:{method:a.method,params:a.params||null},chainId:u,expiry:kr(ce.THIRTY_DAYS)};this.records.set(f.id,f),this.events.emit(Xr.created,f)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const a=await this.getRecord(s.id);typeof a.response>"u"&&(a.response=Hr(s)?{error:s.error}:{result:s.result},this.records.set(a.id,a),this.events.emit(Xr.updated,a))},this.get=async(s,a)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:a}),await this.getRecord(a)),this.delete=(s,a)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:a}),this.values.forEach(u=>{if(u.topic===s){if(typeof a<"u"&&u.id!==a)return;this.records.delete(u.id),this.events.emit(Xr.deleted,u)}})},this.exists=async(s,a)=>(this.isInitialized(),this.records.has(a)?(await this.getRecord(a)).topic===s:!1),this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.logger=Ce.generateChildLogger(r,this.name)}get context(){return Ce.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const s={topic:r.topic,request:An(r.request.method,r.request.params,r.id),chainId:r.chainId};return t.push(s)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const r=this.records.get(t);if(!r){const{message:s}=Z("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Xr.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:r}=Z("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(Xr.created,t=>{const r=Xr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Xr.updated,t=>{const r=Xr.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Xr.deleted,t=>{const r=Xr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.core.heartbeat.on($n.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(t=>{ce.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.delete(t.topic,t.id))})}catch(t){this.logger.warn(t)}}isInitialized(){if(!this.initialized){const{message:t}=Z("NOT_INITIALIZED",this.name);throw new Error(t)}}}class xx extends v_{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.expirations=new Map,this.events=new xr.EventEmitter,this.name=ex,this.version=tx,this.cached=[],this.initialized=!1,this.storagePrefix=Ti,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const a=this.formatTarget(s);return typeof this.getExpiration(a)<"u"}catch{return!1}},this.set=(s,a)=>{this.isInitialized();const u=this.formatTarget(s),f={target:u,expiry:a};this.expirations.set(u,f),this.checkExpiry(u,f),this.events.emit(Lr.created,{target:u,expiration:f})},this.get=s=>{this.isInitialized();const a=this.formatTarget(s);return this.getExpiration(a)},this.del=s=>{if(this.isInitialized(),this.has(s)){const a=this.formatTarget(s),u=this.getExpiration(a);this.expirations.delete(a),this.events.emit(Lr.deleted,{target:a,expiration:u})}},this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.logger=Ce.generateChildLogger(r,this.name)}get context(){return Ce.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return Cw(t);if(typeof t=="number")return Tw(t);const{message:r}=Z("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(r)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Lr.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:r}=Z("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const r=this.expirations.get(t);if(!r){const{message:s}=Z("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return r}checkExpiry(t,r){const{expiry:s}=r;ce.toMiliseconds(s)-Date.now()<=0&&this.expire(t,r)}expire(t,r){this.expirations.delete(t),this.events.emit(Lr.expired,{target:t,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,r)=>this.checkExpiry(r,t))}registerEventListeners(){this.core.heartbeat.on($n.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Lr.created,t=>{const r=Lr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Lr.expired,t=>{const r=Lr.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Lr.deleted,t=>{const r=Lr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=Z("NOT_INITIALIZED",this.name);throw new Error(t)}}}class Sx extends m_{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,this.name=xc,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async s=>{if(this.verifyDisabled||Cn()||!Tn())return;const a=this.getVerifyUrl(s==null?void 0:s.verifyUrl);this.verifyUrl!==a&&this.removeIframe(),this.verifyUrl=a;try{await this.createIframe()}catch(u){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(u)}if(!this.initialized){this.removeIframe(),this.verifyUrl=qc;try{await this.createIframe()}catch(u){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(u),this.verifyDisabled=!0}}},this.register=async s=>{this.initialized?this.sendPost(s.attestationId):(this.addToQueue(s.attestationId),await this.init())},this.resolve=async s=>{if(this.isDevEnv)return"";const a=this.getVerifyUrl(s==null?void 0:s.verifyUrl);let u;try{u=await this.fetchAttestation(s.attestationId,a)}catch(f){this.logger.info(`failed to resolve attestation: ${s.attestationId} from url: ${a}`),this.logger.info(f),u=await this.fetchAttestation(s.attestationId,qc)}return u},this.fetchAttestation=async(s,a)=>{this.logger.info(`resolving attestation: ${s} from url: ${a}`);const u=this.startAbortTimer(ce.ONE_SECOND*2),f=await fetch(`${a}/attestation/${s}`,{signal:this.abortController.signal});return clearTimeout(u),f.status===200?await f.json():void 0},this.addToQueue=s=>{this.queue.push(s)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(s=>this.sendPost(s)),this.queue=[])},this.sendPost=s=>{var a;try{if(!this.iframe)return;(a=this.iframe.contentWindow)==null||a.postMessage(s,"*"),this.logger.info(`postMessage sent: ${s} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let s;const a=u=>{u.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",a),s())};await Promise.race([new Promise(u=>{if(document.getElementById(xc))return u();window.addEventListener("message",a);const f=document.createElement("iframe");f.id=xc,f.src=`${this.verifyUrl}/${this.projectId}`,f.style.display="none",document.body.append(f),this.iframe=f,s=u}),new Promise((u,f)=>setTimeout(()=>{window.removeEventListener("message",a),f("verify iframe load timeout")},ce.toMiliseconds(ce.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=s=>{let a=s||xn;return rx.includes(a)||(this.logger.info(`verify url: ${a}, not included in trusted list, assigning default: ${xn}`),a=xn),a},this.logger=Ce.generateChildLogger(r,this.name),this.verifyUrl=xn,this.abortController=new AbortController,this.isDevEnv=Xc()&&{}.IS_VITEST}get context(){return Ce.getLoggerContext(this.logger)}startAbortTimer(t){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),ce.toMiliseconds(t))}}var Px=Object.defineProperty,gf=Object.getOwnPropertySymbols,Ox=Object.prototype.hasOwnProperty,Ax=Object.prototype.propertyIsEnumerable,yf=(n,t,r)=>t in n?Px(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,vf=(n,t)=>{for(var r in t||(t={}))Ox.call(t,r)&&yf(n,r,t[r]);if(gf)for(var r of gf(t))Ax.call(t,r)&&yf(n,r,t[r]);return n};class au extends h_{constructor(t){super(t),this.protocol=Nd,this.version=AI,this.name=ou,this.events=new xr.EventEmitter,this.initialized=!1,this.on=(s,a)=>this.events.on(s,a),this.once=(s,a)=>this.events.once(s,a),this.off=(s,a)=>this.events.off(s,a),this.removeListener=(s,a)=>this.events.removeListener(s,a),this.projectId=t==null?void 0:t.projectId,this.relayUrl=(t==null?void 0:t.relayUrl)||Ld,this.customStoragePrefix=t!=null&&t.customStoragePrefix?`:${t.customStoragePrefix}`:"";const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Ce.pino(Ce.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||RI.logger}));this.logger=Ce.generateChildLogger(r,this.name),this.heartbeat=new $n.HeartBeat,this.crypto=new nx(this,this.logger,t==null?void 0:t.keychain),this.history=new Ix(this,this.logger),this.expirer=new xx(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new t_(vf(vf({},CI),t==null?void 0:t.storageOptions)),this.relayer=new mx({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new Ex(this,this.logger),this.verify=new Sx(this.projectId||"",this.logger)}static async init(t){const r=new au(t);await r.initialize();const s=await r.crypto.getClientId();return await r.storage.setItem(VI,s),r}get context(){return Ce.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}}const Rx=au,Dd="wc",Fd=2,jd="client",cu=`${Dd}@${Fd}:${jd}:`,Pc={name:jd,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},mf="WALLETCONNECT_DEEPLINK_CHOICE",Cx="proposal",Md="Proposal expired",Tx="session",So=ce.SEVEN_DAYS,Nx="engine",is={wc_sessionPropose:{req:{ttl:ce.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ce.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ce.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ce.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ce.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ce.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ce.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ce.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ce.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ce.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ce.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ce.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ce.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ce.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ce.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ce.THIRTY_SECONDS,prompt:!1,tag:1115}}},Oc={min:ce.FIVE_MINUTES,max:ce.SEVEN_DAYS},gi={idle:"IDLE",active:"ACTIVE"},$x="request",Lx=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var Dx=Object.defineProperty,Fx=Object.defineProperties,jx=Object.getOwnPropertyDescriptors,wf=Object.getOwnPropertySymbols,Mx=Object.prototype.hasOwnProperty,Ux=Object.prototype.propertyIsEnumerable,bf=(n,t,r)=>t in n?Dx(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,dr=(n,t)=>{for(var r in t||(t={}))Mx.call(t,r)&&bf(n,r,t[r]);if(wf)for(var r of wf(t))Ux.call(t,r)&&bf(n,r,t[r]);return n},ns=(n,t)=>Fx(n,jx(t));class qx extends b_{constructor(t){super(t),this.name=Nx,this.events=new Jc,this.initialized=!1,this.ignoredPayloadTypes=[Xi],this.requestQueue={state:gi.idle,queue:[]},this.sessionRequestQueue={state:gi.idle,queue:[]},this.requestQueueDelay=ce.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(is)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},ce.toMiliseconds(this.requestQueueDelay)))},this.connect=async r=>{await this.isInitialized();const s=ns(dr({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:a,requiredNamespaces:u,optionalNamespaces:f,sessionProperties:g,relays:b}=s;let y=a,_,P=!1;if(y&&(P=this.client.core.pairing.pairings.get(y).active),!y||!P){const{topic:D,uri:q}=await this.client.core.pairing.create();y=D,_=q}const N=await this.client.core.crypto.generateKeyPair(),H=dr({requiredNamespaces:u,optionalNamespaces:f,relays:b??[{protocol:$d}],proposer:{publicKey:N,metadata:this.client.metadata}},g&&{sessionProperties:g}),{reject:$,resolve:Q,done:se}=In(ce.FIVE_MINUTES,Md);if(this.events.once(Dt("session_connect"),async({error:D,session:q})=>{if(D)$(D);else if(q){q.self.publicKey=N;const U=ns(dr({},q),{requiredNamespaces:q.requiredNamespaces,optionalNamespaces:q.optionalNamespaces});await this.client.session.set(q.topic,U),await this.setExpiry(q.topic,q.expiry),y&&await this.client.core.pairing.updateMetadata({topic:y,metadata:q.peer.metadata}),Q(U)}}),!y){const{message:D}=Z("NO_MATCHING_KEY",`connect() pairing topic: ${y}`);throw new Error(D)}const le=await this.sendRequest({topic:y,method:"wc_sessionPropose",params:H}),C=kr(ce.FIVE_MINUTES);return await this.setProposal(le,dr({id:le,expiry:C},H)),{uri:_,approval:se}},this.pair=async r=>(await this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{await this.isInitialized(),await this.isValidApprove(r);const{id:s,relayProtocol:a,namespaces:u,sessionProperties:f}=r,g=this.client.proposal.get(s);let{pairingTopic:b,proposer:y,requiredNamespaces:_,optionalNamespaces:P}=g;b=b||"",On(_)||(_=Vw(u,"approve()"));const N=await this.client.core.crypto.generateKeyPair(),H=y.publicKey,$=await this.client.core.crypto.generateSharedKey(N,H);b&&s&&(await this.client.core.pairing.updateMetadata({topic:b,metadata:y.metadata}),await this.sendResult({id:s,topic:b,result:{relay:{protocol:a??"irn"},responderPublicKey:N}}),await this.client.proposal.delete(s,xt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:b}));const Q=dr({relay:{protocol:a??"irn"},namespaces:u,requiredNamespaces:_,optionalNamespaces:P,pairingTopic:b,controller:{publicKey:N,metadata:this.client.metadata},expiry:kr(So)},f&&{sessionProperties:f});await this.client.core.relayer.subscribe($),await this.sendRequest({topic:$,method:"wc_sessionSettle",params:Q,throwOnFailedPublish:!0});const se=ns(dr({},Q),{topic:$,pairingTopic:b,acknowledged:!1,self:Q.controller,peer:{publicKey:y.publicKey,metadata:y.metadata},controller:N});return await this.client.session.set($,se),await this.setExpiry($,kr(So)),{topic:$,acknowledged:()=>new Promise(le=>setTimeout(()=>le(this.client.session.get($)),500))}},this.reject=async r=>{await this.isInitialized(),await this.isValidReject(r);const{id:s,reason:a}=r,{pairingTopic:u}=this.client.proposal.get(s);u&&(await this.sendError(s,u,a),await this.client.proposal.delete(s,xt("USER_DISCONNECTED")))},this.update=async r=>{await this.isInitialized(),await this.isValidUpdate(r);const{topic:s,namespaces:a}=r,u=await this.sendRequest({topic:s,method:"wc_sessionUpdate",params:{namespaces:a}}),{done:f,resolve:g,reject:b}=In();return this.events.once(Dt("session_update",u),({error:y})=>{y?b(y):g()}),await this.client.session.update(s,{namespaces:a}),{acknowledged:f}},this.extend=async r=>{await this.isInitialized(),await this.isValidExtend(r);const{topic:s}=r,a=await this.sendRequest({topic:s,method:"wc_sessionExtend",params:{}}),{done:u,resolve:f,reject:g}=In();return this.events.once(Dt("session_extend",a),({error:b})=>{b?g(b):f()}),await this.setExpiry(s,kr(So)),{acknowledged:u}},this.request=async r=>{await this.isInitialized(),await this.isValidRequest(r);const{chainId:s,request:a,topic:u,expiry:f}=r,g=iu(),{done:b,resolve:y,reject:_}=In(f,"Request expired. Please try again.");return this.events.once(Dt("session_request",g),({error:P,result:N})=>{P?_(P):y(N)}),await Promise.all([new Promise(async P=>{await this.sendRequest({clientRpcId:g,topic:u,method:"wc_sessionRequest",params:{request:a,chainId:s},expiry:f,throwOnFailedPublish:!0}).catch(N=>_(N)),this.client.events.emit("session_request_sent",{topic:u,request:a,chainId:s,id:g}),P()}),new Promise(async P=>{const N=await $w(this.client.core.storage,mf);Nw({id:g,topic:u,wcDeepLink:N}),P()}),b()]).then(P=>P[2])},this.respond=async r=>{await this.isInitialized(),await this.isValidRespond(r);const{topic:s,response:a}=r,{id:u}=a;yi(a)?await this.sendResult({id:u,topic:s,result:a.result,throwOnFailedPublish:!0}):Hr(a)&&await this.sendError(u,s,a.error),this.cleanupAfterResponse(r)},this.ping=async r=>{await this.isInitialized(),await this.isValidPing(r);const{topic:s}=r;if(this.client.session.keys.includes(s)){const a=await this.sendRequest({topic:s,method:"wc_sessionPing",params:{}}),{done:u,resolve:f,reject:g}=In();this.events.once(Dt("session_ping",a),({error:b})=>{b?g(b):f()}),await u()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async r=>{await this.isInitialized(),await this.isValidEmit(r);const{topic:s,event:a,chainId:u}=r;await this.sendRequest({topic:s,method:"wc_sessionEvent",params:{event:a,chainId:u}})},this.disconnect=async r=>{await this.isInitialized(),await this.isValidDisconnect(r);const{topic:s}=r;this.client.session.keys.includes(s)?(await this.sendRequest({topic:s,method:"wc_sessionDelete",params:xt("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(s)):await this.client.core.pairing.disconnect({topic:s})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(s=>Jw(s,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const s=this.client.core.pairing.pairings.get(r.pairingTopic),a=this.client.core.pairing.pairings.getAll().filter(u=>{var f,g;return((f=u.peerMetadata)==null?void 0:f.url)&&((g=u.peerMetadata)==null?void 0:g.url)===r.peer.metadata.url&&u.topic&&u.topic!==s.topic});if(a.length===0)return;this.client.logger.info(`Cleaning up ${a.length} duplicate pairing(s)`),await Promise.all(a.map(u=>this.client.core.pairing.disconnect({topic:u.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async(r,s)=>{const{self:a}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,xt("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(a.publicKey)&&await this.client.core.crypto.deleteKeyPair(a.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),s||this.client.core.expirer.del(r),this.client.core.storage.removeItem(mf).catch(u=>this.client.logger.warn(u))},this.deleteProposal=async(r,s)=>{await Promise.all([this.client.proposal.delete(r,xt("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,s,a=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,s),a?Promise.resolve():this.client.core.expirer.del(r)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(u=>u.id!==r),a&&(this.sessionRequestQueue.state=gi.idle)},this.setExpiry=async(r,s)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:s}),this.client.core.expirer.set(r,s)},this.setProposal=async(r,s)=>{await this.client.proposal.set(r,s),this.client.core.expirer.set(r,s.expiry)},this.setPendingSessionRequest=async r=>{const s=is.wc_sessionRequest.req.ttl,{id:a,topic:u,params:f,verifyContext:g}=r;await this.client.pendingRequest.set(a,{id:a,topic:u,params:f,verifyContext:g}),s&&this.client.core.expirer.set(a,kr(s))},this.sendRequest=async r=>{const{topic:s,method:a,params:u,expiry:f,relayRpcId:g,clientRpcId:b,throwOnFailedPublish:y}=r,_=An(a,u,b);if(Tn()&&Lx.includes(a)){const H=Pn(JSON.stringify(_));this.client.core.verify.register({attestationId:H})}const P=await this.client.core.crypto.encode(s,_),N=is[a].req;return f&&(N.ttl=f),g&&(N.id=g),this.client.core.history.set(s,_),y?(N.internal=ns(dr({},N.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,P,N)):this.client.core.relayer.publish(s,P,N).catch(H=>this.client.logger.error(H)),_.id},this.sendResult=async r=>{const{id:s,topic:a,result:u,throwOnFailedPublish:f}=r,g=nu(s,u),b=await this.client.core.crypto.encode(a,g),y=await this.client.core.history.get(a,s),_=is[y.request.method].res;f?(_.internal=ns(dr({},_.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(a,b,_)):this.client.core.relayer.publish(a,b,_).catch(P=>this.client.logger.error(P)),await this.client.core.history.resolve(g)},this.sendError=async(r,s,a)=>{const u=qo(r,a),f=await this.client.core.crypto.encode(s,u),g=await this.client.core.history.get(s,r),b=is[g.request.method].res;this.client.core.relayer.publish(s,f,b),await this.client.core.history.resolve(u)},this.cleanup=async()=>{const r=[],s=[];this.client.session.getAll().forEach(a=>{Ci(a.expiry)&&r.push(a.topic)}),this.client.proposal.getAll().forEach(a=>{Ci(a.expiry)&&s.push(a.id)}),await Promise.all([...r.map(a=>this.deleteSession(a)),...s.map(a=>this.deleteProposal(a))])},this.onRelayEventRequest=async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===gi.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=gi.active;const r=this.requestQueue.queue.shift();if(r)try{this.processRequest(r),await new Promise(s=>setTimeout(s,300))}catch(s){this.client.logger.warn(s)}}this.requestQueue.state=gi.idle},this.processRequest=r=>{const{topic:s,payload:a}=r,u=a.method;switch(u){case"wc_sessionPropose":return this.onSessionProposeRequest(s,a);case"wc_sessionSettle":return this.onSessionSettleRequest(s,a);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,a);case"wc_sessionExtend":return this.onSessionExtendRequest(s,a);case"wc_sessionPing":return this.onSessionPingRequest(s,a);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,a);case"wc_sessionRequest":return this.onSessionRequest(s,a);case"wc_sessionEvent":return this.onSessionEventRequest(s,a);default:return this.client.logger.info(`Unsupported request method ${u}`)}},this.onRelayEventResponse=async r=>{const{topic:s,payload:a}=r,u=(await this.client.core.history.get(s,a.id)).request.method;switch(u){case"wc_sessionPropose":return this.onSessionProposeResponse(s,a);case"wc_sessionSettle":return this.onSessionSettleResponse(s,a);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,a);case"wc_sessionExtend":return this.onSessionExtendResponse(s,a);case"wc_sessionPing":return this.onSessionPingResponse(s,a);case"wc_sessionRequest":return this.onSessionRequestResponse(s,a);default:return this.client.logger.info(`Unsupported response method ${u}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:s}=r,{message:a}=Z("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(a)},this.onSessionProposeRequest=async(r,s)=>{const{params:a,id:u}=s;try{this.isValidConnect(dr({},s.params));const f=kr(ce.FIVE_MINUTES),g=dr({id:u,pairingTopic:r,expiry:f},a);await this.setProposal(u,g);const b=Pn(JSON.stringify(s)),y=await this.getVerifyContext(b,g.proposer.metadata);this.client.events.emit("session_proposal",{id:u,params:g,verifyContext:y})}catch(f){await this.sendError(u,r,f),this.client.logger.error(f)}},this.onSessionProposeResponse=async(r,s)=>{const{id:a}=s;if(yi(s)){const{result:u}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:u});const f=this.client.proposal.get(a);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:f});const g=f.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:g});const b=u.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:b});const y=await this.client.core.crypto.generateSharedKey(g,b);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:y});const _=await this.client.core.relayer.subscribe(y);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:_}),await this.client.core.pairing.activate({topic:r})}else Hr(s)&&(await this.client.proposal.delete(a,xt("USER_DISCONNECTED")),this.events.emit(Dt("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(r,s)=>{const{id:a,params:u}=s;try{this.isValidSessionSettleRequest(u);const{relay:f,controller:g,expiry:b,namespaces:y,requiredNamespaces:_,optionalNamespaces:P,sessionProperties:N,pairingTopic:H}=s.params,$=dr({topic:r,relay:f,expiry:b,namespaces:y,acknowledged:!0,pairingTopic:H,requiredNamespaces:_,optionalNamespaces:P,controller:g.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:g.publicKey,metadata:g.metadata}},N&&{sessionProperties:N});await this.sendResult({id:s.id,topic:r,result:!0}),this.events.emit(Dt("session_connect"),{session:$}),this.cleanupDuplicatePairings($)}catch(f){await this.sendError(a,r,f),this.client.logger.error(f)}},this.onSessionSettleResponse=async(r,s)=>{const{id:a}=s;yi(s)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Dt("session_approve",a),{})):Hr(s)&&(await this.client.session.delete(r,xt("USER_DISCONNECTED")),this.events.emit(Dt("session_approve",a),{error:s.error}))},this.onSessionUpdateRequest=async(r,s)=>{const{params:a,id:u}=s;try{const f=`${r}_session_update`,g=Eo.get(f);if(g&&this.isRequestOutOfSync(g,u)){this.client.logger.info(`Discarding out of sync request - ${u}`);return}this.isValidUpdate(dr({topic:r},a)),await this.client.session.update(r,{namespaces:a.namespaces}),await this.sendResult({id:u,topic:r,result:!0}),this.client.events.emit("session_update",{id:u,topic:r,params:a}),Eo.set(f,u)}catch(f){await this.sendError(u,r,f),this.client.logger.error(f)}},this.isRequestOutOfSync=(r,s)=>parseInt(s.toString().slice(0,-3))<=parseInt(r.toString().slice(0,-3)),this.onSessionUpdateResponse=(r,s)=>{const{id:a}=s;yi(s)?this.events.emit(Dt("session_update",a),{}):Hr(s)&&this.events.emit(Dt("session_update",a),{error:s.error})},this.onSessionExtendRequest=async(r,s)=>{const{id:a}=s;try{this.isValidExtend({topic:r}),await this.setExpiry(r,kr(So)),await this.sendResult({id:a,topic:r,result:!0}),this.client.events.emit("session_extend",{id:a,topic:r})}catch(u){await this.sendError(a,r,u),this.client.logger.error(u)}},this.onSessionExtendResponse=(r,s)=>{const{id:a}=s;yi(s)?this.events.emit(Dt("session_extend",a),{}):Hr(s)&&this.events.emit(Dt("session_extend",a),{error:s.error})},this.onSessionPingRequest=async(r,s)=>{const{id:a}=s;try{this.isValidPing({topic:r}),await this.sendResult({id:a,topic:r,result:!0}),this.client.events.emit("session_ping",{id:a,topic:r})}catch(u){await this.sendError(a,r,u),this.client.logger.error(u)}},this.onSessionPingResponse=(r,s)=>{const{id:a}=s;setTimeout(()=>{yi(s)?this.events.emit(Dt("session_ping",a),{}):Hr(s)&&this.events.emit(Dt("session_ping",a),{error:s.error})},500)},this.onSessionDeleteRequest=async(r,s)=>{const{id:a}=s;try{this.isValidDisconnect({topic:r,reason:s.params}),await Promise.all([new Promise(u=>{this.client.core.relayer.once(Qt.publish,async()=>{u(await this.deleteSession(r))})}),this.sendResult({id:a,topic:r,result:!0})]),this.client.events.emit("session_delete",{id:a,topic:r})}catch(u){this.client.logger.error(u)}},this.onSessionRequest=async(r,s)=>{const{id:a,params:u}=s;try{this.isValidRequest(dr({topic:r},u));const f=Pn(JSON.stringify(An("wc_sessionRequest",u,a))),g=this.client.session.get(r),b=await this.getVerifyContext(f,g.peer.metadata),y={id:a,topic:r,params:u,verifyContext:b};await this.setPendingSessionRequest(y),this.addSessionRequestToSessionRequestQueue(y),this.processSessionRequestQueue()}catch(f){await this.sendError(a,r,f),this.client.logger.error(f)}},this.onSessionRequestResponse=(r,s)=>{const{id:a}=s;yi(s)?this.events.emit(Dt("session_request",a),{result:s.result}):Hr(s)&&this.events.emit(Dt("session_request",a),{error:s.error})},this.onSessionEventRequest=async(r,s)=>{const{id:a,params:u}=s;try{const f=`${r}_session_event_${u.event.name}`,g=Eo.get(f);if(g&&this.isRequestOutOfSync(g,a)){this.client.logger.info(`Discarding out of sync request - ${a}`);return}this.isValidEmit(dr({topic:r},u)),this.client.events.emit("session_event",{id:a,topic:r,params:u}),Eo.set(f,a)}catch(f){await this.sendError(a,r,f),this.client.logger.error(f)}},this.addSessionRequestToSessionRequestQueue=r=>{this.sessionRequestQueue.queue.push(r)},this.cleanupAfterResponse=r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=gi.idle,this.processSessionRequestQueue()},ce.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===gi.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=gi.active,this.client.events.emit("session_request",r)}catch(s){this.client.logger.error(s)}},this.onPairingCreated=r=>{if(r.active)return;const s=this.client.proposal.getAll().find(a=>a.pairingTopic===r.topic);s&&this.onSessionProposeRequest(r.topic,An("wc_sessionPropose",{requiredNamespaces:s.requiredNamespaces,optionalNamespaces:s.optionalNamespaces,relays:s.relays,proposer:s.proposer,sessionProperties:s.sessionProperties},s.id))},this.isValidConnect=async r=>{if(!gr(r)){const{message:b}=Z("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(b)}const{pairingTopic:s,requiredNamespaces:a,optionalNamespaces:u,sessionProperties:f,relays:g}=r;if(nr(s)||await this.isValidPairingTopic(s),!ab(g,!0)){const{message:b}=Z("MISSING_OR_INVALID",`connect() relays: ${g}`);throw new Error(b)}!nr(a)&&On(a)!==0&&this.validateNamespaces(a,"requiredNamespaces"),!nr(u)&&On(u)!==0&&this.validateNamespaces(u,"optionalNamespaces"),nr(f)||this.validateSessionProps(f,"sessionProperties")},this.validateNamespaces=(r,s)=>{const a=ob(r,"connect()",s);if(a)throw new Error(a.message)},this.isValidApprove=async r=>{if(!gr(r))throw new Error(Z("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:s,namespaces:a,relayProtocol:u,sessionProperties:f}=r;await this.isValidProposalId(s);const g=this.client.proposal.get(s),b=Co(a,"approve()");if(b)throw new Error(b.message);const y=Al(g.requiredNamespaces,a,"approve()");if(y)throw new Error(y.message);if(!Ht(u,!0)){const{message:_}=Z("MISSING_OR_INVALID",`approve() relayProtocol: ${u}`);throw new Error(_)}nr(f)||this.validateSessionProps(f,"sessionProperties")},this.isValidReject=async r=>{if(!gr(r)){const{message:u}=Z("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(u)}const{id:s,reason:a}=r;if(await this.isValidProposalId(s),!ub(a)){const{message:u}=Z("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(a)}`);throw new Error(u)}},this.isValidSessionSettleRequest=r=>{if(!gr(r)){const{message:y}=Z("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(y)}const{relay:s,controller:a,namespaces:u,expiry:f}=r;if(!nd(s)){const{message:y}=Z("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(y)}const g=eb(a,"onSessionSettleRequest()");if(g)throw new Error(g.message);const b=Co(u,"onSessionSettleRequest()");if(b)throw new Error(b.message);if(Ci(f)){const{message:y}=Z("EXPIRED","onSessionSettleRequest()");throw new Error(y)}},this.isValidUpdate=async r=>{if(!gr(r)){const{message:b}=Z("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(b)}const{topic:s,namespaces:a}=r;await this.isValidSessionTopic(s);const u=this.client.session.get(s),f=Co(a,"update()");if(f)throw new Error(f.message);const g=Al(u.requiredNamespaces,a,"update()");if(g)throw new Error(g.message)},this.isValidExtend=async r=>{if(!gr(r)){const{message:a}=Z("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionTopic(s)},this.isValidRequest=async r=>{if(!gr(r)){const{message:b}=Z("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(b)}const{topic:s,request:a,chainId:u,expiry:f}=r;await this.isValidSessionTopic(s);const{namespaces:g}=this.client.session.get(s);if(!Ol(g,u)){const{message:b}=Z("MISSING_OR_INVALID",`request() chainId: ${u}`);throw new Error(b)}if(!hb(a)){const{message:b}=Z("MISSING_OR_INVALID",`request() ${JSON.stringify(a)}`);throw new Error(b)}if(!db(g,u,a.method)){const{message:b}=Z("MISSING_OR_INVALID",`request() method: ${a.method}`);throw new Error(b)}if(f&&!vb(f,Oc)){const{message:b}=Z("MISSING_OR_INVALID",`request() expiry: ${f}. Expiry must be a number (in seconds) between ${Oc.min} and ${Oc.max}`);throw new Error(b)}},this.isValidRespond=async r=>{if(!gr(r)){const{message:u}=Z("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(u)}const{topic:s,response:a}=r;if(await this.isValidSessionTopic(s),!lb(a)){const{message:u}=Z("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(a)}`);throw new Error(u)}},this.isValidPing=async r=>{if(!gr(r)){const{message:a}=Z("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async r=>{if(!gr(r)){const{message:g}=Z("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(g)}const{topic:s,event:a,chainId:u}=r;await this.isValidSessionTopic(s);const{namespaces:f}=this.client.session.get(s);if(!Ol(f,u)){const{message:g}=Z("MISSING_OR_INVALID",`emit() chainId: ${u}`);throw new Error(g)}if(!fb(a)){const{message:g}=Z("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(g)}if(!pb(f,u,a.name)){const{message:g}=Z("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(g)}},this.isValidDisconnect=async r=>{if(!gr(r)){const{message:a}=Z("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(r,s)=>{const a={verified:{verifyUrl:s.verifyUrl||xn,validation:"UNKNOWN",origin:s.url||""}};try{const u=await this.client.core.verify.resolve({attestationId:r,verifyUrl:s.verifyUrl});u&&(a.verified.origin=u.origin,a.verified.isScam=u.isScam,a.verified.validation=u.origin===new URL(s.url).origin?"VALID":"INVALID")}catch(u){this.client.logger.info(u)}return this.client.logger.info(`Verify context: ${JSON.stringify(a)}`),a},this.validateSessionProps=(r,s)=>{Object.values(r).forEach(a=>{if(!Ht(a,!1)){const{message:u}=Z("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(a)}`);throw new Error(u)}})}}async isInitialized(){if(!this.initialized){const{message:t}=Z("NOT_INITIALIZED",this.name);throw new Error(t)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Qt.message,async t=>{const{topic:r,message:s}=t;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const a=await this.client.core.crypto.decode(r,s);try{su(a)?(this.client.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):zo(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.client.core.history.delete(r,a.id)):this.onRelayEventUnknownPayload({topic:r,payload:a})}catch(u){this.client.logger.error(u)}})}registerExpirerEvents(){this.client.core.expirer.on(Lr.expired,async t=>{const{topic:r,id:s}=rd(t.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,Z("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}registerPairingEvents(){this.client.core.pairing.events.on(as.create,t=>this.onPairingCreated(t))}isValidPairingTopic(t){if(!Ht(t,!1)){const{message:r}=Z("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:r}=Z("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(r)}if(Ci(this.client.core.pairing.pairings.get(t).expiry)){const{message:r}=Z("EXPIRED",`pairing topic: ${t}`);throw new Error(r)}}async isValidSessionTopic(t){if(!Ht(t,!1)){const{message:r}=Z("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(r)}if(!this.client.session.keys.includes(t)){const{message:r}=Z("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(r)}if(Ci(this.client.session.get(t).expiry)){await this.deleteSession(t);const{message:r}=Z("EXPIRED",`session topic: ${t}`);throw new Error(r)}}async isValidSessionOrPairingTopic(t){if(this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(Ht(t,!1)){const{message:r}=Z("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(r)}else{const{message:r}=Z("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(r)}}async isValidProposalId(t){if(!cb(t)){const{message:r}=Z("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(r)}if(!this.client.proposal.keys.includes(t)){const{message:r}=Z("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(r)}if(Ci(this.client.proposal.get(t).expiry)){await this.deleteProposal(t);const{message:r}=Z("EXPIRED",`proposal id: ${t}`);throw new Error(r)}}}class zx extends Ho{constructor(t,r){super(t,r,Cx,cu),this.core=t,this.logger=r}}class kx extends Ho{constructor(t,r){super(t,r,Tx,cu),this.core=t,this.logger=r}}class Hx extends Ho{constructor(t,r){super(t,r,$x,cu,s=>s.id),this.core=t,this.logger=r}}let Bx=class Ud extends w_{constructor(t){super(t),this.protocol=Dd,this.version=Fd,this.name=Pc.name,this.events=new xr.EventEmitter,this.on=(s,a)=>this.events.on(s,a),this.once=(s,a)=>this.events.once(s,a),this.off=(s,a)=>this.events.off(s,a),this.removeListener=(s,a)=>this.events.removeListener(s,a),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(a){throw this.logger.error(a.message),a}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(a){throw this.logger.error(a.message),a}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(a){throw this.logger.error(a.message),a}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(a){throw this.logger.error(a.message),a}},this.update=async s=>{try{return await this.engine.update(s)}catch(a){throw this.logger.error(a.message),a}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(a){throw this.logger.error(a.message),a}},this.request=async s=>{try{return await this.engine.request(s)}catch(a){throw this.logger.error(a.message),a}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(a){throw this.logger.error(a.message),a}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(a){throw this.logger.error(a.message),a}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(a){throw this.logger.error(a.message),a}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(a){throw this.logger.error(a.message),a}},this.find=s=>{try{return this.engine.find(s)}catch(a){throw this.logger.error(a.message),a}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=(t==null?void 0:t.name)||Pc.name,this.metadata=(t==null?void 0:t.metadata)||Sw();const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Ce.pino(Ce.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||Pc.logger}));this.core=(t==null?void 0:t.core)||new Rx(t),this.logger=Ce.generateChildLogger(r,this.name),this.session=new kx(this.core,this.logger),this.proposal=new zx(this.core,this.logger),this.pendingRequest=new Hx(this.core,this.logger),this.engine=new qx(this)}static async init(t){const r=new Ud(t);return await r.initialize(),r}get context(){return Ce.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}};var zc={exports:{}};(function(n,t){var r=typeof self<"u"?self:Br,s=function(){function u(){this.fetch=!1,this.DOMException=r.DOMException}return u.prototype=r,new u}();(function(u){(function(f){var g={searchParams:"URLSearchParams"in u,iterable:"Symbol"in u&&"iterator"in Symbol,blob:"FileReader"in u&&"Blob"in u&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in u,arrayBuffer:"ArrayBuffer"in u};function b(m){return m&&DataView.prototype.isPrototypeOf(m)}if(g.arrayBuffer)var y=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],_=ArrayBuffer.isView||function(m){return m&&y.indexOf(Object.prototype.toString.call(m))>-1};function P(m){if(typeof m!="string"&&(m=String(m)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(m))throw new TypeError("Invalid character in header field name");return m.toLowerCase()}function N(m){return typeof m!="string"&&(m=String(m)),m}function H(m){var S={next:function(){var re=m.shift();return{done:re===void 0,value:re}}};return g.iterable&&(S[Symbol.iterator]=function(){return S}),S}function $(m){this.map={},m instanceof $?m.forEach(function(S,re){this.append(re,S)},this):Array.isArray(m)?m.forEach(function(S){this.append(S[0],S[1])},this):m&&Object.getOwnPropertyNames(m).forEach(function(S){this.append(S,m[S])},this)}$.prototype.append=function(m,S){m=P(m),S=N(S);var re=this.map[m];this.map[m]=re?re+", "+S:S},$.prototype.delete=function(m){delete this.map[P(m)]},$.prototype.get=function(m){return m=P(m),this.has(m)?this.map[m]:null},$.prototype.has=function(m){return this.map.hasOwnProperty(P(m))},$.prototype.set=function(m,S){this.map[P(m)]=N(S)},$.prototype.forEach=function(m,S){for(var re in this.map)this.map.hasOwnProperty(re)&&m.call(S,this.map[re],re,this)},$.prototype.keys=function(){var m=[];return this.forEach(function(S,re){m.push(re)}),H(m)},$.prototype.values=function(){var m=[];return this.forEach(function(S){m.push(S)}),H(m)},$.prototype.entries=function(){var m=[];return this.forEach(function(S,re){m.push([re,S])}),H(m)},g.iterable&&($.prototype[Symbol.iterator]=$.prototype.entries);function Q(m){if(m.bodyUsed)return Promise.reject(new TypeError("Already read"));m.bodyUsed=!0}function se(m){return new Promise(function(S,re){m.onload=function(){S(m.result)},m.onerror=function(){re(m.error)}})}function le(m){var S=new FileReader,re=se(S);return S.readAsArrayBuffer(m),re}function C(m){var S=new FileReader,re=se(S);return S.readAsText(m),re}function D(m){for(var S=new Uint8Array(m),re=new Array(S.length),pe=0;pe<S.length;pe++)re[pe]=String.fromCharCode(S[pe]);return re.join("")}function q(m){if(m.slice)return m.slice(0);var S=new Uint8Array(m.byteLength);return S.set(new Uint8Array(m)),S.buffer}function U(){return this.bodyUsed=!1,this._initBody=function(m){this._bodyInit=m,m?typeof m=="string"?this._bodyText=m:g.blob&&Blob.prototype.isPrototypeOf(m)?this._bodyBlob=m:g.formData&&FormData.prototype.isPrototypeOf(m)?this._bodyFormData=m:g.searchParams&&URLSearchParams.prototype.isPrototypeOf(m)?this._bodyText=m.toString():g.arrayBuffer&&g.blob&&b(m)?(this._bodyArrayBuffer=q(m.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):g.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(m)||_(m))?this._bodyArrayBuffer=q(m):this._bodyText=m=Object.prototype.toString.call(m):this._bodyText="",this.headers.get("content-type")||(typeof m=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):g.searchParams&&URLSearchParams.prototype.isPrototypeOf(m)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},g.blob&&(this.blob=function(){var m=Q(this);if(m)return m;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?Q(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(le)}),this.text=function(){var m=Q(this);if(m)return m;if(this._bodyBlob)return C(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(D(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},g.formData&&(this.formData=function(){return this.text().then(ue)}),this.json=function(){return this.text().then(JSON.parse)},this}var x=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function j(m){var S=m.toUpperCase();return x.indexOf(S)>-1?S:m}function k(m,S){S=S||{};var re=S.body;if(m instanceof k){if(m.bodyUsed)throw new TypeError("Already read");this.url=m.url,this.credentials=m.credentials,S.headers||(this.headers=new $(m.headers)),this.method=m.method,this.mode=m.mode,this.signal=m.signal,!re&&m._bodyInit!=null&&(re=m._bodyInit,m.bodyUsed=!0)}else this.url=String(m);if(this.credentials=S.credentials||this.credentials||"same-origin",(S.headers||!this.headers)&&(this.headers=new $(S.headers)),this.method=j(S.method||this.method||"GET"),this.mode=S.mode||this.mode||null,this.signal=S.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&re)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(re)}k.prototype.clone=function(){return new k(this,{body:this._bodyInit})};function ue(m){var S=new FormData;return m.trim().split("&").forEach(function(re){if(re){var pe=re.split("="),Y=pe.shift().replace(/\+/g," "),W=pe.join("=").replace(/\+/g," ");S.append(decodeURIComponent(Y),decodeURIComponent(W))}}),S}function ae(m){var S=new $,re=m.replace(/\r?\n[\t ]+/g," ");return re.split(/\r?\n/).forEach(function(pe){var Y=pe.split(":"),W=Y.shift().trim();if(W){var J=Y.join(":").trim();S.append(W,J)}}),S}U.call(k.prototype);function ge(m,S){S||(S={}),this.type="default",this.status=S.status===void 0?200:S.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in S?S.statusText:"OK",this.headers=new $(S.headers),this.url=S.url||"",this._initBody(m)}U.call(ge.prototype),ge.prototype.clone=function(){return new ge(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new $(this.headers),url:this.url})},ge.error=function(){var m=new ge(null,{status:0,statusText:""});return m.type="error",m};var Te=[301,302,303,307,308];ge.redirect=function(m,S){if(Te.indexOf(S)===-1)throw new RangeError("Invalid status code");return new ge(null,{status:S,headers:{location:m}})},f.DOMException=u.DOMException;try{new f.DOMException}catch{f.DOMException=function(S,re){this.message=S,this.name=re;var pe=Error(S);this.stack=pe.stack},f.DOMException.prototype=Object.create(Error.prototype),f.DOMException.prototype.constructor=f.DOMException}function qe(m,S){return new Promise(function(re,pe){var Y=new k(m,S);if(Y.signal&&Y.signal.aborted)return pe(new f.DOMException("Aborted","AbortError"));var W=new XMLHttpRequest;function J(){W.abort()}W.onload=function(){var X={status:W.status,statusText:W.statusText,headers:ae(W.getAllResponseHeaders()||"")};X.url="responseURL"in W?W.responseURL:X.headers.get("X-Request-URL");var Qe="response"in W?W.response:W.responseText;re(new ge(Qe,X))},W.onerror=function(){pe(new TypeError("Network request failed"))},W.ontimeout=function(){pe(new TypeError("Network request failed"))},W.onabort=function(){pe(new f.DOMException("Aborted","AbortError"))},W.open(Y.method,Y.url,!0),Y.credentials==="include"?W.withCredentials=!0:Y.credentials==="omit"&&(W.withCredentials=!1),"responseType"in W&&g.blob&&(W.responseType="blob"),Y.headers.forEach(function(X,Qe){W.setRequestHeader(Qe,X)}),Y.signal&&(Y.signal.addEventListener("abort",J),W.onreadystatechange=function(){W.readyState===4&&Y.signal.removeEventListener("abort",J)}),W.send(typeof Y._bodyInit>"u"?null:Y._bodyInit)})}return qe.polyfill=!0,u.fetch||(u.fetch=qe,u.Headers=$,u.Request=k,u.Response=ge),f.Headers=$,f.Request=k,f.Response=ge,f.fetch=qe,Object.defineProperty(f,"__esModule",{value:!0}),f})({})})(s),s.fetch.ponyfill=!0,delete s.fetch.polyfill;var a=s;t=a.fetch,t.default=a.fetch,t.fetch=a.fetch,t.Headers=a.Headers,t.Request=a.Request,t.Response=a.Response,n.exports=t})(zc,zc.exports);var Kx=zc.exports;const _f=Kc(Kx),Vx={Accept:"application/json","Content-Type":"application/json"},Wx="POST",Ef={headers:Vx,method:Wx},If=10;class $i{constructor(t,r=!1){if(this.url=t,this.disableProviderPing=r,this.events=new xr.EventEmitter,this.isAvailable=!1,this.registering=!1,!Jl(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);this.url=t,this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(t,r){this.isAvailable||await this.register();try{const s=Yi(t),u=await(await _f(this.url,Object.assign(Object.assign({},Ef),{body:s}))).json();this.onPayload({data:u})}catch(s){this.onError(t.id,s)}}async register(t=this.url){if(!Jl(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,a)=>{this.events.once("register_error",u=>{this.resetMaxListeners(),a(u)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return a(new Error("HTTP connection is missing or invalid"));s()})})}this.url=t,this.registering=!0;try{if(!this.disableProviderPing){const r=Yi({id:1,jsonrpc:"2.0",method:"test",params:[]});await _f(t,Object.assign(Object.assign({},Ef),{body:r}))}this.onOpen()}catch(r){const s=this.parseError(r);throw this.events.emit("register_error",s),this.onClose(),s}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?gs(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const s=this.parseError(r),a=s.message||s.toString(),u=qo(t,a);this.events.emit("payload",u)}parseError(t,r=this.url){return yd(t,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>If&&this.events.setMaxListeners(If)}}const xf="error",Gx="wss://relay.walletconnect.com",Jx="wc",Qx="universal_provider",Sf=`${Jx}@2:${Qx}:`,Yx="https://rpc.walletconnect.com/v1/",mi={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var ss=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},kc={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(n,t){(function(){var r,s="4.17.21",a=200,u="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",f="Expected a function",g="Invalid `variable` option passed into `_.template`",b="__lodash_hash_undefined__",y=500,_="__lodash_placeholder__",P=1,N=2,H=4,$=1,Q=2,se=1,le=2,C=4,D=8,q=16,U=32,x=64,j=128,k=256,ue=512,ae=30,ge="...",Te=800,qe=16,m=1,S=2,re=3,pe=1/0,Y=9007199254740991,W=17976931348623157e292,J=0/0,X=4294967295,Qe=X-1,Be=X>>>1,Kr=[["ary",j],["bind",se],["bindKey",le],["curry",D],["curryRight",q],["flip",ue],["partial",U],["partialRight",x],["rearg",k]],Ie="[object Arguments]",St="[object Array]",M="[object AsyncFunction]",F="[object Boolean]",T="[object Date]",h="[object DOMException]",I="[object Error]",ne="[object Function]",ye="[object GeneratorFunction]",_e="[object Map]",Ne="[object Number]",Le="[object Null]",Pe="[object Object]",Pt="[object Promise]",wt="[object Proxy]",at="[object RegExp]",Fe="[object Set]",Xe="[object String]",Ze="[object Symbol]",ct="[object Undefined]",ze="[object WeakMap]",et="[object WeakSet]",$e="[object ArrayBuffer]",Ke="[object DataView]",lt="[object Float32Array]",Me="[object Float64Array]",Ot="[object Int8Array]",Ft="[object Int16Array]",Bt="[object Int32Array]",Kt="[object Uint8Array]",Ut="[object Uint8ClampedArray]",Yt="[object Uint16Array]",ar="[object Uint32Array]",Vr=/\b__p \+= '';/g,Xt=/\b(__p \+=) '' \+/g,ei=/(__e\(.*?\)|\b__t\)) \+\n'';/g,wi=/&(?:amp|lt|gt|quot|#39);/g,Li=/[&<>"']/g,ft=RegExp(wi.source),it=RegExp(Li.source),dt=/<%-([\s\S]+?)%>/g,pt=/<%([\s\S]+?)%>/g,ut=/<%=([\s\S]+?)%>/g,nt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,At=/^\w*$/,Rt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,gt=/[\\^$.*+?()[\]{}|]/g,Ct=RegExp(gt.source),yt=/^\s+/,bt=/\s/,vt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Ye=/\{\n\/\* \[wrapped with (.+)\] \*/,Tt=/,? & /,Nt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Bo=/[()=,{}\[\]\/\s]/,Ko=/\\(\\)?/g,Vo=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Sr=/\w*$/,Wo=/^[-+]0x[0-9a-f]+$/i,Go=/^0b[01]+$/i,Jo=/^\[object .+?Constructor\]$/,Qo=/^0o[0-7]+$/i,Yo=/^(?:0|[1-9]\d*)$/,ti=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,rn=/($^)/,Xo=/['\n\r\u2028\u2029\\]/g,nn="\\ud800-\\udfff",Zo="\\u0300-\\u036f",ea="\\ufe20-\\ufe2f",sn="\\u20d0-\\u20ff",vs=Zo+ea+sn,ms="\\u2700-\\u27bf",Dr="a-z\\xdf-\\xf6\\xf8-\\xff",ta="\\xac\\xb1\\xd7\\xf7",ra="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ia="\\u2000-\\u206f",na=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ws="A-Z\\xc0-\\xd6\\xd8-\\xde",bs="\\ufe0e\\ufe0f",Di=ta+ra+ia+na,Ln="['’]",Fi="["+nn+"]",Dn="["+Di+"]",ji="["+vs+"]",_s="\\d+",sa="["+ms+"]",Es="["+Dr+"]",Is="[^"+nn+Di+_s+ms+Dr+ws+"]",on="\\ud83c[\\udffb-\\udfff]",oa="(?:"+ji+"|"+on+")",xs="[^"+nn+"]",an="(?:\\ud83c[\\udde6-\\uddff]){2}",bi="[\\ud800-\\udbff][\\udc00-\\udfff]",vr="["+ws+"]",Ss="\\u200d",Ps="(?:"+Es+"|"+Is+")",Wr="(?:"+vr+"|"+Is+")",Os="(?:"+Ln+"(?:d|ll|m|re|s|t|ve))?",As="(?:"+Ln+"(?:D|LL|M|RE|S|T|VE))?",Rs=oa+"?",Cs="["+bs+"]?",aa="(?:"+Ss+"(?:"+[xs,an,bi].join("|")+")"+Cs+Rs+")*",ri="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ts="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Ns=Cs+Rs+aa,cn="(?:"+[sa,an,bi].join("|")+")"+Ns,ca="(?:"+[xs+ji+"?",ji,an,bi,Fi].join("|")+")",Fn=RegExp(Ln,"g"),ua=RegExp(ji,"g"),un=RegExp(on+"(?="+on+")|"+ca+Ns,"g"),$s=RegExp([vr+"?"+Es+"+"+Os+"(?="+[Dn,vr,"$"].join("|")+")",Wr+"+"+As+"(?="+[Dn,vr+Ps,"$"].join("|")+")",vr+"?"+Ps+"+"+Os,vr+"+"+As,Ts,ri,_s,cn].join("|"),"g"),Ls=RegExp("["+Ss+nn+vs+bs+"]"),Mi=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ds=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],ha=-1,Ve={};Ve[lt]=Ve[Me]=Ve[Ot]=Ve[Ft]=Ve[Bt]=Ve[Kt]=Ve[Ut]=Ve[Yt]=Ve[ar]=!0,Ve[Ie]=Ve[St]=Ve[$e]=Ve[F]=Ve[Ke]=Ve[T]=Ve[I]=Ve[ne]=Ve[_e]=Ve[Ne]=Ve[Pe]=Ve[at]=Ve[Fe]=Ve[Xe]=Ve[ze]=!1;var ke={};ke[Ie]=ke[St]=ke[$e]=ke[Ke]=ke[F]=ke[T]=ke[lt]=ke[Me]=ke[Ot]=ke[Ft]=ke[Bt]=ke[_e]=ke[Ne]=ke[Pe]=ke[at]=ke[Fe]=ke[Xe]=ke[Ze]=ke[Kt]=ke[Ut]=ke[Yt]=ke[ar]=!0,ke[I]=ke[ne]=ke[ze]=!1;var v={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},O={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},V={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},te={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},We=parseFloat,me=parseInt,tt=typeof ss=="object"&&ss&&ss.Object===Object&&ss,$t=typeof self=="object"&&self&&self.Object===Object&&self,Ae=tt||$t||Function("return this")(),Ge=t&&!t.nodeType&&t,_t=Ge&&!0&&n&&!n.nodeType&&n,cr=_t&&_t.exports===Ge,Lt=cr&&tt.process,rt=function(){try{var A=_t&&_t.require&&_t.require("util").types;return A||Lt&&Lt.binding&&Lt.binding("util")}catch{}}(),Zt=rt&&rt.isArrayBuffer,Fr=rt&&rt.isDate,Pr=rt&&rt.isMap,Gr=rt&&rt.isRegExp,jn=rt&&rt.isSet,Ui=rt&&rt.isTypedArray;function qt(A,z,L){switch(L.length){case 0:return A.call(z);case 1:return A.call(z,L[0]);case 2:return A.call(z,L[0],L[1]);case 3:return A.call(z,L[0],L[1],L[2])}return A.apply(z,L)}function kd(A,z,L,ie){for(var ve=-1,De=A==null?0:A.length;++ve<De;){var jt=A[ve];z(ie,jt,L(jt),A)}return ie}function Or(A,z){for(var L=-1,ie=A==null?0:A.length;++L<ie&&z(A[L],L,A)!==!1;);return A}function Hd(A,z){for(var L=A==null?0:A.length;L--&&z(A[L],L,A)!==!1;);return A}function lu(A,z){for(var L=-1,ie=A==null?0:A.length;++L<ie;)if(!z(A[L],L,A))return!1;return!0}function _i(A,z){for(var L=-1,ie=A==null?0:A.length,ve=0,De=[];++L<ie;){var jt=A[L];z(jt,L,A)&&(De[ve++]=jt)}return De}function Fs(A,z){var L=A==null?0:A.length;return!!L&&hn(A,z,0)>-1}function la(A,z,L){for(var ie=-1,ve=A==null?0:A.length;++ie<ve;)if(L(z,A[ie]))return!0;return!1}function st(A,z){for(var L=-1,ie=A==null?0:A.length,ve=Array(ie);++L<ie;)ve[L]=z(A[L],L,A);return ve}function Ei(A,z){for(var L=-1,ie=z.length,ve=A.length;++L<ie;)A[ve+L]=z[L];return A}function fa(A,z,L,ie){var ve=-1,De=A==null?0:A.length;for(ie&&De&&(L=A[++ve]);++ve<De;)L=z(L,A[ve],ve,A);return L}function Bd(A,z,L,ie){var ve=A==null?0:A.length;for(ie&&ve&&(L=A[--ve]);ve--;)L=z(L,A[ve],ve,A);return L}function da(A,z){for(var L=-1,ie=A==null?0:A.length;++L<ie;)if(z(A[L],L,A))return!0;return!1}var Kd=pa("length");function Vd(A){return A.split("")}function Wd(A){return A.match(Nt)||[]}function fu(A,z,L){var ie;return L(A,function(ve,De,jt){if(z(ve,De,jt))return ie=De,!1}),ie}function js(A,z,L,ie){for(var ve=A.length,De=L+(ie?1:-1);ie?De--:++De<ve;)if(z(A[De],De,A))return De;return-1}function hn(A,z,L){return z===z?sp(A,z,L):js(A,du,L)}function Gd(A,z,L,ie){for(var ve=L-1,De=A.length;++ve<De;)if(ie(A[ve],z))return ve;return-1}function du(A){return A!==A}function pu(A,z){var L=A==null?0:A.length;return L?ya(A,z)/L:J}function pa(A){return function(z){return z==null?r:z[A]}}function ga(A){return function(z){return A==null?r:A[z]}}function gu(A,z,L,ie,ve){return ve(A,function(De,jt,Je){L=ie?(ie=!1,De):z(L,De,jt,Je)}),L}function Jd(A,z){var L=A.length;for(A.sort(z);L--;)A[L]=A[L].value;return A}function ya(A,z){for(var L,ie=-1,ve=A.length;++ie<ve;){var De=z(A[ie]);De!==r&&(L=L===r?De:L+De)}return L}function va(A,z){for(var L=-1,ie=Array(A);++L<A;)ie[L]=z(L);return ie}function Qd(A,z){return st(z,function(L){return[L,A[L]]})}function yu(A){return A&&A.slice(0,bu(A)+1).replace(yt,"")}function mr(A){return function(z){return A(z)}}function ma(A,z){return st(z,function(L){return A[L]})}function Mn(A,z){return A.has(z)}function vu(A,z){for(var L=-1,ie=A.length;++L<ie&&hn(z,A[L],0)>-1;);return L}function mu(A,z){for(var L=A.length;L--&&hn(z,A[L],0)>-1;);return L}function Yd(A,z){for(var L=A.length,ie=0;L--;)A[L]===z&&++ie;return ie}var Xd=ga(v),Zd=ga(O);function ep(A){return"\\"+te[A]}function tp(A,z){return A==null?r:A[z]}function ln(A){return Ls.test(A)}function rp(A){return Mi.test(A)}function ip(A){for(var z,L=[];!(z=A.next()).done;)L.push(z.value);return L}function wa(A){var z=-1,L=Array(A.size);return A.forEach(function(ie,ve){L[++z]=[ve,ie]}),L}function wu(A,z){return function(L){return A(z(L))}}function Ii(A,z){for(var L=-1,ie=A.length,ve=0,De=[];++L<ie;){var jt=A[L];(jt===z||jt===_)&&(A[L]=_,De[ve++]=L)}return De}function Ms(A){var z=-1,L=Array(A.size);return A.forEach(function(ie){L[++z]=ie}),L}function np(A){var z=-1,L=Array(A.size);return A.forEach(function(ie){L[++z]=[ie,ie]}),L}function sp(A,z,L){for(var ie=L-1,ve=A.length;++ie<ve;)if(A[ie]===z)return ie;return-1}function op(A,z,L){for(var ie=L+1;ie--;)if(A[ie]===z)return ie;return ie}function fn(A){return ln(A)?cp(A):Kd(A)}function jr(A){return ln(A)?up(A):Vd(A)}function bu(A){for(var z=A.length;z--&&bt.test(A.charAt(z)););return z}var ap=ga(V);function cp(A){for(var z=un.lastIndex=0;un.test(A);)++z;return z}function up(A){return A.match(un)||[]}function hp(A){return A.match($s)||[]}var lp=function A(z){z=z==null?Ae:dn.defaults(Ae.Object(),z,dn.pick(Ae,Ds));var L=z.Array,ie=z.Date,ve=z.Error,De=z.Function,jt=z.Math,Je=z.Object,ba=z.RegExp,fp=z.String,Ar=z.TypeError,Us=L.prototype,dp=De.prototype,pn=Je.prototype,qs=z["__core-js_shared__"],zs=dp.toString,Ue=pn.hasOwnProperty,pp=0,_u=function(){var e=/[^.]+$/.exec(qs&&qs.keys&&qs.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),ks=pn.toString,gp=zs.call(Je),yp=Ae._,vp=ba("^"+zs.call(Ue).replace(gt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Hs=cr?z.Buffer:r,xi=z.Symbol,Bs=z.Uint8Array,Eu=Hs?Hs.allocUnsafe:r,Ks=wu(Je.getPrototypeOf,Je),Iu=Je.create,xu=pn.propertyIsEnumerable,Vs=Us.splice,Su=xi?xi.isConcatSpreadable:r,Un=xi?xi.iterator:r,qi=xi?xi.toStringTag:r,Ws=function(){try{var e=Ki(Je,"defineProperty");return e({},"",{}),e}catch{}}(),mp=z.clearTimeout!==Ae.clearTimeout&&z.clearTimeout,wp=ie&&ie.now!==Ae.Date.now&&ie.now,bp=z.setTimeout!==Ae.setTimeout&&z.setTimeout,Gs=jt.ceil,Js=jt.floor,_a=Je.getOwnPropertySymbols,_p=Hs?Hs.isBuffer:r,Pu=z.isFinite,Ep=Us.join,Ip=wu(Je.keys,Je),Mt=jt.max,Gt=jt.min,xp=ie.now,Sp=z.parseInt,Ou=jt.random,Pp=Us.reverse,Ea=Ki(z,"DataView"),qn=Ki(z,"Map"),Ia=Ki(z,"Promise"),gn=Ki(z,"Set"),zn=Ki(z,"WeakMap"),kn=Ki(Je,"create"),Qs=zn&&new zn,yn={},Op=Vi(Ea),Ap=Vi(qn),Rp=Vi(Ia),Cp=Vi(gn),Tp=Vi(zn),Ys=xi?xi.prototype:r,Hn=Ys?Ys.valueOf:r,Au=Ys?Ys.toString:r;function d(e){if(mt(e)&&!we(e)&&!(e instanceof Oe)){if(e instanceof Rr)return e;if(Ue.call(e,"__wrapped__"))return Rh(e)}return new Rr(e)}var vn=function(){function e(){}return function(i){if(!ht(i))return{};if(Iu)return Iu(i);e.prototype=i;var o=new e;return e.prototype=r,o}}();function Xs(){}function Rr(e,i){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=r}d.templateSettings={escape:dt,evaluate:pt,interpolate:ut,variable:"",imports:{_:d}},d.prototype=Xs.prototype,d.prototype.constructor=d,Rr.prototype=vn(Xs.prototype),Rr.prototype.constructor=Rr;function Oe(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=X,this.__views__=[]}function Np(){var e=new Oe(this.__wrapped__);return e.__actions__=ur(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=ur(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=ur(this.__views__),e}function $p(){if(this.__filtered__){var e=new Oe(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function Lp(){var e=this.__wrapped__.value(),i=this.__dir__,o=we(e),c=i<0,l=o?e.length:0,p=Vg(0,l,this.__views__),w=p.start,E=p.end,R=E-w,B=c?E:w-1,K=this.__iteratees__,G=K.length,ee=0,oe=Gt(R,this.__takeCount__);if(!o||!c&&l==R&&oe==R)return Xu(e,this.__actions__);var fe=[];e:for(;R--&&ee<oe;){B+=i;for(var Ee=-1,de=e[B];++Ee<G;){var Se=K[Ee],Re=Se.iteratee,_r=Se.type,rr=Re(de);if(_r==S)de=rr;else if(!rr){if(_r==m)continue e;break e}}fe[ee++]=de}return fe}Oe.prototype=vn(Xs.prototype),Oe.prototype.constructor=Oe;function zi(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var c=e[i];this.set(c[0],c[1])}}function Dp(){this.__data__=kn?kn(null):{},this.size=0}function Fp(e){var i=this.has(e)&&delete this.__data__[e];return this.size-=i?1:0,i}function jp(e){var i=this.__data__;if(kn){var o=i[e];return o===b?r:o}return Ue.call(i,e)?i[e]:r}function Mp(e){var i=this.__data__;return kn?i[e]!==r:Ue.call(i,e)}function Up(e,i){var o=this.__data__;return this.size+=this.has(e)?0:1,o[e]=kn&&i===r?b:i,this}zi.prototype.clear=Dp,zi.prototype.delete=Fp,zi.prototype.get=jp,zi.prototype.has=Mp,zi.prototype.set=Up;function ii(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var c=e[i];this.set(c[0],c[1])}}function qp(){this.__data__=[],this.size=0}function zp(e){var i=this.__data__,o=Zs(i,e);if(o<0)return!1;var c=i.length-1;return o==c?i.pop():Vs.call(i,o,1),--this.size,!0}function kp(e){var i=this.__data__,o=Zs(i,e);return o<0?r:i[o][1]}function Hp(e){return Zs(this.__data__,e)>-1}function Bp(e,i){var o=this.__data__,c=Zs(o,e);return c<0?(++this.size,o.push([e,i])):o[c][1]=i,this}ii.prototype.clear=qp,ii.prototype.delete=zp,ii.prototype.get=kp,ii.prototype.has=Hp,ii.prototype.set=Bp;function ni(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var c=e[i];this.set(c[0],c[1])}}function Kp(){this.size=0,this.__data__={hash:new zi,map:new(qn||ii),string:new zi}}function Vp(e){var i=lo(this,e).delete(e);return this.size-=i?1:0,i}function Wp(e){return lo(this,e).get(e)}function Gp(e){return lo(this,e).has(e)}function Jp(e,i){var o=lo(this,e),c=o.size;return o.set(e,i),this.size+=o.size==c?0:1,this}ni.prototype.clear=Kp,ni.prototype.delete=Vp,ni.prototype.get=Wp,ni.prototype.has=Gp,ni.prototype.set=Jp;function ki(e){var i=-1,o=e==null?0:e.length;for(this.__data__=new ni;++i<o;)this.add(e[i])}function Qp(e){return this.__data__.set(e,b),this}function Yp(e){return this.__data__.has(e)}ki.prototype.add=ki.prototype.push=Qp,ki.prototype.has=Yp;function Mr(e){var i=this.__data__=new ii(e);this.size=i.size}function Xp(){this.__data__=new ii,this.size=0}function Zp(e){var i=this.__data__,o=i.delete(e);return this.size=i.size,o}function eg(e){return this.__data__.get(e)}function tg(e){return this.__data__.has(e)}function rg(e,i){var o=this.__data__;if(o instanceof ii){var c=o.__data__;if(!qn||c.length<a-1)return c.push([e,i]),this.size=++o.size,this;o=this.__data__=new ni(c)}return o.set(e,i),this.size=o.size,this}Mr.prototype.clear=Xp,Mr.prototype.delete=Zp,Mr.prototype.get=eg,Mr.prototype.has=tg,Mr.prototype.set=rg;function Ru(e,i){var o=we(e),c=!o&&Wi(e),l=!o&&!c&&Ri(e),p=!o&&!c&&!l&&_n(e),w=o||c||l||p,E=w?va(e.length,fp):[],R=E.length;for(var B in e)(i||Ue.call(e,B))&&!(w&&(B=="length"||l&&(B=="offset"||B=="parent")||p&&(B=="buffer"||B=="byteLength"||B=="byteOffset")||ci(B,R)))&&E.push(B);return E}function Cu(e){var i=e.length;return i?e[La(0,i-1)]:r}function ig(e,i){return fo(ur(e),Hi(i,0,e.length))}function ng(e){return fo(ur(e))}function xa(e,i,o){(o!==r&&!Ur(e[i],o)||o===r&&!(i in e))&&si(e,i,o)}function Bn(e,i,o){var c=e[i];(!(Ue.call(e,i)&&Ur(c,o))||o===r&&!(i in e))&&si(e,i,o)}function Zs(e,i){for(var o=e.length;o--;)if(Ur(e[o][0],i))return o;return-1}function sg(e,i,o,c){return Si(e,function(l,p,w){i(c,l,o(l),w)}),c}function Tu(e,i){return e&&Qr(i,zt(i),e)}function og(e,i){return e&&Qr(i,lr(i),e)}function si(e,i,o){i=="__proto__"&&Ws?Ws(e,i,{configurable:!0,enumerable:!0,value:o,writable:!0}):e[i]=o}function Sa(e,i){for(var o=-1,c=i.length,l=L(c),p=e==null;++o<c;)l[o]=p?r:sc(e,i[o]);return l}function Hi(e,i,o){return e===e&&(o!==r&&(e=e<=o?e:o),i!==r&&(e=e>=i?e:i)),e}function Cr(e,i,o,c,l,p){var w,E=i&P,R=i&N,B=i&H;if(o&&(w=l?o(e,c,l,p):o(e)),w!==r)return w;if(!ht(e))return e;var K=we(e);if(K){if(w=Gg(e),!E)return ur(e,w)}else{var G=Jt(e),ee=G==ne||G==ye;if(Ri(e))return th(e,E);if(G==Pe||G==Ie||ee&&!l){if(w=R||ee?{}:bh(e),!E)return R?jg(e,og(w,e)):Fg(e,Tu(w,e))}else{if(!ke[G])return l?e:{};w=Jg(e,G,E)}}p||(p=new Mr);var oe=p.get(e);if(oe)return oe;p.set(e,w),Jh(e)?e.forEach(function(de){w.add(Cr(de,i,o,de,e,p))}):Wh(e)&&e.forEach(function(de,Se){w.set(Se,Cr(de,i,o,Se,e,p))});var fe=B?R?Ka:Ba:R?lr:zt,Ee=K?r:fe(e);return Or(Ee||e,function(de,Se){Ee&&(Se=de,de=e[Se]),Bn(w,Se,Cr(de,i,o,Se,e,p))}),w}function ag(e){var i=zt(e);return function(o){return Nu(o,e,i)}}function Nu(e,i,o){var c=o.length;if(e==null)return!c;for(e=Je(e);c--;){var l=o[c],p=i[l],w=e[l];if(w===r&&!(l in e)||!p(w))return!1}return!0}function $u(e,i,o){if(typeof e!="function")throw new Ar(f);return Yn(function(){e.apply(r,o)},i)}function Kn(e,i,o,c){var l=-1,p=Fs,w=!0,E=e.length,R=[],B=i.length;if(!E)return R;o&&(i=st(i,mr(o))),c?(p=la,w=!1):i.length>=a&&(p=Mn,w=!1,i=new ki(i));e:for(;++l<E;){var K=e[l],G=o==null?K:o(K);if(K=c||K!==0?K:0,w&&G===G){for(var ee=B;ee--;)if(i[ee]===G)continue e;R.push(K)}else p(i,G,c)||R.push(K)}return R}var Si=oh(Jr),Lu=oh(Oa,!0);function cg(e,i){var o=!0;return Si(e,function(c,l,p){return o=!!i(c,l,p),o}),o}function eo(e,i,o){for(var c=-1,l=e.length;++c<l;){var p=e[c],w=i(p);if(w!=null&&(E===r?w===w&&!br(w):o(w,E)))var E=w,R=p}return R}function ug(e,i,o,c){var l=e.length;for(o=be(o),o<0&&(o=-o>l?0:l+o),c=c===r||c>l?l:be(c),c<0&&(c+=l),c=o>c?0:Yh(c);o<c;)e[o++]=i;return e}function Du(e,i){var o=[];return Si(e,function(c,l,p){i(c,l,p)&&o.push(c)}),o}function Vt(e,i,o,c,l){var p=-1,w=e.length;for(o||(o=Yg),l||(l=[]);++p<w;){var E=e[p];i>0&&o(E)?i>1?Vt(E,i-1,o,c,l):Ei(l,E):c||(l[l.length]=E)}return l}var Pa=ah(),Fu=ah(!0);function Jr(e,i){return e&&Pa(e,i,zt)}function Oa(e,i){return e&&Fu(e,i,zt)}function to(e,i){return _i(i,function(o){return ui(e[o])})}function Bi(e,i){i=Oi(i,e);for(var o=0,c=i.length;e!=null&&o<c;)e=e[Yr(i[o++])];return o&&o==c?e:r}function ju(e,i,o){var c=i(e);return we(e)?c:Ei(c,o(e))}function er(e){return e==null?e===r?ct:Le:qi&&qi in Je(e)?Kg(e):ny(e)}function Aa(e,i){return e>i}function hg(e,i){return e!=null&&Ue.call(e,i)}function lg(e,i){return e!=null&&i in Je(e)}function fg(e,i,o){return e>=Gt(i,o)&&e<Mt(i,o)}function Ra(e,i,o){for(var c=o?la:Fs,l=e[0].length,p=e.length,w=p,E=L(p),R=1/0,B=[];w--;){var K=e[w];w&&i&&(K=st(K,mr(i))),R=Gt(K.length,R),E[w]=!o&&(i||l>=120&&K.length>=120)?new ki(w&&K):r}K=e[0];var G=-1,ee=E[0];e:for(;++G<l&&B.length<R;){var oe=K[G],fe=i?i(oe):oe;if(oe=o||oe!==0?oe:0,!(ee?Mn(ee,fe):c(B,fe,o))){for(w=p;--w;){var Ee=E[w];if(!(Ee?Mn(Ee,fe):c(e[w],fe,o)))continue e}ee&&ee.push(fe),B.push(oe)}}return B}function dg(e,i,o,c){return Jr(e,function(l,p,w){i(c,o(l),p,w)}),c}function Vn(e,i,o){i=Oi(i,e),e=xh(e,i);var c=e==null?e:e[Yr(Nr(i))];return c==null?r:qt(c,e,o)}function Mu(e){return mt(e)&&er(e)==Ie}function pg(e){return mt(e)&&er(e)==$e}function gg(e){return mt(e)&&er(e)==T}function Wn(e,i,o,c,l){return e===i?!0:e==null||i==null||!mt(e)&&!mt(i)?e!==e&&i!==i:yg(e,i,o,c,Wn,l)}function yg(e,i,o,c,l,p){var w=we(e),E=we(i),R=w?St:Jt(e),B=E?St:Jt(i);R=R==Ie?Pe:R,B=B==Ie?Pe:B;var K=R==Pe,G=B==Pe,ee=R==B;if(ee&&Ri(e)){if(!Ri(i))return!1;w=!0,K=!1}if(ee&&!K)return p||(p=new Mr),w||_n(e)?vh(e,i,o,c,l,p):Hg(e,i,R,o,c,l,p);if(!(o&$)){var oe=K&&Ue.call(e,"__wrapped__"),fe=G&&Ue.call(i,"__wrapped__");if(oe||fe){var Ee=oe?e.value():e,de=fe?i.value():i;return p||(p=new Mr),l(Ee,de,o,c,p)}}return ee?(p||(p=new Mr),Bg(e,i,o,c,l,p)):!1}function vg(e){return mt(e)&&Jt(e)==_e}function Ca(e,i,o,c){var l=o.length,p=l,w=!c;if(e==null)return!p;for(e=Je(e);l--;){var E=o[l];if(w&&E[2]?E[1]!==e[E[0]]:!(E[0]in e))return!1}for(;++l<p;){E=o[l];var R=E[0],B=e[R],K=E[1];if(w&&E[2]){if(B===r&&!(R in e))return!1}else{var G=new Mr;if(c)var ee=c(B,K,R,e,i,G);if(!(ee===r?Wn(K,B,$|Q,c,G):ee))return!1}}return!0}function Uu(e){if(!ht(e)||Zg(e))return!1;var i=ui(e)?vp:Jo;return i.test(Vi(e))}function mg(e){return mt(e)&&er(e)==at}function wg(e){return mt(e)&&Jt(e)==Fe}function bg(e){return mt(e)&&wo(e.length)&&!!Ve[er(e)]}function qu(e){return typeof e=="function"?e:e==null?fr:typeof e=="object"?we(e)?Hu(e[0],e[1]):ku(e):cl(e)}function Ta(e){if(!Qn(e))return Ip(e);var i=[];for(var o in Je(e))Ue.call(e,o)&&o!="constructor"&&i.push(o);return i}function _g(e){if(!ht(e))return iy(e);var i=Qn(e),o=[];for(var c in e)c=="constructor"&&(i||!Ue.call(e,c))||o.push(c);return o}function Na(e,i){return e<i}function zu(e,i){var o=-1,c=hr(e)?L(e.length):[];return Si(e,function(l,p,w){c[++o]=i(l,p,w)}),c}function ku(e){var i=Wa(e);return i.length==1&&i[0][2]?Eh(i[0][0],i[0][1]):function(o){return o===e||Ca(o,e,i)}}function Hu(e,i){return Ja(e)&&_h(i)?Eh(Yr(e),i):function(o){var c=sc(o,e);return c===r&&c===i?oc(o,e):Wn(i,c,$|Q)}}function ro(e,i,o,c,l){e!==i&&Pa(i,function(p,w){if(l||(l=new Mr),ht(p))Eg(e,i,w,o,ro,c,l);else{var E=c?c(Ya(e,w),p,w+"",e,i,l):r;E===r&&(E=p),xa(e,w,E)}},lr)}function Eg(e,i,o,c,l,p,w){var E=Ya(e,o),R=Ya(i,o),B=w.get(R);if(B){xa(e,o,B);return}var K=p?p(E,R,o+"",e,i,w):r,G=K===r;if(G){var ee=we(R),oe=!ee&&Ri(R),fe=!ee&&!oe&&_n(R);K=R,ee||oe||fe?we(E)?K=E:Et(E)?K=ur(E):oe?(G=!1,K=th(R,!0)):fe?(G=!1,K=rh(R,!0)):K=[]:Xn(R)||Wi(R)?(K=E,Wi(E)?K=Xh(E):(!ht(E)||ui(E))&&(K=bh(R))):G=!1}G&&(w.set(R,K),l(K,R,c,p,w),w.delete(R)),xa(e,o,K)}function Bu(e,i){var o=e.length;if(o)return i+=i<0?o:0,ci(i,o)?e[i]:r}function Ku(e,i,o){i.length?i=st(i,function(p){return we(p)?function(w){return Bi(w,p.length===1?p[0]:p)}:p}):i=[fr];var c=-1;i=st(i,mr(he()));var l=zu(e,function(p,w,E){var R=st(i,function(B){return B(p)});return{criteria:R,index:++c,value:p}});return Jd(l,function(p,w){return Dg(p,w,o)})}function Ig(e,i){return Vu(e,i,function(o,c){return oc(e,c)})}function Vu(e,i,o){for(var c=-1,l=i.length,p={};++c<l;){var w=i[c],E=Bi(e,w);o(E,w)&&Gn(p,Oi(w,e),E)}return p}function xg(e){return function(i){return Bi(i,e)}}function $a(e,i,o,c){var l=c?Gd:hn,p=-1,w=i.length,E=e;for(e===i&&(i=ur(i)),o&&(E=st(e,mr(o)));++p<w;)for(var R=0,B=i[p],K=o?o(B):B;(R=l(E,K,R,c))>-1;)E!==e&&Vs.call(E,R,1),Vs.call(e,R,1);return e}function Wu(e,i){for(var o=e?i.length:0,c=o-1;o--;){var l=i[o];if(o==c||l!==p){var p=l;ci(l)?Vs.call(e,l,1):ja(e,l)}}return e}function La(e,i){return e+Js(Ou()*(i-e+1))}function Sg(e,i,o,c){for(var l=-1,p=Mt(Gs((i-e)/(o||1)),0),w=L(p);p--;)w[c?p:++l]=e,e+=o;return w}function Da(e,i){var o="";if(!e||i<1||i>Y)return o;do i%2&&(o+=e),i=Js(i/2),i&&(e+=e);while(i);return o}function xe(e,i){return Xa(Ih(e,i,fr),e+"")}function Pg(e){return Cu(En(e))}function Og(e,i){var o=En(e);return fo(o,Hi(i,0,o.length))}function Gn(e,i,o,c){if(!ht(e))return e;i=Oi(i,e);for(var l=-1,p=i.length,w=p-1,E=e;E!=null&&++l<p;){var R=Yr(i[l]),B=o;if(R==="__proto__"||R==="constructor"||R==="prototype")return e;if(l!=w){var K=E[R];B=c?c(K,R,E):r,B===r&&(B=ht(K)?K:ci(i[l+1])?[]:{})}Bn(E,R,B),E=E[R]}return e}var Gu=Qs?function(e,i){return Qs.set(e,i),e}:fr,Ag=Ws?function(e,i){return Ws(e,"toString",{configurable:!0,enumerable:!1,value:cc(i),writable:!0})}:fr;function Rg(e){return fo(En(e))}function Tr(e,i,o){var c=-1,l=e.length;i<0&&(i=-i>l?0:l+i),o=o>l?l:o,o<0&&(o+=l),l=i>o?0:o-i>>>0,i>>>=0;for(var p=L(l);++c<l;)p[c]=e[c+i];return p}function Cg(e,i){var o;return Si(e,function(c,l,p){return o=i(c,l,p),!o}),!!o}function io(e,i,o){var c=0,l=e==null?c:e.length;if(typeof i=="number"&&i===i&&l<=Be){for(;c<l;){var p=c+l>>>1,w=e[p];w!==null&&!br(w)&&(o?w<=i:w<i)?c=p+1:l=p}return l}return Fa(e,i,fr,o)}function Fa(e,i,o,c){var l=0,p=e==null?0:e.length;if(p===0)return 0;i=o(i);for(var w=i!==i,E=i===null,R=br(i),B=i===r;l<p;){var K=Js((l+p)/2),G=o(e[K]),ee=G!==r,oe=G===null,fe=G===G,Ee=br(G);if(w)var de=c||fe;else B?de=fe&&(c||ee):E?de=fe&&ee&&(c||!oe):R?de=fe&&ee&&!oe&&(c||!Ee):oe||Ee?de=!1:de=c?G<=i:G<i;de?l=K+1:p=K}return Gt(p,Qe)}function Ju(e,i){for(var o=-1,c=e.length,l=0,p=[];++o<c;){var w=e[o],E=i?i(w):w;if(!o||!Ur(E,R)){var R=E;p[l++]=w===0?0:w}}return p}function Qu(e){return typeof e=="number"?e:br(e)?J:+e}function wr(e){if(typeof e=="string")return e;if(we(e))return st(e,wr)+"";if(br(e))return Au?Au.call(e):"";var i=e+"";return i=="0"&&1/e==-pe?"-0":i}function Pi(e,i,o){var c=-1,l=Fs,p=e.length,w=!0,E=[],R=E;if(o)w=!1,l=la;else if(p>=a){var B=i?null:zg(e);if(B)return Ms(B);w=!1,l=Mn,R=new ki}else R=i?[]:E;e:for(;++c<p;){var K=e[c],G=i?i(K):K;if(K=o||K!==0?K:0,w&&G===G){for(var ee=R.length;ee--;)if(R[ee]===G)continue e;i&&R.push(G),E.push(K)}else l(R,G,o)||(R!==E&&R.push(G),E.push(K))}return E}function ja(e,i){return i=Oi(i,e),e=xh(e,i),e==null||delete e[Yr(Nr(i))]}function Yu(e,i,o,c){return Gn(e,i,o(Bi(e,i)),c)}function no(e,i,o,c){for(var l=e.length,p=c?l:-1;(c?p--:++p<l)&&i(e[p],p,e););return o?Tr(e,c?0:p,c?p+1:l):Tr(e,c?p+1:0,c?l:p)}function Xu(e,i){var o=e;return o instanceof Oe&&(o=o.value()),fa(i,function(c,l){return l.func.apply(l.thisArg,Ei([c],l.args))},o)}function Ma(e,i,o){var c=e.length;if(c<2)return c?Pi(e[0]):[];for(var l=-1,p=L(c);++l<c;)for(var w=e[l],E=-1;++E<c;)E!=l&&(p[l]=Kn(p[l]||w,e[E],i,o));return Pi(Vt(p,1),i,o)}function Zu(e,i,o){for(var c=-1,l=e.length,p=i.length,w={};++c<l;){var E=c<p?i[c]:r;o(w,e[c],E)}return w}function Ua(e){return Et(e)?e:[]}function qa(e){return typeof e=="function"?e:fr}function Oi(e,i){return we(e)?e:Ja(e,i)?[e]:Ah(je(e))}var Tg=xe;function Ai(e,i,o){var c=e.length;return o=o===r?c:o,!i&&o>=c?e:Tr(e,i,o)}var eh=mp||function(e){return Ae.clearTimeout(e)};function th(e,i){if(i)return e.slice();var o=e.length,c=Eu?Eu(o):new e.constructor(o);return e.copy(c),c}function za(e){var i=new e.constructor(e.byteLength);return new Bs(i).set(new Bs(e)),i}function Ng(e,i){var o=i?za(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.byteLength)}function $g(e){var i=new e.constructor(e.source,Sr.exec(e));return i.lastIndex=e.lastIndex,i}function Lg(e){return Hn?Je(Hn.call(e)):{}}function rh(e,i){var o=i?za(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.length)}function ih(e,i){if(e!==i){var o=e!==r,c=e===null,l=e===e,p=br(e),w=i!==r,E=i===null,R=i===i,B=br(i);if(!E&&!B&&!p&&e>i||p&&w&&R&&!E&&!B||c&&w&&R||!o&&R||!l)return 1;if(!c&&!p&&!B&&e<i||B&&o&&l&&!c&&!p||E&&o&&l||!w&&l||!R)return-1}return 0}function Dg(e,i,o){for(var c=-1,l=e.criteria,p=i.criteria,w=l.length,E=o.length;++c<w;){var R=ih(l[c],p[c]);if(R){if(c>=E)return R;var B=o[c];return R*(B=="desc"?-1:1)}}return e.index-i.index}function nh(e,i,o,c){for(var l=-1,p=e.length,w=o.length,E=-1,R=i.length,B=Mt(p-w,0),K=L(R+B),G=!c;++E<R;)K[E]=i[E];for(;++l<w;)(G||l<p)&&(K[o[l]]=e[l]);for(;B--;)K[E++]=e[l++];return K}function sh(e,i,o,c){for(var l=-1,p=e.length,w=-1,E=o.length,R=-1,B=i.length,K=Mt(p-E,0),G=L(K+B),ee=!c;++l<K;)G[l]=e[l];for(var oe=l;++R<B;)G[oe+R]=i[R];for(;++w<E;)(ee||l<p)&&(G[oe+o[w]]=e[l++]);return G}function ur(e,i){var o=-1,c=e.length;for(i||(i=L(c));++o<c;)i[o]=e[o];return i}function Qr(e,i,o,c){var l=!o;o||(o={});for(var p=-1,w=i.length;++p<w;){var E=i[p],R=c?c(o[E],e[E],E,o,e):r;R===r&&(R=e[E]),l?si(o,E,R):Bn(o,E,R)}return o}function Fg(e,i){return Qr(e,Ga(e),i)}function jg(e,i){return Qr(e,mh(e),i)}function so(e,i){return function(o,c){var l=we(o)?kd:sg,p=i?i():{};return l(o,e,he(c,2),p)}}function mn(e){return xe(function(i,o){var c=-1,l=o.length,p=l>1?o[l-1]:r,w=l>2?o[2]:r;for(p=e.length>3&&typeof p=="function"?(l--,p):r,w&&tr(o[0],o[1],w)&&(p=l<3?r:p,l=1),i=Je(i);++c<l;){var E=o[c];E&&e(i,E,c,p)}return i})}function oh(e,i){return function(o,c){if(o==null)return o;if(!hr(o))return e(o,c);for(var l=o.length,p=i?l:-1,w=Je(o);(i?p--:++p<l)&&c(w[p],p,w)!==!1;);return o}}function ah(e){return function(i,o,c){for(var l=-1,p=Je(i),w=c(i),E=w.length;E--;){var R=w[e?E:++l];if(o(p[R],R,p)===!1)break}return i}}function Mg(e,i,o){var c=i&se,l=Jn(e);function p(){var w=this&&this!==Ae&&this instanceof p?l:e;return w.apply(c?o:this,arguments)}return p}function ch(e){return function(i){i=je(i);var o=ln(i)?jr(i):r,c=o?o[0]:i.charAt(0),l=o?Ai(o,1).join(""):i.slice(1);return c[e]()+l}}function wn(e){return function(i){return fa(ol(sl(i).replace(Fn,"")),e,"")}}function Jn(e){return function(){var i=arguments;switch(i.length){case 0:return new e;case 1:return new e(i[0]);case 2:return new e(i[0],i[1]);case 3:return new e(i[0],i[1],i[2]);case 4:return new e(i[0],i[1],i[2],i[3]);case 5:return new e(i[0],i[1],i[2],i[3],i[4]);case 6:return new e(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new e(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var o=vn(e.prototype),c=e.apply(o,i);return ht(c)?c:o}}function Ug(e,i,o){var c=Jn(e);function l(){for(var p=arguments.length,w=L(p),E=p,R=bn(l);E--;)w[E]=arguments[E];var B=p<3&&w[0]!==R&&w[p-1]!==R?[]:Ii(w,R);if(p-=B.length,p<o)return dh(e,i,oo,l.placeholder,r,w,B,r,r,o-p);var K=this&&this!==Ae&&this instanceof l?c:e;return qt(K,this,w)}return l}function uh(e){return function(i,o,c){var l=Je(i);if(!hr(i)){var p=he(o,3);i=zt(i),o=function(E){return p(l[E],E,l)}}var w=e(i,o,c);return w>-1?l[p?i[w]:w]:r}}function hh(e){return ai(function(i){var o=i.length,c=o,l=Rr.prototype.thru;for(e&&i.reverse();c--;){var p=i[c];if(typeof p!="function")throw new Ar(f);if(l&&!w&&ho(p)=="wrapper")var w=new Rr([],!0)}for(c=w?c:o;++c<o;){p=i[c];var E=ho(p),R=E=="wrapper"?Va(p):r;R&&Qa(R[0])&&R[1]==(j|D|U|k)&&!R[4].length&&R[9]==1?w=w[ho(R[0])].apply(w,R[3]):w=p.length==1&&Qa(p)?w[E]():w.thru(p)}return function(){var B=arguments,K=B[0];if(w&&B.length==1&&we(K))return w.plant(K).value();for(var G=0,ee=o?i[G].apply(this,B):K;++G<o;)ee=i[G].call(this,ee);return ee}})}function oo(e,i,o,c,l,p,w,E,R,B){var K=i&j,G=i&se,ee=i&le,oe=i&(D|q),fe=i&ue,Ee=ee?r:Jn(e);function de(){for(var Se=arguments.length,Re=L(Se),_r=Se;_r--;)Re[_r]=arguments[_r];if(oe)var rr=bn(de),Er=Yd(Re,rr);if(c&&(Re=nh(Re,c,l,oe)),p&&(Re=sh(Re,p,w,oe)),Se-=Er,oe&&Se<B){var It=Ii(Re,rr);return dh(e,i,oo,de.placeholder,o,Re,It,E,R,B-Se)}var qr=G?o:this,li=ee?qr[e]:e;return Se=Re.length,E?Re=sy(Re,E):fe&&Se>1&&Re.reverse(),K&&R<Se&&(Re.length=R),this&&this!==Ae&&this instanceof de&&(li=Ee||Jn(li)),li.apply(qr,Re)}return de}function lh(e,i){return function(o,c){return dg(o,e,i(c),{})}}function ao(e,i){return function(o,c){var l;if(o===r&&c===r)return i;if(o!==r&&(l=o),c!==r){if(l===r)return c;typeof o=="string"||typeof c=="string"?(o=wr(o),c=wr(c)):(o=Qu(o),c=Qu(c)),l=e(o,c)}return l}}function ka(e){return ai(function(i){return i=st(i,mr(he())),xe(function(o){var c=this;return e(i,function(l){return qt(l,c,o)})})})}function co(e,i){i=i===r?" ":wr(i);var o=i.length;if(o<2)return o?Da(i,e):i;var c=Da(i,Gs(e/fn(i)));return ln(i)?Ai(jr(c),0,e).join(""):c.slice(0,e)}function qg(e,i,o,c){var l=i&se,p=Jn(e);function w(){for(var E=-1,R=arguments.length,B=-1,K=c.length,G=L(K+R),ee=this&&this!==Ae&&this instanceof w?p:e;++B<K;)G[B]=c[B];for(;R--;)G[B++]=arguments[++E];return qt(ee,l?o:this,G)}return w}function fh(e){return function(i,o,c){return c&&typeof c!="number"&&tr(i,o,c)&&(o=c=r),i=hi(i),o===r?(o=i,i=0):o=hi(o),c=c===r?i<o?1:-1:hi(c),Sg(i,o,c,e)}}function uo(e){return function(i,o){return typeof i=="string"&&typeof o=="string"||(i=$r(i),o=$r(o)),e(i,o)}}function dh(e,i,o,c,l,p,w,E,R,B){var K=i&D,G=K?w:r,ee=K?r:w,oe=K?p:r,fe=K?r:p;i|=K?U:x,i&=~(K?x:U),i&C||(i&=~(se|le));var Ee=[e,i,l,oe,G,fe,ee,E,R,B],de=o.apply(r,Ee);return Qa(e)&&Sh(de,Ee),de.placeholder=c,Ph(de,e,i)}function Ha(e){var i=jt[e];return function(o,c){if(o=$r(o),c=c==null?0:Gt(be(c),292),c&&Pu(o)){var l=(je(o)+"e").split("e"),p=i(l[0]+"e"+(+l[1]+c));return l=(je(p)+"e").split("e"),+(l[0]+"e"+(+l[1]-c))}return i(o)}}var zg=gn&&1/Ms(new gn([,-0]))[1]==pe?function(e){return new gn(e)}:lc;function ph(e){return function(i){var o=Jt(i);return o==_e?wa(i):o==Fe?np(i):Qd(i,e(i))}}function oi(e,i,o,c,l,p,w,E){var R=i&le;if(!R&&typeof e!="function")throw new Ar(f);var B=c?c.length:0;if(B||(i&=~(U|x),c=l=r),w=w===r?w:Mt(be(w),0),E=E===r?E:be(E),B-=l?l.length:0,i&x){var K=c,G=l;c=l=r}var ee=R?r:Va(e),oe=[e,i,o,c,l,K,G,p,w,E];if(ee&&ry(oe,ee),e=oe[0],i=oe[1],o=oe[2],c=oe[3],l=oe[4],E=oe[9]=oe[9]===r?R?0:e.length:Mt(oe[9]-B,0),!E&&i&(D|q)&&(i&=~(D|q)),!i||i==se)var fe=Mg(e,i,o);else i==D||i==q?fe=Ug(e,i,E):(i==U||i==(se|U))&&!l.length?fe=qg(e,i,o,c):fe=oo.apply(r,oe);var Ee=ee?Gu:Sh;return Ph(Ee(fe,oe),e,i)}function gh(e,i,o,c){return e===r||Ur(e,pn[o])&&!Ue.call(c,o)?i:e}function yh(e,i,o,c,l,p){return ht(e)&&ht(i)&&(p.set(i,e),ro(e,i,r,yh,p),p.delete(i)),e}function kg(e){return Xn(e)?r:e}function vh(e,i,o,c,l,p){var w=o&$,E=e.length,R=i.length;if(E!=R&&!(w&&R>E))return!1;var B=p.get(e),K=p.get(i);if(B&&K)return B==i&&K==e;var G=-1,ee=!0,oe=o&Q?new ki:r;for(p.set(e,i),p.set(i,e);++G<E;){var fe=e[G],Ee=i[G];if(c)var de=w?c(Ee,fe,G,i,e,p):c(fe,Ee,G,e,i,p);if(de!==r){if(de)continue;ee=!1;break}if(oe){if(!da(i,function(Se,Re){if(!Mn(oe,Re)&&(fe===Se||l(fe,Se,o,c,p)))return oe.push(Re)})){ee=!1;break}}else if(!(fe===Ee||l(fe,Ee,o,c,p))){ee=!1;break}}return p.delete(e),p.delete(i),ee}function Hg(e,i,o,c,l,p,w){switch(o){case Ke:if(e.byteLength!=i.byteLength||e.byteOffset!=i.byteOffset)return!1;e=e.buffer,i=i.buffer;case $e:return!(e.byteLength!=i.byteLength||!p(new Bs(e),new Bs(i)));case F:case T:case Ne:return Ur(+e,+i);case I:return e.name==i.name&&e.message==i.message;case at:case Xe:return e==i+"";case _e:var E=wa;case Fe:var R=c&$;if(E||(E=Ms),e.size!=i.size&&!R)return!1;var B=w.get(e);if(B)return B==i;c|=Q,w.set(e,i);var K=vh(E(e),E(i),c,l,p,w);return w.delete(e),K;case Ze:if(Hn)return Hn.call(e)==Hn.call(i)}return!1}function Bg(e,i,o,c,l,p){var w=o&$,E=Ba(e),R=E.length,B=Ba(i),K=B.length;if(R!=K&&!w)return!1;for(var G=R;G--;){var ee=E[G];if(!(w?ee in i:Ue.call(i,ee)))return!1}var oe=p.get(e),fe=p.get(i);if(oe&&fe)return oe==i&&fe==e;var Ee=!0;p.set(e,i),p.set(i,e);for(var de=w;++G<R;){ee=E[G];var Se=e[ee],Re=i[ee];if(c)var _r=w?c(Re,Se,ee,i,e,p):c(Se,Re,ee,e,i,p);if(!(_r===r?Se===Re||l(Se,Re,o,c,p):_r)){Ee=!1;break}de||(de=ee=="constructor")}if(Ee&&!de){var rr=e.constructor,Er=i.constructor;rr!=Er&&"constructor"in e&&"constructor"in i&&!(typeof rr=="function"&&rr instanceof rr&&typeof Er=="function"&&Er instanceof Er)&&(Ee=!1)}return p.delete(e),p.delete(i),Ee}function ai(e){return Xa(Ih(e,r,Nh),e+"")}function Ba(e){return ju(e,zt,Ga)}function Ka(e){return ju(e,lr,mh)}var Va=Qs?function(e){return Qs.get(e)}:lc;function ho(e){for(var i=e.name+"",o=yn[i],c=Ue.call(yn,i)?o.length:0;c--;){var l=o[c],p=l.func;if(p==null||p==e)return l.name}return i}function bn(e){var i=Ue.call(d,"placeholder")?d:e;return i.placeholder}function he(){var e=d.iteratee||uc;return e=e===uc?qu:e,arguments.length?e(arguments[0],arguments[1]):e}function lo(e,i){var o=e.__data__;return Xg(i)?o[typeof i=="string"?"string":"hash"]:o.map}function Wa(e){for(var i=zt(e),o=i.length;o--;){var c=i[o],l=e[c];i[o]=[c,l,_h(l)]}return i}function Ki(e,i){var o=tp(e,i);return Uu(o)?o:r}function Kg(e){var i=Ue.call(e,qi),o=e[qi];try{e[qi]=r;var c=!0}catch{}var l=ks.call(e);return c&&(i?e[qi]=o:delete e[qi]),l}var Ga=_a?function(e){return e==null?[]:(e=Je(e),_i(_a(e),function(i){return xu.call(e,i)}))}:fc,mh=_a?function(e){for(var i=[];e;)Ei(i,Ga(e)),e=Ks(e);return i}:fc,Jt=er;(Ea&&Jt(new Ea(new ArrayBuffer(1)))!=Ke||qn&&Jt(new qn)!=_e||Ia&&Jt(Ia.resolve())!=Pt||gn&&Jt(new gn)!=Fe||zn&&Jt(new zn)!=ze)&&(Jt=function(e){var i=er(e),o=i==Pe?e.constructor:r,c=o?Vi(o):"";if(c)switch(c){case Op:return Ke;case Ap:return _e;case Rp:return Pt;case Cp:return Fe;case Tp:return ze}return i});function Vg(e,i,o){for(var c=-1,l=o.length;++c<l;){var p=o[c],w=p.size;switch(p.type){case"drop":e+=w;break;case"dropRight":i-=w;break;case"take":i=Gt(i,e+w);break;case"takeRight":e=Mt(e,i-w);break}}return{start:e,end:i}}function Wg(e){var i=e.match(Ye);return i?i[1].split(Tt):[]}function wh(e,i,o){i=Oi(i,e);for(var c=-1,l=i.length,p=!1;++c<l;){var w=Yr(i[c]);if(!(p=e!=null&&o(e,w)))break;e=e[w]}return p||++c!=l?p:(l=e==null?0:e.length,!!l&&wo(l)&&ci(w,l)&&(we(e)||Wi(e)))}function Gg(e){var i=e.length,o=new e.constructor(i);return i&&typeof e[0]=="string"&&Ue.call(e,"index")&&(o.index=e.index,o.input=e.input),o}function bh(e){return typeof e.constructor=="function"&&!Qn(e)?vn(Ks(e)):{}}function Jg(e,i,o){var c=e.constructor;switch(i){case $e:return za(e);case F:case T:return new c(+e);case Ke:return Ng(e,o);case lt:case Me:case Ot:case Ft:case Bt:case Kt:case Ut:case Yt:case ar:return rh(e,o);case _e:return new c;case Ne:case Xe:return new c(e);case at:return $g(e);case Fe:return new c;case Ze:return Lg(e)}}function Qg(e,i){var o=i.length;if(!o)return e;var c=o-1;return i[c]=(o>1?"& ":"")+i[c],i=i.join(o>2?", ":" "),e.replace(vt,`{
/* [wrapped with `+i+`] */
`)}function Yg(e){return we(e)||Wi(e)||!!(Su&&e&&e[Su])}function ci(e,i){var o=typeof e;return i=i??Y,!!i&&(o=="number"||o!="symbol"&&Yo.test(e))&&e>-1&&e%1==0&&e<i}function tr(e,i,o){if(!ht(o))return!1;var c=typeof i;return(c=="number"?hr(o)&&ci(i,o.length):c=="string"&&i in o)?Ur(o[i],e):!1}function Ja(e,i){if(we(e))return!1;var o=typeof e;return o=="number"||o=="symbol"||o=="boolean"||e==null||br(e)?!0:At.test(e)||!nt.test(e)||i!=null&&e in Je(i)}function Xg(e){var i=typeof e;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?e!=="__proto__":e===null}function Qa(e){var i=ho(e),o=d[i];if(typeof o!="function"||!(i in Oe.prototype))return!1;if(e===o)return!0;var c=Va(o);return!!c&&e===c[0]}function Zg(e){return!!_u&&_u in e}var ey=qs?ui:dc;function Qn(e){var i=e&&e.constructor,o=typeof i=="function"&&i.prototype||pn;return e===o}function _h(e){return e===e&&!ht(e)}function Eh(e,i){return function(o){return o==null?!1:o[e]===i&&(i!==r||e in Je(o))}}function ty(e){var i=vo(e,function(c){return o.size===y&&o.clear(),c}),o=i.cache;return i}function ry(e,i){var o=e[1],c=i[1],l=o|c,p=l<(se|le|j),w=c==j&&o==D||c==j&&o==k&&e[7].length<=i[8]||c==(j|k)&&i[7].length<=i[8]&&o==D;if(!(p||w))return e;c&se&&(e[2]=i[2],l|=o&se?0:C);var E=i[3];if(E){var R=e[3];e[3]=R?nh(R,E,i[4]):E,e[4]=R?Ii(e[3],_):i[4]}return E=i[5],E&&(R=e[5],e[5]=R?sh(R,E,i[6]):E,e[6]=R?Ii(e[5],_):i[6]),E=i[7],E&&(e[7]=E),c&j&&(e[8]=e[8]==null?i[8]:Gt(e[8],i[8])),e[9]==null&&(e[9]=i[9]),e[0]=i[0],e[1]=l,e}function iy(e){var i=[];if(e!=null)for(var o in Je(e))i.push(o);return i}function ny(e){return ks.call(e)}function Ih(e,i,o){return i=Mt(i===r?e.length-1:i,0),function(){for(var c=arguments,l=-1,p=Mt(c.length-i,0),w=L(p);++l<p;)w[l]=c[i+l];l=-1;for(var E=L(i+1);++l<i;)E[l]=c[l];return E[i]=o(w),qt(e,this,E)}}function xh(e,i){return i.length<2?e:Bi(e,Tr(i,0,-1))}function sy(e,i){for(var o=e.length,c=Gt(i.length,o),l=ur(e);c--;){var p=i[c];e[c]=ci(p,o)?l[p]:r}return e}function Ya(e,i){if(!(i==="constructor"&&typeof e[i]=="function")&&i!="__proto__")return e[i]}var Sh=Oh(Gu),Yn=bp||function(e,i){return Ae.setTimeout(e,i)},Xa=Oh(Ag);function Ph(e,i,o){var c=i+"";return Xa(e,Qg(c,oy(Wg(c),o)))}function Oh(e){var i=0,o=0;return function(){var c=xp(),l=qe-(c-o);if(o=c,l>0){if(++i>=Te)return arguments[0]}else i=0;return e.apply(r,arguments)}}function fo(e,i){var o=-1,c=e.length,l=c-1;for(i=i===r?c:i;++o<i;){var p=La(o,l),w=e[p];e[p]=e[o],e[o]=w}return e.length=i,e}var Ah=ty(function(e){var i=[];return e.charCodeAt(0)===46&&i.push(""),e.replace(Rt,function(o,c,l,p){i.push(l?p.replace(Ko,"$1"):c||o)}),i});function Yr(e){if(typeof e=="string"||br(e))return e;var i=e+"";return i=="0"&&1/e==-pe?"-0":i}function Vi(e){if(e!=null){try{return zs.call(e)}catch{}try{return e+""}catch{}}return""}function oy(e,i){return Or(Kr,function(o){var c="_."+o[0];i&o[1]&&!Fs(e,c)&&e.push(c)}),e.sort()}function Rh(e){if(e instanceof Oe)return e.clone();var i=new Rr(e.__wrapped__,e.__chain__);return i.__actions__=ur(e.__actions__),i.__index__=e.__index__,i.__values__=e.__values__,i}function ay(e,i,o){(o?tr(e,i,o):i===r)?i=1:i=Mt(be(i),0);var c=e==null?0:e.length;if(!c||i<1)return[];for(var l=0,p=0,w=L(Gs(c/i));l<c;)w[p++]=Tr(e,l,l+=i);return w}function cy(e){for(var i=-1,o=e==null?0:e.length,c=0,l=[];++i<o;){var p=e[i];p&&(l[c++]=p)}return l}function uy(){var e=arguments.length;if(!e)return[];for(var i=L(e-1),o=arguments[0],c=e;c--;)i[c-1]=arguments[c];return Ei(we(o)?ur(o):[o],Vt(i,1))}var hy=xe(function(e,i){return Et(e)?Kn(e,Vt(i,1,Et,!0)):[]}),ly=xe(function(e,i){var o=Nr(i);return Et(o)&&(o=r),Et(e)?Kn(e,Vt(i,1,Et,!0),he(o,2)):[]}),fy=xe(function(e,i){var o=Nr(i);return Et(o)&&(o=r),Et(e)?Kn(e,Vt(i,1,Et,!0),r,o):[]});function dy(e,i,o){var c=e==null?0:e.length;return c?(i=o||i===r?1:be(i),Tr(e,i<0?0:i,c)):[]}function py(e,i,o){var c=e==null?0:e.length;return c?(i=o||i===r?1:be(i),i=c-i,Tr(e,0,i<0?0:i)):[]}function gy(e,i){return e&&e.length?no(e,he(i,3),!0,!0):[]}function yy(e,i){return e&&e.length?no(e,he(i,3),!0):[]}function vy(e,i,o,c){var l=e==null?0:e.length;return l?(o&&typeof o!="number"&&tr(e,i,o)&&(o=0,c=l),ug(e,i,o,c)):[]}function Ch(e,i,o){var c=e==null?0:e.length;if(!c)return-1;var l=o==null?0:be(o);return l<0&&(l=Mt(c+l,0)),js(e,he(i,3),l)}function Th(e,i,o){var c=e==null?0:e.length;if(!c)return-1;var l=c-1;return o!==r&&(l=be(o),l=o<0?Mt(c+l,0):Gt(l,c-1)),js(e,he(i,3),l,!0)}function Nh(e){var i=e==null?0:e.length;return i?Vt(e,1):[]}function my(e){var i=e==null?0:e.length;return i?Vt(e,pe):[]}function wy(e,i){var o=e==null?0:e.length;return o?(i=i===r?1:be(i),Vt(e,i)):[]}function by(e){for(var i=-1,o=e==null?0:e.length,c={};++i<o;){var l=e[i];c[l[0]]=l[1]}return c}function $h(e){return e&&e.length?e[0]:r}function _y(e,i,o){var c=e==null?0:e.length;if(!c)return-1;var l=o==null?0:be(o);return l<0&&(l=Mt(c+l,0)),hn(e,i,l)}function Ey(e){var i=e==null?0:e.length;return i?Tr(e,0,-1):[]}var Iy=xe(function(e){var i=st(e,Ua);return i.length&&i[0]===e[0]?Ra(i):[]}),xy=xe(function(e){var i=Nr(e),o=st(e,Ua);return i===Nr(o)?i=r:o.pop(),o.length&&o[0]===e[0]?Ra(o,he(i,2)):[]}),Sy=xe(function(e){var i=Nr(e),o=st(e,Ua);return i=typeof i=="function"?i:r,i&&o.pop(),o.length&&o[0]===e[0]?Ra(o,r,i):[]});function Py(e,i){return e==null?"":Ep.call(e,i)}function Nr(e){var i=e==null?0:e.length;return i?e[i-1]:r}function Oy(e,i,o){var c=e==null?0:e.length;if(!c)return-1;var l=c;return o!==r&&(l=be(o),l=l<0?Mt(c+l,0):Gt(l,c-1)),i===i?op(e,i,l):js(e,du,l,!0)}function Ay(e,i){return e&&e.length?Bu(e,be(i)):r}var Ry=xe(Lh);function Lh(e,i){return e&&e.length&&i&&i.length?$a(e,i):e}function Cy(e,i,o){return e&&e.length&&i&&i.length?$a(e,i,he(o,2)):e}function Ty(e,i,o){return e&&e.length&&i&&i.length?$a(e,i,r,o):e}var Ny=ai(function(e,i){var o=e==null?0:e.length,c=Sa(e,i);return Wu(e,st(i,function(l){return ci(l,o)?+l:l}).sort(ih)),c});function $y(e,i){var o=[];if(!(e&&e.length))return o;var c=-1,l=[],p=e.length;for(i=he(i,3);++c<p;){var w=e[c];i(w,c,e)&&(o.push(w),l.push(c))}return Wu(e,l),o}function Za(e){return e==null?e:Pp.call(e)}function Ly(e,i,o){var c=e==null?0:e.length;return c?(o&&typeof o!="number"&&tr(e,i,o)?(i=0,o=c):(i=i==null?0:be(i),o=o===r?c:be(o)),Tr(e,i,o)):[]}function Dy(e,i){return io(e,i)}function Fy(e,i,o){return Fa(e,i,he(o,2))}function jy(e,i){var o=e==null?0:e.length;if(o){var c=io(e,i);if(c<o&&Ur(e[c],i))return c}return-1}function My(e,i){return io(e,i,!0)}function Uy(e,i,o){return Fa(e,i,he(o,2),!0)}function qy(e,i){var o=e==null?0:e.length;if(o){var c=io(e,i,!0)-1;if(Ur(e[c],i))return c}return-1}function zy(e){return e&&e.length?Ju(e):[]}function ky(e,i){return e&&e.length?Ju(e,he(i,2)):[]}function Hy(e){var i=e==null?0:e.length;return i?Tr(e,1,i):[]}function By(e,i,o){return e&&e.length?(i=o||i===r?1:be(i),Tr(e,0,i<0?0:i)):[]}function Ky(e,i,o){var c=e==null?0:e.length;return c?(i=o||i===r?1:be(i),i=c-i,Tr(e,i<0?0:i,c)):[]}function Vy(e,i){return e&&e.length?no(e,he(i,3),!1,!0):[]}function Wy(e,i){return e&&e.length?no(e,he(i,3)):[]}var Gy=xe(function(e){return Pi(Vt(e,1,Et,!0))}),Jy=xe(function(e){var i=Nr(e);return Et(i)&&(i=r),Pi(Vt(e,1,Et,!0),he(i,2))}),Qy=xe(function(e){var i=Nr(e);return i=typeof i=="function"?i:r,Pi(Vt(e,1,Et,!0),r,i)});function Yy(e){return e&&e.length?Pi(e):[]}function Xy(e,i){return e&&e.length?Pi(e,he(i,2)):[]}function Zy(e,i){return i=typeof i=="function"?i:r,e&&e.length?Pi(e,r,i):[]}function ec(e){if(!(e&&e.length))return[];var i=0;return e=_i(e,function(o){if(Et(o))return i=Mt(o.length,i),!0}),va(i,function(o){return st(e,pa(o))})}function Dh(e,i){if(!(e&&e.length))return[];var o=ec(e);return i==null?o:st(o,function(c){return qt(i,r,c)})}var ev=xe(function(e,i){return Et(e)?Kn(e,i):[]}),tv=xe(function(e){return Ma(_i(e,Et))}),rv=xe(function(e){var i=Nr(e);return Et(i)&&(i=r),Ma(_i(e,Et),he(i,2))}),iv=xe(function(e){var i=Nr(e);return i=typeof i=="function"?i:r,Ma(_i(e,Et),r,i)}),nv=xe(ec);function sv(e,i){return Zu(e||[],i||[],Bn)}function ov(e,i){return Zu(e||[],i||[],Gn)}var av=xe(function(e){var i=e.length,o=i>1?e[i-1]:r;return o=typeof o=="function"?(e.pop(),o):r,Dh(e,o)});function Fh(e){var i=d(e);return i.__chain__=!0,i}function cv(e,i){return i(e),e}function po(e,i){return i(e)}var uv=ai(function(e){var i=e.length,o=i?e[0]:0,c=this.__wrapped__,l=function(p){return Sa(p,e)};return i>1||this.__actions__.length||!(c instanceof Oe)||!ci(o)?this.thru(l):(c=c.slice(o,+o+(i?1:0)),c.__actions__.push({func:po,args:[l],thisArg:r}),new Rr(c,this.__chain__).thru(function(p){return i&&!p.length&&p.push(r),p}))});function hv(){return Fh(this)}function lv(){return new Rr(this.value(),this.__chain__)}function fv(){this.__values__===r&&(this.__values__=Qh(this.value()));var e=this.__index__>=this.__values__.length,i=e?r:this.__values__[this.__index__++];return{done:e,value:i}}function dv(){return this}function pv(e){for(var i,o=this;o instanceof Xs;){var c=Rh(o);c.__index__=0,c.__values__=r,i?l.__wrapped__=c:i=c;var l=c;o=o.__wrapped__}return l.__wrapped__=e,i}function gv(){var e=this.__wrapped__;if(e instanceof Oe){var i=e;return this.__actions__.length&&(i=new Oe(this)),i=i.reverse(),i.__actions__.push({func:po,args:[Za],thisArg:r}),new Rr(i,this.__chain__)}return this.thru(Za)}function yv(){return Xu(this.__wrapped__,this.__actions__)}var vv=so(function(e,i,o){Ue.call(e,o)?++e[o]:si(e,o,1)});function mv(e,i,o){var c=we(e)?lu:cg;return o&&tr(e,i,o)&&(i=r),c(e,he(i,3))}function wv(e,i){var o=we(e)?_i:Du;return o(e,he(i,3))}var bv=uh(Ch),_v=uh(Th);function Ev(e,i){return Vt(go(e,i),1)}function Iv(e,i){return Vt(go(e,i),pe)}function xv(e,i,o){return o=o===r?1:be(o),Vt(go(e,i),o)}function jh(e,i){var o=we(e)?Or:Si;return o(e,he(i,3))}function Mh(e,i){var o=we(e)?Hd:Lu;return o(e,he(i,3))}var Sv=so(function(e,i,o){Ue.call(e,o)?e[o].push(i):si(e,o,[i])});function Pv(e,i,o,c){e=hr(e)?e:En(e),o=o&&!c?be(o):0;var l=e.length;return o<0&&(o=Mt(l+o,0)),bo(e)?o<=l&&e.indexOf(i,o)>-1:!!l&&hn(e,i,o)>-1}var Ov=xe(function(e,i,o){var c=-1,l=typeof i=="function",p=hr(e)?L(e.length):[];return Si(e,function(w){p[++c]=l?qt(i,w,o):Vn(w,i,o)}),p}),Av=so(function(e,i,o){si(e,o,i)});function go(e,i){var o=we(e)?st:zu;return o(e,he(i,3))}function Rv(e,i,o,c){return e==null?[]:(we(i)||(i=i==null?[]:[i]),o=c?r:o,we(o)||(o=o==null?[]:[o]),Ku(e,i,o))}var Cv=so(function(e,i,o){e[o?0:1].push(i)},function(){return[[],[]]});function Tv(e,i,o){var c=we(e)?fa:gu,l=arguments.length<3;return c(e,he(i,4),o,l,Si)}function Nv(e,i,o){var c=we(e)?Bd:gu,l=arguments.length<3;return c(e,he(i,4),o,l,Lu)}function $v(e,i){var o=we(e)?_i:Du;return o(e,mo(he(i,3)))}function Lv(e){var i=we(e)?Cu:Pg;return i(e)}function Dv(e,i,o){(o?tr(e,i,o):i===r)?i=1:i=be(i);var c=we(e)?ig:Og;return c(e,i)}function Fv(e){var i=we(e)?ng:Rg;return i(e)}function jv(e){if(e==null)return 0;if(hr(e))return bo(e)?fn(e):e.length;var i=Jt(e);return i==_e||i==Fe?e.size:Ta(e).length}function Mv(e,i,o){var c=we(e)?da:Cg;return o&&tr(e,i,o)&&(i=r),c(e,he(i,3))}var Uv=xe(function(e,i){if(e==null)return[];var o=i.length;return o>1&&tr(e,i[0],i[1])?i=[]:o>2&&tr(i[0],i[1],i[2])&&(i=[i[0]]),Ku(e,Vt(i,1),[])}),yo=wp||function(){return Ae.Date.now()};function qv(e,i){if(typeof i!="function")throw new Ar(f);return e=be(e),function(){if(--e<1)return i.apply(this,arguments)}}function Uh(e,i,o){return i=o?r:i,i=e&&i==null?e.length:i,oi(e,j,r,r,r,r,i)}function qh(e,i){var o;if(typeof i!="function")throw new Ar(f);return e=be(e),function(){return--e>0&&(o=i.apply(this,arguments)),e<=1&&(i=r),o}}var tc=xe(function(e,i,o){var c=se;if(o.length){var l=Ii(o,bn(tc));c|=U}return oi(e,c,i,o,l)}),zh=xe(function(e,i,o){var c=se|le;if(o.length){var l=Ii(o,bn(zh));c|=U}return oi(i,c,e,o,l)});function kh(e,i,o){i=o?r:i;var c=oi(e,D,r,r,r,r,r,i);return c.placeholder=kh.placeholder,c}function Hh(e,i,o){i=o?r:i;var c=oi(e,q,r,r,r,r,r,i);return c.placeholder=Hh.placeholder,c}function Bh(e,i,o){var c,l,p,w,E,R,B=0,K=!1,G=!1,ee=!0;if(typeof e!="function")throw new Ar(f);i=$r(i)||0,ht(o)&&(K=!!o.leading,G="maxWait"in o,p=G?Mt($r(o.maxWait)||0,i):p,ee="trailing"in o?!!o.trailing:ee);function oe(It){var qr=c,li=l;return c=l=r,B=It,w=e.apply(li,qr),w}function fe(It){return B=It,E=Yn(Se,i),K?oe(It):w}function Ee(It){var qr=It-R,li=It-B,ul=i-qr;return G?Gt(ul,p-li):ul}function de(It){var qr=It-R,li=It-B;return R===r||qr>=i||qr<0||G&&li>=p}function Se(){var It=yo();if(de(It))return Re(It);E=Yn(Se,Ee(It))}function Re(It){return E=r,ee&&c?oe(It):(c=l=r,w)}function _r(){E!==r&&eh(E),B=0,c=R=l=E=r}function rr(){return E===r?w:Re(yo())}function Er(){var It=yo(),qr=de(It);if(c=arguments,l=this,R=It,qr){if(E===r)return fe(R);if(G)return eh(E),E=Yn(Se,i),oe(R)}return E===r&&(E=Yn(Se,i)),w}return Er.cancel=_r,Er.flush=rr,Er}var zv=xe(function(e,i){return $u(e,1,i)}),kv=xe(function(e,i,o){return $u(e,$r(i)||0,o)});function Hv(e){return oi(e,ue)}function vo(e,i){if(typeof e!="function"||i!=null&&typeof i!="function")throw new Ar(f);var o=function(){var c=arguments,l=i?i.apply(this,c):c[0],p=o.cache;if(p.has(l))return p.get(l);var w=e.apply(this,c);return o.cache=p.set(l,w)||p,w};return o.cache=new(vo.Cache||ni),o}vo.Cache=ni;function mo(e){if(typeof e!="function")throw new Ar(f);return function(){var i=arguments;switch(i.length){case 0:return!e.call(this);case 1:return!e.call(this,i[0]);case 2:return!e.call(this,i[0],i[1]);case 3:return!e.call(this,i[0],i[1],i[2])}return!e.apply(this,i)}}function Bv(e){return qh(2,e)}var Kv=Tg(function(e,i){i=i.length==1&&we(i[0])?st(i[0],mr(he())):st(Vt(i,1),mr(he()));var o=i.length;return xe(function(c){for(var l=-1,p=Gt(c.length,o);++l<p;)c[l]=i[l].call(this,c[l]);return qt(e,this,c)})}),rc=xe(function(e,i){var o=Ii(i,bn(rc));return oi(e,U,r,i,o)}),Kh=xe(function(e,i){var o=Ii(i,bn(Kh));return oi(e,x,r,i,o)}),Vv=ai(function(e,i){return oi(e,k,r,r,r,i)});function Wv(e,i){if(typeof e!="function")throw new Ar(f);return i=i===r?i:be(i),xe(e,i)}function Gv(e,i){if(typeof e!="function")throw new Ar(f);return i=i==null?0:Mt(be(i),0),xe(function(o){var c=o[i],l=Ai(o,0,i);return c&&Ei(l,c),qt(e,this,l)})}function Jv(e,i,o){var c=!0,l=!0;if(typeof e!="function")throw new Ar(f);return ht(o)&&(c="leading"in o?!!o.leading:c,l="trailing"in o?!!o.trailing:l),Bh(e,i,{leading:c,maxWait:i,trailing:l})}function Qv(e){return Uh(e,1)}function Yv(e,i){return rc(qa(i),e)}function Xv(){if(!arguments.length)return[];var e=arguments[0];return we(e)?e:[e]}function Zv(e){return Cr(e,H)}function em(e,i){return i=typeof i=="function"?i:r,Cr(e,H,i)}function tm(e){return Cr(e,P|H)}function rm(e,i){return i=typeof i=="function"?i:r,Cr(e,P|H,i)}function im(e,i){return i==null||Nu(e,i,zt(i))}function Ur(e,i){return e===i||e!==e&&i!==i}var nm=uo(Aa),sm=uo(function(e,i){return e>=i}),Wi=Mu(function(){return arguments}())?Mu:function(e){return mt(e)&&Ue.call(e,"callee")&&!xu.call(e,"callee")},we=L.isArray,om=Zt?mr(Zt):pg;function hr(e){return e!=null&&wo(e.length)&&!ui(e)}function Et(e){return mt(e)&&hr(e)}function am(e){return e===!0||e===!1||mt(e)&&er(e)==F}var Ri=_p||dc,cm=Fr?mr(Fr):gg;function um(e){return mt(e)&&e.nodeType===1&&!Xn(e)}function hm(e){if(e==null)return!0;if(hr(e)&&(we(e)||typeof e=="string"||typeof e.splice=="function"||Ri(e)||_n(e)||Wi(e)))return!e.length;var i=Jt(e);if(i==_e||i==Fe)return!e.size;if(Qn(e))return!Ta(e).length;for(var o in e)if(Ue.call(e,o))return!1;return!0}function lm(e,i){return Wn(e,i)}function fm(e,i,o){o=typeof o=="function"?o:r;var c=o?o(e,i):r;return c===r?Wn(e,i,r,o):!!c}function ic(e){if(!mt(e))return!1;var i=er(e);return i==I||i==h||typeof e.message=="string"&&typeof e.name=="string"&&!Xn(e)}function dm(e){return typeof e=="number"&&Pu(e)}function ui(e){if(!ht(e))return!1;var i=er(e);return i==ne||i==ye||i==M||i==wt}function Vh(e){return typeof e=="number"&&e==be(e)}function wo(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Y}function ht(e){var i=typeof e;return e!=null&&(i=="object"||i=="function")}function mt(e){return e!=null&&typeof e=="object"}var Wh=Pr?mr(Pr):vg;function pm(e,i){return e===i||Ca(e,i,Wa(i))}function gm(e,i,o){return o=typeof o=="function"?o:r,Ca(e,i,Wa(i),o)}function ym(e){return Gh(e)&&e!=+e}function vm(e){if(ey(e))throw new ve(u);return Uu(e)}function mm(e){return e===null}function wm(e){return e==null}function Gh(e){return typeof e=="number"||mt(e)&&er(e)==Ne}function Xn(e){if(!mt(e)||er(e)!=Pe)return!1;var i=Ks(e);if(i===null)return!0;var o=Ue.call(i,"constructor")&&i.constructor;return typeof o=="function"&&o instanceof o&&zs.call(o)==gp}var nc=Gr?mr(Gr):mg;function bm(e){return Vh(e)&&e>=-Y&&e<=Y}var Jh=jn?mr(jn):wg;function bo(e){return typeof e=="string"||!we(e)&&mt(e)&&er(e)==Xe}function br(e){return typeof e=="symbol"||mt(e)&&er(e)==Ze}var _n=Ui?mr(Ui):bg;function _m(e){return e===r}function Em(e){return mt(e)&&Jt(e)==ze}function Im(e){return mt(e)&&er(e)==et}var xm=uo(Na),Sm=uo(function(e,i){return e<=i});function Qh(e){if(!e)return[];if(hr(e))return bo(e)?jr(e):ur(e);if(Un&&e[Un])return ip(e[Un]());var i=Jt(e),o=i==_e?wa:i==Fe?Ms:En;return o(e)}function hi(e){if(!e)return e===0?e:0;if(e=$r(e),e===pe||e===-pe){var i=e<0?-1:1;return i*W}return e===e?e:0}function be(e){var i=hi(e),o=i%1;return i===i?o?i-o:i:0}function Yh(e){return e?Hi(be(e),0,X):0}function $r(e){if(typeof e=="number")return e;if(br(e))return J;if(ht(e)){var i=typeof e.valueOf=="function"?e.valueOf():e;e=ht(i)?i+"":i}if(typeof e!="string")return e===0?e:+e;e=yu(e);var o=Go.test(e);return o||Qo.test(e)?me(e.slice(2),o?2:8):Wo.test(e)?J:+e}function Xh(e){return Qr(e,lr(e))}function Pm(e){return e?Hi(be(e),-Y,Y):e===0?e:0}function je(e){return e==null?"":wr(e)}var Om=mn(function(e,i){if(Qn(i)||hr(i)){Qr(i,zt(i),e);return}for(var o in i)Ue.call(i,o)&&Bn(e,o,i[o])}),Zh=mn(function(e,i){Qr(i,lr(i),e)}),_o=mn(function(e,i,o,c){Qr(i,lr(i),e,c)}),Am=mn(function(e,i,o,c){Qr(i,zt(i),e,c)}),Rm=ai(Sa);function Cm(e,i){var o=vn(e);return i==null?o:Tu(o,i)}var Tm=xe(function(e,i){e=Je(e);var o=-1,c=i.length,l=c>2?i[2]:r;for(l&&tr(i[0],i[1],l)&&(c=1);++o<c;)for(var p=i[o],w=lr(p),E=-1,R=w.length;++E<R;){var B=w[E],K=e[B];(K===r||Ur(K,pn[B])&&!Ue.call(e,B))&&(e[B]=p[B])}return e}),Nm=xe(function(e){return e.push(r,yh),qt(el,r,e)});function $m(e,i){return fu(e,he(i,3),Jr)}function Lm(e,i){return fu(e,he(i,3),Oa)}function Dm(e,i){return e==null?e:Pa(e,he(i,3),lr)}function Fm(e,i){return e==null?e:Fu(e,he(i,3),lr)}function jm(e,i){return e&&Jr(e,he(i,3))}function Mm(e,i){return e&&Oa(e,he(i,3))}function Um(e){return e==null?[]:to(e,zt(e))}function qm(e){return e==null?[]:to(e,lr(e))}function sc(e,i,o){var c=e==null?r:Bi(e,i);return c===r?o:c}function zm(e,i){return e!=null&&wh(e,i,hg)}function oc(e,i){return e!=null&&wh(e,i,lg)}var km=lh(function(e,i,o){i!=null&&typeof i.toString!="function"&&(i=ks.call(i)),e[i]=o},cc(fr)),Hm=lh(function(e,i,o){i!=null&&typeof i.toString!="function"&&(i=ks.call(i)),Ue.call(e,i)?e[i].push(o):e[i]=[o]},he),Bm=xe(Vn);function zt(e){return hr(e)?Ru(e):Ta(e)}function lr(e){return hr(e)?Ru(e,!0):_g(e)}function Km(e,i){var o={};return i=he(i,3),Jr(e,function(c,l,p){si(o,i(c,l,p),c)}),o}function Vm(e,i){var o={};return i=he(i,3),Jr(e,function(c,l,p){si(o,l,i(c,l,p))}),o}var Wm=mn(function(e,i,o){ro(e,i,o)}),el=mn(function(e,i,o,c){ro(e,i,o,c)}),Gm=ai(function(e,i){var o={};if(e==null)return o;var c=!1;i=st(i,function(p){return p=Oi(p,e),c||(c=p.length>1),p}),Qr(e,Ka(e),o),c&&(o=Cr(o,P|N|H,kg));for(var l=i.length;l--;)ja(o,i[l]);return o});function Jm(e,i){return tl(e,mo(he(i)))}var Qm=ai(function(e,i){return e==null?{}:Ig(e,i)});function tl(e,i){if(e==null)return{};var o=st(Ka(e),function(c){return[c]});return i=he(i),Vu(e,o,function(c,l){return i(c,l[0])})}function Ym(e,i,o){i=Oi(i,e);var c=-1,l=i.length;for(l||(l=1,e=r);++c<l;){var p=e==null?r:e[Yr(i[c])];p===r&&(c=l,p=o),e=ui(p)?p.call(e):p}return e}function Xm(e,i,o){return e==null?e:Gn(e,i,o)}function Zm(e,i,o,c){return c=typeof c=="function"?c:r,e==null?e:Gn(e,i,o,c)}var rl=ph(zt),il=ph(lr);function e0(e,i,o){var c=we(e),l=c||Ri(e)||_n(e);if(i=he(i,4),o==null){var p=e&&e.constructor;l?o=c?new p:[]:ht(e)?o=ui(p)?vn(Ks(e)):{}:o={}}return(l?Or:Jr)(e,function(w,E,R){return i(o,w,E,R)}),o}function t0(e,i){return e==null?!0:ja(e,i)}function r0(e,i,o){return e==null?e:Yu(e,i,qa(o))}function i0(e,i,o,c){return c=typeof c=="function"?c:r,e==null?e:Yu(e,i,qa(o),c)}function En(e){return e==null?[]:ma(e,zt(e))}function n0(e){return e==null?[]:ma(e,lr(e))}function s0(e,i,o){return o===r&&(o=i,i=r),o!==r&&(o=$r(o),o=o===o?o:0),i!==r&&(i=$r(i),i=i===i?i:0),Hi($r(e),i,o)}function o0(e,i,o){return i=hi(i),o===r?(o=i,i=0):o=hi(o),e=$r(e),fg(e,i,o)}function a0(e,i,o){if(o&&typeof o!="boolean"&&tr(e,i,o)&&(i=o=r),o===r&&(typeof i=="boolean"?(o=i,i=r):typeof e=="boolean"&&(o=e,e=r)),e===r&&i===r?(e=0,i=1):(e=hi(e),i===r?(i=e,e=0):i=hi(i)),e>i){var c=e;e=i,i=c}if(o||e%1||i%1){var l=Ou();return Gt(e+l*(i-e+We("1e-"+((l+"").length-1))),i)}return La(e,i)}var c0=wn(function(e,i,o){return i=i.toLowerCase(),e+(o?nl(i):i)});function nl(e){return ac(je(e).toLowerCase())}function sl(e){return e=je(e),e&&e.replace(ti,Xd).replace(ua,"")}function u0(e,i,o){e=je(e),i=wr(i);var c=e.length;o=o===r?c:Hi(be(o),0,c);var l=o;return o-=i.length,o>=0&&e.slice(o,l)==i}function h0(e){return e=je(e),e&&it.test(e)?e.replace(Li,Zd):e}function l0(e){return e=je(e),e&&Ct.test(e)?e.replace(gt,"\\$&"):e}var f0=wn(function(e,i,o){return e+(o?"-":"")+i.toLowerCase()}),d0=wn(function(e,i,o){return e+(o?" ":"")+i.toLowerCase()}),p0=ch("toLowerCase");function g0(e,i,o){e=je(e),i=be(i);var c=i?fn(e):0;if(!i||c>=i)return e;var l=(i-c)/2;return co(Js(l),o)+e+co(Gs(l),o)}function y0(e,i,o){e=je(e),i=be(i);var c=i?fn(e):0;return i&&c<i?e+co(i-c,o):e}function v0(e,i,o){e=je(e),i=be(i);var c=i?fn(e):0;return i&&c<i?co(i-c,o)+e:e}function m0(e,i,o){return o||i==null?i=0:i&&(i=+i),Sp(je(e).replace(yt,""),i||0)}function w0(e,i,o){return(o?tr(e,i,o):i===r)?i=1:i=be(i),Da(je(e),i)}function b0(){var e=arguments,i=je(e[0]);return e.length<3?i:i.replace(e[1],e[2])}var _0=wn(function(e,i,o){return e+(o?"_":"")+i.toLowerCase()});function E0(e,i,o){return o&&typeof o!="number"&&tr(e,i,o)&&(i=o=r),o=o===r?X:o>>>0,o?(e=je(e),e&&(typeof i=="string"||i!=null&&!nc(i))&&(i=wr(i),!i&&ln(e))?Ai(jr(e),0,o):e.split(i,o)):[]}var I0=wn(function(e,i,o){return e+(o?" ":"")+ac(i)});function x0(e,i,o){return e=je(e),o=o==null?0:Hi(be(o),0,e.length),i=wr(i),e.slice(o,o+i.length)==i}function S0(e,i,o){var c=d.templateSettings;o&&tr(e,i,o)&&(i=r),e=je(e),i=_o({},i,c,gh);var l=_o({},i.imports,c.imports,gh),p=zt(l),w=ma(l,p),E,R,B=0,K=i.interpolate||rn,G="__p += '",ee=ba((i.escape||rn).source+"|"+K.source+"|"+(K===ut?Vo:rn).source+"|"+(i.evaluate||rn).source+"|$","g"),oe="//# sourceURL="+(Ue.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++ha+"]")+`
`;e.replace(ee,function(de,Se,Re,_r,rr,Er){return Re||(Re=_r),G+=e.slice(B,Er).replace(Xo,ep),Se&&(E=!0,G+=`' +
__e(`+Se+`) +
'`),rr&&(R=!0,G+=`';
`+rr+`;
__p += '`),Re&&(G+=`' +
((__t = (`+Re+`)) == null ? '' : __t) +
'`),B=Er+de.length,de}),G+=`';
`;var fe=Ue.call(i,"variable")&&i.variable;if(!fe)G=`with (obj) {
`+G+`
}
`;else if(Bo.test(fe))throw new ve(g);G=(R?G.replace(Vr,""):G).replace(Xt,"$1").replace(ei,"$1;"),G="function("+(fe||"obj")+`) {
`+(fe?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(E?", __e = _.escape":"")+(R?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+G+`return __p
}`;var Ee=al(function(){return De(p,oe+"return "+G).apply(r,w)});if(Ee.source=G,ic(Ee))throw Ee;return Ee}function P0(e){return je(e).toLowerCase()}function O0(e){return je(e).toUpperCase()}function A0(e,i,o){if(e=je(e),e&&(o||i===r))return yu(e);if(!e||!(i=wr(i)))return e;var c=jr(e),l=jr(i),p=vu(c,l),w=mu(c,l)+1;return Ai(c,p,w).join("")}function R0(e,i,o){if(e=je(e),e&&(o||i===r))return e.slice(0,bu(e)+1);if(!e||!(i=wr(i)))return e;var c=jr(e),l=mu(c,jr(i))+1;return Ai(c,0,l).join("")}function C0(e,i,o){if(e=je(e),e&&(o||i===r))return e.replace(yt,"");if(!e||!(i=wr(i)))return e;var c=jr(e),l=vu(c,jr(i));return Ai(c,l).join("")}function T0(e,i){var o=ae,c=ge;if(ht(i)){var l="separator"in i?i.separator:l;o="length"in i?be(i.length):o,c="omission"in i?wr(i.omission):c}e=je(e);var p=e.length;if(ln(e)){var w=jr(e);p=w.length}if(o>=p)return e;var E=o-fn(c);if(E<1)return c;var R=w?Ai(w,0,E).join(""):e.slice(0,E);if(l===r)return R+c;if(w&&(E+=R.length-E),nc(l)){if(e.slice(E).search(l)){var B,K=R;for(l.global||(l=ba(l.source,je(Sr.exec(l))+"g")),l.lastIndex=0;B=l.exec(K);)var G=B.index;R=R.slice(0,G===r?E:G)}}else if(e.indexOf(wr(l),E)!=E){var ee=R.lastIndexOf(l);ee>-1&&(R=R.slice(0,ee))}return R+c}function N0(e){return e=je(e),e&&ft.test(e)?e.replace(wi,ap):e}var $0=wn(function(e,i,o){return e+(o?" ":"")+i.toUpperCase()}),ac=ch("toUpperCase");function ol(e,i,o){return e=je(e),i=o?r:i,i===r?rp(e)?hp(e):Wd(e):e.match(i)||[]}var al=xe(function(e,i){try{return qt(e,r,i)}catch(o){return ic(o)?o:new ve(o)}}),L0=ai(function(e,i){return Or(i,function(o){o=Yr(o),si(e,o,tc(e[o],e))}),e});function D0(e){var i=e==null?0:e.length,o=he();return e=i?st(e,function(c){if(typeof c[1]!="function")throw new Ar(f);return[o(c[0]),c[1]]}):[],xe(function(c){for(var l=-1;++l<i;){var p=e[l];if(qt(p[0],this,c))return qt(p[1],this,c)}})}function F0(e){return ag(Cr(e,P))}function cc(e){return function(){return e}}function j0(e,i){return e==null||e!==e?i:e}var M0=hh(),U0=hh(!0);function fr(e){return e}function uc(e){return qu(typeof e=="function"?e:Cr(e,P))}function q0(e){return ku(Cr(e,P))}function z0(e,i){return Hu(e,Cr(i,P))}var k0=xe(function(e,i){return function(o){return Vn(o,e,i)}}),H0=xe(function(e,i){return function(o){return Vn(e,o,i)}});function hc(e,i,o){var c=zt(i),l=to(i,c);o==null&&!(ht(i)&&(l.length||!c.length))&&(o=i,i=e,e=this,l=to(i,zt(i)));var p=!(ht(o)&&"chain"in o)||!!o.chain,w=ui(e);return Or(l,function(E){var R=i[E];e[E]=R,w&&(e.prototype[E]=function(){var B=this.__chain__;if(p||B){var K=e(this.__wrapped__),G=K.__actions__=ur(this.__actions__);return G.push({func:R,args:arguments,thisArg:e}),K.__chain__=B,K}return R.apply(e,Ei([this.value()],arguments))})}),e}function B0(){return Ae._===this&&(Ae._=yp),this}function lc(){}function K0(e){return e=be(e),xe(function(i){return Bu(i,e)})}var V0=ka(st),W0=ka(lu),G0=ka(da);function cl(e){return Ja(e)?pa(Yr(e)):xg(e)}function J0(e){return function(i){return e==null?r:Bi(e,i)}}var Q0=fh(),Y0=fh(!0);function fc(){return[]}function dc(){return!1}function X0(){return{}}function Z0(){return""}function e1(){return!0}function t1(e,i){if(e=be(e),e<1||e>Y)return[];var o=X,c=Gt(e,X);i=he(i),e-=X;for(var l=va(c,i);++o<e;)i(o);return l}function r1(e){return we(e)?st(e,Yr):br(e)?[e]:ur(Ah(je(e)))}function i1(e){var i=++pp;return je(e)+i}var n1=ao(function(e,i){return e+i},0),s1=Ha("ceil"),o1=ao(function(e,i){return e/i},1),a1=Ha("floor");function c1(e){return e&&e.length?eo(e,fr,Aa):r}function u1(e,i){return e&&e.length?eo(e,he(i,2),Aa):r}function h1(e){return pu(e,fr)}function l1(e,i){return pu(e,he(i,2))}function f1(e){return e&&e.length?eo(e,fr,Na):r}function d1(e,i){return e&&e.length?eo(e,he(i,2),Na):r}var p1=ao(function(e,i){return e*i},1),g1=Ha("round"),y1=ao(function(e,i){return e-i},0);function v1(e){return e&&e.length?ya(e,fr):0}function m1(e,i){return e&&e.length?ya(e,he(i,2)):0}return d.after=qv,d.ary=Uh,d.assign=Om,d.assignIn=Zh,d.assignInWith=_o,d.assignWith=Am,d.at=Rm,d.before=qh,d.bind=tc,d.bindAll=L0,d.bindKey=zh,d.castArray=Xv,d.chain=Fh,d.chunk=ay,d.compact=cy,d.concat=uy,d.cond=D0,d.conforms=F0,d.constant=cc,d.countBy=vv,d.create=Cm,d.curry=kh,d.curryRight=Hh,d.debounce=Bh,d.defaults=Tm,d.defaultsDeep=Nm,d.defer=zv,d.delay=kv,d.difference=hy,d.differenceBy=ly,d.differenceWith=fy,d.drop=dy,d.dropRight=py,d.dropRightWhile=gy,d.dropWhile=yy,d.fill=vy,d.filter=wv,d.flatMap=Ev,d.flatMapDeep=Iv,d.flatMapDepth=xv,d.flatten=Nh,d.flattenDeep=my,d.flattenDepth=wy,d.flip=Hv,d.flow=M0,d.flowRight=U0,d.fromPairs=by,d.functions=Um,d.functionsIn=qm,d.groupBy=Sv,d.initial=Ey,d.intersection=Iy,d.intersectionBy=xy,d.intersectionWith=Sy,d.invert=km,d.invertBy=Hm,d.invokeMap=Ov,d.iteratee=uc,d.keyBy=Av,d.keys=zt,d.keysIn=lr,d.map=go,d.mapKeys=Km,d.mapValues=Vm,d.matches=q0,d.matchesProperty=z0,d.memoize=vo,d.merge=Wm,d.mergeWith=el,d.method=k0,d.methodOf=H0,d.mixin=hc,d.negate=mo,d.nthArg=K0,d.omit=Gm,d.omitBy=Jm,d.once=Bv,d.orderBy=Rv,d.over=V0,d.overArgs=Kv,d.overEvery=W0,d.overSome=G0,d.partial=rc,d.partialRight=Kh,d.partition=Cv,d.pick=Qm,d.pickBy=tl,d.property=cl,d.propertyOf=J0,d.pull=Ry,d.pullAll=Lh,d.pullAllBy=Cy,d.pullAllWith=Ty,d.pullAt=Ny,d.range=Q0,d.rangeRight=Y0,d.rearg=Vv,d.reject=$v,d.remove=$y,d.rest=Wv,d.reverse=Za,d.sampleSize=Dv,d.set=Xm,d.setWith=Zm,d.shuffle=Fv,d.slice=Ly,d.sortBy=Uv,d.sortedUniq=zy,d.sortedUniqBy=ky,d.split=E0,d.spread=Gv,d.tail=Hy,d.take=By,d.takeRight=Ky,d.takeRightWhile=Vy,d.takeWhile=Wy,d.tap=cv,d.throttle=Jv,d.thru=po,d.toArray=Qh,d.toPairs=rl,d.toPairsIn=il,d.toPath=r1,d.toPlainObject=Xh,d.transform=e0,d.unary=Qv,d.union=Gy,d.unionBy=Jy,d.unionWith=Qy,d.uniq=Yy,d.uniqBy=Xy,d.uniqWith=Zy,d.unset=t0,d.unzip=ec,d.unzipWith=Dh,d.update=r0,d.updateWith=i0,d.values=En,d.valuesIn=n0,d.without=ev,d.words=ol,d.wrap=Yv,d.xor=tv,d.xorBy=rv,d.xorWith=iv,d.zip=nv,d.zipObject=sv,d.zipObjectDeep=ov,d.zipWith=av,d.entries=rl,d.entriesIn=il,d.extend=Zh,d.extendWith=_o,hc(d,d),d.add=n1,d.attempt=al,d.camelCase=c0,d.capitalize=nl,d.ceil=s1,d.clamp=s0,d.clone=Zv,d.cloneDeep=tm,d.cloneDeepWith=rm,d.cloneWith=em,d.conformsTo=im,d.deburr=sl,d.defaultTo=j0,d.divide=o1,d.endsWith=u0,d.eq=Ur,d.escape=h0,d.escapeRegExp=l0,d.every=mv,d.find=bv,d.findIndex=Ch,d.findKey=$m,d.findLast=_v,d.findLastIndex=Th,d.findLastKey=Lm,d.floor=a1,d.forEach=jh,d.forEachRight=Mh,d.forIn=Dm,d.forInRight=Fm,d.forOwn=jm,d.forOwnRight=Mm,d.get=sc,d.gt=nm,d.gte=sm,d.has=zm,d.hasIn=oc,d.head=$h,d.identity=fr,d.includes=Pv,d.indexOf=_y,d.inRange=o0,d.invoke=Bm,d.isArguments=Wi,d.isArray=we,d.isArrayBuffer=om,d.isArrayLike=hr,d.isArrayLikeObject=Et,d.isBoolean=am,d.isBuffer=Ri,d.isDate=cm,d.isElement=um,d.isEmpty=hm,d.isEqual=lm,d.isEqualWith=fm,d.isError=ic,d.isFinite=dm,d.isFunction=ui,d.isInteger=Vh,d.isLength=wo,d.isMap=Wh,d.isMatch=pm,d.isMatchWith=gm,d.isNaN=ym,d.isNative=vm,d.isNil=wm,d.isNull=mm,d.isNumber=Gh,d.isObject=ht,d.isObjectLike=mt,d.isPlainObject=Xn,d.isRegExp=nc,d.isSafeInteger=bm,d.isSet=Jh,d.isString=bo,d.isSymbol=br,d.isTypedArray=_n,d.isUndefined=_m,d.isWeakMap=Em,d.isWeakSet=Im,d.join=Py,d.kebabCase=f0,d.last=Nr,d.lastIndexOf=Oy,d.lowerCase=d0,d.lowerFirst=p0,d.lt=xm,d.lte=Sm,d.max=c1,d.maxBy=u1,d.mean=h1,d.meanBy=l1,d.min=f1,d.minBy=d1,d.stubArray=fc,d.stubFalse=dc,d.stubObject=X0,d.stubString=Z0,d.stubTrue=e1,d.multiply=p1,d.nth=Ay,d.noConflict=B0,d.noop=lc,d.now=yo,d.pad=g0,d.padEnd=y0,d.padStart=v0,d.parseInt=m0,d.random=a0,d.reduce=Tv,d.reduceRight=Nv,d.repeat=w0,d.replace=b0,d.result=Ym,d.round=g1,d.runInContext=A,d.sample=Lv,d.size=jv,d.snakeCase=_0,d.some=Mv,d.sortedIndex=Dy,d.sortedIndexBy=Fy,d.sortedIndexOf=jy,d.sortedLastIndex=My,d.sortedLastIndexBy=Uy,d.sortedLastIndexOf=qy,d.startCase=I0,d.startsWith=x0,d.subtract=y1,d.sum=v1,d.sumBy=m1,d.template=S0,d.times=t1,d.toFinite=hi,d.toInteger=be,d.toLength=Yh,d.toLower=P0,d.toNumber=$r,d.toSafeInteger=Pm,d.toString=je,d.toUpper=O0,d.trim=A0,d.trimEnd=R0,d.trimStart=C0,d.truncate=T0,d.unescape=N0,d.uniqueId=i1,d.upperCase=$0,d.upperFirst=ac,d.each=jh,d.eachRight=Mh,d.first=$h,hc(d,function(){var e={};return Jr(d,function(i,o){Ue.call(d.prototype,o)||(e[o]=i)}),e}(),{chain:!1}),d.VERSION=s,Or(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){d[e].placeholder=d}),Or(["drop","take"],function(e,i){Oe.prototype[e]=function(o){o=o===r?1:Mt(be(o),0);var c=this.__filtered__&&!i?new Oe(this):this.clone();return c.__filtered__?c.__takeCount__=Gt(o,c.__takeCount__):c.__views__.push({size:Gt(o,X),type:e+(c.__dir__<0?"Right":"")}),c},Oe.prototype[e+"Right"]=function(o){return this.reverse()[e](o).reverse()}}),Or(["filter","map","takeWhile"],function(e,i){var o=i+1,c=o==m||o==re;Oe.prototype[e]=function(l){var p=this.clone();return p.__iteratees__.push({iteratee:he(l,3),type:o}),p.__filtered__=p.__filtered__||c,p}}),Or(["head","last"],function(e,i){var o="take"+(i?"Right":"");Oe.prototype[e]=function(){return this[o](1).value()[0]}}),Or(["initial","tail"],function(e,i){var o="drop"+(i?"":"Right");Oe.prototype[e]=function(){return this.__filtered__?new Oe(this):this[o](1)}}),Oe.prototype.compact=function(){return this.filter(fr)},Oe.prototype.find=function(e){return this.filter(e).head()},Oe.prototype.findLast=function(e){return this.reverse().find(e)},Oe.prototype.invokeMap=xe(function(e,i){return typeof e=="function"?new Oe(this):this.map(function(o){return Vn(o,e,i)})}),Oe.prototype.reject=function(e){return this.filter(mo(he(e)))},Oe.prototype.slice=function(e,i){e=be(e);var o=this;return o.__filtered__&&(e>0||i<0)?new Oe(o):(e<0?o=o.takeRight(-e):e&&(o=o.drop(e)),i!==r&&(i=be(i),o=i<0?o.dropRight(-i):o.take(i-e)),o)},Oe.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Oe.prototype.toArray=function(){return this.take(X)},Jr(Oe.prototype,function(e,i){var o=/^(?:filter|find|map|reject)|While$/.test(i),c=/^(?:head|last)$/.test(i),l=d[c?"take"+(i=="last"?"Right":""):i],p=c||/^find/.test(i);l&&(d.prototype[i]=function(){var w=this.__wrapped__,E=c?[1]:arguments,R=w instanceof Oe,B=E[0],K=R||we(w),G=function(Se){var Re=l.apply(d,Ei([Se],E));return c&&ee?Re[0]:Re};K&&o&&typeof B=="function"&&B.length!=1&&(R=K=!1);var ee=this.__chain__,oe=!!this.__actions__.length,fe=p&&!ee,Ee=R&&!oe;if(!p&&K){w=Ee?w:new Oe(this);var de=e.apply(w,E);return de.__actions__.push({func:po,args:[G],thisArg:r}),new Rr(de,ee)}return fe&&Ee?e.apply(this,E):(de=this.thru(G),fe?c?de.value()[0]:de.value():de)})}),Or(["pop","push","shift","sort","splice","unshift"],function(e){var i=Us[e],o=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",c=/^(?:pop|shift)$/.test(e);d.prototype[e]=function(){var l=arguments;if(c&&!this.__chain__){var p=this.value();return i.apply(we(p)?p:[],l)}return this[o](function(w){return i.apply(we(w)?w:[],l)})}}),Jr(Oe.prototype,function(e,i){var o=d[i];if(o){var c=o.name+"";Ue.call(yn,c)||(yn[c]=[]),yn[c].push({name:i,func:o})}}),yn[oo(r,le).name]=[{name:"wrapper",func:r}],Oe.prototype.clone=Np,Oe.prototype.reverse=$p,Oe.prototype.value=Lp,d.prototype.at=uv,d.prototype.chain=hv,d.prototype.commit=lv,d.prototype.next=fv,d.prototype.plant=pv,d.prototype.reverse=gv,d.prototype.toJSON=d.prototype.valueOf=d.prototype.value=yv,d.prototype.first=d.prototype.head,Un&&(d.prototype[Un]=dv),d},dn=lp();_t?((_t.exports=dn)._=dn,Ge._=dn):Ae._=dn}).call(ss)})(kc,kc.exports);var Xx=Object.defineProperty,Zx=Object.defineProperties,eS=Object.getOwnPropertyDescriptors,Pf=Object.getOwnPropertySymbols,tS=Object.prototype.hasOwnProperty,rS=Object.prototype.propertyIsEnumerable,Of=(n,t,r)=>t in n?Xx(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Po=(n,t)=>{for(var r in t||(t={}))tS.call(t,r)&&Of(n,r,t[r]);if(Pf)for(var r of Pf(t))rS.call(t,r)&&Of(n,r,t[r]);return n},iS=(n,t)=>Zx(n,eS(t));function Ni(n,t,r){var s;const a=aw(n);return((s=t.rpcMap)==null?void 0:s[a.reference])||`${Yx}?chainId=${a.namespace}:${a.reference}&projectId=${r}`}function tn(n){return n.includes(":")?n.split(":")[1]:n}function qd(n){return n.map(t=>`${t.split(":")[0]}:${t.split(":")[1]}`)}function nS(n,t){const r=Object.keys(t.namespaces).filter(a=>a.includes(n));if(!r.length)return[];const s=[];return r.forEach(a=>{const u=t.namespaces[a].accounts;s.push(...u)}),s}function sS(n={},t={}){const r=Af(n),s=Af(t);return kc.exports.merge(r,s)}function Af(n){var t,r,s,a;const u={};if(!On(n))return u;for(const[f,g]of Object.entries(n)){const b=Zc(f)?[f]:g.chains,y=g.methods||[],_=g.events||[],P=g.rpcMap||{},N=os(f);u[N]=iS(Po(Po({},u[N]),g),{chains:gc(b,(t=u[N])==null?void 0:t.chains),methods:gc(y,(r=u[N])==null?void 0:r.methods),events:gc(_,(s=u[N])==null?void 0:s.events),rpcMap:Po(Po({},P),(a=u[N])==null?void 0:a.rpcMap)})}return u}function oS(n){return n.includes(":")?n.split(":")[2]:n}function aS(n){const t={};for(const[r,s]of Object.entries(n)){const a=s.methods||[],u=s.events||[],f=s.accounts||[],g=Zc(r)?[r]:s.chains?s.chains:qd(s.accounts);t[r]={chains:g,methods:a,events:u,accounts:f}}return t}function Ac(n){return typeof n=="number"?n:n.includes("0x")?parseInt(n,16):n.includes(":")?Number(n.split(":")[1]):Number(n)}const zd={},ot=n=>zd[n],Rc=(n,t)=>{zd[n]=t};class cS{constructor(t){this.name="polkadot",this.namespace=t.namespace,this.events=ot("events"),this.client=ot("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(mi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=tn(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Ni(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new vi(new $i(s,ot("disableProviderPing")))}}class uS{constructor(t){this.name="eip155",this.namespace=t.namespace,this.events=ot("events"),this.client=ot("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(t){switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(t);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(t.request.method)?await this.client.request(t):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(parseInt(t),r),this.chainId=parseInt(t),this.events.emit(mi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,r){const s=r||Ni(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new vi(new $i(s,ot("disableProviderPing")))}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=parseInt(tn(r));t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const t=this.chainId,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}async handleSwitchChain(t){var r,s;let a=t.request.params?(r=t.request.params[0])==null?void 0:r.chainId:"0x0";a=a.startsWith("0x")?a:`0x${a}`;const u=parseInt(a,16);if(this.isChainApproved(u))this.setDefaultChain(`${u}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:t.topic,request:{method:t.request.method,params:[{chainId:a}]},chainId:(s=this.namespace.chains)==null?void 0:s[0]}),this.setDefaultChain(`${u}`);else throw new Error(`Failed to switch to chain 'eip155:${u}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(t){return this.namespace.chains.includes(`${this.name}:${t}`)}}class hS{constructor(t){this.name="solana",this.namespace=t.namespace,this.events=ot("events"),this.client=ot("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(mi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=tn(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Ni(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new vi(new $i(s,ot("disableProviderPing")))}}class lS{constructor(t){this.name="cosmos",this.namespace=t.namespace,this.events=ot("events"),this.client=ot("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(mi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=tn(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Ni(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new vi(new $i(s,ot("disableProviderPing")))}}class fS{constructor(t){this.name="cip34",this.namespace=t.namespace,this.events=ot("events"),this.client=ot("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(mi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{const s=this.getCardanoRPCUrl(r),a=tn(r);t[a]=this.createHttpProvider(a,s)}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}getCardanoRPCUrl(t){const r=this.namespace.rpcMap;if(r)return r[t]}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||this.getCardanoRPCUrl(t);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new vi(new $i(s,ot("disableProviderPing")))}}class dS{constructor(t){this.name="elrond",this.namespace=t.namespace,this.events=ot("events"),this.client=ot("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(mi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=tn(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Ni(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new vi(new $i(s,ot("disableProviderPing")))}}class pS{constructor(t){this.name="multiversx",this.namespace=t.namespace,this.events=ot("events"),this.client=ot("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(mi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=tn(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Ni(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new vi(new $i(s,ot("disableProviderPing")))}}class gS{constructor(t){this.name="near",this.namespace=t.namespace,this.events=ot("events"),this.client=ot("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const s=r||Ni(`${this.name}:${t}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(mi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Ni(t,this.namespace);return typeof s>"u"?void 0:new vi(new $i(s,ot("disableProviderPing")))}}var yS=Object.defineProperty,vS=Object.defineProperties,mS=Object.getOwnPropertyDescriptors,Rf=Object.getOwnPropertySymbols,wS=Object.prototype.hasOwnProperty,bS=Object.prototype.propertyIsEnumerable,Cf=(n,t,r)=>t in n?yS(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Oo=(n,t)=>{for(var r in t||(t={}))wS.call(t,r)&&Cf(n,r,t[r]);if(Rf)for(var r of Rf(t))bS.call(t,r)&&Cf(n,r,t[r]);return n},Cc=(n,t)=>vS(n,mS(t));class uu{constructor(t){this.events=new Jc,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=t,this.logger=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Ce.pino(Ce.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||xf})),this.disableProviderPing=(t==null?void 0:t.disableProviderPing)||!1}static async init(t){const r=new uu(t);return await r.initialize(),r}async request(t,r){const[s,a]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:Oo({},t),chainId:`${s}:${a}`,topic:this.session.topic})}sendAsync(t,r,s){this.request(t,s).then(a=>r(null,a)).catch(a=>r(a,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:xt("USER_DISCONNECTED")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),await this.cleanupPendingPairings(),!t.skipPairing)return await this.pair(t.pairingTopic)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}removeListener(t,r){this.events.removeListener(t,r)}off(t,r){this.events.off(t,r)}get isWalletConnect(){return!0}async pair(t){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:a}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await a().then(u=>{this.session=u,this.namespaces||(this.namespaces=aS(u.namespaces),this.persist("namespaces",this.namespaces))}).catch(u=>{if(u.message!==Md)throw u;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(t,r){try{if(!this.session)return;const[s,a]=this.validateChain(t);this.getProvider(s).setDefaultChain(a,r)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(t={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(Zr(r)){for(const s of r)t.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await Bx.init({logger:this.providerOpts.logger||xf,relayUrl:this.providerOpts.relayUrl||Gx,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const t=[...new Set(Object.keys(this.session.namespaces).map(r=>os(r)))];Rc("client",this.client),Rc("events",this.events),Rc("disableProviderPing",this.disableProviderPing),t.forEach(r=>{if(!this.session)return;const s=nS(r,this.session),a=qd(s),u=sS(this.namespaces,this.optionalNamespaces),f=Cc(Oo({},u[r]),{accounts:s,chains:a});switch(r){case"eip155":this.rpcProviders[r]=new uS({namespace:f});break;case"solana":this.rpcProviders[r]=new hS({namespace:f});break;case"cosmos":this.rpcProviders[r]=new lS({namespace:f});break;case"polkadot":this.rpcProviders[r]=new cS({namespace:f});break;case"cip34":this.rpcProviders[r]=new fS({namespace:f});break;case"elrond":this.rpcProviders[r]=new dS({namespace:f});break;case"multiversx":this.rpcProviders[r]=new pS({namespace:f});break;case"near":this.rpcProviders[r]=new gS({namespace:f});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",t=>{this.events.emit("session_ping",t)}),this.client.on("session_event",t=>{const{params:r}=t,{event:s}=r;if(s.name==="accountsChanged"){const a=s.data;a&&Zr(a)&&this.events.emit("accountsChanged",a.map(oS))}else if(s.name==="chainChanged"){const a=r.chainId,u=r.event.data,f=os(a),g=Ac(a)!==Ac(u)?`${f}:${Ac(u)}`:a;this.onChainChanged(g)}else this.events.emit(s.name,s.data);this.events.emit("session_event",t)}),this.client.on("session_update",({topic:t,params:r})=>{var s;const{namespaces:a}=r,u=(s=this.client)==null?void 0:s.session.get(t);this.session=Cc(Oo({},u),{namespaces:a}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:r})}),this.client.on("session_delete",async t=>{await this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",Cc(Oo({},xt("USER_DISCONNECTED")),{data:t.topic}))}),this.on(mi.DEFAULT_CHAIN_CHANGED,t=>{this.onChainChanged(t,!0)})}getProvider(t){if(!this.rpcProviders[t])throw new Error(`Provider not found: ${t}`);return this.rpcProviders[t]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var r;this.getProvider(t).updateNamespace((r=this.session)==null?void 0:r.namespaces[t])})}setNamespaces(t){const{namespaces:r,optionalNamespaces:s,sessionProperties:a}=t;r&&Object.keys(r).length&&(this.namespaces=r),s&&Object.keys(s).length&&(this.optionalNamespaces=s),this.sessionProperties=a,this.persist("namespaces",r),this.persist("optionalNamespaces",s)}validateChain(t){const[r,s]=(t==null?void 0:t.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,s];if(r&&!Object.keys(this.namespaces||{}).map(f=>os(f)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&s)return[r,s];const a=os(Object.keys(this.namespaces)[0]),u=this.rpcProviders[a].getDefaultChain();return[a,u]}async requestAccounts(){const[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}onChainChanged(t,r=!1){var s;if(!this.namespaces)return;const[a,u]=this.validateChain(t);r||this.getProvider(a).setDefaultChain(u),((s=this.namespaces[a])!=null?s:this.namespaces[`${a}:${u}`]).defaultChain=u,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",u)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(t,r){this.client.core.storage.setItem(`${Sf}/${t}`,r)}async getFromStore(t){return await this.client.core.storage.getItem(`${Sf}/${t}`)}}const _S=uu,ES="wc",IS="ethereum_provider",xS=`${ES}@2:${IS}:`,SS="https://rpc.walletconnect.com/v1/",Hc=["eth_sendTransaction","personal_sign"],PS=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],Bc=["chainChanged","accountsChanged"],OS=["chainChanged","accountsChanged","message","disconnect","connect"];var AS=Object.defineProperty,RS=Object.defineProperties,CS=Object.getOwnPropertyDescriptors,Tf=Object.getOwnPropertySymbols,TS=Object.prototype.hasOwnProperty,NS=Object.prototype.propertyIsEnumerable,Nf=(n,t,r)=>t in n?AS(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,cs=(n,t)=>{for(var r in t||(t={}))TS.call(t,r)&&Nf(n,r,t[r]);if(Tf)for(var r of Tf(t))NS.call(t,r)&&Nf(n,r,t[r]);return n},$f=(n,t)=>RS(n,CS(t));function jo(n){return Number(n[0].split(":")[1])}function Tc(n){return`0x${n.toString(16)}`}function $S(n){const{chains:t,optionalChains:r,methods:s,optionalMethods:a,events:u,optionalEvents:f,rpcMap:g}=n;if(!Zr(t))throw new Error("Invalid chains");const b={chains:t,methods:s||Hc,events:u||Bc,rpcMap:cs({},t.length?{[jo(t)]:g[jo(t)]}:{})},y=u==null?void 0:u.filter(H=>!Bc.includes(H)),_=s==null?void 0:s.filter(H=>!Hc.includes(H));if(!r&&!f&&!a&&!(y!=null&&y.length)&&!(_!=null&&_.length))return{required:t.length?b:void 0};const P=(y==null?void 0:y.length)&&(_==null?void 0:_.length)||!r,N={chains:[...new Set(P?b.chains.concat(r||[]):r)],methods:[...new Set(b.methods.concat(a!=null&&a.length?a:PS))],events:[...new Set(b.events.concat(f!=null&&f.length?f:OS))],rpcMap:g};return{required:t.length?b:void 0,optional:r.length?N:void 0}}class hu{constructor(){this.events=new xr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=xS,this.on=(t,r)=>(this.events.on(t,r),this),this.once=(t,r)=>(this.events.once(t,r),this),this.removeListener=(t,r)=>(this.events.removeListener(t,r),this),this.off=(t,r)=>(this.events.off(t,r),this),this.parseAccount=t=>this.isCompatibleChainId(t)?this.parseAccountId(t).address:t,this.signer={},this.rpc={}}static async init(t){const r=new hu;return await r.initialize(t),r}async request(t){return await this.signer.request(t,this.formatChainId(this.chainId))}sendAsync(t,r){this.signer.sendAsync(t,r,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(t);const{required:r,optional:s}=$S(this.rpc);try{const a=await new Promise(async(f,g)=>{var b;this.rpc.showQrModal&&((b=this.modal)==null||b.subscribeModal(y=>{!y.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),g(new Error("Connection request reset. Please try again.")))})),await this.signer.connect($f(cs({namespaces:cs({},r&&{[this.namespace]:r})},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:t==null?void 0:t.pairingTopic})).then(y=>{f(y)}).catch(y=>{g(new Error(y.message))})});if(!a)return;const u=cw(a.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:u),this.setAccounts(u),this.events.emit("connect",{chainId:Tc(this.chainId)})}catch(a){throw this.signer.logger.error(a),a}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",t=>{const{params:r}=t,{event:s}=r;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",t)}),this.signer.on("chainChanged",t=>{const r=parseInt(t);this.chainId=r,this.events.emit("chainChanged",Tc(this.chainId)),this.persist()}),this.signer.on("session_update",t=>{this.events.emit("session_update",t)}),this.signer.on("session_delete",t=>{this.reset(),this.events.emit("session_delete",t),this.events.emit("disconnect",$f(cs({},xt("USER_DISCONNECTED")),{data:t.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",t=>{var r,s;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(s=this.modal)==null||s.openModal({uri:t})),this.events.emit("display_uri",t)})}switchEthereumChain(t){this.request({method:"wallet_switchEthereumChain",params:[{chainId:t.toString(16)}]})}isCompatibleChainId(t){return typeof t=="string"?t.startsWith(`${this.namespace}:`):!1}formatChainId(t){return`${this.namespace}:${t}`}parseChainId(t){return Number(t.split(":")[1])}setChainIds(t){const r=t.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",Tc(this.chainId)),this.persist())}setChainId(t){if(this.isCompatibleChainId(t)){const r=this.parseChainId(t);this.chainId=r,this.switchEthereumChain(r)}}parseAccountId(t){const[r,s,a]=t.split(":");return{chainId:`${r}:${s}`,address:a}}setAccounts(t){this.accounts=t.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(t){var r,s;const a=(r=t==null?void 0:t.chains)!=null?r:[],u=(s=t==null?void 0:t.optionalChains)!=null?s:[],f=a.concat(u);if(!f.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const g=a.length?(t==null?void 0:t.methods)||Hc:[],b=a.length?(t==null?void 0:t.events)||Bc:[],y=(t==null?void 0:t.optionalMethods)||[],_=(t==null?void 0:t.optionalEvents)||[],P=(t==null?void 0:t.rpcMap)||this.buildRpcMap(f,t.projectId),N=(t==null?void 0:t.qrModalOptions)||void 0;return{chains:a==null?void 0:a.map(H=>this.formatChainId(H)),optionalChains:u.map(H=>this.formatChainId(H)),methods:g,events:b,optionalMethods:y,optionalEvents:_,rpcMap:P,showQrModal:!!(t!=null&&t.showQrModal),qrModalOptions:N,projectId:t.projectId,metadata:t.metadata}}buildRpcMap(t,r){const s={};return t.forEach(a=>{s[a]=this.getRpcUrl(a,r)}),s}async initialize(t){if(this.rpc=this.getRpcConfig(t),this.chainId=this.rpc.chains.length?jo(this.rpc.chains):jo(this.rpc.optionalChains),this.signer=await _S.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:t.disableProviderPing,relayUrl:t.relayUrl,storageOptions:t.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let r;try{const{WalletConnectModal:s}=await U1(()=>import("./index-d3e292a8.js").then(a=>a.i),["assets/index-d3e292a8.js","assets/index-2d27a8d2.js","assets/index-8c31665f.css"]);r=s}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(r)try{this.modal=new r(cs({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(t){if(!t)return;const{chains:r,optionalChains:s,rpcMap:a}=t;r&&Zr(r)&&(this.rpc.chains=r.map(u=>this.formatChainId(u)),r.forEach(u=>{this.rpc.rpcMap[u]=(a==null?void 0:a[u])||this.getRpcUrl(u)})),s&&Zr(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s==null?void 0:s.map(u=>this.formatChainId(u)),s.forEach(u=>{this.rpc.rpcMap[u]=(a==null?void 0:a[u])||this.getRpcUrl(u)}))}getRpcUrl(t,r){var s;return((s=this.rpc.rpcMap)==null?void 0:s[t])||`${SS}?chainId=eip155:${t}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const t=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),r=this.session.namespaces[`${this.namespace}:${t}`]?this.session.namespaces[`${this.namespace}:${t}`]:this.session.namespaces[this.namespace];this.setChainIds(t?[this.formatChainId(t)]:r==null?void 0:r.accounts),this.setAccounts(r==null?void 0:r.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(t){return typeof t=="string"||t instanceof String?[this.parseAccount(t)]:t.map(r=>this.parseAccount(r))}}const QS=hu;export{QS as EthereumProvider,OS as OPTIONAL_EVENTS,PS as OPTIONAL_METHODS,Bc as REQUIRED_EVENTS,Hc as REQUIRED_METHODS,hu as default};
