import{r as Mc,c as nt,g as jc,a as Hc,_ as qc}from"./index-52750c41.js";var Ze={},Bc={get exports(){return Ze},set exports(r){Ze=r}},hr=typeof Reflect=="object"?Reflect:null,js=hr&&typeof hr.apply=="function"?hr.apply:function(e,t,i){return Function.prototype.apply.call(e,t,i)},ei;hr&&typeof hr.ownKeys=="function"?ei=hr.ownKeys:Object.getOwnPropertySymbols?ei=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:ei=function(e){return Object.getOwnPropertyNames(e)};function zc(r){console&&console.warn&&console.warn(r)}var Eo=Number.isNaN||function(e){return e!==e};function Ie(){Ie.init.call(this)}Bc.exports=Ie;Ze.once=kc;Ie.EventEmitter=Ie;Ie.prototype._events=void 0;Ie.prototype._eventsCount=0;Ie.prototype._maxListeners=void 0;var Hs=10;function li(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(Ie,"defaultMaxListeners",{enumerable:!0,get:function(){return Hs},set:function(r){if(typeof r!="number"||r<0||Eo(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");Hs=r}});Ie.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Ie.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Eo(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Do(r){return r._maxListeners===void 0?Ie.defaultMaxListeners:r._maxListeners}Ie.prototype.getMaxListeners=function(){return Do(this)};Ie.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var s=e==="error",a=this._events;if(a!==void 0)s=s&&a.error===void 0;else if(!s)return!1;if(s){var h;if(t.length>0&&(h=t[0]),h instanceof Error)throw h;var c=new Error("Unhandled error."+(h?" ("+h.message+")":""));throw c.context=h,c}var u=a[e];if(u===void 0)return!1;if(typeof u=="function")js(u,this,t);else for(var g=u.length,b=Po(u,g),i=0;i<g;++i)js(b[i],this,t);return!0};function So(r,e,t,i){var s,a,h;if(li(t),a=r._events,a===void 0?(a=r._events=Object.create(null),r._eventsCount=0):(a.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),a=r._events),h=a[e]),h===void 0)h=a[e]=t,++r._eventsCount;else if(typeof h=="function"?h=a[e]=i?[t,h]:[h,t]:i?h.unshift(t):h.push(t),s=Do(r),s>0&&h.length>s&&!h.warned){h.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+h.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=r,c.type=e,c.count=h.length,zc(c)}return r}Ie.prototype.addListener=function(e,t){return So(this,e,t,!1)};Ie.prototype.on=Ie.prototype.addListener;Ie.prototype.prependListener=function(e,t){return So(this,e,t,!0)};function Kc(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Io(r,e,t){var i={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},s=Kc.bind(i);return s.listener=t,i.wrapFn=s,s}Ie.prototype.once=function(e,t){return li(t),this.on(e,Io(this,e,t)),this};Ie.prototype.prependOnceListener=function(e,t){return li(t),this.prependListener(e,Io(this,e,t)),this};Ie.prototype.removeListener=function(e,t){var i,s,a,h,c;if(li(t),s=this._events,s===void 0)return this;if(i=s[e],i===void 0)return this;if(i===t||i.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete s[e],s.removeListener&&this.emit("removeListener",e,i.listener||t));else if(typeof i!="function"){for(a=-1,h=i.length-1;h>=0;h--)if(i[h]===t||i[h].listener===t){c=i[h].listener,a=h;break}if(a<0)return this;a===0?i.shift():Vc(i,a),i.length===1&&(s[e]=i[0]),s.removeListener!==void 0&&this.emit("removeListener",e,c||t)}return this};Ie.prototype.off=Ie.prototype.removeListener;Ie.prototype.removeAllListeners=function(e){var t,i,s;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var a=Object.keys(i),h;for(s=0;s<a.length;++s)h=a[s],h!=="removeListener"&&this.removeAllListeners(h);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=i[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(s=t.length-1;s>=0;s--)this.removeListener(e,t[s]);return this};function Oo(r,e,t){var i=r._events;if(i===void 0)return[];var s=i[e];return s===void 0?[]:typeof s=="function"?t?[s.listener||s]:[s]:t?Gc(s):Po(s,s.length)}Ie.prototype.listeners=function(e){return Oo(this,e,!0)};Ie.prototype.rawListeners=function(e){return Oo(this,e,!1)};Ie.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):xo.call(r,e)};Ie.prototype.listenerCount=xo;function xo(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}Ie.prototype.eventNames=function(){return this._eventsCount>0?ei(this._events):[]};function Po(r,e){for(var t=new Array(e),i=0;i<e;++i)t[i]=r[i];return t}function Vc(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function Gc(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function kc(r,e){return new Promise(function(t,i){function s(h){r.removeListener(e,a),i(h)}function a(){typeof r.removeListener=="function"&&r.removeListener("error",s),t([].slice.call(arguments))}Ao(r,e,a,{once:!0}),e!=="error"&&Wc(r,s,{once:!0})})}function Wc(r,e,t){typeof r.on=="function"&&Ao(r,"error",e,t)}function Ao(r,e,t,i){if(typeof r.on=="function")i.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function s(a){i.once&&r.removeEventListener(e,s),t(a)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}var as={},fi={},ie={},Co={};(function(r){Object.defineProperty(r,"__esModule",{value:!0});function e(c,u){var g=c>>>16&65535,b=c&65535,E=u>>>16&65535,F=u&65535;return b*F+(g*F+b*E<<16>>>0)|0}r.mul=Math.imul||e;function t(c,u){return c+u|0}r.add=t;function i(c,u){return c-u|0}r.sub=i;function s(c,u){return c<<u|c>>>32-u}r.rotl=s;function a(c,u){return c<<32-u|c>>>u}r.rotr=a;function h(c){return typeof c=="number"&&isFinite(c)&&Math.floor(c)===c}r.isInteger=Number.isInteger||h,r.MAX_SAFE_INTEGER=9007199254740991,r.isSafeInteger=function(c){return r.isInteger(c)&&c>=-r.MAX_SAFE_INTEGER&&c<=r.MAX_SAFE_INTEGER}})(Co);Object.defineProperty(ie,"__esModule",{value:!0});var Ro=Co;function Yc(r,e){return e===void 0&&(e=0),(r[e+0]<<8|r[e+1])<<16>>16}ie.readInt16BE=Yc;function Jc(r,e){return e===void 0&&(e=0),(r[e+0]<<8|r[e+1])>>>0}ie.readUint16BE=Jc;function Xc(r,e){return e===void 0&&(e=0),(r[e+1]<<8|r[e])<<16>>16}ie.readInt16LE=Xc;function Qc(r,e){return e===void 0&&(e=0),(r[e+1]<<8|r[e])>>>0}ie.readUint16LE=Qc;function To(r,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=r>>>8,e[t+1]=r>>>0,e}ie.writeUint16BE=To;ie.writeInt16BE=To;function No(r,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=r>>>0,e[t+1]=r>>>8,e}ie.writeUint16LE=No;ie.writeInt16LE=No;function Bi(r,e){return e===void 0&&(e=0),r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3]}ie.readInt32BE=Bi;function zi(r,e){return e===void 0&&(e=0),(r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3])>>>0}ie.readUint32BE=zi;function Ki(r,e){return e===void 0&&(e=0),r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e]}ie.readInt32LE=Ki;function Vi(r,e){return e===void 0&&(e=0),(r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e])>>>0}ie.readUint32LE=Vi;function ii(r,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=r>>>24,e[t+1]=r>>>16,e[t+2]=r>>>8,e[t+3]=r>>>0,e}ie.writeUint32BE=ii;ie.writeInt32BE=ii;function si(r,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=r>>>0,e[t+1]=r>>>8,e[t+2]=r>>>16,e[t+3]=r>>>24,e}ie.writeUint32LE=si;ie.writeInt32LE=si;function Zc(r,e){e===void 0&&(e=0);var t=Bi(r,e),i=Bi(r,e+4);return t*4294967296+i-(i>>31)*4294967296}ie.readInt64BE=Zc;function eh(r,e){e===void 0&&(e=0);var t=zi(r,e),i=zi(r,e+4);return t*4294967296+i}ie.readUint64BE=eh;function th(r,e){e===void 0&&(e=0);var t=Ki(r,e),i=Ki(r,e+4);return i*4294967296+t-(t>>31)*4294967296}ie.readInt64LE=th;function rh(r,e){e===void 0&&(e=0);var t=Vi(r,e),i=Vi(r,e+4);return i*4294967296+t}ie.readUint64LE=rh;function Lo(r,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),ii(r/4294967296>>>0,e,t),ii(r>>>0,e,t+4),e}ie.writeUint64BE=Lo;ie.writeInt64BE=Lo;function Fo(r,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),si(r>>>0,e,t),si(r/4294967296>>>0,e,t+4),e}ie.writeUint64LE=Fo;ie.writeInt64LE=Fo;function ih(r,e,t){if(t===void 0&&(t=0),r%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(r/8>e.length-t)throw new Error("readUintBE: array is too short for the given bitLength");for(var i=0,s=1,a=r/8+t-1;a>=t;a--)i+=e[a]*s,s*=256;return i}ie.readUintBE=ih;function sh(r,e,t){if(t===void 0&&(t=0),r%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(r/8>e.length-t)throw new Error("readUintLE: array is too short for the given bitLength");for(var i=0,s=1,a=t;a<t+r/8;a++)i+=e[a]*s,s*=256;return i}ie.readUintLE=sh;function nh(r,e,t,i){if(t===void 0&&(t=new Uint8Array(r/8)),i===void 0&&(i=0),r%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!Ro.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var s=1,a=r/8+i-1;a>=i;a--)t[a]=e/s&255,s*=256;return t}ie.writeUintBE=nh;function oh(r,e,t,i){if(t===void 0&&(t=new Uint8Array(r/8)),i===void 0&&(i=0),r%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!Ro.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var s=1,a=i;a<i+r/8;a++)t[a]=e/s&255,s*=256;return t}ie.writeUintLE=oh;function ah(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat32(e)}ie.readFloat32BE=ah;function ch(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat32(e,!0)}ie.readFloat32LE=ch;function hh(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat64(e)}ie.readFloat64BE=hh;function uh(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat64(e,!0)}ie.readFloat64LE=uh;function lh(r,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(t,r),e}ie.writeFloat32BE=lh;function fh(r,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(t,r,!0),e}ie.writeFloat32LE=fh;function dh(r,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(t,r),e}ie.writeFloat64BE=dh;function ph(r,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(t,r,!0),e}ie.writeFloat64LE=ph;var gt={};Object.defineProperty(gt,"__esModule",{value:!0});function gh(r){for(var e=0;e<r.length;e++)r[e]=0;return r}gt.wipe=gh;Object.defineProperty(fi,"__esModule",{value:!0});var st=ie,Gi=gt,yh=20;function bh(r,e,t){for(var i=1634760805,s=857760878,a=2036477234,h=1797285236,c=t[3]<<24|t[2]<<16|t[1]<<8|t[0],u=t[7]<<24|t[6]<<16|t[5]<<8|t[4],g=t[11]<<24|t[10]<<16|t[9]<<8|t[8],b=t[15]<<24|t[14]<<16|t[13]<<8|t[12],E=t[19]<<24|t[18]<<16|t[17]<<8|t[16],F=t[23]<<24|t[22]<<16|t[21]<<8|t[20],I=t[27]<<24|t[26]<<16|t[25]<<8|t[24],w=t[31]<<24|t[30]<<16|t[29]<<8|t[28],j=e[3]<<24|e[2]<<16|e[1]<<8|e[0],M=e[7]<<24|e[6]<<16|e[5]<<8|e[4],V=e[11]<<24|e[10]<<16|e[9]<<8|e[8],D=e[15]<<24|e[14]<<16|e[13]<<8|e[12],P=i,y=s,_=a,v=h,n=c,f=u,z=g,S=b,T=E,N=F,H=I,l=w,d=j,L=M,$=V,U=D,A=0;A<yh;A+=2)P=P+n|0,d^=P,d=d>>>32-16|d<<16,T=T+d|0,n^=T,n=n>>>32-12|n<<12,y=y+f|0,L^=y,L=L>>>32-16|L<<16,N=N+L|0,f^=N,f=f>>>32-12|f<<12,_=_+z|0,$^=_,$=$>>>32-16|$<<16,H=H+$|0,z^=H,z=z>>>32-12|z<<12,v=v+S|0,U^=v,U=U>>>32-16|U<<16,l=l+U|0,S^=l,S=S>>>32-12|S<<12,_=_+z|0,$^=_,$=$>>>32-8|$<<8,H=H+$|0,z^=H,z=z>>>32-7|z<<7,v=v+S|0,U^=v,U=U>>>32-8|U<<8,l=l+U|0,S^=l,S=S>>>32-7|S<<7,y=y+f|0,L^=y,L=L>>>32-8|L<<8,N=N+L|0,f^=N,f=f>>>32-7|f<<7,P=P+n|0,d^=P,d=d>>>32-8|d<<8,T=T+d|0,n^=T,n=n>>>32-7|n<<7,P=P+f|0,U^=P,U=U>>>32-16|U<<16,H=H+U|0,f^=H,f=f>>>32-12|f<<12,y=y+z|0,d^=y,d=d>>>32-16|d<<16,l=l+d|0,z^=l,z=z>>>32-12|z<<12,_=_+S|0,L^=_,L=L>>>32-16|L<<16,T=T+L|0,S^=T,S=S>>>32-12|S<<12,v=v+n|0,$^=v,$=$>>>32-16|$<<16,N=N+$|0,n^=N,n=n>>>32-12|n<<12,_=_+S|0,L^=_,L=L>>>32-8|L<<8,T=T+L|0,S^=T,S=S>>>32-7|S<<7,v=v+n|0,$^=v,$=$>>>32-8|$<<8,N=N+$|0,n^=N,n=n>>>32-7|n<<7,y=y+z|0,d^=y,d=d>>>32-8|d<<8,l=l+d|0,z^=l,z=z>>>32-7|z<<7,P=P+f|0,U^=P,U=U>>>32-8|U<<8,H=H+U|0,f^=H,f=f>>>32-7|f<<7;st.writeUint32LE(P+i|0,r,0),st.writeUint32LE(y+s|0,r,4),st.writeUint32LE(_+a|0,r,8),st.writeUint32LE(v+h|0,r,12),st.writeUint32LE(n+c|0,r,16),st.writeUint32LE(f+u|0,r,20),st.writeUint32LE(z+g|0,r,24),st.writeUint32LE(S+b|0,r,28),st.writeUint32LE(T+E|0,r,32),st.writeUint32LE(N+F|0,r,36),st.writeUint32LE(H+I|0,r,40),st.writeUint32LE(l+w|0,r,44),st.writeUint32LE(d+j|0,r,48),st.writeUint32LE(L+M|0,r,52),st.writeUint32LE($+V|0,r,56),st.writeUint32LE(U+D|0,r,60)}function Uo(r,e,t,i,s){if(s===void 0&&(s=0),r.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(i.length<t.length)throw new Error("ChaCha: destination is shorter than source");var a,h;if(s===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");a=new Uint8Array(16),h=a.length-e.length,a.set(e,h)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");a=e,h=s}for(var c=new Uint8Array(64),u=0;u<t.length;u+=64){bh(c,a,r);for(var g=u;g<u+64&&g<t.length;g++)i[g]=t[g]^c[g-u];vh(a,0,h)}return Gi.wipe(c),s===0&&Gi.wipe(a),i}fi.streamXOR=Uo;function mh(r,e,t,i){return i===void 0&&(i=0),Gi.wipe(t),Uo(r,e,t,t,i)}fi.stream=mh;function vh(r,e,t){for(var i=1;t--;)i=i+(r[e]&255)|0,r[e]=i&255,i>>>=8,e++;if(i>0)throw new Error("ChaCha: counter overflow")}var $o={},Bt={};Object.defineProperty(Bt,"__esModule",{value:!0});function _h(r,e,t){return~(r-1)&e|r-1&t}Bt.select=_h;function wh(r,e){return(r|0)-(e|0)-1>>>31&1}Bt.lessOrEqual=wh;function Mo(r,e){if(r.length!==e.length)return 0;for(var t=0,i=0;i<r.length;i++)t|=r[i]^e[i];return 1&t-1>>>8}Bt.compare=Mo;function Eh(r,e){return r.length===0||e.length===0?!1:Mo(r,e)!==0}Bt.equal=Eh;(function(r){Object.defineProperty(r,"__esModule",{value:!0});var e=Bt,t=gt;r.DIGEST_LENGTH=16;var i=function(){function h(c){this.digestLength=r.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var u=c[0]|c[1]<<8;this._r[0]=u&8191;var g=c[2]|c[3]<<8;this._r[1]=(u>>>13|g<<3)&8191;var b=c[4]|c[5]<<8;this._r[2]=(g>>>10|b<<6)&7939;var E=c[6]|c[7]<<8;this._r[3]=(b>>>7|E<<9)&8191;var F=c[8]|c[9]<<8;this._r[4]=(E>>>4|F<<12)&255,this._r[5]=F>>>1&8190;var I=c[10]|c[11]<<8;this._r[6]=(F>>>14|I<<2)&8191;var w=c[12]|c[13]<<8;this._r[7]=(I>>>11|w<<5)&8065;var j=c[14]|c[15]<<8;this._r[8]=(w>>>8|j<<8)&8191,this._r[9]=j>>>5&127,this._pad[0]=c[16]|c[17]<<8,this._pad[1]=c[18]|c[19]<<8,this._pad[2]=c[20]|c[21]<<8,this._pad[3]=c[22]|c[23]<<8,this._pad[4]=c[24]|c[25]<<8,this._pad[5]=c[26]|c[27]<<8,this._pad[6]=c[28]|c[29]<<8,this._pad[7]=c[30]|c[31]<<8}return h.prototype._blocks=function(c,u,g){for(var b=this._fin?0:2048,E=this._h[0],F=this._h[1],I=this._h[2],w=this._h[3],j=this._h[4],M=this._h[5],V=this._h[6],D=this._h[7],P=this._h[8],y=this._h[9],_=this._r[0],v=this._r[1],n=this._r[2],f=this._r[3],z=this._r[4],S=this._r[5],T=this._r[6],N=this._r[7],H=this._r[8],l=this._r[9];g>=16;){var d=c[u+0]|c[u+1]<<8;E+=d&8191;var L=c[u+2]|c[u+3]<<8;F+=(d>>>13|L<<3)&8191;var $=c[u+4]|c[u+5]<<8;I+=(L>>>10|$<<6)&8191;var U=c[u+6]|c[u+7]<<8;w+=($>>>7|U<<9)&8191;var A=c[u+8]|c[u+9]<<8;j+=(U>>>4|A<<12)&8191,M+=A>>>1&8191;var q=c[u+10]|c[u+11]<<8;V+=(A>>>14|q<<2)&8191;var K=c[u+12]|c[u+13]<<8;D+=(q>>>11|K<<5)&8191;var Q=c[u+14]|c[u+15]<<8;P+=(K>>>8|Q<<8)&8191,y+=Q>>>5|b;var G=0,Z=G;Z+=E*_,Z+=F*(5*l),Z+=I*(5*H),Z+=w*(5*N),Z+=j*(5*T),G=Z>>>13,Z&=8191,Z+=M*(5*S),Z+=V*(5*z),Z+=D*(5*f),Z+=P*(5*n),Z+=y*(5*v),G+=Z>>>13,Z&=8191;var X=G;X+=E*v,X+=F*_,X+=I*(5*l),X+=w*(5*H),X+=j*(5*N),G=X>>>13,X&=8191,X+=M*(5*T),X+=V*(5*S),X+=D*(5*z),X+=P*(5*f),X+=y*(5*n),G+=X>>>13,X&=8191;var ae=G;ae+=E*n,ae+=F*v,ae+=I*_,ae+=w*(5*l),ae+=j*(5*H),G=ae>>>13,ae&=8191,ae+=M*(5*N),ae+=V*(5*T),ae+=D*(5*S),ae+=P*(5*z),ae+=y*(5*f),G+=ae>>>13,ae&=8191;var R=G;R+=E*f,R+=F*n,R+=I*v,R+=w*_,R+=j*(5*l),G=R>>>13,R&=8191,R+=M*(5*H),R+=V*(5*N),R+=D*(5*T),R+=P*(5*S),R+=y*(5*z),G+=R>>>13,R&=8191;var C=G;C+=E*z,C+=F*f,C+=I*n,C+=w*v,C+=j*_,G=C>>>13,C&=8191,C+=M*(5*l),C+=V*(5*H),C+=D*(5*N),C+=P*(5*T),C+=y*(5*S),G+=C>>>13,C&=8191;var O=G;O+=E*S,O+=F*z,O+=I*f,O+=w*n,O+=j*v,G=O>>>13,O&=8191,O+=M*_,O+=V*(5*l),O+=D*(5*H),O+=P*(5*N),O+=y*(5*T),G+=O>>>13,O&=8191;var o=G;o+=E*T,o+=F*S,o+=I*z,o+=w*f,o+=j*n,G=o>>>13,o&=8191,o+=M*v,o+=V*_,o+=D*(5*l),o+=P*(5*H),o+=y*(5*N),G+=o>>>13,o&=8191;var m=G;m+=E*N,m+=F*T,m+=I*S,m+=w*z,m+=j*f,G=m>>>13,m&=8191,m+=M*n,m+=V*v,m+=D*_,m+=P*(5*l),m+=y*(5*H),G+=m>>>13,m&=8191;var k=G;k+=E*H,k+=F*N,k+=I*T,k+=w*S,k+=j*z,G=k>>>13,k&=8191,k+=M*f,k+=V*n,k+=D*v,k+=P*_,k+=y*(5*l),G+=k>>>13,k&=8191;var Y=G;Y+=E*l,Y+=F*H,Y+=I*N,Y+=w*T,Y+=j*S,G=Y>>>13,Y&=8191,Y+=M*z,Y+=V*f,Y+=D*n,Y+=P*v,Y+=y*_,G+=Y>>>13,Y&=8191,G=(G<<2)+G|0,G=G+Z|0,Z=G&8191,G=G>>>13,X+=G,E=Z,F=X,I=ae,w=R,j=C,M=O,V=o,D=m,P=k,y=Y,u+=16,g-=16}this._h[0]=E,this._h[1]=F,this._h[2]=I,this._h[3]=w,this._h[4]=j,this._h[5]=M,this._h[6]=V,this._h[7]=D,this._h[8]=P,this._h[9]=y},h.prototype.finish=function(c,u){u===void 0&&(u=0);var g=new Uint16Array(10),b,E,F,I;if(this._leftover){for(I=this._leftover,this._buffer[I++]=1;I<16;I++)this._buffer[I]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(b=this._h[1]>>>13,this._h[1]&=8191,I=2;I<10;I++)this._h[I]+=b,b=this._h[I]>>>13,this._h[I]&=8191;for(this._h[0]+=b*5,b=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=b,b=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=b,g[0]=this._h[0]+5,b=g[0]>>>13,g[0]&=8191,I=1;I<10;I++)g[I]=this._h[I]+b,b=g[I]>>>13,g[I]&=8191;for(g[9]-=1<<13,E=(b^1)-1,I=0;I<10;I++)g[I]&=E;for(E=~E,I=0;I<10;I++)this._h[I]=this._h[I]&E|g[I];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,F=this._h[0]+this._pad[0],this._h[0]=F&65535,I=1;I<8;I++)F=(this._h[I]+this._pad[I]|0)+(F>>>16)|0,this._h[I]=F&65535;return c[u+0]=this._h[0]>>>0,c[u+1]=this._h[0]>>>8,c[u+2]=this._h[1]>>>0,c[u+3]=this._h[1]>>>8,c[u+4]=this._h[2]>>>0,c[u+5]=this._h[2]>>>8,c[u+6]=this._h[3]>>>0,c[u+7]=this._h[3]>>>8,c[u+8]=this._h[4]>>>0,c[u+9]=this._h[4]>>>8,c[u+10]=this._h[5]>>>0,c[u+11]=this._h[5]>>>8,c[u+12]=this._h[6]>>>0,c[u+13]=this._h[6]>>>8,c[u+14]=this._h[7]>>>0,c[u+15]=this._h[7]>>>8,this._finished=!0,this},h.prototype.update=function(c){var u=0,g=c.length,b;if(this._leftover){b=16-this._leftover,b>g&&(b=g);for(var E=0;E<b;E++)this._buffer[this._leftover+E]=c[u+E];if(g-=b,u+=b,this._leftover+=b,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(g>=16&&(b=g-g%16,this._blocks(c,u,b),u+=b,g-=b),g){for(var E=0;E<g;E++)this._buffer[this._leftover+E]=c[u+E];this._leftover+=g}return this},h.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var c=new Uint8Array(16);return this.finish(c),c},h.prototype.clean=function(){return t.wipe(this._buffer),t.wipe(this._r),t.wipe(this._h),t.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},h}();r.Poly1305=i;function s(h,c){var u=new i(h);u.update(c);var g=u.digest();return u.clean(),g}r.oneTimeAuth=s;function a(h,c){return h.length!==r.DIGEST_LENGTH||c.length!==r.DIGEST_LENGTH?!1:e.equal(h,c)}r.equal=a})($o);(function(r){Object.defineProperty(r,"__esModule",{value:!0});var e=fi,t=$o,i=gt,s=ie,a=Bt;r.KEY_LENGTH=32,r.NONCE_LENGTH=12,r.TAG_LENGTH=16;var h=new Uint8Array(16),c=function(){function u(g){if(this.nonceLength=r.NONCE_LENGTH,this.tagLength=r.TAG_LENGTH,g.length!==r.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(g)}return u.prototype.seal=function(g,b,E,F){if(g.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var I=new Uint8Array(16);I.set(g,I.length-g.length);var w=new Uint8Array(32);e.stream(this._key,I,w,4);var j=b.length+this.tagLength,M;if(F){if(F.length!==j)throw new Error("ChaCha20Poly1305: incorrect destination length");M=F}else M=new Uint8Array(j);return e.streamXOR(this._key,I,b,M,4),this._authenticate(M.subarray(M.length-this.tagLength,M.length),w,M.subarray(0,M.length-this.tagLength),E),i.wipe(I),M},u.prototype.open=function(g,b,E,F){if(g.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(b.length<this.tagLength)return null;var I=new Uint8Array(16);I.set(g,I.length-g.length);var w=new Uint8Array(32);e.stream(this._key,I,w,4);var j=new Uint8Array(this.tagLength);if(this._authenticate(j,w,b.subarray(0,b.length-this.tagLength),E),!a.equal(j,b.subarray(b.length-this.tagLength,b.length)))return null;var M=b.length-this.tagLength,V;if(F){if(F.length!==M)throw new Error("ChaCha20Poly1305: incorrect destination length");V=F}else V=new Uint8Array(M);return e.streamXOR(this._key,I,b.subarray(0,b.length-this.tagLength),V,4),i.wipe(I),V},u.prototype.clean=function(){return i.wipe(this._key),this},u.prototype._authenticate=function(g,b,E,F){var I=new t.Poly1305(b);F&&(I.update(F),F.length%16>0&&I.update(h.subarray(F.length%16))),I.update(E),E.length%16>0&&I.update(h.subarray(E.length%16));var w=new Uint8Array(8);F&&s.writeUint64LE(F.length,w),I.update(w),s.writeUint64LE(E.length,w),I.update(w);for(var j=I.digest(),M=0;M<j.length;M++)g[M]=j[M];I.clean(),i.wipe(j),i.wipe(w)},u}();r.ChaCha20Poly1305=c})(as);var jo={},Ur={},cs={};Object.defineProperty(cs,"__esModule",{value:!0});function Dh(r){return typeof r.saveState<"u"&&typeof r.restoreState<"u"&&typeof r.cleanSavedState<"u"}cs.isSerializableHash=Dh;Object.defineProperty(Ur,"__esModule",{value:!0});var Dt=cs,Sh=Bt,Ih=gt,Ho=function(){function r(e,t){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var i=new Uint8Array(this.blockSize);t.length>this.blockSize?this._inner.update(t).finish(i).clean():i.set(t);for(var s=0;s<i.length;s++)i[s]^=54;this._inner.update(i);for(var s=0;s<i.length;s++)i[s]^=106;this._outer.update(i),Dt.isSerializableHash(this._inner)&&Dt.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),Ih.wipe(i)}return r.prototype.reset=function(){if(!Dt.isSerializableHash(this._inner)||!Dt.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},r.prototype.clean=function(){Dt.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Dt.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},r.prototype.update=function(e){return this._inner.update(e),this},r.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},r.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},r.prototype.saveState=function(){if(!Dt.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},r.prototype.restoreState=function(e){if(!Dt.isSerializableHash(this._inner)||!Dt.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},r.prototype.cleanSavedState=function(e){if(!Dt.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},r}();Ur.HMAC=Ho;function Oh(r,e,t){var i=new Ho(r,e);i.update(t);var s=i.digest();return i.clean(),s}Ur.hmac=Oh;Ur.equal=Sh.equal;Object.defineProperty(jo,"__esModule",{value:!0});var qs=Ur,Bs=gt,xh=function(){function r(e,t,i,s){i===void 0&&(i=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=s;var a=qs.hmac(this._hash,i,t);this._hmac=new qs.HMAC(e,a),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return r.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},r.prototype.expand=function(e){for(var t=new Uint8Array(e),i=0;i<t.length;i++)this._bufpos===this._buffer.length&&this._fillBuffer(),t[i]=this._buffer[this._bufpos++];return t},r.prototype.clean=function(){this._hmac.clean(),Bs.wipe(this._buffer),Bs.wipe(this._counter),this._bufpos=0},r}(),Ph=jo.HKDF=xh,lr={},di={},pi={};Object.defineProperty(pi,"__esModule",{value:!0});pi.BrowserRandomSource=void 0;const zs=65536;class Ah{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const t=new Uint8Array(e);for(let i=0;i<t.length;i+=zs)this._crypto.getRandomValues(t.subarray(i,i+Math.min(t.length-i,zs)));return t}}pi.BrowserRandomSource=Ah;function Ch(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var gi={};Object.defineProperty(gi,"__esModule",{value:!0});gi.NodeRandomSource=void 0;const Rh=gt;class Th{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof Ch<"u"){const e=Mc;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let t=this._crypto.randomBytes(e);if(t.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const i=new Uint8Array(e);for(let s=0;s<i.length;s++)i[s]=t[s];return(0,Rh.wipe)(t),i}}gi.NodeRandomSource=Th;Object.defineProperty(di,"__esModule",{value:!0});di.SystemRandomSource=void 0;const Nh=pi,Lh=gi;class Fh{constructor(){if(this.isAvailable=!1,this.name="",this._source=new Nh.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new Lh.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}di.SystemRandomSource=Fh;(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.randomStringForEntropy=r.randomString=r.randomUint32=r.randomBytes=r.defaultRandomSource=void 0;const e=di,t=ie,i=gt;r.defaultRandomSource=new e.SystemRandomSource;function s(g,b=r.defaultRandomSource){return b.randomBytes(g)}r.randomBytes=s;function a(g=r.defaultRandomSource){const b=s(4,g),E=(0,t.readUint32LE)(b);return(0,i.wipe)(b),E}r.randomUint32=a;const h="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function c(g,b=h,E=r.defaultRandomSource){if(b.length<2)throw new Error("randomString charset is too short");if(b.length>256)throw new Error("randomString charset is too long");let F="";const I=b.length,w=256-256%I;for(;g>0;){const j=s(Math.ceil(g*256/w),E);for(let M=0;M<j.length&&g>0;M++){const V=j[M];V<w&&(F+=b.charAt(V%I),g--)}(0,i.wipe)(j)}return F}r.randomString=c;function u(g,b=h,E=r.defaultRandomSource){const F=Math.ceil(g/(Math.log(b.length)/Math.LN2));return c(F,b,E)}r.randomStringForEntropy=u})(lr);var yi={};(function(r){Object.defineProperty(r,"__esModule",{value:!0});var e=ie,t=gt;r.DIGEST_LENGTH=32,r.BLOCK_SIZE=64;var i=function(){function c(){this.digestLength=r.DIGEST_LENGTH,this.blockSize=r.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return c.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},c.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},c.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._temp),this.reset()},c.prototype.update=function(u,g){if(g===void 0&&(g=u.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var b=0;if(this._bytesHashed+=g,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&g>0;)this._buffer[this._bufferLength++]=u[b++],g--;this._bufferLength===this.blockSize&&(a(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(g>=this.blockSize&&(b=a(this._temp,this._state,u,b,g),g%=this.blockSize);g>0;)this._buffer[this._bufferLength++]=u[b++],g--;return this},c.prototype.finish=function(u){if(!this._finished){var g=this._bytesHashed,b=this._bufferLength,E=g/536870912|0,F=g<<3,I=g%64<56?64:128;this._buffer[b]=128;for(var w=b+1;w<I-8;w++)this._buffer[w]=0;e.writeUint32BE(E,this._buffer,I-8),e.writeUint32BE(F,this._buffer,I-4),a(this._temp,this._state,this._buffer,0,I),this._finished=!0}for(var w=0;w<this.digestLength/4;w++)e.writeUint32BE(this._state[w],u,w*4);return this},c.prototype.digest=function(){var u=new Uint8Array(this.digestLength);return this.finish(u),u},c.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},c.prototype.restoreState=function(u){return this._state.set(u.state),this._bufferLength=u.bufferLength,u.buffer&&this._buffer.set(u.buffer),this._bytesHashed=u.bytesHashed,this._finished=!1,this},c.prototype.cleanSavedState=function(u){t.wipe(u.state),u.buffer&&t.wipe(u.buffer),u.bufferLength=0,u.bytesHashed=0},c}();r.SHA256=i;var s=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function a(c,u,g,b,E){for(;E>=64;){for(var F=u[0],I=u[1],w=u[2],j=u[3],M=u[4],V=u[5],D=u[6],P=u[7],y=0;y<16;y++){var _=b+y*4;c[y]=e.readUint32BE(g,_)}for(var y=16;y<64;y++){var v=c[y-2],n=(v>>>17|v<<32-17)^(v>>>19|v<<32-19)^v>>>10;v=c[y-15];var f=(v>>>7|v<<32-7)^(v>>>18|v<<32-18)^v>>>3;c[y]=(n+c[y-7]|0)+(f+c[y-16]|0)}for(var y=0;y<64;y++){var n=(((M>>>6|M<<26)^(M>>>11|M<<21)^(M>>>25|M<<7))+(M&V^~M&D)|0)+(P+(s[y]+c[y]|0)|0)|0,f=((F>>>2|F<<32-2)^(F>>>13|F<<32-13)^(F>>>22|F<<32-22))+(F&I^F&w^I&w)|0;P=D,D=V,V=M,M=j+n|0,j=w,w=I,I=F,F=n+f|0}u[0]+=F,u[1]+=I,u[2]+=w,u[3]+=j,u[4]+=M,u[5]+=V,u[6]+=D,u[7]+=P,b+=64,E-=64}return b}function h(c){var u=new i;u.update(c);var g=u.digest();return u.clean(),g}r.hash=h})(yi);var hs={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.sharedKey=r.generateKeyPair=r.generateKeyPairFromSeed=r.scalarMultBase=r.scalarMult=r.SHARED_KEY_LENGTH=r.SECRET_KEY_LENGTH=r.PUBLIC_KEY_LENGTH=void 0;const e=lr,t=gt;r.PUBLIC_KEY_LENGTH=32,r.SECRET_KEY_LENGTH=32,r.SHARED_KEY_LENGTH=32;function i(y){const _=new Float64Array(16);if(y)for(let v=0;v<y.length;v++)_[v]=y[v];return _}const s=new Uint8Array(32);s[0]=9;const a=i([56129,1]);function h(y){let _=1;for(let v=0;v<16;v++){let n=y[v]+_+65535;_=Math.floor(n/65536),y[v]=n-_*65536}y[0]+=_-1+37*(_-1)}function c(y,_,v){const n=~(v-1);for(let f=0;f<16;f++){const z=n&(y[f]^_[f]);y[f]^=z,_[f]^=z}}function u(y,_){const v=i(),n=i();for(let f=0;f<16;f++)n[f]=_[f];h(n),h(n),h(n);for(let f=0;f<2;f++){v[0]=n[0]-65517;for(let S=1;S<15;S++)v[S]=n[S]-65535-(v[S-1]>>16&1),v[S-1]&=65535;v[15]=n[15]-32767-(v[14]>>16&1);const z=v[15]>>16&1;v[14]&=65535,c(n,v,1-z)}for(let f=0;f<16;f++)y[2*f]=n[f]&255,y[2*f+1]=n[f]>>8}function g(y,_){for(let v=0;v<16;v++)y[v]=_[2*v]+(_[2*v+1]<<8);y[15]&=32767}function b(y,_,v){for(let n=0;n<16;n++)y[n]=_[n]+v[n]}function E(y,_,v){for(let n=0;n<16;n++)y[n]=_[n]-v[n]}function F(y,_,v){let n,f,z=0,S=0,T=0,N=0,H=0,l=0,d=0,L=0,$=0,U=0,A=0,q=0,K=0,Q=0,G=0,Z=0,X=0,ae=0,R=0,C=0,O=0,o=0,m=0,k=0,Y=0,le=0,be=0,de=0,_e=0,Le=0,Ce=0,ye=v[0],pe=v[1],fe=v[2],he=v[3],ce=v[4],oe=v[5],ne=v[6],te=v[7],ue=v[8],ge=v[9],re=v[10],me=v[11],ve=v[12],Ee=v[13],De=v[14],we=v[15];n=_[0],z+=n*ye,S+=n*pe,T+=n*fe,N+=n*he,H+=n*ce,l+=n*oe,d+=n*ne,L+=n*te,$+=n*ue,U+=n*ge,A+=n*re,q+=n*me,K+=n*ve,Q+=n*Ee,G+=n*De,Z+=n*we,n=_[1],S+=n*ye,T+=n*pe,N+=n*fe,H+=n*he,l+=n*ce,d+=n*oe,L+=n*ne,$+=n*te,U+=n*ue,A+=n*ge,q+=n*re,K+=n*me,Q+=n*ve,G+=n*Ee,Z+=n*De,X+=n*we,n=_[2],T+=n*ye,N+=n*pe,H+=n*fe,l+=n*he,d+=n*ce,L+=n*oe,$+=n*ne,U+=n*te,A+=n*ue,q+=n*ge,K+=n*re,Q+=n*me,G+=n*ve,Z+=n*Ee,X+=n*De,ae+=n*we,n=_[3],N+=n*ye,H+=n*pe,l+=n*fe,d+=n*he,L+=n*ce,$+=n*oe,U+=n*ne,A+=n*te,q+=n*ue,K+=n*ge,Q+=n*re,G+=n*me,Z+=n*ve,X+=n*Ee,ae+=n*De,R+=n*we,n=_[4],H+=n*ye,l+=n*pe,d+=n*fe,L+=n*he,$+=n*ce,U+=n*oe,A+=n*ne,q+=n*te,K+=n*ue,Q+=n*ge,G+=n*re,Z+=n*me,X+=n*ve,ae+=n*Ee,R+=n*De,C+=n*we,n=_[5],l+=n*ye,d+=n*pe,L+=n*fe,$+=n*he,U+=n*ce,A+=n*oe,q+=n*ne,K+=n*te,Q+=n*ue,G+=n*ge,Z+=n*re,X+=n*me,ae+=n*ve,R+=n*Ee,C+=n*De,O+=n*we,n=_[6],d+=n*ye,L+=n*pe,$+=n*fe,U+=n*he,A+=n*ce,q+=n*oe,K+=n*ne,Q+=n*te,G+=n*ue,Z+=n*ge,X+=n*re,ae+=n*me,R+=n*ve,C+=n*Ee,O+=n*De,o+=n*we,n=_[7],L+=n*ye,$+=n*pe,U+=n*fe,A+=n*he,q+=n*ce,K+=n*oe,Q+=n*ne,G+=n*te,Z+=n*ue,X+=n*ge,ae+=n*re,R+=n*me,C+=n*ve,O+=n*Ee,o+=n*De,m+=n*we,n=_[8],$+=n*ye,U+=n*pe,A+=n*fe,q+=n*he,K+=n*ce,Q+=n*oe,G+=n*ne,Z+=n*te,X+=n*ue,ae+=n*ge,R+=n*re,C+=n*me,O+=n*ve,o+=n*Ee,m+=n*De,k+=n*we,n=_[9],U+=n*ye,A+=n*pe,q+=n*fe,K+=n*he,Q+=n*ce,G+=n*oe,Z+=n*ne,X+=n*te,ae+=n*ue,R+=n*ge,C+=n*re,O+=n*me,o+=n*ve,m+=n*Ee,k+=n*De,Y+=n*we,n=_[10],A+=n*ye,q+=n*pe,K+=n*fe,Q+=n*he,G+=n*ce,Z+=n*oe,X+=n*ne,ae+=n*te,R+=n*ue,C+=n*ge,O+=n*re,o+=n*me,m+=n*ve,k+=n*Ee,Y+=n*De,le+=n*we,n=_[11],q+=n*ye,K+=n*pe,Q+=n*fe,G+=n*he,Z+=n*ce,X+=n*oe,ae+=n*ne,R+=n*te,C+=n*ue,O+=n*ge,o+=n*re,m+=n*me,k+=n*ve,Y+=n*Ee,le+=n*De,be+=n*we,n=_[12],K+=n*ye,Q+=n*pe,G+=n*fe,Z+=n*he,X+=n*ce,ae+=n*oe,R+=n*ne,C+=n*te,O+=n*ue,o+=n*ge,m+=n*re,k+=n*me,Y+=n*ve,le+=n*Ee,be+=n*De,de+=n*we,n=_[13],Q+=n*ye,G+=n*pe,Z+=n*fe,X+=n*he,ae+=n*ce,R+=n*oe,C+=n*ne,O+=n*te,o+=n*ue,m+=n*ge,k+=n*re,Y+=n*me,le+=n*ve,be+=n*Ee,de+=n*De,_e+=n*we,n=_[14],G+=n*ye,Z+=n*pe,X+=n*fe,ae+=n*he,R+=n*ce,C+=n*oe,O+=n*ne,o+=n*te,m+=n*ue,k+=n*ge,Y+=n*re,le+=n*me,be+=n*ve,de+=n*Ee,_e+=n*De,Le+=n*we,n=_[15],Z+=n*ye,X+=n*pe,ae+=n*fe,R+=n*he,C+=n*ce,O+=n*oe,o+=n*ne,m+=n*te,k+=n*ue,Y+=n*ge,le+=n*re,be+=n*me,de+=n*ve,_e+=n*Ee,Le+=n*De,Ce+=n*we,z+=38*X,S+=38*ae,T+=38*R,N+=38*C,H+=38*O,l+=38*o,d+=38*m,L+=38*k,$+=38*Y,U+=38*le,A+=38*be,q+=38*de,K+=38*_e,Q+=38*Le,G+=38*Ce,f=1,n=z+f+65535,f=Math.floor(n/65536),z=n-f*65536,n=S+f+65535,f=Math.floor(n/65536),S=n-f*65536,n=T+f+65535,f=Math.floor(n/65536),T=n-f*65536,n=N+f+65535,f=Math.floor(n/65536),N=n-f*65536,n=H+f+65535,f=Math.floor(n/65536),H=n-f*65536,n=l+f+65535,f=Math.floor(n/65536),l=n-f*65536,n=d+f+65535,f=Math.floor(n/65536),d=n-f*65536,n=L+f+65535,f=Math.floor(n/65536),L=n-f*65536,n=$+f+65535,f=Math.floor(n/65536),$=n-f*65536,n=U+f+65535,f=Math.floor(n/65536),U=n-f*65536,n=A+f+65535,f=Math.floor(n/65536),A=n-f*65536,n=q+f+65535,f=Math.floor(n/65536),q=n-f*65536,n=K+f+65535,f=Math.floor(n/65536),K=n-f*65536,n=Q+f+65535,f=Math.floor(n/65536),Q=n-f*65536,n=G+f+65535,f=Math.floor(n/65536),G=n-f*65536,n=Z+f+65535,f=Math.floor(n/65536),Z=n-f*65536,z+=f-1+37*(f-1),f=1,n=z+f+65535,f=Math.floor(n/65536),z=n-f*65536,n=S+f+65535,f=Math.floor(n/65536),S=n-f*65536,n=T+f+65535,f=Math.floor(n/65536),T=n-f*65536,n=N+f+65535,f=Math.floor(n/65536),N=n-f*65536,n=H+f+65535,f=Math.floor(n/65536),H=n-f*65536,n=l+f+65535,f=Math.floor(n/65536),l=n-f*65536,n=d+f+65535,f=Math.floor(n/65536),d=n-f*65536,n=L+f+65535,f=Math.floor(n/65536),L=n-f*65536,n=$+f+65535,f=Math.floor(n/65536),$=n-f*65536,n=U+f+65535,f=Math.floor(n/65536),U=n-f*65536,n=A+f+65535,f=Math.floor(n/65536),A=n-f*65536,n=q+f+65535,f=Math.floor(n/65536),q=n-f*65536,n=K+f+65535,f=Math.floor(n/65536),K=n-f*65536,n=Q+f+65535,f=Math.floor(n/65536),Q=n-f*65536,n=G+f+65535,f=Math.floor(n/65536),G=n-f*65536,n=Z+f+65535,f=Math.floor(n/65536),Z=n-f*65536,z+=f-1+37*(f-1),y[0]=z,y[1]=S,y[2]=T,y[3]=N,y[4]=H,y[5]=l,y[6]=d,y[7]=L,y[8]=$,y[9]=U,y[10]=A,y[11]=q,y[12]=K,y[13]=Q,y[14]=G,y[15]=Z}function I(y,_){F(y,_,_)}function w(y,_){const v=i();for(let n=0;n<16;n++)v[n]=_[n];for(let n=253;n>=0;n--)I(v,v),n!==2&&n!==4&&F(v,v,_);for(let n=0;n<16;n++)y[n]=v[n]}function j(y,_){const v=new Uint8Array(32),n=new Float64Array(80),f=i(),z=i(),S=i(),T=i(),N=i(),H=i();for(let $=0;$<31;$++)v[$]=y[$];v[31]=y[31]&127|64,v[0]&=248,g(n,_);for(let $=0;$<16;$++)z[$]=n[$];f[0]=T[0]=1;for(let $=254;$>=0;--$){const U=v[$>>>3]>>>($&7)&1;c(f,z,U),c(S,T,U),b(N,f,S),E(f,f,S),b(S,z,T),E(z,z,T),I(T,N),I(H,f),F(f,S,f),F(S,z,N),b(N,f,S),E(f,f,S),I(z,f),E(S,T,H),F(f,S,a),b(f,f,T),F(S,S,f),F(f,T,H),F(T,z,n),I(z,N),c(f,z,U),c(S,T,U)}for(let $=0;$<16;$++)n[$+16]=f[$],n[$+32]=S[$],n[$+48]=z[$],n[$+64]=T[$];const l=n.subarray(32),d=n.subarray(16);w(l,l),F(d,d,l);const L=new Uint8Array(32);return u(L,d),L}r.scalarMult=j;function M(y){return j(y,s)}r.scalarMultBase=M;function V(y){if(y.length!==r.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${r.SECRET_KEY_LENGTH} bytes`);const _=new Uint8Array(y);return{publicKey:M(_),secretKey:_}}r.generateKeyPairFromSeed=V;function D(y){const _=(0,e.randomBytes)(32,y),v=V(_);return(0,t.wipe)(_),v}r.generateKeyPair=D;function P(y,_,v=!1){if(y.length!==r.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(_.length!==r.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const n=j(y,_);if(v){let f=0;for(let z=0;z<n.length;z++)f|=n[z];if(f===0)throw new Error("X25519: invalid shared key")}return n}r.sharedKey=P})(hs);function us(r){return globalThis.Buffer!=null?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function qo(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?us(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}function ki(r,e){e||(e=r.reduce((s,a)=>s+a.length,0));const t=qo(e);let i=0;for(const s of r)t.set(s,i),i+=s.length;return us(t)}function Uh(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),i=0;i<t.length;i++)t[i]=255;for(var s=0;s<r.length;s++){var a=r.charAt(s),h=a.charCodeAt(0);if(t[h]!==255)throw new TypeError(a+" is ambiguous");t[h]=s}var c=r.length,u=r.charAt(0),g=Math.log(c)/Math.log(256),b=Math.log(256)/Math.log(c);function E(w){if(w instanceof Uint8Array||(ArrayBuffer.isView(w)?w=new Uint8Array(w.buffer,w.byteOffset,w.byteLength):Array.isArray(w)&&(w=Uint8Array.from(w))),!(w instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(w.length===0)return"";for(var j=0,M=0,V=0,D=w.length;V!==D&&w[V]===0;)V++,j++;for(var P=(D-V)*b+1>>>0,y=new Uint8Array(P);V!==D;){for(var _=w[V],v=0,n=P-1;(_!==0||v<M)&&n!==-1;n--,v++)_+=256*y[n]>>>0,y[n]=_%c>>>0,_=_/c>>>0;if(_!==0)throw new Error("Non-zero carry");M=v,V++}for(var f=P-M;f!==P&&y[f]===0;)f++;for(var z=u.repeat(j);f<P;++f)z+=r.charAt(y[f]);return z}function F(w){if(typeof w!="string")throw new TypeError("Expected String");if(w.length===0)return new Uint8Array;var j=0;if(w[j]!==" "){for(var M=0,V=0;w[j]===u;)M++,j++;for(var D=(w.length-j)*g+1>>>0,P=new Uint8Array(D);w[j];){var y=t[w.charCodeAt(j)];if(y===255)return;for(var _=0,v=D-1;(y!==0||_<V)&&v!==-1;v--,_++)y+=c*P[v]>>>0,P[v]=y%256>>>0,y=y/256>>>0;if(y!==0)throw new Error("Non-zero carry");V=_,j++}if(w[j]!==" "){for(var n=D-V;n!==D&&P[n]===0;)n++;for(var f=new Uint8Array(M+(D-n)),z=M;n!==D;)f[z++]=P[n++];return f}}}function I(w){var j=F(w);if(j)return j;throw new Error(`Non-${e} character`)}return{encode:E,decodeUnsafe:F,decode:I}}var $h=Uh,Mh=$h;const jh=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},Hh=r=>new TextEncoder().encode(r),qh=r=>new TextDecoder().decode(r);class Bh{constructor(e,t,i){this.name=e,this.prefix=t,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class zh{constructor(e,t,i){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Bo(this,e)}}class Kh{constructor(e){this.decoders=e}or(e){return Bo(this,e)}decode(e){const t=e[0],i=this.decoders[t];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Bo=(r,e)=>new Kh({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class Vh{constructor(e,t,i,s){this.name=e,this.prefix=t,this.baseEncode=i,this.baseDecode=s,this.encoder=new Bh(e,t,i),this.decoder=new zh(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const bi=({name:r,prefix:e,encode:t,decode:i})=>new Vh(r,e,t,i),$r=({prefix:r,name:e,alphabet:t})=>{const{encode:i,decode:s}=Mh(t,e);return bi({prefix:r,name:e,encode:i,decode:a=>jh(s(a))})},Gh=(r,e,t,i)=>{const s={};for(let b=0;b<e.length;++b)s[e[b]]=b;let a=r.length;for(;r[a-1]==="=";)--a;const h=new Uint8Array(a*t/8|0);let c=0,u=0,g=0;for(let b=0;b<a;++b){const E=s[r[b]];if(E===void 0)throw new SyntaxError(`Non-${i} character`);u=u<<t|E,c+=t,c>=8&&(c-=8,h[g++]=255&u>>c)}if(c>=t||255&u<<8-c)throw new SyntaxError("Unexpected end of data");return h},kh=(r,e,t)=>{const i=e[e.length-1]==="=",s=(1<<t)-1;let a="",h=0,c=0;for(let u=0;u<r.length;++u)for(c=c<<8|r[u],h+=8;h>t;)h-=t,a+=e[s&c>>h];if(h&&(a+=e[s&c<<t-h]),i)for(;a.length*t&7;)a+="=";return a},tt=({name:r,prefix:e,bitsPerChar:t,alphabet:i})=>bi({prefix:e,name:r,encode(s){return kh(s,i,t)},decode(s){return Gh(s,i,t,r)}}),Wh=bi({prefix:"\0",name:"identity",encode:r=>qh(r),decode:r=>Hh(r)}),Yh=Object.freeze(Object.defineProperty({__proto__:null,identity:Wh},Symbol.toStringTag,{value:"Module"})),Jh=tt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Xh=Object.freeze(Object.defineProperty({__proto__:null,base2:Jh},Symbol.toStringTag,{value:"Module"})),Qh=tt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),Zh=Object.freeze(Object.defineProperty({__proto__:null,base8:Qh},Symbol.toStringTag,{value:"Module"})),eu=$r({prefix:"9",name:"base10",alphabet:"0123456789"}),tu=Object.freeze(Object.defineProperty({__proto__:null,base10:eu},Symbol.toStringTag,{value:"Module"})),ru=tt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),iu=tt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),su=Object.freeze(Object.defineProperty({__proto__:null,base16:ru,base16upper:iu},Symbol.toStringTag,{value:"Module"})),nu=tt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),ou=tt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),au=tt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),cu=tt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),hu=tt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),uu=tt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),lu=tt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),fu=tt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),du=tt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),pu=Object.freeze(Object.defineProperty({__proto__:null,base32:nu,base32hex:hu,base32hexpad:lu,base32hexpadupper:fu,base32hexupper:uu,base32pad:au,base32padupper:cu,base32upper:ou,base32z:du},Symbol.toStringTag,{value:"Module"})),gu=$r({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),yu=$r({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),bu=Object.freeze(Object.defineProperty({__proto__:null,base36:gu,base36upper:yu},Symbol.toStringTag,{value:"Module"})),mu=$r({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),vu=$r({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),_u=Object.freeze(Object.defineProperty({__proto__:null,base58btc:mu,base58flickr:vu},Symbol.toStringTag,{value:"Module"})),wu=tt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Eu=tt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Du=tt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Su=tt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Iu=Object.freeze(Object.defineProperty({__proto__:null,base64:wu,base64pad:Eu,base64url:Du,base64urlpad:Su},Symbol.toStringTag,{value:"Module"})),zo=Array.from("ðŸš€ðŸªâ˜„ðŸ›°ðŸŒŒðŸŒ‘ðŸŒ’ðŸŒ“ðŸŒ”ðŸŒ•ðŸŒ–ðŸŒ—ðŸŒ˜ðŸŒðŸŒðŸŒŽðŸ‰â˜€ðŸ’»ðŸ–¥ðŸ’¾ðŸ’¿ðŸ˜‚â¤ðŸ˜ðŸ¤£ðŸ˜ŠðŸ™ðŸ’•ðŸ˜­ðŸ˜˜ðŸ‘ðŸ˜…ðŸ‘ðŸ˜ðŸ”¥ðŸ¥°ðŸ’”ðŸ’–ðŸ’™ðŸ˜¢ðŸ¤”ðŸ˜†ðŸ™„ðŸ’ªðŸ˜‰â˜ºðŸ‘ŒðŸ¤—ðŸ’œðŸ˜”ðŸ˜ŽðŸ˜‡ðŸŒ¹ðŸ¤¦ðŸŽ‰ðŸ’žâœŒâœ¨ðŸ¤·ðŸ˜±ðŸ˜ŒðŸŒ¸ðŸ™ŒðŸ˜‹ðŸ’—ðŸ’šðŸ˜ðŸ’›ðŸ™‚ðŸ’“ðŸ¤©ðŸ˜„ðŸ˜€ðŸ–¤ðŸ˜ƒðŸ’¯ðŸ™ˆðŸ‘‡ðŸŽ¶ðŸ˜’ðŸ¤­â£ðŸ˜œðŸ’‹ðŸ‘€ðŸ˜ªðŸ˜‘ðŸ’¥ðŸ™‹ðŸ˜žðŸ˜©ðŸ˜¡ðŸ¤ªðŸ‘ŠðŸ¥³ðŸ˜¥ðŸ¤¤ðŸ‘‰ðŸ’ƒðŸ˜³âœ‹ðŸ˜šðŸ˜ðŸ˜´ðŸŒŸðŸ˜¬ðŸ™ƒðŸ€ðŸŒ·ðŸ˜»ðŸ˜“â­âœ…ðŸ¥ºðŸŒˆðŸ˜ˆðŸ¤˜ðŸ’¦âœ”ðŸ˜£ðŸƒðŸ’â˜¹ðŸŽŠðŸ’˜ðŸ˜ â˜ðŸ˜•ðŸŒºðŸŽ‚ðŸŒ»ðŸ˜ðŸ–•ðŸ’ðŸ™ŠðŸ˜¹ðŸ—£ðŸ’«ðŸ’€ðŸ‘‘ðŸŽµðŸ¤žðŸ˜›ðŸ”´ðŸ˜¤ðŸŒ¼ðŸ˜«âš½ðŸ¤™â˜•ðŸ†ðŸ¤«ðŸ‘ˆðŸ˜®ðŸ™†ðŸ»ðŸƒðŸ¶ðŸ’ðŸ˜²ðŸŒ¿ðŸ§¡ðŸŽâš¡ðŸŒžðŸŽˆâŒâœŠðŸ‘‹ðŸ˜°ðŸ¤¨ðŸ˜¶ðŸ¤ðŸš¶ðŸ’°ðŸ“ðŸ’¢ðŸ¤ŸðŸ™ðŸš¨ðŸ’¨ðŸ¤¬âœˆðŸŽ€ðŸºðŸ¤“ðŸ˜™ðŸ’ŸðŸŒ±ðŸ˜–ðŸ‘¶ðŸ¥´â–¶âž¡â“ðŸ’ŽðŸ’¸â¬‡ðŸ˜¨ðŸŒšðŸ¦‹ðŸ˜·ðŸ•ºâš ðŸ™…ðŸ˜ŸðŸ˜µðŸ‘ŽðŸ¤²ðŸ¤ ðŸ¤§ðŸ“ŒðŸ”µðŸ’…ðŸ§ðŸ¾ðŸ’ðŸ˜—ðŸ¤‘ðŸŒŠðŸ¤¯ðŸ·â˜ŽðŸ’§ðŸ˜¯ðŸ’†ðŸ‘†ðŸŽ¤ðŸ™‡ðŸ‘â„ðŸŒ´ðŸ’£ðŸ¸ðŸ’ŒðŸ“ðŸ¥€ðŸ¤¢ðŸ‘…ðŸ’¡ðŸ’©ðŸ‘ðŸ“¸ðŸ‘»ðŸ¤ðŸ¤®ðŸŽ¼ðŸ¥µðŸš©ðŸŽðŸŠðŸ‘¼ðŸ’ðŸ“£ðŸ¥‚"),Ou=zo.reduce((r,e,t)=>(r[t]=e,r),[]),xu=zo.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function Pu(r){return r.reduce((e,t)=>(e+=Ou[t],e),"")}function Au(r){const e=[];for(const t of r){const i=xu[t.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(i)}return new Uint8Array(e)}const Cu=bi({prefix:"ðŸš€",name:"base256emoji",encode:Pu,decode:Au}),Ru=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:Cu},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const Ks={...Yh,...Xh,...Zh,...tu,...su,...pu,...bu,..._u,...Iu,...Ru};function Ko(r,e,t,i){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:i}}}const Vs=Ko("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),Di=Ko("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=qo(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),Vo={utf8:Vs,"utf-8":Vs,hex:Ks.base16,latin1:Di,ascii:Di,binary:Di,...Ks};function ht(r,e="utf8"){const t=Vo[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?us(globalThis.Buffer.from(r,"utf-8")):t.decoder.decode(`${t.prefix}${r}`)}function lt(r,e="utf8"){const t=Vo[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8"):t.encoder.encode(r).substring(1)}var Gs=globalThis&&globalThis.__spreadArray||function(r,e,t){if(t||arguments.length===2)for(var i=0,s=e.length,a;i<s;i++)(a||!(i in e))&&(a||(a=Array.prototype.slice.call(e,0,i)),a[i]=e[i]);return r.concat(a||Array.prototype.slice.call(e))},Tu=function(){function r(e,t,i){this.name=e,this.version=t,this.os=i,this.type="browser"}return r}(),Nu=function(){function r(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return r}(),Lu=function(){function r(e,t,i,s){this.name=e,this.version=t,this.os=i,this.bot=s,this.type="bot-device"}return r}(),Fu=function(){function r(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return r}(),Uu=function(){function r(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return r}(),$u=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,Mu=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,ks=3,ju=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",$u]],Ws=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Hu(r){return r?Ys(r):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new Uu:typeof navigator<"u"?Ys(navigator.userAgent):zu()}function qu(r){return r!==""&&ju.reduce(function(e,t){var i=t[0],s=t[1];if(e)return e;var a=s.exec(r);return!!a&&[i,a]},!1)}function Ys(r){var e=qu(r);if(!e)return null;var t=e[0],i=e[1];if(t==="searchbot")return new Fu;var s=i[1]&&i[1].split(".").join("_").split("_").slice(0,3);s?s.length<ks&&(s=Gs(Gs([],s,!0),Ku(ks-s.length),!0)):s=[];var a=s.join("."),h=Bu(r),c=Mu.exec(r);return c&&c[1]?new Lu(t,a,h,c[1]):new Tu(t,a,h)}function Bu(r){for(var e=0,t=Ws.length;e<t;e++){var i=Ws[e],s=i[0],a=i[1],h=a.exec(r);if(h)return s}return null}function zu(){var r=typeof process<"u"&&process.version;return r?new Nu(process.version.slice(1)):null}function Ku(r){for(var e=[],t=0;t<r;t++)e.push("0");return e}var ee={},ft={},Vu={get exports(){return ft},set exports(r){ft=r}};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */(function(r){var e,t,i,s,a,h,c,u,g,b,E,F,I,w,j,M,V,D,P,y,_,v,n;(function(f){var z=typeof nt=="object"?nt:typeof self=="object"?self:typeof this=="object"?this:{};f(S(z,S(r.exports)));function S(T,N){return T!==z&&(typeof Object.create=="function"?Object.defineProperty(T,"__esModule",{value:!0}):T.__esModule=!0),function(H,l){return T[H]=N?N(H,l):l}}})(function(f){var z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(S,T){S.__proto__=T}||function(S,T){for(var N in T)T.hasOwnProperty(N)&&(S[N]=T[N])};e=function(S,T){z(S,T);function N(){this.constructor=S}S.prototype=T===null?Object.create(T):(N.prototype=T.prototype,new N)},t=Object.assign||function(S){for(var T,N=1,H=arguments.length;N<H;N++){T=arguments[N];for(var l in T)Object.prototype.hasOwnProperty.call(T,l)&&(S[l]=T[l])}return S},i=function(S,T){var N={};for(var H in S)Object.prototype.hasOwnProperty.call(S,H)&&T.indexOf(H)<0&&(N[H]=S[H]);if(S!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,H=Object.getOwnPropertySymbols(S);l<H.length;l++)T.indexOf(H[l])<0&&Object.prototype.propertyIsEnumerable.call(S,H[l])&&(N[H[l]]=S[H[l]]);return N},s=function(S,T,N,H){var l=arguments.length,d=l<3?T:H===null?H=Object.getOwnPropertyDescriptor(T,N):H,L;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(S,T,N,H);else for(var $=S.length-1;$>=0;$--)(L=S[$])&&(d=(l<3?L(d):l>3?L(T,N,d):L(T,N))||d);return l>3&&d&&Object.defineProperty(T,N,d),d},a=function(S,T){return function(N,H){T(N,H,S)}},h=function(S,T){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(S,T)},c=function(S,T,N,H){function l(d){return d instanceof N?d:new N(function(L){L(d)})}return new(N||(N=Promise))(function(d,L){function $(q){try{A(H.next(q))}catch(K){L(K)}}function U(q){try{A(H.throw(q))}catch(K){L(K)}}function A(q){q.done?d(q.value):l(q.value).then($,U)}A((H=H.apply(S,T||[])).next())})},u=function(S,T){var N={label:0,sent:function(){if(d[0]&1)throw d[1];return d[1]},trys:[],ops:[]},H,l,d,L;return L={next:$(0),throw:$(1),return:$(2)},typeof Symbol=="function"&&(L[Symbol.iterator]=function(){return this}),L;function $(A){return function(q){return U([A,q])}}function U(A){if(H)throw new TypeError("Generator is already executing.");for(;N;)try{if(H=1,l&&(d=A[0]&2?l.return:A[0]?l.throw||((d=l.return)&&d.call(l),0):l.next)&&!(d=d.call(l,A[1])).done)return d;switch(l=0,d&&(A=[A[0]&2,d.value]),A[0]){case 0:case 1:d=A;break;case 4:return N.label++,{value:A[1],done:!1};case 5:N.label++,l=A[1],A=[0];continue;case 7:A=N.ops.pop(),N.trys.pop();continue;default:if(d=N.trys,!(d=d.length>0&&d[d.length-1])&&(A[0]===6||A[0]===2)){N=0;continue}if(A[0]===3&&(!d||A[1]>d[0]&&A[1]<d[3])){N.label=A[1];break}if(A[0]===6&&N.label<d[1]){N.label=d[1],d=A;break}if(d&&N.label<d[2]){N.label=d[2],N.ops.push(A);break}d[2]&&N.ops.pop(),N.trys.pop();continue}A=T.call(S,N)}catch(q){A=[6,q],l=0}finally{H=d=0}if(A[0]&5)throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}},n=function(S,T,N,H){H===void 0&&(H=N),S[H]=T[N]},g=function(S,T){for(var N in S)N!=="default"&&!T.hasOwnProperty(N)&&(T[N]=S[N])},b=function(S){var T=typeof Symbol=="function"&&Symbol.iterator,N=T&&S[T],H=0;if(N)return N.call(S);if(S&&typeof S.length=="number")return{next:function(){return S&&H>=S.length&&(S=void 0),{value:S&&S[H++],done:!S}}};throw new TypeError(T?"Object is not iterable.":"Symbol.iterator is not defined.")},E=function(S,T){var N=typeof Symbol=="function"&&S[Symbol.iterator];if(!N)return S;var H=N.call(S),l,d=[],L;try{for(;(T===void 0||T-- >0)&&!(l=H.next()).done;)d.push(l.value)}catch($){L={error:$}}finally{try{l&&!l.done&&(N=H.return)&&N.call(H)}finally{if(L)throw L.error}}return d},F=function(){for(var S=[],T=0;T<arguments.length;T++)S=S.concat(E(arguments[T]));return S},I=function(){for(var S=0,T=0,N=arguments.length;T<N;T++)S+=arguments[T].length;for(var H=Array(S),l=0,T=0;T<N;T++)for(var d=arguments[T],L=0,$=d.length;L<$;L++,l++)H[l]=d[L];return H},w=function(S){return this instanceof w?(this.v=S,this):new w(S)},j=function(S,T,N){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var H=N.apply(S,T||[]),l,d=[];return l={},L("next"),L("throw"),L("return"),l[Symbol.asyncIterator]=function(){return this},l;function L(Q){H[Q]&&(l[Q]=function(G){return new Promise(function(Z,X){d.push([Q,G,Z,X])>1||$(Q,G)})})}function $(Q,G){try{U(H[Q](G))}catch(Z){K(d[0][3],Z)}}function U(Q){Q.value instanceof w?Promise.resolve(Q.value.v).then(A,q):K(d[0][2],Q)}function A(Q){$("next",Q)}function q(Q){$("throw",Q)}function K(Q,G){Q(G),d.shift(),d.length&&$(d[0][0],d[0][1])}},M=function(S){var T,N;return T={},H("next"),H("throw",function(l){throw l}),H("return"),T[Symbol.iterator]=function(){return this},T;function H(l,d){T[l]=S[l]?function(L){return(N=!N)?{value:w(S[l](L)),done:l==="return"}:d?d(L):L}:d}},V=function(S){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var T=S[Symbol.asyncIterator],N;return T?T.call(S):(S=typeof b=="function"?b(S):S[Symbol.iterator](),N={},H("next"),H("throw"),H("return"),N[Symbol.asyncIterator]=function(){return this},N);function H(d){N[d]=S[d]&&function(L){return new Promise(function($,U){L=S[d](L),l($,U,L.done,L.value)})}}function l(d,L,$,U){Promise.resolve(U).then(function(A){d({value:A,done:$})},L)}},D=function(S,T){return Object.defineProperty?Object.defineProperty(S,"raw",{value:T}):S.raw=T,S},P=function(S){if(S&&S.__esModule)return S;var T={};if(S!=null)for(var N in S)Object.hasOwnProperty.call(S,N)&&(T[N]=S[N]);return T.default=S,T},y=function(S){return S&&S.__esModule?S:{default:S}},_=function(S,T){if(!T.has(S))throw new TypeError("attempted to get private field on non-instance");return T.get(S)},v=function(S,T,N){if(!T.has(S))throw new TypeError("attempted to set private field on non-instance");return T.set(S,N),N},f("__extends",e),f("__assign",t),f("__rest",i),f("__decorate",s),f("__param",a),f("__metadata",h),f("__awaiter",c),f("__generator",u),f("__exportStar",g),f("__createBinding",n),f("__values",b),f("__read",E),f("__spread",F),f("__spreadArrays",I),f("__await",w),f("__asyncGenerator",j),f("__asyncDelegator",M),f("__asyncValues",V),f("__makeTemplateObject",D),f("__importStar",P),f("__importDefault",y),f("__classPrivateFieldGet",_),f("__classPrivateFieldSet",v)})})(Vu);var Si={},vr={},Js;function Gu(){if(Js)return vr;Js=1,Object.defineProperty(vr,"__esModule",{value:!0}),vr.delay=void 0;function r(e){return new Promise(t=>{setTimeout(()=>{t(!0)},e)})}return vr.delay=r,vr}var kt={},Ii={},Wt={},Xs;function ku(){return Xs||(Xs=1,Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.ONE_THOUSAND=Wt.ONE_HUNDRED=void 0,Wt.ONE_HUNDRED=100,Wt.ONE_THOUSAND=1e3),Wt}var Oi={},Qs;function Wu(){return Qs||(Qs=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.ONE_YEAR=r.FOUR_WEEKS=r.THREE_WEEKS=r.TWO_WEEKS=r.ONE_WEEK=r.THIRTY_DAYS=r.SEVEN_DAYS=r.FIVE_DAYS=r.THREE_DAYS=r.ONE_DAY=r.TWENTY_FOUR_HOURS=r.TWELVE_HOURS=r.SIX_HOURS=r.THREE_HOURS=r.ONE_HOUR=r.SIXTY_MINUTES=r.THIRTY_MINUTES=r.TEN_MINUTES=r.FIVE_MINUTES=r.ONE_MINUTE=r.SIXTY_SECONDS=r.THIRTY_SECONDS=r.TEN_SECONDS=r.FIVE_SECONDS=r.ONE_SECOND=void 0,r.ONE_SECOND=1,r.FIVE_SECONDS=5,r.TEN_SECONDS=10,r.THIRTY_SECONDS=30,r.SIXTY_SECONDS=60,r.ONE_MINUTE=r.SIXTY_SECONDS,r.FIVE_MINUTES=r.ONE_MINUTE*5,r.TEN_MINUTES=r.ONE_MINUTE*10,r.THIRTY_MINUTES=r.ONE_MINUTE*30,r.SIXTY_MINUTES=r.ONE_MINUTE*60,r.ONE_HOUR=r.SIXTY_MINUTES,r.THREE_HOURS=r.ONE_HOUR*3,r.SIX_HOURS=r.ONE_HOUR*6,r.TWELVE_HOURS=r.ONE_HOUR*12,r.TWENTY_FOUR_HOURS=r.ONE_HOUR*24,r.ONE_DAY=r.TWENTY_FOUR_HOURS,r.THREE_DAYS=r.ONE_DAY*3,r.FIVE_DAYS=r.ONE_DAY*5,r.SEVEN_DAYS=r.ONE_DAY*7,r.THIRTY_DAYS=r.ONE_DAY*30,r.ONE_WEEK=r.SEVEN_DAYS,r.TWO_WEEKS=r.ONE_WEEK*2,r.THREE_WEEKS=r.ONE_WEEK*3,r.FOUR_WEEKS=r.ONE_WEEK*4,r.ONE_YEAR=r.ONE_DAY*365}(Oi)),Oi}var Zs;function Go(){return Zs||(Zs=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=ft;e.__exportStar(ku(),r),e.__exportStar(Wu(),r)}(Ii)),Ii}var en;function Yu(){if(en)return kt;en=1,Object.defineProperty(kt,"__esModule",{value:!0}),kt.fromMiliseconds=kt.toMiliseconds=void 0;const r=Go();function e(i){return i*r.ONE_THOUSAND}kt.toMiliseconds=e;function t(i){return Math.floor(i/r.ONE_THOUSAND)}return kt.fromMiliseconds=t,kt}var tn;function Ju(){return tn||(tn=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=ft;e.__exportStar(Gu(),r),e.__exportStar(Yu(),r)}(Si)),Si}var nr={},rn;function Xu(){if(rn)return nr;rn=1,Object.defineProperty(nr,"__esModule",{value:!0}),nr.Watch=void 0;class r{constructor(){this.timestamps=new Map}start(t){if(this.timestamps.has(t))throw new Error(`Watch already started for label: ${t}`);this.timestamps.set(t,{started:Date.now()})}stop(t){const i=this.get(t);if(typeof i.elapsed<"u")throw new Error(`Watch already stopped for label: ${t}`);const s=Date.now()-i.started;this.timestamps.set(t,{started:i.started,elapsed:s})}get(t){const i=this.timestamps.get(t);if(typeof i>"u")throw new Error(`No timestamp found for label: ${t}`);return i}elapsed(t){const i=this.get(t);return i.elapsed||Date.now()-i.started}}return nr.Watch=r,nr.default=r,nr}var xi={},_r={},sn;function Qu(){if(sn)return _r;sn=1,Object.defineProperty(_r,"__esModule",{value:!0}),_r.IWatch=void 0;class r{}return _r.IWatch=r,_r}var nn;function Zu(){return nn||(nn=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),ft.__exportStar(Qu(),r)}(xi)),xi}(function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=ft;e.__exportStar(Ju(),r),e.__exportStar(Xu(),r),e.__exportStar(Zu(),r),e.__exportStar(Go(),r)})(ee);var Oe={};Object.defineProperty(Oe,"__esModule",{value:!0});Oe.getLocalStorage=Oe.getLocalStorageOrThrow=Oe.getCrypto=Oe.getCryptoOrThrow=Wo=Oe.getLocation=Oe.getLocationOrThrow=ls=Oe.getNavigator=Oe.getNavigatorOrThrow=ko=Oe.getDocument=Oe.getDocumentOrThrow=Oe.getFromWindowOrThrow=Oe.getFromWindow=void 0;function Zt(r){let e;return typeof window<"u"&&typeof window[r]<"u"&&(e=window[r]),e}Oe.getFromWindow=Zt;function fr(r){const e=Zt(r);if(!e)throw new Error(`${r} is not defined in Window`);return e}Oe.getFromWindowOrThrow=fr;function el(){return fr("document")}Oe.getDocumentOrThrow=el;function tl(){return Zt("document")}var ko=Oe.getDocument=tl;function rl(){return fr("navigator")}Oe.getNavigatorOrThrow=rl;function il(){return Zt("navigator")}var ls=Oe.getNavigator=il;function sl(){return fr("location")}Oe.getLocationOrThrow=sl;function nl(){return Zt("location")}var Wo=Oe.getLocation=nl;function ol(){return fr("crypto")}Oe.getCryptoOrThrow=ol;function al(){return Zt("crypto")}Oe.getCrypto=al;function cl(){return fr("localStorage")}Oe.getLocalStorageOrThrow=cl;function hl(){return Zt("localStorage")}Oe.getLocalStorage=hl;var fs={};Object.defineProperty(fs,"__esModule",{value:!0});var Yo=fs.getWindowMetadata=void 0;const on=Oe;function ul(){let r,e;try{r=on.getDocumentOrThrow(),e=on.getLocationOrThrow()}catch{return null}function t(){const E=r.getElementsByTagName("link"),F=[];for(let I=0;I<E.length;I++){const w=E[I],j=w.getAttribute("rel");if(j&&j.toLowerCase().indexOf("icon")>-1){const M=w.getAttribute("href");if(M)if(M.toLowerCase().indexOf("https:")===-1&&M.toLowerCase().indexOf("http:")===-1&&M.indexOf("//")!==0){let V=e.protocol+"//"+e.host;if(M.indexOf("/")===0)V+=M;else{const D=e.pathname.split("/");D.pop();const P=D.join("/");V+=P+"/"+M}F.push(V)}else if(M.indexOf("//")===0){const V=e.protocol+M;F.push(V)}else F.push(M)}}return F}function i(...E){const F=r.getElementsByTagName("meta");for(let I=0;I<F.length;I++){const w=F[I],j=["itemprop","property","name"].map(M=>w.getAttribute(M)).filter(M=>M?E.includes(M):!1);if(j.length&&j){const M=w.getAttribute("content");if(M)return M}}return""}function s(){let E=i("name","og:site_name","og:title","twitter:title");return E||(E=r.title),E}function a(){return i("description","og:description","twitter:description","keywords")}const h=s(),c=a(),u=e.origin,g=t();return{description:c,url:u,icons:g,name:h}}Yo=fs.getWindowMetadata=ul;var Tr={},ll=r=>encodeURIComponent(r).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),Jo="%[a-f0-9]{2}",an=new RegExp("("+Jo+")|([^%]+?)","gi"),cn=new RegExp("("+Jo+")+","gi");function Wi(r,e){try{return[decodeURIComponent(r.join(""))]}catch{}if(r.length===1)return r;e=e||1;var t=r.slice(0,e),i=r.slice(e);return Array.prototype.concat.call([],Wi(t),Wi(i))}function fl(r){try{return decodeURIComponent(r)}catch{for(var e=r.match(an)||[],t=1;t<e.length;t++)r=Wi(e,t).join(""),e=r.match(an)||[];return r}}function dl(r){for(var e={"%FE%FF":"ï¿½ï¿½","%FF%FE":"ï¿½ï¿½"},t=cn.exec(r);t;){try{e[t[0]]=decodeURIComponent(t[0])}catch{var i=fl(t[0]);i!==t[0]&&(e[t[0]]=i)}t=cn.exec(r)}e["%C2"]="ï¿½";for(var s=Object.keys(e),a=0;a<s.length;a++){var h=s[a];r=r.replace(new RegExp(h,"g"),e[h])}return r}var pl=function(r){if(typeof r!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof r+"`");try{return r=r.replace(/\+/g," "),decodeURIComponent(r)}catch{return dl(r)}},gl=(r,e)=>{if(!(typeof r=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[r];const t=r.indexOf(e);return t===-1?[r]:[r.slice(0,t),r.slice(t+e.length)]},yl=function(r,e){for(var t={},i=Object.keys(r),s=Array.isArray(e),a=0;a<i.length;a++){var h=i[a],c=r[h];(s?e.indexOf(h)!==-1:e(h,c,r))&&(t[h]=c)}return t};(function(r){const e=ll,t=pl,i=gl,s=yl,a=D=>D==null,h=Symbol("encodeFragmentIdentifier");function c(D){switch(D.arrayFormat){case"index":return P=>(y,_)=>{const v=y.length;return _===void 0||D.skipNull&&_===null||D.skipEmptyString&&_===""?y:_===null?[...y,[b(P,D),"[",v,"]"].join("")]:[...y,[b(P,D),"[",b(v,D),"]=",b(_,D)].join("")]};case"bracket":return P=>(y,_)=>_===void 0||D.skipNull&&_===null||D.skipEmptyString&&_===""?y:_===null?[...y,[b(P,D),"[]"].join("")]:[...y,[b(P,D),"[]=",b(_,D)].join("")];case"colon-list-separator":return P=>(y,_)=>_===void 0||D.skipNull&&_===null||D.skipEmptyString&&_===""?y:_===null?[...y,[b(P,D),":list="].join("")]:[...y,[b(P,D),":list=",b(_,D)].join("")];case"comma":case"separator":case"bracket-separator":{const P=D.arrayFormat==="bracket-separator"?"[]=":"=";return y=>(_,v)=>v===void 0||D.skipNull&&v===null||D.skipEmptyString&&v===""?_:(v=v===null?"":v,_.length===0?[[b(y,D),P,b(v,D)].join("")]:[[_,b(v,D)].join(D.arrayFormatSeparator)])}default:return P=>(y,_)=>_===void 0||D.skipNull&&_===null||D.skipEmptyString&&_===""?y:_===null?[...y,b(P,D)]:[...y,[b(P,D),"=",b(_,D)].join("")]}}function u(D){let P;switch(D.arrayFormat){case"index":return(y,_,v)=>{if(P=/\[(\d*)\]$/.exec(y),y=y.replace(/\[\d*\]$/,""),!P){v[y]=_;return}v[y]===void 0&&(v[y]={}),v[y][P[1]]=_};case"bracket":return(y,_,v)=>{if(P=/(\[\])$/.exec(y),y=y.replace(/\[\]$/,""),!P){v[y]=_;return}if(v[y]===void 0){v[y]=[_];return}v[y]=[].concat(v[y],_)};case"colon-list-separator":return(y,_,v)=>{if(P=/(:list)$/.exec(y),y=y.replace(/:list$/,""),!P){v[y]=_;return}if(v[y]===void 0){v[y]=[_];return}v[y]=[].concat(v[y],_)};case"comma":case"separator":return(y,_,v)=>{const n=typeof _=="string"&&_.includes(D.arrayFormatSeparator),f=typeof _=="string"&&!n&&E(_,D).includes(D.arrayFormatSeparator);_=f?E(_,D):_;const z=n||f?_.split(D.arrayFormatSeparator).map(S=>E(S,D)):_===null?_:E(_,D);v[y]=z};case"bracket-separator":return(y,_,v)=>{const n=/(\[\])$/.test(y);if(y=y.replace(/\[\]$/,""),!n){v[y]=_&&E(_,D);return}const f=_===null?[]:_.split(D.arrayFormatSeparator).map(z=>E(z,D));if(v[y]===void 0){v[y]=f;return}v[y]=[].concat(v[y],f)};default:return(y,_,v)=>{if(v[y]===void 0){v[y]=_;return}v[y]=[].concat(v[y],_)}}}function g(D){if(typeof D!="string"||D.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function b(D,P){return P.encode?P.strict?e(D):encodeURIComponent(D):D}function E(D,P){return P.decode?t(D):D}function F(D){return Array.isArray(D)?D.sort():typeof D=="object"?F(Object.keys(D)).sort((P,y)=>Number(P)-Number(y)).map(P=>D[P]):D}function I(D){const P=D.indexOf("#");return P!==-1&&(D=D.slice(0,P)),D}function w(D){let P="";const y=D.indexOf("#");return y!==-1&&(P=D.slice(y)),P}function j(D){D=I(D);const P=D.indexOf("?");return P===-1?"":D.slice(P+1)}function M(D,P){return P.parseNumbers&&!Number.isNaN(Number(D))&&typeof D=="string"&&D.trim()!==""?D=Number(D):P.parseBooleans&&D!==null&&(D.toLowerCase()==="true"||D.toLowerCase()==="false")&&(D=D.toLowerCase()==="true"),D}function V(D,P){P=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},P),g(P.arrayFormatSeparator);const y=u(P),_=Object.create(null);if(typeof D!="string"||(D=D.trim().replace(/^[?#&]/,""),!D))return _;for(const v of D.split("&")){if(v==="")continue;let[n,f]=i(P.decode?v.replace(/\+/g," "):v,"=");f=f===void 0?null:["comma","separator","bracket-separator"].includes(P.arrayFormat)?f:E(f,P),y(E(n,P),f,_)}for(const v of Object.keys(_)){const n=_[v];if(typeof n=="object"&&n!==null)for(const f of Object.keys(n))n[f]=M(n[f],P);else _[v]=M(n,P)}return P.sort===!1?_:(P.sort===!0?Object.keys(_).sort():Object.keys(_).sort(P.sort)).reduce((v,n)=>{const f=_[n];return Boolean(f)&&typeof f=="object"&&!Array.isArray(f)?v[n]=F(f):v[n]=f,v},Object.create(null))}r.extract=j,r.parse=V,r.stringify=(D,P)=>{if(!D)return"";P=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},P),g(P.arrayFormatSeparator);const y=f=>P.skipNull&&a(D[f])||P.skipEmptyString&&D[f]==="",_=c(P),v={};for(const f of Object.keys(D))y(f)||(v[f]=D[f]);const n=Object.keys(v);return P.sort!==!1&&n.sort(P.sort),n.map(f=>{const z=D[f];return z===void 0?"":z===null?b(f,P):Array.isArray(z)?z.length===0&&P.arrayFormat==="bracket-separator"?b(f,P)+"[]":z.reduce(_(f),[]).join("&"):b(f,P)+"="+b(z,P)}).filter(f=>f.length>0).join("&")},r.parseUrl=(D,P)=>{P=Object.assign({decode:!0},P);const[y,_]=i(D,"#");return Object.assign({url:y.split("?")[0]||"",query:V(j(D),P)},P&&P.parseFragmentIdentifier&&_?{fragmentIdentifier:E(_,P)}:{})},r.stringifyUrl=(D,P)=>{P=Object.assign({encode:!0,strict:!0,[h]:!0},P);const y=I(D.url).split("?")[0]||"",_=r.extract(D.url),v=r.parse(_,{sort:!1}),n=Object.assign(v,D.query);let f=r.stringify(n,P);f&&(f=`?${f}`);let z=w(D.url);return D.fragmentIdentifier&&(z=`#${P[h]?b(D.fragmentIdentifier,P):D.fragmentIdentifier}`),`${y}${f}${z}`},r.pick=(D,P,y)=>{y=Object.assign({parseFragmentIdentifier:!0,[h]:!1},y);const{url:_,query:v,fragmentIdentifier:n}=r.parseUrl(D,y);return r.stringifyUrl({url:_,query:s(v,P),fragmentIdentifier:n},y)},r.exclude=(D,P,y)=>{const _=Array.isArray(P)?v=>!P.includes(v):(v,n)=>!P(v,n);return r.pick(D,_,y)}})(Tr);const bl={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}};function ml(r,e=[]){const t=[];return Object.keys(r).forEach(i=>{if(e.length&&!e.includes(i))return;const s=r[i];t.push(...s.accounts)}),t}function Xo(r,e){return r.includes(":")?[r]:e.chains||[]}const Qo="base10",ut="base16",Yi="base64pad",ds="utf8",Zo=0,er=1,vl=0,hn=1,Ji=12,ps=32;function _l(){const r=hs.generateKeyPair();return{privateKey:lt(r.secretKey,ut),publicKey:lt(r.publicKey,ut)}}function Xi(){const r=lr.randomBytes(ps);return lt(r,ut)}function wl(r,e){const t=hs.sharedKey(ht(r,ut),ht(e,ut)),i=new Ph(yi.SHA256,t).expand(ps);return lt(i,ut)}function El(r){const e=yi.hash(ht(r,ut));return lt(e,ut)}function ni(r){const e=yi.hash(ht(r,ds));return lt(e,ut)}function Dl(r){return ht(`${r}`,Qo)}function Mr(r){return Number(lt(r,Qo))}function Sl(r){const e=Dl(typeof r.type<"u"?r.type:Zo);if(Mr(e)===er&&typeof r.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const t=typeof r.senderPublicKey<"u"?ht(r.senderPublicKey,ut):void 0,i=typeof r.iv<"u"?ht(r.iv,ut):lr.randomBytes(Ji),s=new as.ChaCha20Poly1305(ht(r.symKey,ut)).seal(i,ht(r.message,ds));return Ol({type:e,sealed:s,iv:i,senderPublicKey:t})}function Il(r){const e=new as.ChaCha20Poly1305(ht(r.symKey,ut)),{sealed:t,iv:i}=gs(r.encoded),s=e.open(i,t);if(s===null)throw new Error("Failed to decrypt");return lt(s,ds)}function Ol(r){if(Mr(r.type)===er){if(typeof r.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return lt(ki([r.type,r.senderPublicKey,r.iv,r.sealed]),Yi)}return lt(ki([r.type,r.iv,r.sealed]),Yi)}function gs(r){const e=ht(r,Yi),t=e.slice(vl,hn),i=hn;if(Mr(t)===er){const c=i+ps,u=c+Ji,g=e.slice(i,c),b=e.slice(c,u),E=e.slice(u);return{type:t,sealed:E,iv:b,senderPublicKey:g}}const s=i+Ji,a=e.slice(i,s),h=e.slice(s);return{type:t,sealed:h,iv:a}}function xl(r,e){const t=gs(r);return ea({type:Mr(t.type),senderPublicKey:typeof t.senderPublicKey<"u"?lt(t.senderPublicKey,ut):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function ea(r){const e=(r==null?void 0:r.type)||Zo;if(e===er){if(typeof(r==null?void 0:r.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(r==null?void 0:r.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:r==null?void 0:r.senderPublicKey,receiverPublicKey:r==null?void 0:r.receiverPublicKey}}function un(r){return r.type===er&&typeof r.senderPublicKey=="string"&&typeof r.receiverPublicKey=="string"}var Pl=Object.defineProperty,ln=Object.getOwnPropertySymbols,Al=Object.prototype.hasOwnProperty,Cl=Object.prototype.propertyIsEnumerable,fn=(r,e,t)=>e in r?Pl(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,dn=(r,e)=>{for(var t in e||(e={}))Al.call(e,t)&&fn(r,t,e[t]);if(ln)for(var t of ln(e))Cl.call(e,t)&&fn(r,t,e[t]);return r};const Rl="ReactNative",Pr={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},Tl="js";function ta(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Nl(){return!ko()&&!!ls()&&navigator.product===Rl}function Ll(){return!ta()&&!!ls()}function Fl(){return Nl()?Pr.reactNative:ta()?Pr.node:Ll()?Pr.browser:Pr.unknown}function Ul(r,e){let t=Tr.parse(r);return t=dn(dn({},t),e),r=Tr.stringify(t),r}function $l(){return Yo()||{name:"",description:"",url:"",icons:[""]}}function Ml(){const r=Hu();if(r===null)return"unknown";const e=r.os?r.os.replace(" ","").toLowerCase():"unknown";return r.type==="browser"?[e,r.name,r.version].join("-"):[e,r.version].join("-")}function jl(){var r;const e=Fl();return e===Pr.browser?[e,((r=Wo())==null?void 0:r.host)||"unknown"].join(":"):e}function Hl(r,e,t){const i=Ml(),s=jl();return[[r,e].join("-"),[Tl,t].join("-"),i,s].join("/")}function ql({protocol:r,version:e,relayUrl:t,sdkVersion:i,auth:s,projectId:a,useOnCloseEvent:h}){const c=t.split("?"),u=Hl(r,e,i),g={auth:s,ua:u,projectId:a,useOnCloseEvent:h||void 0},b=Ul(c[1]||"",g);return c[0]+"?"+b}function Qt(r,e){return r.filter(t=>e.includes(t)).length===r.length}function ra(r){return Object.fromEntries(r.entries())}function ia(r){return new Map(Object.entries(r))}function Xt(r=ee.FIVE_MINUTES,e){const t=ee.toMiliseconds(r||ee.FIVE_MINUTES);let i,s,a;return{resolve:h=>{a&&i&&(clearTimeout(a),i(h))},reject:h=>{a&&s&&(clearTimeout(a),s(h))},done:()=>new Promise((h,c)=>{a=setTimeout(()=>{c(new Error(e))},t),i=h,s=c})}}function oi(r,e,t){return new Promise(async(i,s)=>{const a=setTimeout(()=>s(new Error(t)),e);try{const h=await r;i(h)}catch(h){s(h)}clearTimeout(a)})}function sa(r,e){if(typeof e=="string"&&e.startsWith(`${r}:`))return e;if(r.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(r.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${r}`)}function Bl(r){return sa("topic",r)}function zl(r){return sa("id",r)}function na(r){const[e,t]=r.split(":"),i={id:void 0,topic:void 0};if(e==="topic"&&typeof t=="string")i.topic=t;else if(e==="id"&&Number.isInteger(Number(t)))i.id=Number(t);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${t}`);return i}function Ot(r,e){return ee.fromMiliseconds((e||Date.now())+ee.toMiliseconds(r))}function Ht(r){return Date.now()>=ee.toMiliseconds(r)}function Fe(r,e){return`${r}${e?`:${e}`:""}`}const Kl="irn";function Qi(r){return(r==null?void 0:r.relay)||{protocol:Kl}}function ti(r){const e=bl[r];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${r}`);return e}var Vl=Object.defineProperty,pn=Object.getOwnPropertySymbols,Gl=Object.prototype.hasOwnProperty,kl=Object.prototype.propertyIsEnumerable,gn=(r,e,t)=>e in r?Vl(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Wl=(r,e)=>{for(var t in e||(e={}))Gl.call(e,t)&&gn(r,t,e[t]);if(pn)for(var t of pn(e))kl.call(e,t)&&gn(r,t,e[t]);return r};function Yl(r,e="-"){const t={},i="relay"+e;return Object.keys(r).forEach(s=>{if(s.startsWith(i)){const a=s.replace(i,""),h=r[s];t[a]=h}}),t}function Jl(r){const e=r.indexOf(":"),t=r.indexOf("?")!==-1?r.indexOf("?"):void 0,i=r.substring(0,e),s=r.substring(e+1,t).split("@"),a=typeof t<"u"?r.substring(t):"",h=Tr.parse(a);return{protocol:i,topic:s[0],version:parseInt(s[1],10),symKey:h.symKey,relay:Yl(h)}}function Xl(r,e="-"){const t="relay",i={};return Object.keys(r).forEach(s=>{const a=t+e+s;r[s]&&(i[a]=r[s])}),i}function Ql(r){return`${r.protocol}:${r.topic}@${r.version}?`+Tr.stringify(Wl({symKey:r.symKey},Xl(r.relay)))}function dr(r){const e=[];return r.forEach(t=>{const[i,s]=t.split(":");e.push(`${i}:${s}`)}),e}function Zl(r){const e=[];return Object.values(r).forEach(t=>{e.push(...dr(t.accounts))}),e}function ef(r,e){const t=[];return Object.values(r).forEach(i=>{dr(i.accounts).includes(e)&&t.push(...i.methods)}),t}function tf(r,e){const t=[];return Object.values(r).forEach(i=>{dr(i.accounts).includes(e)&&t.push(...i.events)}),t}function rf(r,e){const t=ri(r,e);if(t)throw new Error(t.message);const i={};for(const[s,a]of Object.entries(r))i[s]={methods:a.methods,events:a.events,chains:a.accounts.map(h=>`${h.split(":")[0]}:${h.split(":")[1]}`)};return i}const sf={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},nf={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function W(r,e){const{message:t,code:i}=nf[r];return{message:e?`${t} ${e}`:t,code:i}}function Ue(r,e){const{message:t,code:i}=sf[r];return{message:e?`${t} ${e}`:t,code:i}}function Ft(r,e){return Array.isArray(r)?typeof e<"u"&&r.length?r.every(e):!0:!1}function ur(r){return Object.getPrototypeOf(r)===Object.prototype&&Object.keys(r).length}function at(r){return typeof r>"u"}function Qe(r,e){return e&&at(r)?!0:typeof r=="string"&&Boolean(r.trim().length)}function ys(r,e){return e&&at(r)?!0:typeof r=="number"&&!isNaN(r)}function of(r,e){const{requiredNamespaces:t}=e,i=Object.keys(r.namespaces),s=Object.keys(t);let a=!0;return Qt(s,i)?(i.forEach(h=>{const{accounts:c,methods:u,events:g}=r.namespaces[h],b=dr(c),E=t[h];(!Qt(Xo(h,E),b)||!Qt(E.methods,u)||!Qt(E.events,g))&&(a=!1)}),a):!1}function bs(r){return Qe(r,!1)&&r.includes(":")?r.split(":").length===2:!1}function af(r){if(Qe(r,!1)&&r.includes(":")){const e=r.split(":");if(e.length===3){const t=e[0]+":"+e[1];return!!e[2]&&bs(t)}}return!1}function cf(r){if(Qe(r,!1))try{return typeof new URL(r)<"u"}catch{return!1}return!1}function hf(r){var e;return(e=r==null?void 0:r.proposer)==null?void 0:e.publicKey}function uf(r){return r==null?void 0:r.topic}function lf(r,e){let t=null;return Qe(r==null?void 0:r.publicKey,!1)||(t=W("MISSING_OR_INVALID",`${e} controller public key should be a string`)),t}function yn(r){let e=!0;return Ft(r)?r.length&&(e=r.every(t=>Qe(t,!1))):e=!1,e}function ff(r,e,t){let i=null;return Ft(e)?e.forEach(s=>{i||(!bs(s)||!s.includes(r))&&(i=Ue("UNSUPPORTED_CHAINS",`${t}, chain ${s} should be a string and conform to "namespace:chainId" format`))}):i=Ue("UNSUPPORTED_CHAINS",`${t}, chains ${e} should be an array of strings conforming to "namespace:chainId" format`),i}function df(r,e){let t=null;return Object.entries(r).forEach(([i,s])=>{if(t)return;const a=ff(i,Xo(i,s),`${e} requiredNamespace`);a&&(t=a)}),t}function pf(r,e){let t=null;return Ft(r)?r.forEach(i=>{t||af(i)||(t=Ue("UNSUPPORTED_ACCOUNTS",`${e}, account ${i} should be a string and conform to "namespace:chainId:address" format`))}):t=Ue("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),t}function gf(r,e){let t=null;return Object.values(r).forEach(i=>{if(t)return;const s=pf(i==null?void 0:i.accounts,`${e} namespace`);s&&(t=s)}),t}function yf(r,e){let t=null;return yn(r==null?void 0:r.methods)?yn(r==null?void 0:r.events)||(t=Ue("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):t=Ue("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),t}function oa(r,e){let t=null;return Object.values(r).forEach(i=>{if(t)return;const s=yf(i,`${e}, namespace`);s&&(t=s)}),t}function bf(r,e,t){let i=null;if(r&&ur(r)){const s=oa(r,e);s&&(i=s);const a=df(r,e);a&&(i=a)}else i=W("MISSING_OR_INVALID",`${e}, ${t} should be an object with data`);return i}function ri(r,e){let t=null;if(r&&ur(r)){const i=oa(r,e);i&&(t=i);const s=gf(r,e);s&&(t=s)}else t=W("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return t}function aa(r){return Qe(r.protocol,!0)}function mf(r,e){let t=!1;return e&&!r?t=!0:r&&Ft(r)&&r.length&&r.forEach(i=>{t=aa(i)}),t}function vf(r){return typeof r=="number"}function ct(r){return typeof r<"u"&&typeof r!==null}function _f(r){return!(!r||typeof r!="object"||!r.code||!ys(r.code,!1)||!r.message||!Qe(r.message,!1))}function wf(r){return!(at(r)||!Qe(r.method,!1))}function Ef(r){return!(at(r)||at(r.result)&&at(r.error)||!ys(r.id,!1)||!Qe(r.jsonrpc,!1))}function Df(r){return!(at(r)||!Qe(r.name,!1))}function bn(r,e){return!(!bs(e)||!Zl(r).includes(e))}function Sf(r,e,t){return Qe(t,!1)?ef(r,e).includes(t):!1}function If(r,e,t){return Qe(t,!1)?tf(r,e).includes(t):!1}function mn(r,e,t){let i=null;const s=Of(r),a=xf(e),h=Object.keys(s),c=Object.keys(a),u=vn(Object.keys(r)),g=vn(Object.keys(e)),b=u.filter(E=>!g.includes(E));return b.length&&(i=W("NON_CONFORMING_NAMESPACES",`${t} namespaces keys don't satisfy requiredNamespaces.
      Required: ${b.toString()}
      Received: ${Object.keys(e).toString()}`)),Qt(h,c)||(i=W("NON_CONFORMING_NAMESPACES",`${t} namespaces chains don't satisfy required namespaces.
      Required: ${h.toString()}
      Approved: ${c.toString()}`)),Object.keys(e).forEach(E=>{if(!E.includes(":")||i)return;const F=dr(e[E].accounts);F.includes(E)||(i=W("NON_CONFORMING_NAMESPACES",`${t} namespaces accounts don't satisfy namespace accounts for ${E}
        Required: ${E}
        Approved: ${F.toString()}`))}),h.forEach(E=>{i||(Qt(s[E].methods,a[E].methods)?Qt(s[E].events,a[E].events)||(i=W("NON_CONFORMING_NAMESPACES",`${t} namespaces events don't satisfy namespace events for ${E}`)):i=W("NON_CONFORMING_NAMESPACES",`${t} namespaces methods don't satisfy namespace methods for ${E}`))}),i}function Of(r){const e={};return Object.keys(r).forEach(t=>{var i;t.includes(":")?e[t]=r[t]:(i=r[t].chains)==null||i.forEach(s=>{e[s]={methods:r[t].methods,events:r[t].events}})}),e}function vn(r){return[...new Set(r.map(e=>e.includes(":")?e.split(":")[0]:e))]}function xf(r){const e={};return Object.keys(r).forEach(t=>{if(t.includes(":"))e[t]=r[t];else{const i=dr(r[t].accounts);i==null||i.forEach(s=>{e[s]={accounts:r[t].accounts.filter(a=>a.includes(`${s}:`)),methods:r[t].methods,events:r[t].events}})}}),e}function Pf(r,e){return ys(r,!1)&&r<=e.max&&r>=e.min}function Af(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}var Cf=Rf;function Rf(r,e,t){var i=t&&t.stringify||Af,s=1;if(typeof r=="object"&&r!==null){var a=e.length+s;if(a===1)return r;var h=new Array(a);h[0]=i(r);for(var c=1;c<a;c++)h[c]=i(e[c]);return h.join(" ")}if(typeof r!="string")return r;var u=e.length;if(u===0)return r;for(var g="",b=1-s,E=-1,F=r&&r.length||0,I=0;I<F;){if(r.charCodeAt(I)===37&&I+1<F){switch(E=E>-1?E:0,r.charCodeAt(I+1)){case 100:case 102:if(b>=u||e[b]==null)break;E<I&&(g+=r.slice(E,I)),g+=Number(e[b]),E=I+2,I++;break;case 105:if(b>=u||e[b]==null)break;E<I&&(g+=r.slice(E,I)),g+=Math.floor(Number(e[b])),E=I+2,I++;break;case 79:case 111:case 106:if(b>=u||e[b]===void 0)break;E<I&&(g+=r.slice(E,I));var w=typeof e[b];if(w==="string"){g+="'"+e[b]+"'",E=I+2,I++;break}if(w==="function"){g+=e[b].name||"<anonymous>",E=I+2,I++;break}g+=i(e[b]),E=I+2,I++;break;case 115:if(b>=u)break;E<I&&(g+=r.slice(E,I)),g+=String(e[b]),E=I+2,I++;break;case 37:E<I&&(g+=r.slice(E,I)),g+="%",E=I+2,I++,b--;break}++b}++I}return E===-1?r:(E<F&&(g+=r.slice(E)),g)}const _n=Cf;var jr=Pt;const Nr=qf().console||{},Tf={mapHttpRequest:Jr,mapHttpResponse:Jr,wrapRequestSerializer:Pi,wrapResponseSerializer:Pi,wrapErrorSerializer:Pi,req:Jr,res:Jr,err:$f};function Nf(r,e){return Array.isArray(r)?r.filter(function(i){return i!=="!stdSerializers.err"}):r===!0?Object.keys(e):!1}function Pt(r){r=r||{},r.browser=r.browser||{};const e=r.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");const t=r.browser.write||Nr;r.browser.write&&(r.browser.asObject=!0);const i=r.serializers||{},s=Nf(r.browser.serialize,i);let a=r.browser.serialize;Array.isArray(r.browser.serialize)&&r.browser.serialize.indexOf("!stdSerializers.err")>-1&&(a=!1);const h=["error","fatal","warn","info","debug","trace"];typeof t=="function"&&(t.error=t.fatal=t.warn=t.info=t.debug=t.trace=t),r.enabled===!1&&(r.level="silent");const c=r.level||"info",u=Object.create(t);u.log||(u.log=Lr),Object.defineProperty(u,"levelVal",{get:b}),Object.defineProperty(u,"level",{get:E,set:F});const g={transmit:e,serialize:s,asObject:r.browser.asObject,levels:h,timestamp:Mf(r)};u.levels=Pt.levels,u.level=c,u.setMaxListeners=u.getMaxListeners=u.emit=u.addListener=u.on=u.prependListener=u.once=u.prependOnceListener=u.removeListener=u.removeAllListeners=u.listeners=u.listenerCount=u.eventNames=u.write=u.flush=Lr,u.serializers=i,u._serialize=s,u._stdErrSerialize=a,u.child=I,e&&(u._logEvent=Zi());function b(){return this.level==="silent"?1/0:this.levels.values[this.level]}function E(){return this._level}function F(w){if(w!=="silent"&&!this.levels.values[w])throw Error("unknown level "+w);this._level=w,or(g,u,"error","log"),or(g,u,"fatal","error"),or(g,u,"warn","error"),or(g,u,"info","log"),or(g,u,"debug","log"),or(g,u,"trace","log")}function I(w,j){if(!w)throw new Error("missing bindings for child Pino");j=j||{},s&&w.serializers&&(j.serializers=w.serializers);const M=j.serializers;if(s&&M){var V=Object.assign({},i,M),D=r.browser.serialize===!0?Object.keys(V):s;delete w.serializers,mi([w],D,V,this._stdErrSerialize)}function P(y){this._childLevel=(y._childLevel|0)+1,this.error=ar(y,w,"error"),this.fatal=ar(y,w,"fatal"),this.warn=ar(y,w,"warn"),this.info=ar(y,w,"info"),this.debug=ar(y,w,"debug"),this.trace=ar(y,w,"trace"),V&&(this.serializers=V,this._serialize=D),e&&(this._logEvent=Zi([].concat(y._logEvent.bindings,w)))}return P.prototype=this,new P(this)}return u}Pt.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};Pt.stdSerializers=Tf;Pt.stdTimeFunctions=Object.assign({},{nullTime:ca,epochTime:ha,unixTime:jf,isoTime:Hf});function or(r,e,t,i){const s=Object.getPrototypeOf(e);e[t]=e.levelVal>e.levels.values[t]?Lr:s[t]?s[t]:Nr[t]||Nr[i]||Lr,Lf(r,e,t)}function Lf(r,e,t){!r.transmit&&e[t]===Lr||(e[t]=function(i){return function(){const a=r.timestamp(),h=new Array(arguments.length),c=Object.getPrototypeOf&&Object.getPrototypeOf(this)===Nr?Nr:this;for(var u=0;u<h.length;u++)h[u]=arguments[u];if(r.serialize&&!r.asObject&&mi(h,this._serialize,this.serializers,this._stdErrSerialize),r.asObject?i.call(c,Ff(this,t,h,a)):i.apply(c,h),r.transmit){const g=r.transmit.level||e.level,b=Pt.levels.values[g],E=Pt.levels.values[t];if(E<b)return;Uf(this,{ts:a,methodLevel:t,methodValue:E,transmitLevel:g,transmitValue:Pt.levels.values[r.transmit.level||e.level],send:r.transmit.send,val:e.levelVal},h)}}}(e[t]))}function Ff(r,e,t,i){r._serialize&&mi(t,r._serialize,r.serializers,r._stdErrSerialize);const s=t.slice();let a=s[0];const h={};i&&(h.time=i),h.level=Pt.levels.values[e];let c=(r._childLevel|0)+1;if(c<1&&(c=1),a!==null&&typeof a=="object"){for(;c--&&typeof s[0]=="object";)Object.assign(h,s.shift());a=s.length?_n(s.shift(),s):void 0}else typeof a=="string"&&(a=_n(s.shift(),s));return a!==void 0&&(h.msg=a),h}function mi(r,e,t,i){for(const s in r)if(i&&r[s]instanceof Error)r[s]=Pt.stdSerializers.err(r[s]);else if(typeof r[s]=="object"&&!Array.isArray(r[s]))for(const a in r[s])e&&e.indexOf(a)>-1&&a in t&&(r[s][a]=t[a](r[s][a]))}function ar(r,e,t){return function(){const i=new Array(1+arguments.length);i[0]=e;for(var s=1;s<i.length;s++)i[s]=arguments[s-1];return r[t].apply(this,i)}}function Uf(r,e,t){const i=e.send,s=e.ts,a=e.methodLevel,h=e.methodValue,c=e.val,u=r._logEvent.bindings;mi(t,r._serialize||Object.keys(r.serializers),r.serializers,r._stdErrSerialize===void 0?!0:r._stdErrSerialize),r._logEvent.ts=s,r._logEvent.messages=t.filter(function(g){return u.indexOf(g)===-1}),r._logEvent.level.label=a,r._logEvent.level.value=h,i(a,r._logEvent,c),r._logEvent=Zi(u)}function Zi(r){return{ts:0,messages:[],bindings:r||[],level:{label:"",value:0}}}function $f(r){const e={type:r.constructor.name,msg:r.message,stack:r.stack};for(const t in r)e[t]===void 0&&(e[t]=r[t]);return e}function Mf(r){return typeof r.timestamp=="function"?r.timestamp:r.timestamp===!1?ca:ha}function Jr(){return{}}function Pi(r){return r}function Lr(){}function ca(){return!1}function ha(){return Date.now()}function jf(){return Math.round(Date.now()/1e3)}function Hf(){return new Date(Date.now()).toISOString()}function qf(){function r(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return r(self)||r(window)||r(this)||{}}}var vi={},Hr={};Object.defineProperty(Hr,"__esModule",{value:!0});function Bf(r){if(typeof r!="string")throw new Error(`Cannot safe json parse value of type ${typeof r}`);try{return JSON.parse(r)}catch{return r}}Hr.safeJsonParse=Bf;function zf(r){return typeof r=="string"?r:JSON.stringify(r,(e,t)=>typeof t>"u"?null:t)}Hr.safeJsonStringify=zf;var ai={},Ai={get exports(){return ai},set exports(r){ai=r}},wn;function Kf(){return wn||(wn=1,function(){let r;function e(){}r=e,r.prototype.getItem=function(t){return this.hasOwnProperty(t)?String(this[t]):null},r.prototype.setItem=function(t,i){this[t]=String(i)},r.prototype.removeItem=function(t){delete this[t]},r.prototype.clear=function(){const t=this;Object.keys(t).forEach(function(i){t[i]=void 0,delete t[i]})},r.prototype.key=function(t){return t=t||0,Object.keys(this)[t]},r.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof nt<"u"&&nt.localStorage?Ai.exports=nt.localStorage:typeof window<"u"&&window.localStorage?Ai.exports=window.localStorage:Ai.exports=new e}()),ai}var Ci={},wr={},En;function Vf(){if(En)return wr;En=1,Object.defineProperty(wr,"__esModule",{value:!0}),wr.IKeyValueStorage=void 0;class r{}return wr.IKeyValueStorage=r,wr}var Er={},Dn;function Gf(){if(Dn)return Er;Dn=1,Object.defineProperty(Er,"__esModule",{value:!0}),Er.parseEntry=void 0;const r=Hr;function e(t){var i;return[t[0],r.safeJsonParse((i=t[1])!==null&&i!==void 0?i:"")]}return Er.parseEntry=e,Er}var Sn;function kf(){return Sn||(Sn=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=ft;e.__exportStar(Vf(),r),e.__exportStar(Gf(),r)}(Ci)),Ci}Object.defineProperty(vi,"__esModule",{value:!0});vi.KeyValueStorage=void 0;const cr=ft,In=Hr,Wf=cr.__importDefault(Kf()),Yf=kf();class ua{constructor(){this.localStorage=Wf.default}getKeys(){return cr.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return cr.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(Yf.parseEntry)})}getItem(e){return cr.__awaiter(this,void 0,void 0,function*(){const t=this.localStorage.getItem(e);if(t!==null)return In.safeJsonParse(t)})}setItem(e,t){return cr.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(e,In.safeJsonStringify(t))})}removeItem(e){return cr.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(e)})}}vi.KeyValueStorage=ua;var Jf=vi.default=ua,qr={},Dr={},Ri={},Sr={};let tr=class{};const Xf=Object.freeze(Object.defineProperty({__proto__:null,IEvents:tr},Symbol.toStringTag,{value:"Module"})),Qf=jc(Xf);var On;function Zf(){if(On)return Sr;On=1,Object.defineProperty(Sr,"__esModule",{value:!0}),Sr.IHeartBeat=void 0;const r=Qf;class e extends r.IEvents{constructor(i){super()}}return Sr.IHeartBeat=e,Sr}var xn;function la(){return xn||(xn=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),ft.__exportStar(Zf(),r)}(Ri)),Ri}var Ti={},Yt={},Pn;function ed(){if(Pn)return Yt;Pn=1,Object.defineProperty(Yt,"__esModule",{value:!0}),Yt.HEARTBEAT_EVENTS=Yt.HEARTBEAT_INTERVAL=void 0;const r=ee;return Yt.HEARTBEAT_INTERVAL=r.FIVE_SECONDS,Yt.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Yt}var An;function fa(){return An||(An=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),ft.__exportStar(ed(),r)}(Ti)),Ti}var Cn;function td(){if(Cn)return Dr;Cn=1,Object.defineProperty(Dr,"__esModule",{value:!0}),Dr.HeartBeat=void 0;const r=ft,e=Ze,t=ee,i=la(),s=fa();class a extends i.IHeartBeat{constructor(c){super(c),this.events=new e.EventEmitter,this.interval=s.HEARTBEAT_INTERVAL,this.interval=(c==null?void 0:c.interval)||s.HEARTBEAT_INTERVAL}static init(c){return r.__awaiter(this,void 0,void 0,function*(){const u=new a(c);return yield u.init(),u})}init(){return r.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(c,u){this.events.on(c,u)}once(c,u){this.events.once(c,u)}off(c,u){this.events.off(c,u)}removeListener(c,u){this.events.removeListener(c,u)}initialize(){return r.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),t.toMiliseconds(this.interval))})}pulse(){this.events.emit(s.HEARTBEAT_EVENTS.pulse)}}return Dr.HeartBeat=a,Dr}(function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=ft;e.__exportStar(td(),r),e.__exportStar(la(),r),e.__exportStar(fa(),r)})(qr);var Se={},Jt={},Rn;function da(){return Rn||(Rn=1,Object.defineProperty(Jt,"__esModule",{value:!0}),Jt.PINO_CUSTOM_CONTEXT_KEY=Jt.PINO_LOGGER_DEFAULTS=void 0,Jt.PINO_LOGGER_DEFAULTS={level:"info"},Jt.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Jt}var ot={},Tn;function rd(){if(Tn)return ot;Tn=1,Object.defineProperty(ot,"__esModule",{value:!0}),ot.generateChildLogger=ot.formatChildLoggerContext=ot.getLoggerContext=ot.setBrowserLoggerContext=ot.getBrowserLoggerContext=ot.getDefaultLoggerOptions=void 0;const r=da();function e(c){return Object.assign(Object.assign({},c),{level:(c==null?void 0:c.level)||r.PINO_LOGGER_DEFAULTS.level})}ot.getDefaultLoggerOptions=e;function t(c,u=r.PINO_CUSTOM_CONTEXT_KEY){return c[u]||""}ot.getBrowserLoggerContext=t;function i(c,u,g=r.PINO_CUSTOM_CONTEXT_KEY){return c[g]=u,c}ot.setBrowserLoggerContext=i;function s(c,u=r.PINO_CUSTOM_CONTEXT_KEY){let g="";return typeof c.bindings>"u"?g=t(c,u):g=c.bindings().context||"",g}ot.getLoggerContext=s;function a(c,u,g=r.PINO_CUSTOM_CONTEXT_KEY){const b=s(c,g);return b.trim()?`${b}/${u}`:u}ot.formatChildLoggerContext=a;function h(c,u,g=r.PINO_CUSTOM_CONTEXT_KEY){const b=a(c,u,g),E=c.child({context:b});return i(E,b,g)}return ot.generateChildLogger=h,ot}(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.pino=void 0;const e=ft,t=e.__importDefault(jr);Object.defineProperty(r,"pino",{enumerable:!0,get:function(){return t.default}}),e.__exportStar(da(),r),e.__exportStar(rd(),r)})(Se);class id extends tr{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}let sd=class extends tr{constructor(e,t){super(),this.core=e,this.logger=t,this.records=new Map}},nd=class{constructor(e,t){this.logger=e,this.core=t}},od=class extends tr{constructor(e,t){super(),this.relayer=e,this.logger=t}},ad=class extends tr{constructor(e){super()}},cd=class{constructor(e,t,i,s){this.core=e,this.logger=t,this.name=i}},hd=class extends tr{constructor(e,t){super(),this.relayer=e,this.logger=t}},ud=class extends tr{constructor(e,t){super(),this.core=e,this.logger=t}},ld=class{constructor(e){this.opts=e,this.protocol="wc",this.version=2}},fd=class{constructor(e){this.client=e}};function ms(r){if(typeof r!="string")throw new Error(`Cannot safe json parse value of type ${typeof r}`);try{return JSON.parse(r)}catch{return r}}function Fr(r){return typeof r=="string"?r:JSON.stringify(r)}var vs={},pa={};(function(r){Object.defineProperty(r,"__esModule",{value:!0});var e=ie,t=gt;r.DIGEST_LENGTH=64,r.BLOCK_SIZE=128;var i=function(){function c(){this.digestLength=r.DIGEST_LENGTH,this.blockSize=r.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return c.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},c.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},c.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._tempHi),t.wipe(this._tempLo),this.reset()},c.prototype.update=function(u,g){if(g===void 0&&(g=u.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var b=0;if(this._bytesHashed+=g,this._bufferLength>0){for(;this._bufferLength<r.BLOCK_SIZE&&g>0;)this._buffer[this._bufferLength++]=u[b++],g--;this._bufferLength===this.blockSize&&(a(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(g>=this.blockSize&&(b=a(this._tempHi,this._tempLo,this._stateHi,this._stateLo,u,b,g),g%=this.blockSize);g>0;)this._buffer[this._bufferLength++]=u[b++],g--;return this},c.prototype.finish=function(u){if(!this._finished){var g=this._bytesHashed,b=this._bufferLength,E=g/536870912|0,F=g<<3,I=g%128<112?128:256;this._buffer[b]=128;for(var w=b+1;w<I-8;w++)this._buffer[w]=0;e.writeUint32BE(E,this._buffer,I-8),e.writeUint32BE(F,this._buffer,I-4),a(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,I),this._finished=!0}for(var w=0;w<this.digestLength/8;w++)e.writeUint32BE(this._stateHi[w],u,w*8),e.writeUint32BE(this._stateLo[w],u,w*8+4);return this},c.prototype.digest=function(){var u=new Uint8Array(this.digestLength);return this.finish(u),u},c.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},c.prototype.restoreState=function(u){return this._stateHi.set(u.stateHi),this._stateLo.set(u.stateLo),this._bufferLength=u.bufferLength,u.buffer&&this._buffer.set(u.buffer),this._bytesHashed=u.bytesHashed,this._finished=!1,this},c.prototype.cleanSavedState=function(u){t.wipe(u.stateHi),t.wipe(u.stateLo),u.buffer&&t.wipe(u.buffer),u.bufferLength=0,u.bytesHashed=0},c}();r.SHA512=i;var s=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function a(c,u,g,b,E,F,I){for(var w=g[0],j=g[1],M=g[2],V=g[3],D=g[4],P=g[5],y=g[6],_=g[7],v=b[0],n=b[1],f=b[2],z=b[3],S=b[4],T=b[5],N=b[6],H=b[7],l,d,L,$,U,A,q,K;I>=128;){for(var Q=0;Q<16;Q++){var G=8*Q+F;c[Q]=e.readUint32BE(E,G),u[Q]=e.readUint32BE(E,G+4)}for(var Q=0;Q<80;Q++){var Z=w,X=j,ae=M,R=V,C=D,O=P,o=y,m=_,k=v,Y=n,le=f,be=z,de=S,_e=T,Le=N,Ce=H;if(l=_,d=H,U=d&65535,A=d>>>16,q=l&65535,K=l>>>16,l=(D>>>14|S<<32-14)^(D>>>18|S<<32-18)^(S>>>41-32|D<<32-(41-32)),d=(S>>>14|D<<32-14)^(S>>>18|D<<32-18)^(D>>>41-32|S<<32-(41-32)),U+=d&65535,A+=d>>>16,q+=l&65535,K+=l>>>16,l=D&P^~D&y,d=S&T^~S&N,U+=d&65535,A+=d>>>16,q+=l&65535,K+=l>>>16,l=s[Q*2],d=s[Q*2+1],U+=d&65535,A+=d>>>16,q+=l&65535,K+=l>>>16,l=c[Q%16],d=u[Q%16],U+=d&65535,A+=d>>>16,q+=l&65535,K+=l>>>16,A+=U>>>16,q+=A>>>16,K+=q>>>16,L=q&65535|K<<16,$=U&65535|A<<16,l=L,d=$,U=d&65535,A=d>>>16,q=l&65535,K=l>>>16,l=(w>>>28|v<<32-28)^(v>>>34-32|w<<32-(34-32))^(v>>>39-32|w<<32-(39-32)),d=(v>>>28|w<<32-28)^(w>>>34-32|v<<32-(34-32))^(w>>>39-32|v<<32-(39-32)),U+=d&65535,A+=d>>>16,q+=l&65535,K+=l>>>16,l=w&j^w&M^j&M,d=v&n^v&f^n&f,U+=d&65535,A+=d>>>16,q+=l&65535,K+=l>>>16,A+=U>>>16,q+=A>>>16,K+=q>>>16,m=q&65535|K<<16,Ce=U&65535|A<<16,l=R,d=be,U=d&65535,A=d>>>16,q=l&65535,K=l>>>16,l=L,d=$,U+=d&65535,A+=d>>>16,q+=l&65535,K+=l>>>16,A+=U>>>16,q+=A>>>16,K+=q>>>16,R=q&65535|K<<16,be=U&65535|A<<16,j=Z,M=X,V=ae,D=R,P=C,y=O,_=o,w=m,n=k,f=Y,z=le,S=be,T=de,N=_e,H=Le,v=Ce,Q%16===15)for(var G=0;G<16;G++)l=c[G],d=u[G],U=d&65535,A=d>>>16,q=l&65535,K=l>>>16,l=c[(G+9)%16],d=u[(G+9)%16],U+=d&65535,A+=d>>>16,q+=l&65535,K+=l>>>16,L=c[(G+1)%16],$=u[(G+1)%16],l=(L>>>1|$<<32-1)^(L>>>8|$<<32-8)^L>>>7,d=($>>>1|L<<32-1)^($>>>8|L<<32-8)^($>>>7|L<<32-7),U+=d&65535,A+=d>>>16,q+=l&65535,K+=l>>>16,L=c[(G+14)%16],$=u[(G+14)%16],l=(L>>>19|$<<32-19)^($>>>61-32|L<<32-(61-32))^L>>>6,d=($>>>19|L<<32-19)^(L>>>61-32|$<<32-(61-32))^($>>>6|L<<32-6),U+=d&65535,A+=d>>>16,q+=l&65535,K+=l>>>16,A+=U>>>16,q+=A>>>16,K+=q>>>16,c[G]=q&65535|K<<16,u[G]=U&65535|A<<16}l=w,d=v,U=d&65535,A=d>>>16,q=l&65535,K=l>>>16,l=g[0],d=b[0],U+=d&65535,A+=d>>>16,q+=l&65535,K+=l>>>16,A+=U>>>16,q+=A>>>16,K+=q>>>16,g[0]=w=q&65535|K<<16,b[0]=v=U&65535|A<<16,l=j,d=n,U=d&65535,A=d>>>16,q=l&65535,K=l>>>16,l=g[1],d=b[1],U+=d&65535,A+=d>>>16,q+=l&65535,K+=l>>>16,A+=U>>>16,q+=A>>>16,K+=q>>>16,g[1]=j=q&65535|K<<16,b[1]=n=U&65535|A<<16,l=M,d=f,U=d&65535,A=d>>>16,q=l&65535,K=l>>>16,l=g[2],d=b[2],U+=d&65535,A+=d>>>16,q+=l&65535,K+=l>>>16,A+=U>>>16,q+=A>>>16,K+=q>>>16,g[2]=M=q&65535|K<<16,b[2]=f=U&65535|A<<16,l=V,d=z,U=d&65535,A=d>>>16,q=l&65535,K=l>>>16,l=g[3],d=b[3],U+=d&65535,A+=d>>>16,q+=l&65535,K+=l>>>16,A+=U>>>16,q+=A>>>16,K+=q>>>16,g[3]=V=q&65535|K<<16,b[3]=z=U&65535|A<<16,l=D,d=S,U=d&65535,A=d>>>16,q=l&65535,K=l>>>16,l=g[4],d=b[4],U+=d&65535,A+=d>>>16,q+=l&65535,K+=l>>>16,A+=U>>>16,q+=A>>>16,K+=q>>>16,g[4]=D=q&65535|K<<16,b[4]=S=U&65535|A<<16,l=P,d=T,U=d&65535,A=d>>>16,q=l&65535,K=l>>>16,l=g[5],d=b[5],U+=d&65535,A+=d>>>16,q+=l&65535,K+=l>>>16,A+=U>>>16,q+=A>>>16,K+=q>>>16,g[5]=P=q&65535|K<<16,b[5]=T=U&65535|A<<16,l=y,d=N,U=d&65535,A=d>>>16,q=l&65535,K=l>>>16,l=g[6],d=b[6],U+=d&65535,A+=d>>>16,q+=l&65535,K+=l>>>16,A+=U>>>16,q+=A>>>16,K+=q>>>16,g[6]=y=q&65535|K<<16,b[6]=N=U&65535|A<<16,l=_,d=H,U=d&65535,A=d>>>16,q=l&65535,K=l>>>16,l=g[7],d=b[7],U+=d&65535,A+=d>>>16,q+=l&65535,K+=l>>>16,A+=U>>>16,q+=A>>>16,K+=q>>>16,g[7]=_=q&65535|K<<16,b[7]=H=U&65535|A<<16,F+=128,I-=128}return F}function h(c){var u=new i;u.update(c);var g=u.digest();return u.clean(),g}r.hash=h})(pa);(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.convertSecretKeyToX25519=r.convertPublicKeyToX25519=r.verify=r.sign=r.extractPublicKeyFromSecretKey=r.generateKeyPair=r.generateKeyPairFromSeed=r.SEED_LENGTH=r.SECRET_KEY_LENGTH=r.PUBLIC_KEY_LENGTH=r.SIGNATURE_LENGTH=void 0;const e=lr,t=pa,i=gt;r.SIGNATURE_LENGTH=64,r.PUBLIC_KEY_LENGTH=32,r.SECRET_KEY_LENGTH=64,r.SEED_LENGTH=32;function s(R){const C=new Float64Array(16);if(R)for(let O=0;O<R.length;O++)C[O]=R[O];return C}const a=new Uint8Array(32);a[0]=9;const h=s(),c=s([1]),u=s([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),g=s([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),b=s([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),E=s([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),F=s([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function I(R,C){for(let O=0;O<16;O++)R[O]=C[O]|0}function w(R){let C=1;for(let O=0;O<16;O++){let o=R[O]+C+65535;C=Math.floor(o/65536),R[O]=o-C*65536}R[0]+=C-1+37*(C-1)}function j(R,C,O){const o=~(O-1);for(let m=0;m<16;m++){const k=o&(R[m]^C[m]);R[m]^=k,C[m]^=k}}function M(R,C){const O=s(),o=s();for(let m=0;m<16;m++)o[m]=C[m];w(o),w(o),w(o);for(let m=0;m<2;m++){O[0]=o[0]-65517;for(let Y=1;Y<15;Y++)O[Y]=o[Y]-65535-(O[Y-1]>>16&1),O[Y-1]&=65535;O[15]=o[15]-32767-(O[14]>>16&1);const k=O[15]>>16&1;O[14]&=65535,j(o,O,1-k)}for(let m=0;m<16;m++)R[2*m]=o[m]&255,R[2*m+1]=o[m]>>8}function V(R,C){let O=0;for(let o=0;o<32;o++)O|=R[o]^C[o];return(1&O-1>>>8)-1}function D(R,C){const O=new Uint8Array(32),o=new Uint8Array(32);return M(O,R),M(o,C),V(O,o)}function P(R){const C=new Uint8Array(32);return M(C,R),C[0]&1}function y(R,C){for(let O=0;O<16;O++)R[O]=C[2*O]+(C[2*O+1]<<8);R[15]&=32767}function _(R,C,O){for(let o=0;o<16;o++)R[o]=C[o]+O[o]}function v(R,C,O){for(let o=0;o<16;o++)R[o]=C[o]-O[o]}function n(R,C,O){let o,m,k=0,Y=0,le=0,be=0,de=0,_e=0,Le=0,Ce=0,ye=0,pe=0,fe=0,he=0,ce=0,oe=0,ne=0,te=0,ue=0,ge=0,re=0,me=0,ve=0,Ee=0,De=0,we=0,_t=0,Et=0,Ut=0,dt=0,zt=0,yr=0,zr=0,$e=O[0],Re=O[1],Me=O[2],je=O[3],He=O[4],Te=O[5],ze=O[6],Ke=O[7],Ve=O[8],Ge=O[9],ke=O[10],Be=O[11],qe=O[12],Pe=O[13],We=O[14],Ye=O[15];o=C[0],k+=o*$e,Y+=o*Re,le+=o*Me,be+=o*je,de+=o*He,_e+=o*Te,Le+=o*ze,Ce+=o*Ke,ye+=o*Ve,pe+=o*Ge,fe+=o*ke,he+=o*Be,ce+=o*qe,oe+=o*Pe,ne+=o*We,te+=o*Ye,o=C[1],Y+=o*$e,le+=o*Re,be+=o*Me,de+=o*je,_e+=o*He,Le+=o*Te,Ce+=o*ze,ye+=o*Ke,pe+=o*Ve,fe+=o*Ge,he+=o*ke,ce+=o*Be,oe+=o*qe,ne+=o*Pe,te+=o*We,ue+=o*Ye,o=C[2],le+=o*$e,be+=o*Re,de+=o*Me,_e+=o*je,Le+=o*He,Ce+=o*Te,ye+=o*ze,pe+=o*Ke,fe+=o*Ve,he+=o*Ge,ce+=o*ke,oe+=o*Be,ne+=o*qe,te+=o*Pe,ue+=o*We,ge+=o*Ye,o=C[3],be+=o*$e,de+=o*Re,_e+=o*Me,Le+=o*je,Ce+=o*He,ye+=o*Te,pe+=o*ze,fe+=o*Ke,he+=o*Ve,ce+=o*Ge,oe+=o*ke,ne+=o*Be,te+=o*qe,ue+=o*Pe,ge+=o*We,re+=o*Ye,o=C[4],de+=o*$e,_e+=o*Re,Le+=o*Me,Ce+=o*je,ye+=o*He,pe+=o*Te,fe+=o*ze,he+=o*Ke,ce+=o*Ve,oe+=o*Ge,ne+=o*ke,te+=o*Be,ue+=o*qe,ge+=o*Pe,re+=o*We,me+=o*Ye,o=C[5],_e+=o*$e,Le+=o*Re,Ce+=o*Me,ye+=o*je,pe+=o*He,fe+=o*Te,he+=o*ze,ce+=o*Ke,oe+=o*Ve,ne+=o*Ge,te+=o*ke,ue+=o*Be,ge+=o*qe,re+=o*Pe,me+=o*We,ve+=o*Ye,o=C[6],Le+=o*$e,Ce+=o*Re,ye+=o*Me,pe+=o*je,fe+=o*He,he+=o*Te,ce+=o*ze,oe+=o*Ke,ne+=o*Ve,te+=o*Ge,ue+=o*ke,ge+=o*Be,re+=o*qe,me+=o*Pe,ve+=o*We,Ee+=o*Ye,o=C[7],Ce+=o*$e,ye+=o*Re,pe+=o*Me,fe+=o*je,he+=o*He,ce+=o*Te,oe+=o*ze,ne+=o*Ke,te+=o*Ve,ue+=o*Ge,ge+=o*ke,re+=o*Be,me+=o*qe,ve+=o*Pe,Ee+=o*We,De+=o*Ye,o=C[8],ye+=o*$e,pe+=o*Re,fe+=o*Me,he+=o*je,ce+=o*He,oe+=o*Te,ne+=o*ze,te+=o*Ke,ue+=o*Ve,ge+=o*Ge,re+=o*ke,me+=o*Be,ve+=o*qe,Ee+=o*Pe,De+=o*We,we+=o*Ye,o=C[9],pe+=o*$e,fe+=o*Re,he+=o*Me,ce+=o*je,oe+=o*He,ne+=o*Te,te+=o*ze,ue+=o*Ke,ge+=o*Ve,re+=o*Ge,me+=o*ke,ve+=o*Be,Ee+=o*qe,De+=o*Pe,we+=o*We,_t+=o*Ye,o=C[10],fe+=o*$e,he+=o*Re,ce+=o*Me,oe+=o*je,ne+=o*He,te+=o*Te,ue+=o*ze,ge+=o*Ke,re+=o*Ve,me+=o*Ge,ve+=o*ke,Ee+=o*Be,De+=o*qe,we+=o*Pe,_t+=o*We,Et+=o*Ye,o=C[11],he+=o*$e,ce+=o*Re,oe+=o*Me,ne+=o*je,te+=o*He,ue+=o*Te,ge+=o*ze,re+=o*Ke,me+=o*Ve,ve+=o*Ge,Ee+=o*ke,De+=o*Be,we+=o*qe,_t+=o*Pe,Et+=o*We,Ut+=o*Ye,o=C[12],ce+=o*$e,oe+=o*Re,ne+=o*Me,te+=o*je,ue+=o*He,ge+=o*Te,re+=o*ze,me+=o*Ke,ve+=o*Ve,Ee+=o*Ge,De+=o*ke,we+=o*Be,_t+=o*qe,Et+=o*Pe,Ut+=o*We,dt+=o*Ye,o=C[13],oe+=o*$e,ne+=o*Re,te+=o*Me,ue+=o*je,ge+=o*He,re+=o*Te,me+=o*ze,ve+=o*Ke,Ee+=o*Ve,De+=o*Ge,we+=o*ke,_t+=o*Be,Et+=o*qe,Ut+=o*Pe,dt+=o*We,zt+=o*Ye,o=C[14],ne+=o*$e,te+=o*Re,ue+=o*Me,ge+=o*je,re+=o*He,me+=o*Te,ve+=o*ze,Ee+=o*Ke,De+=o*Ve,we+=o*Ge,_t+=o*ke,Et+=o*Be,Ut+=o*qe,dt+=o*Pe,zt+=o*We,yr+=o*Ye,o=C[15],te+=o*$e,ue+=o*Re,ge+=o*Me,re+=o*je,me+=o*He,ve+=o*Te,Ee+=o*ze,De+=o*Ke,we+=o*Ve,_t+=o*Ge,Et+=o*ke,Ut+=o*Be,dt+=o*qe,zt+=o*Pe,yr+=o*We,zr+=o*Ye,k+=38*ue,Y+=38*ge,le+=38*re,be+=38*me,de+=38*ve,_e+=38*Ee,Le+=38*De,Ce+=38*we,ye+=38*_t,pe+=38*Et,fe+=38*Ut,he+=38*dt,ce+=38*zt,oe+=38*yr,ne+=38*zr,m=1,o=k+m+65535,m=Math.floor(o/65536),k=o-m*65536,o=Y+m+65535,m=Math.floor(o/65536),Y=o-m*65536,o=le+m+65535,m=Math.floor(o/65536),le=o-m*65536,o=be+m+65535,m=Math.floor(o/65536),be=o-m*65536,o=de+m+65535,m=Math.floor(o/65536),de=o-m*65536,o=_e+m+65535,m=Math.floor(o/65536),_e=o-m*65536,o=Le+m+65535,m=Math.floor(o/65536),Le=o-m*65536,o=Ce+m+65535,m=Math.floor(o/65536),Ce=o-m*65536,o=ye+m+65535,m=Math.floor(o/65536),ye=o-m*65536,o=pe+m+65535,m=Math.floor(o/65536),pe=o-m*65536,o=fe+m+65535,m=Math.floor(o/65536),fe=o-m*65536,o=he+m+65535,m=Math.floor(o/65536),he=o-m*65536,o=ce+m+65535,m=Math.floor(o/65536),ce=o-m*65536,o=oe+m+65535,m=Math.floor(o/65536),oe=o-m*65536,o=ne+m+65535,m=Math.floor(o/65536),ne=o-m*65536,o=te+m+65535,m=Math.floor(o/65536),te=o-m*65536,k+=m-1+37*(m-1),m=1,o=k+m+65535,m=Math.floor(o/65536),k=o-m*65536,o=Y+m+65535,m=Math.floor(o/65536),Y=o-m*65536,o=le+m+65535,m=Math.floor(o/65536),le=o-m*65536,o=be+m+65535,m=Math.floor(o/65536),be=o-m*65536,o=de+m+65535,m=Math.floor(o/65536),de=o-m*65536,o=_e+m+65535,m=Math.floor(o/65536),_e=o-m*65536,o=Le+m+65535,m=Math.floor(o/65536),Le=o-m*65536,o=Ce+m+65535,m=Math.floor(o/65536),Ce=o-m*65536,o=ye+m+65535,m=Math.floor(o/65536),ye=o-m*65536,o=pe+m+65535,m=Math.floor(o/65536),pe=o-m*65536,o=fe+m+65535,m=Math.floor(o/65536),fe=o-m*65536,o=he+m+65535,m=Math.floor(o/65536),he=o-m*65536,o=ce+m+65535,m=Math.floor(o/65536),ce=o-m*65536,o=oe+m+65535,m=Math.floor(o/65536),oe=o-m*65536,o=ne+m+65535,m=Math.floor(o/65536),ne=o-m*65536,o=te+m+65535,m=Math.floor(o/65536),te=o-m*65536,k+=m-1+37*(m-1),R[0]=k,R[1]=Y,R[2]=le,R[3]=be,R[4]=de,R[5]=_e,R[6]=Le,R[7]=Ce,R[8]=ye,R[9]=pe,R[10]=fe,R[11]=he,R[12]=ce,R[13]=oe,R[14]=ne,R[15]=te}function f(R,C){n(R,C,C)}function z(R,C){const O=s();let o;for(o=0;o<16;o++)O[o]=C[o];for(o=253;o>=0;o--)f(O,O),o!==2&&o!==4&&n(O,O,C);for(o=0;o<16;o++)R[o]=O[o]}function S(R,C){const O=s();let o;for(o=0;o<16;o++)O[o]=C[o];for(o=250;o>=0;o--)f(O,O),o!==1&&n(O,O,C);for(o=0;o<16;o++)R[o]=O[o]}function T(R,C){const O=s(),o=s(),m=s(),k=s(),Y=s(),le=s(),be=s(),de=s(),_e=s();v(O,R[1],R[0]),v(_e,C[1],C[0]),n(O,O,_e),_(o,R[0],R[1]),_(_e,C[0],C[1]),n(o,o,_e),n(m,R[3],C[3]),n(m,m,g),n(k,R[2],C[2]),_(k,k,k),v(Y,o,O),v(le,k,m),_(be,k,m),_(de,o,O),n(R[0],Y,le),n(R[1],de,be),n(R[2],be,le),n(R[3],Y,de)}function N(R,C,O){for(let o=0;o<4;o++)j(R[o],C[o],O)}function H(R,C){const O=s(),o=s(),m=s();z(m,C[2]),n(O,C[0],m),n(o,C[1],m),M(R,o),R[31]^=P(O)<<7}function l(R,C,O){I(R[0],h),I(R[1],c),I(R[2],c),I(R[3],h);for(let o=255;o>=0;--o){const m=O[o/8|0]>>(o&7)&1;N(R,C,m),T(C,R),T(R,R),N(R,C,m)}}function d(R,C){const O=[s(),s(),s(),s()];I(O[0],b),I(O[1],E),I(O[2],c),n(O[3],b,E),l(R,O,C)}function L(R){if(R.length!==r.SEED_LENGTH)throw new Error(`ed25519: seed must be ${r.SEED_LENGTH} bytes`);const C=(0,t.hash)(R);C[0]&=248,C[31]&=127,C[31]|=64;const O=new Uint8Array(32),o=[s(),s(),s(),s()];d(o,C),H(O,o);const m=new Uint8Array(64);return m.set(R),m.set(O,32),{publicKey:O,secretKey:m}}r.generateKeyPairFromSeed=L;function $(R){const C=(0,e.randomBytes)(32,R),O=L(C);return(0,i.wipe)(C),O}r.generateKeyPair=$;function U(R){if(R.length!==r.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${r.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(R.subarray(32))}r.extractPublicKeyFromSecretKey=U;const A=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function q(R,C){let O,o,m,k;for(o=63;o>=32;--o){for(O=0,m=o-32,k=o-12;m<k;++m)C[m]+=O-16*C[o]*A[m-(o-32)],O=Math.floor((C[m]+128)/256),C[m]-=O*256;C[m]+=O,C[o]=0}for(O=0,m=0;m<32;m++)C[m]+=O-(C[31]>>4)*A[m],O=C[m]>>8,C[m]&=255;for(m=0;m<32;m++)C[m]-=O*A[m];for(o=0;o<32;o++)C[o+1]+=C[o]>>8,R[o]=C[o]&255}function K(R){const C=new Float64Array(64);for(let O=0;O<64;O++)C[O]=R[O];for(let O=0;O<64;O++)R[O]=0;q(R,C)}function Q(R,C){const O=new Float64Array(64),o=[s(),s(),s(),s()],m=(0,t.hash)(R.subarray(0,32));m[0]&=248,m[31]&=127,m[31]|=64;const k=new Uint8Array(64);k.set(m.subarray(32),32);const Y=new t.SHA512;Y.update(k.subarray(32)),Y.update(C);const le=Y.digest();Y.clean(),K(le),d(o,le),H(k,o),Y.reset(),Y.update(k.subarray(0,32)),Y.update(R.subarray(32)),Y.update(C);const be=Y.digest();K(be);for(let de=0;de<32;de++)O[de]=le[de];for(let de=0;de<32;de++)for(let _e=0;_e<32;_e++)O[de+_e]+=be[de]*m[_e];return q(k.subarray(32),O),k}r.sign=Q;function G(R,C){const O=s(),o=s(),m=s(),k=s(),Y=s(),le=s(),be=s();return I(R[2],c),y(R[1],C),f(m,R[1]),n(k,m,u),v(m,m,R[2]),_(k,R[2],k),f(Y,k),f(le,Y),n(be,le,Y),n(O,be,m),n(O,O,k),S(O,O),n(O,O,m),n(O,O,k),n(O,O,k),n(R[0],O,k),f(o,R[0]),n(o,o,k),D(o,m)&&n(R[0],R[0],F),f(o,R[0]),n(o,o,k),D(o,m)?-1:(P(R[0])===C[31]>>7&&v(R[0],h,R[0]),n(R[3],R[0],R[1]),0)}function Z(R,C,O){const o=new Uint8Array(32),m=[s(),s(),s(),s()],k=[s(),s(),s(),s()];if(O.length!==r.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${r.SIGNATURE_LENGTH} bytes`);if(G(k,R))return!1;const Y=new t.SHA512;Y.update(O.subarray(0,32)),Y.update(R),Y.update(C);const le=Y.digest();return K(le),l(m,k,le),d(k,O.subarray(32)),T(m,k),H(o,m),!V(O,o)}r.verify=Z;function X(R){let C=[s(),s(),s(),s()];if(G(C,R))throw new Error("Ed25519: invalid public key");let O=s(),o=s(),m=C[1];_(O,c,m),v(o,c,m),z(o,o),n(O,O,o);let k=new Uint8Array(32);return M(k,O),k}r.convertPublicKeyToX25519=X;function ae(R){const C=(0,t.hash)(R.subarray(0,32));C[0]&=248,C[31]&=127,C[31]|=64;const O=new Uint8Array(C.subarray(0,32));return(0,i.wipe)(C),O}r.convertSecretKeyToX25519=ae})(vs);const dd="EdDSA",pd="JWT",ga=".",ya="base64url",gd="utf8",yd="utf8",bd=":",md="did",vd="key",Nn="base58btc",_d="z",wd="K36",Ed=32;function ci(r){return lt(ht(Fr(r),gd),ya)}function ba(r){const e=ht(wd,Nn),t=_d+lt(ki([e,r]),Nn);return[md,vd,t].join(bd)}function Dd(r){return lt(r,ya)}function Sd(r){return ht([ci(r.header),ci(r.payload)].join(ga),yd)}function Id(r){return[ci(r.header),ci(r.payload),Dd(r.signature)].join(ga)}function Ln(r=lr.randomBytes(Ed)){return vs.generateKeyPairFromSeed(r)}async function Od(r,e,t,i,s=ee.fromMiliseconds(Date.now())){const a={alg:dd,typ:pd},h=ba(i.publicKey),c=s+t,u={iss:h,sub:r,aud:e,iat:s,exp:c},g=Sd({header:a,payload:u}),b=vs.sign(i.secretKey,g);return Id({header:a,payload:u,signature:b})}var ma={},Tt={},Fn;function xd(){if(Fn)return Tt;Fn=1,Object.defineProperty(Tt,"__esModule",{value:!0}),Tt.isBrowserCryptoAvailable=Tt.getSubtleCrypto=Tt.getBrowerCrypto=void 0;function r(){return(nt===null||nt===void 0?void 0:nt.crypto)||(nt===null||nt===void 0?void 0:nt.msCrypto)||{}}Tt.getBrowerCrypto=r;function e(){const i=r();return i.subtle||i.webkitSubtle}Tt.getSubtleCrypto=e;function t(){return!!r()&&!!e()}return Tt.isBrowserCryptoAvailable=t,Tt}var Nt={},Un;function Pd(){if(Un)return Nt;Un=1,Object.defineProperty(Nt,"__esModule",{value:!0}),Nt.isBrowser=Nt.isNode=Nt.isReactNative=void 0;function r(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}Nt.isReactNative=r;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}Nt.isNode=e;function t(){return!r()&&!e()}return Nt.isBrowser=t,Nt}(function(r){Object.defineProperty(r,"__esModule",{value:!0});const e=ft;e.__exportStar(xd(),r),e.__exportStar(Pd(),r)})(ma);function Ad(){const r=Date.now()*Math.pow(10,3),e=Math.floor(Math.random()*Math.pow(10,3));return r+e}function Cd(r,e,t){return{id:t||Ad(),jsonrpc:"2.0",method:r,params:e}}class Rd{}class Td extends Rd{constructor(){super()}}class Nd extends Td{constructor(e){super()}}function Ld(r){return typeof r=="object"&&"id"in r&&"jsonrpc"in r&&r.jsonrpc==="2.0"}function Fd(r){return Ld(r)&&(Ud(r)||va(r))}function Ud(r){return"result"in r}function va(r){return"error"in r}class rr extends Nd{constructor(e){super(e),this.events=new Ze.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async request(e,t){return this.requestStrict(Cd(e.method,e.params||[]),t)}async requestStrict(e,t){return new Promise(async(i,s)=>{if(!this.connection.connected)try{await this.open()}catch(a){s(a)}this.events.on(`${e.id}`,a=>{va(a)?s(a.error):i(a.result)});try{await this.connection.send(e,t)}catch(a){s(a)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),Fd(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const $d="PARSE_ERROR",Md="INVALID_REQUEST",jd="METHOD_NOT_FOUND",Hd="INVALID_PARAMS",_a="INTERNAL_ERROR",_s="SERVER_ERROR",qd=[-32700,-32600,-32601,-32602,-32603],Ar={[$d]:{code:-32700,message:"Parse error"},[Md]:{code:-32600,message:"Invalid Request"},[jd]:{code:-32601,message:"Method not found"},[Hd]:{code:-32602,message:"Invalid params"},[_a]:{code:-32603,message:"Internal error"},[_s]:{code:-32e3,message:"Server error"}},wa=_s;function Bd(r){return qd.includes(r)}function $n(r){return Object.keys(Ar).includes(r)?Ar[r]:Ar[wa]}function zd(r){const e=Object.values(Ar).find(t=>t.code===r);return e||Ar[wa]}function Kd(){const r=Date.now()*Math.pow(10,3),e=Math.floor(Math.random()*Math.pow(10,3));return r+e}function ws(r,e,t){return{id:t||Kd(),jsonrpc:"2.0",method:r,params:e}}function Es(r,e){return{id:r,jsonrpc:"2.0",result:e}}function Ea(r,e,t){return{id:r,jsonrpc:"2.0",error:Vd(e,t)}}function Vd(r,e){return typeof r>"u"?$n(_a):(typeof r=="string"&&(r=Object.assign(Object.assign({},$n(_s)),{message:r})),typeof e<"u"&&(r.data=e),Bd(r.code)&&(r=zd(r.code)),r)}function Da(r){return typeof r=="object"&&"id"in r&&"jsonrpc"in r&&r.jsonrpc==="2.0"}function Ds(r){return Da(r)&&"method"in r}function Sa(r){return Da(r)&&(Lt(r)||xt(r))}function Lt(r){return"result"in r}function xt(r){return"error"in r}const Gd="PARSE_ERROR",kd="INVALID_REQUEST",Wd="METHOD_NOT_FOUND",Yd="INVALID_PARAMS",Ia="INTERNAL_ERROR",Ss="SERVER_ERROR",Jd=[-32700,-32600,-32601,-32602,-32603],Cr={[Gd]:{code:-32700,message:"Parse error"},[kd]:{code:-32600,message:"Invalid Request"},[Wd]:{code:-32601,message:"Method not found"},[Yd]:{code:-32602,message:"Invalid params"},[Ia]:{code:-32603,message:"Internal error"},[Ss]:{code:-32e3,message:"Server error"}},Oa=Ss;function Xd(r){return Jd.includes(r)}function Mn(r){return Object.keys(Cr).includes(r)?Cr[r]:Cr[Oa]}function Qd(r){const e=Object.values(Cr).find(t=>t.code===r);return e||Cr[Oa]}function Zd(r,e,t){return r.message.includes("getaddrinfo ENOTFOUND")||r.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${t} RPC url at ${e}`):r}function ep(r,e,t){return{id:r,jsonrpc:"2.0",error:tp(e,t)}}function tp(r,e){return typeof r>"u"?Mn(Ia):(typeof r=="string"&&(r=Object.assign(Object.assign({},Mn(Ss)),{message:r})),typeof e<"u"&&(r.data=e),Xd(r.code)&&(r=Qd(r.code)),r)}const rp="^wss?:";function ip(r){const e=r.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function sp(r,e){const t=ip(r);return typeof t>"u"?!1:new RegExp(e).test(t)}function jn(r){return sp(r,rp)}function np(r){return new RegExp("wss?://localhost(:d{2,5})?").test(r)}const Hn=10,op=()=>typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),ap=()=>typeof window<"u",cp=op();class hp{constructor(e){if(this.url=e,this.events=new Ze.EventEmitter,this.registering=!1,!jn(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,t)=>{if(typeof this.socket>"u"){t(new Error("Connection already closed"));return}this.socket.onclose=i=>{this.onClose(i),e()},this.socket.close()})}async send(e,t){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Fr(e))}catch(i){this.onError(e.id,i)}}register(e=this.url){if(!jn(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((i,s)=>{this.events.once("register_error",a=>{this.resetMaxListeners(),s(a)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return s(new Error("WebSocket connection is missing or invalid"));i(this.socket)})})}return this.url=e,this.registering=!0,new Promise((t,i)=>{const s=ma.isReactNative()?void 0:{rejectUnauthorized:!np(e)},a=new cp(e,[],s);ap()?a.onerror=h=>{const c=h;i(this.emitError(c.error))}:a.on("error",h=>{i(this.emitError(h))}),a.onopen=()=>{this.onOpen(a),t(a)}})}onOpen(e){e.onmessage=t=>this.onPayload(t),e.onclose=t=>this.onClose(t),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?ms(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const i=this.parseError(t),s=i.message||i.toString(),a=ep(e,s);this.events.emit("payload",a)}parseError(e,t=this.url){return Zd(e,t,"WS")}resetMaxListeners(){this.events.getMaxListeners()>Hn&&this.events.setMaxListeners(Hn)}emitError(e){const t=this.parseError(new Error((e==null?void 0:e.message)||`WebSocket connection failed for URL: ${this.url}`));return this.events.emit("register_error",t),t}}var hi={},up={get exports(){return hi},set exports(r){hi=r}};(function(r,e){var t=200,i="__lodash_hash_undefined__",s=1,a=2,h=9007199254740991,c="[object Arguments]",u="[object Array]",g="[object AsyncFunction]",b="[object Boolean]",E="[object Date]",F="[object Error]",I="[object Function]",w="[object GeneratorFunction]",j="[object Map]",M="[object Number]",V="[object Null]",D="[object Object]",P="[object Promise]",y="[object Proxy]",_="[object RegExp]",v="[object Set]",n="[object String]",f="[object Symbol]",z="[object Undefined]",S="[object WeakMap]",T="[object ArrayBuffer]",N="[object DataView]",H="[object Float32Array]",l="[object Float64Array]",d="[object Int8Array]",L="[object Int16Array]",$="[object Int32Array]",U="[object Uint8Array]",A="[object Uint8ClampedArray]",q="[object Uint16Array]",K="[object Uint32Array]",Q=/[\\^$.*+?()[\]{}|]/g,G=/^\[object .+?Constructor\]$/,Z=/^(?:0|[1-9]\d*)$/,X={};X[H]=X[l]=X[d]=X[L]=X[$]=X[U]=X[A]=X[q]=X[K]=!0,X[c]=X[u]=X[T]=X[b]=X[N]=X[E]=X[F]=X[I]=X[j]=X[M]=X[D]=X[_]=X[v]=X[n]=X[S]=!1;var ae=typeof nt=="object"&&nt&&nt.Object===Object&&nt,R=typeof self=="object"&&self&&self.Object===Object&&self,C=ae||R||Function("return this")(),O=e&&!e.nodeType&&e,o=O&&!0&&r&&!r.nodeType&&r,m=o&&o.exports===O,k=m&&ae.process,Y=function(){try{return k&&k.binding&&k.binding("util")}catch{}}(),le=Y&&Y.isTypedArray;function be(p,x){for(var B=-1,J=p==null?0:p.length,xe=0,se=[];++B<J;){var Ne=p[B];x(Ne,B,p)&&(se[xe++]=Ne)}return se}function de(p,x){for(var B=-1,J=x.length,xe=p.length;++B<J;)p[xe+B]=x[B];return p}function _e(p,x){for(var B=-1,J=p==null?0:p.length;++B<J;)if(x(p[B],B,p))return!0;return!1}function Le(p,x){for(var B=-1,J=Array(p);++B<p;)J[B]=x(B);return J}function Ce(p){return function(x){return p(x)}}function ye(p,x){return p.has(x)}function pe(p,x){return p==null?void 0:p[x]}function fe(p){var x=-1,B=Array(p.size);return p.forEach(function(J,xe){B[++x]=[xe,J]}),B}function he(p,x){return function(B){return p(x(B))}}function ce(p){var x=-1,B=Array(p.size);return p.forEach(function(J){B[++x]=J}),B}var oe=Array.prototype,ne=Function.prototype,te=Object.prototype,ue=C["__core-js_shared__"],ge=ne.toString,re=te.hasOwnProperty,me=function(){var p=/[^.]+$/.exec(ue&&ue.keys&&ue.keys.IE_PROTO||"");return p?"Symbol(src)_1."+p:""}(),ve=te.toString,Ee=RegExp("^"+ge.call(re).replace(Q,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),De=m?C.Buffer:void 0,we=C.Symbol,_t=C.Uint8Array,Et=te.propertyIsEnumerable,Ut=oe.splice,dt=we?we.toStringTag:void 0,zt=Object.getOwnPropertySymbols,yr=De?De.isBuffer:void 0,zr=he(Object.keys,Object),$e=sr(C,"DataView"),Re=sr(C,"Map"),Me=sr(C,"Promise"),je=sr(C,"Set"),He=sr(C,"WeakMap"),Te=sr(Object,"create"),ze=Vt($e),Ke=Vt(Re),Ve=Vt(Me),Ge=Vt(je),ke=Vt(He),Be=we?we.prototype:void 0,qe=Be?Be.valueOf:void 0;function Pe(p){var x=-1,B=p==null?0:p.length;for(this.clear();++x<B;){var J=p[x];this.set(J[0],J[1])}}function We(){this.__data__=Te?Te(null):{},this.size=0}function Ye(p){var x=this.has(p)&&delete this.__data__[p];return this.size-=x?1:0,x}function Xa(p){var x=this.__data__;if(Te){var B=x[p];return B===i?void 0:B}return re.call(x,p)?x[p]:void 0}function Qa(p){var x=this.__data__;return Te?x[p]!==void 0:re.call(x,p)}function Za(p,x){var B=this.__data__;return this.size+=this.has(p)?0:1,B[p]=Te&&x===void 0?i:x,this}Pe.prototype.clear=We,Pe.prototype.delete=Ye,Pe.prototype.get=Xa,Pe.prototype.has=Qa,Pe.prototype.set=Za;function Ct(p){var x=-1,B=p==null?0:p.length;for(this.clear();++x<B;){var J=p[x];this.set(J[0],J[1])}}function ec(){this.__data__=[],this.size=0}function tc(p){var x=this.__data__,B=Vr(x,p);if(B<0)return!1;var J=x.length-1;return B==J?x.pop():Ut.call(x,B,1),--this.size,!0}function rc(p){var x=this.__data__,B=Vr(x,p);return B<0?void 0:x[B][1]}function ic(p){return Vr(this.__data__,p)>-1}function sc(p,x){var B=this.__data__,J=Vr(B,p);return J<0?(++this.size,B.push([p,x])):B[J][1]=x,this}Ct.prototype.clear=ec,Ct.prototype.delete=tc,Ct.prototype.get=rc,Ct.prototype.has=ic,Ct.prototype.set=sc;function Kt(p){var x=-1,B=p==null?0:p.length;for(this.clear();++x<B;){var J=p[x];this.set(J[0],J[1])}}function nc(){this.size=0,this.__data__={hash:new Pe,map:new(Re||Ct),string:new Pe}}function oc(p){var x=Gr(this,p).delete(p);return this.size-=x?1:0,x}function ac(p){return Gr(this,p).get(p)}function cc(p){return Gr(this,p).has(p)}function hc(p,x){var B=Gr(this,p),J=B.size;return B.set(p,x),this.size+=B.size==J?0:1,this}Kt.prototype.clear=nc,Kt.prototype.delete=oc,Kt.prototype.get=ac,Kt.prototype.has=cc,Kt.prototype.set=hc;function Kr(p){var x=-1,B=p==null?0:p.length;for(this.__data__=new Kt;++x<B;)this.add(p[x])}function uc(p){return this.__data__.set(p,i),this}function lc(p){return this.__data__.has(p)}Kr.prototype.add=Kr.prototype.push=uc,Kr.prototype.has=lc;function $t(p){var x=this.__data__=new Ct(p);this.size=x.size}function fc(){this.__data__=new Ct,this.size=0}function dc(p){var x=this.__data__,B=x.delete(p);return this.size=x.size,B}function pc(p){return this.__data__.get(p)}function gc(p){return this.__data__.has(p)}function yc(p,x){var B=this.__data__;if(B instanceof Ct){var J=B.__data__;if(!Re||J.length<t-1)return J.push([p,x]),this.size=++B.size,this;B=this.__data__=new Kt(J)}return B.set(p,x),this.size=B.size,this}$t.prototype.clear=fc,$t.prototype.delete=dc,$t.prototype.get=pc,$t.prototype.has=gc,$t.prototype.set=yc;function bc(p,x){var B=kr(p),J=!B&&Tc(p),xe=!B&&!J&&Ei(p),se=!B&&!J&&!xe&&$s(p),Ne=B||J||xe||se,Je=Ne?Le(p.length,String):[],et=Je.length;for(var Ae in p)(x||re.call(p,Ae))&&!(Ne&&(Ae=="length"||xe&&(Ae=="offset"||Ae=="parent")||se&&(Ae=="buffer"||Ae=="byteLength"||Ae=="byteOffset")||xc(Ae,et)))&&Je.push(Ae);return Je}function Vr(p,x){for(var B=p.length;B--;)if(Ns(p[B][0],x))return B;return-1}function mc(p,x,B){var J=x(p);return kr(p)?J:de(J,B(p))}function br(p){return p==null?p===void 0?z:V:dt&&dt in Object(p)?Ic(p):Rc(p)}function As(p){return mr(p)&&br(p)==c}function Cs(p,x,B,J,xe){return p===x?!0:p==null||x==null||!mr(p)&&!mr(x)?p!==p&&x!==x:vc(p,x,B,J,Cs,xe)}function vc(p,x,B,J,xe,se){var Ne=kr(p),Je=kr(x),et=Ne?u:Mt(p),Ae=Je?u:Mt(x);et=et==c?D:et,Ae=Ae==c?D:Ae;var pt=et==D,wt=Ae==D,it=et==Ae;if(it&&Ei(p)){if(!Ei(x))return!1;Ne=!0,pt=!1}if(it&&!pt)return se||(se=new $t),Ne||$s(p)?Rs(p,x,B,J,xe,se):Dc(p,x,et,B,J,xe,se);if(!(B&s)){var yt=pt&&re.call(p,"__wrapped__"),bt=wt&&re.call(x,"__wrapped__");if(yt||bt){var jt=yt?p.value():p,Rt=bt?x.value():x;return se||(se=new $t),xe(jt,Rt,B,J,se)}}return it?(se||(se=new $t),Sc(p,x,B,J,xe,se)):!1}function _c(p){if(!Us(p)||Ac(p))return!1;var x=Ls(p)?Ee:G;return x.test(Vt(p))}function wc(p){return mr(p)&&Fs(p.length)&&!!X[br(p)]}function Ec(p){if(!Cc(p))return zr(p);var x=[];for(var B in Object(p))re.call(p,B)&&B!="constructor"&&x.push(B);return x}function Rs(p,x,B,J,xe,se){var Ne=B&s,Je=p.length,et=x.length;if(Je!=et&&!(Ne&&et>Je))return!1;var Ae=se.get(p);if(Ae&&se.get(x))return Ae==x;var pt=-1,wt=!0,it=B&a?new Kr:void 0;for(se.set(p,x),se.set(x,p);++pt<Je;){var yt=p[pt],bt=x[pt];if(J)var jt=Ne?J(bt,yt,pt,x,p,se):J(yt,bt,pt,p,x,se);if(jt!==void 0){if(jt)continue;wt=!1;break}if(it){if(!_e(x,function(Rt,Gt){if(!ye(it,Gt)&&(yt===Rt||xe(yt,Rt,B,J,se)))return it.push(Gt)})){wt=!1;break}}else if(!(yt===bt||xe(yt,bt,B,J,se))){wt=!1;break}}return se.delete(p),se.delete(x),wt}function Dc(p,x,B,J,xe,se,Ne){switch(B){case N:if(p.byteLength!=x.byteLength||p.byteOffset!=x.byteOffset)return!1;p=p.buffer,x=x.buffer;case T:return!(p.byteLength!=x.byteLength||!se(new _t(p),new _t(x)));case b:case E:case M:return Ns(+p,+x);case F:return p.name==x.name&&p.message==x.message;case _:case n:return p==x+"";case j:var Je=fe;case v:var et=J&s;if(Je||(Je=ce),p.size!=x.size&&!et)return!1;var Ae=Ne.get(p);if(Ae)return Ae==x;J|=a,Ne.set(p,x);var pt=Rs(Je(p),Je(x),J,xe,se,Ne);return Ne.delete(p),pt;case f:if(qe)return qe.call(p)==qe.call(x)}return!1}function Sc(p,x,B,J,xe,se){var Ne=B&s,Je=Ts(p),et=Je.length,Ae=Ts(x),pt=Ae.length;if(et!=pt&&!Ne)return!1;for(var wt=et;wt--;){var it=Je[wt];if(!(Ne?it in x:re.call(x,it)))return!1}var yt=se.get(p);if(yt&&se.get(x))return yt==x;var bt=!0;se.set(p,x),se.set(x,p);for(var jt=Ne;++wt<et;){it=Je[wt];var Rt=p[it],Gt=x[it];if(J)var Ms=Ne?J(Gt,Rt,it,x,p,se):J(Rt,Gt,it,p,x,se);if(!(Ms===void 0?Rt===Gt||xe(Rt,Gt,B,J,se):Ms)){bt=!1;break}jt||(jt=it=="constructor")}if(bt&&!jt){var Wr=p.constructor,Yr=x.constructor;Wr!=Yr&&"constructor"in p&&"constructor"in x&&!(typeof Wr=="function"&&Wr instanceof Wr&&typeof Yr=="function"&&Yr instanceof Yr)&&(bt=!1)}return se.delete(p),se.delete(x),bt}function Ts(p){return mc(p,Fc,Oc)}function Gr(p,x){var B=p.__data__;return Pc(x)?B[typeof x=="string"?"string":"hash"]:B.map}function sr(p,x){var B=pe(p,x);return _c(B)?B:void 0}function Ic(p){var x=re.call(p,dt),B=p[dt];try{p[dt]=void 0;var J=!0}catch{}var xe=ve.call(p);return J&&(x?p[dt]=B:delete p[dt]),xe}var Oc=zt?function(p){return p==null?[]:(p=Object(p),be(zt(p),function(x){return Et.call(p,x)}))}:Uc,Mt=br;($e&&Mt(new $e(new ArrayBuffer(1)))!=N||Re&&Mt(new Re)!=j||Me&&Mt(Me.resolve())!=P||je&&Mt(new je)!=v||He&&Mt(new He)!=S)&&(Mt=function(p){var x=br(p),B=x==D?p.constructor:void 0,J=B?Vt(B):"";if(J)switch(J){case ze:return N;case Ke:return j;case Ve:return P;case Ge:return v;case ke:return S}return x});function xc(p,x){return x=x??h,!!x&&(typeof p=="number"||Z.test(p))&&p>-1&&p%1==0&&p<x}function Pc(p){var x=typeof p;return x=="string"||x=="number"||x=="symbol"||x=="boolean"?p!=="__proto__":p===null}function Ac(p){return!!me&&me in p}function Cc(p){var x=p&&p.constructor,B=typeof x=="function"&&x.prototype||te;return p===B}function Rc(p){return ve.call(p)}function Vt(p){if(p!=null){try{return ge.call(p)}catch{}try{return p+""}catch{}}return""}function Ns(p,x){return p===x||p!==p&&x!==x}var Tc=As(function(){return arguments}())?As:function(p){return mr(p)&&re.call(p,"callee")&&!Et.call(p,"callee")},kr=Array.isArray;function Nc(p){return p!=null&&Fs(p.length)&&!Ls(p)}var Ei=yr||$c;function Lc(p,x){return Cs(p,x)}function Ls(p){if(!Us(p))return!1;var x=br(p);return x==I||x==w||x==g||x==y}function Fs(p){return typeof p=="number"&&p>-1&&p%1==0&&p<=h}function Us(p){var x=typeof p;return p!=null&&(x=="object"||x=="function")}function mr(p){return p!=null&&typeof p=="object"}var $s=le?Ce(le):wc;function Fc(p){return Nc(p)?bc(p):Ec(p)}function Uc(){return[]}function $c(){return!1}r.exports=Lc})(up,hi);function lp(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),i=0;i<t.length;i++)t[i]=255;for(var s=0;s<r.length;s++){var a=r.charAt(s),h=a.charCodeAt(0);if(t[h]!==255)throw new TypeError(a+" is ambiguous");t[h]=s}var c=r.length,u=r.charAt(0),g=Math.log(c)/Math.log(256),b=Math.log(256)/Math.log(c);function E(w){if(w instanceof Uint8Array||(ArrayBuffer.isView(w)?w=new Uint8Array(w.buffer,w.byteOffset,w.byteLength):Array.isArray(w)&&(w=Uint8Array.from(w))),!(w instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(w.length===0)return"";for(var j=0,M=0,V=0,D=w.length;V!==D&&w[V]===0;)V++,j++;for(var P=(D-V)*b+1>>>0,y=new Uint8Array(P);V!==D;){for(var _=w[V],v=0,n=P-1;(_!==0||v<M)&&n!==-1;n--,v++)_+=256*y[n]>>>0,y[n]=_%c>>>0,_=_/c>>>0;if(_!==0)throw new Error("Non-zero carry");M=v,V++}for(var f=P-M;f!==P&&y[f]===0;)f++;for(var z=u.repeat(j);f<P;++f)z+=r.charAt(y[f]);return z}function F(w){if(typeof w!="string")throw new TypeError("Expected String");if(w.length===0)return new Uint8Array;var j=0;if(w[j]!==" "){for(var M=0,V=0;w[j]===u;)M++,j++;for(var D=(w.length-j)*g+1>>>0,P=new Uint8Array(D);w[j];){var y=t[w.charCodeAt(j)];if(y===255)return;for(var _=0,v=D-1;(y!==0||_<V)&&v!==-1;v--,_++)y+=c*P[v]>>>0,P[v]=y%256>>>0,y=y/256>>>0;if(y!==0)throw new Error("Non-zero carry");V=_,j++}if(w[j]!==" "){for(var n=D-V;n!==D&&P[n]===0;)n++;for(var f=new Uint8Array(M+(D-n)),z=M;n!==D;)f[z++]=P[n++];return f}}}function I(w){var j=F(w);if(j)return j;throw new Error(`Non-${e} character`)}return{encode:E,decodeUnsafe:F,decode:I}}var fp=lp,dp=fp;const xa=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},pp=r=>new TextEncoder().encode(r),gp=r=>new TextDecoder().decode(r);class yp{constructor(e,t,i){this.name=e,this.prefix=t,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class bp{constructor(e,t,i){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Pa(this,e)}}class mp{constructor(e){this.decoders=e}or(e){return Pa(this,e)}decode(e){const t=e[0],i=this.decoders[t];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Pa=(r,e)=>new mp({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}});class vp{constructor(e,t,i,s){this.name=e,this.prefix=t,this.baseEncode=i,this.baseDecode=s,this.encoder=new yp(e,t,i),this.decoder=new bp(e,t,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const _i=({name:r,prefix:e,encode:t,decode:i})=>new vp(r,e,t,i),Br=({prefix:r,name:e,alphabet:t})=>{const{encode:i,decode:s}=dp(t,e);return _i({prefix:r,name:e,encode:i,decode:a=>xa(s(a))})},_p=(r,e,t,i)=>{const s={};for(let b=0;b<e.length;++b)s[e[b]]=b;let a=r.length;for(;r[a-1]==="=";)--a;const h=new Uint8Array(a*t/8|0);let c=0,u=0,g=0;for(let b=0;b<a;++b){const E=s[r[b]];if(E===void 0)throw new SyntaxError(`Non-${i} character`);u=u<<t|E,c+=t,c>=8&&(c-=8,h[g++]=255&u>>c)}if(c>=t||255&u<<8-c)throw new SyntaxError("Unexpected end of data");return h},wp=(r,e,t)=>{const i=e[e.length-1]==="=",s=(1<<t)-1;let a="",h=0,c=0;for(let u=0;u<r.length;++u)for(c=c<<8|r[u],h+=8;h>t;)h-=t,a+=e[s&c>>h];if(h&&(a+=e[s&c<<t-h]),i)for(;a.length*t&7;)a+="=";return a},rt=({name:r,prefix:e,bitsPerChar:t,alphabet:i})=>_i({prefix:e,name:r,encode(s){return wp(s,i,t)},decode(s){return _p(s,i,t,r)}}),Ep=_i({prefix:"\0",name:"identity",encode:r=>gp(r),decode:r=>pp(r)});var Dp=Object.freeze({__proto__:null,identity:Ep});const Sp=rt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Ip=Object.freeze({__proto__:null,base2:Sp});const Op=rt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var xp=Object.freeze({__proto__:null,base8:Op});const Pp=Br({prefix:"9",name:"base10",alphabet:"0123456789"});var Ap=Object.freeze({__proto__:null,base10:Pp});const Cp=rt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Rp=rt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Tp=Object.freeze({__proto__:null,base16:Cp,base16upper:Rp});const Np=rt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Lp=rt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Fp=rt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Up=rt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),$p=rt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Mp=rt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),jp=rt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Hp=rt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),qp=rt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Bp=Object.freeze({__proto__:null,base32:Np,base32upper:Lp,base32pad:Fp,base32padupper:Up,base32hex:$p,base32hexupper:Mp,base32hexpad:jp,base32hexpadupper:Hp,base32z:qp});const zp=Br({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Kp=Br({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Vp=Object.freeze({__proto__:null,base36:zp,base36upper:Kp});const Gp=Br({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),kp=Br({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Wp=Object.freeze({__proto__:null,base58btc:Gp,base58flickr:kp});const Yp=rt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Jp=rt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Xp=rt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Qp=rt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Zp=Object.freeze({__proto__:null,base64:Yp,base64pad:Jp,base64url:Xp,base64urlpad:Qp});const Aa=Array.from("ðŸš€ðŸªâ˜„ðŸ›°ðŸŒŒðŸŒ‘ðŸŒ’ðŸŒ“ðŸŒ”ðŸŒ•ðŸŒ–ðŸŒ—ðŸŒ˜ðŸŒðŸŒðŸŒŽðŸ‰â˜€ðŸ’»ðŸ–¥ðŸ’¾ðŸ’¿ðŸ˜‚â¤ðŸ˜ðŸ¤£ðŸ˜ŠðŸ™ðŸ’•ðŸ˜­ðŸ˜˜ðŸ‘ðŸ˜…ðŸ‘ðŸ˜ðŸ”¥ðŸ¥°ðŸ’”ðŸ’–ðŸ’™ðŸ˜¢ðŸ¤”ðŸ˜†ðŸ™„ðŸ’ªðŸ˜‰â˜ºðŸ‘ŒðŸ¤—ðŸ’œðŸ˜”ðŸ˜ŽðŸ˜‡ðŸŒ¹ðŸ¤¦ðŸŽ‰ðŸ’žâœŒâœ¨ðŸ¤·ðŸ˜±ðŸ˜ŒðŸŒ¸ðŸ™ŒðŸ˜‹ðŸ’—ðŸ’šðŸ˜ðŸ’›ðŸ™‚ðŸ’“ðŸ¤©ðŸ˜„ðŸ˜€ðŸ–¤ðŸ˜ƒðŸ’¯ðŸ™ˆðŸ‘‡ðŸŽ¶ðŸ˜’ðŸ¤­â£ðŸ˜œðŸ’‹ðŸ‘€ðŸ˜ªðŸ˜‘ðŸ’¥ðŸ™‹ðŸ˜žðŸ˜©ðŸ˜¡ðŸ¤ªðŸ‘ŠðŸ¥³ðŸ˜¥ðŸ¤¤ðŸ‘‰ðŸ’ƒðŸ˜³âœ‹ðŸ˜šðŸ˜ðŸ˜´ðŸŒŸðŸ˜¬ðŸ™ƒðŸ€ðŸŒ·ðŸ˜»ðŸ˜“â­âœ…ðŸ¥ºðŸŒˆðŸ˜ˆðŸ¤˜ðŸ’¦âœ”ðŸ˜£ðŸƒðŸ’â˜¹ðŸŽŠðŸ’˜ðŸ˜ â˜ðŸ˜•ðŸŒºðŸŽ‚ðŸŒ»ðŸ˜ðŸ–•ðŸ’ðŸ™ŠðŸ˜¹ðŸ—£ðŸ’«ðŸ’€ðŸ‘‘ðŸŽµðŸ¤žðŸ˜›ðŸ”´ðŸ˜¤ðŸŒ¼ðŸ˜«âš½ðŸ¤™â˜•ðŸ†ðŸ¤«ðŸ‘ˆðŸ˜®ðŸ™†ðŸ»ðŸƒðŸ¶ðŸ’ðŸ˜²ðŸŒ¿ðŸ§¡ðŸŽâš¡ðŸŒžðŸŽˆâŒâœŠðŸ‘‹ðŸ˜°ðŸ¤¨ðŸ˜¶ðŸ¤ðŸš¶ðŸ’°ðŸ“ðŸ’¢ðŸ¤ŸðŸ™ðŸš¨ðŸ’¨ðŸ¤¬âœˆðŸŽ€ðŸºðŸ¤“ðŸ˜™ðŸ’ŸðŸŒ±ðŸ˜–ðŸ‘¶ðŸ¥´â–¶âž¡â“ðŸ’ŽðŸ’¸â¬‡ðŸ˜¨ðŸŒšðŸ¦‹ðŸ˜·ðŸ•ºâš ðŸ™…ðŸ˜ŸðŸ˜µðŸ‘ŽðŸ¤²ðŸ¤ ðŸ¤§ðŸ“ŒðŸ”µðŸ’…ðŸ§ðŸ¾ðŸ’ðŸ˜—ðŸ¤‘ðŸŒŠðŸ¤¯ðŸ·â˜ŽðŸ’§ðŸ˜¯ðŸ’†ðŸ‘†ðŸŽ¤ðŸ™‡ðŸ‘â„ðŸŒ´ðŸ’£ðŸ¸ðŸ’ŒðŸ“ðŸ¥€ðŸ¤¢ðŸ‘…ðŸ’¡ðŸ’©ðŸ‘ðŸ“¸ðŸ‘»ðŸ¤ðŸ¤®ðŸŽ¼ðŸ¥µðŸš©ðŸŽðŸŠðŸ‘¼ðŸ’ðŸ“£ðŸ¥‚"),eg=Aa.reduce((r,e,t)=>(r[t]=e,r),[]),tg=Aa.reduce((r,e,t)=>(r[e.codePointAt(0)]=t,r),[]);function rg(r){return r.reduce((e,t)=>(e+=eg[t],e),"")}function ig(r){const e=[];for(const t of r){const i=tg[t.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(i)}return new Uint8Array(e)}const sg=_i({prefix:"ðŸš€",name:"base256emoji",encode:rg,decode:ig});var ng=Object.freeze({__proto__:null,base256emoji:sg}),og=Ca,qn=128,ag=127,cg=~ag,hg=Math.pow(2,31);function Ca(r,e,t){e=e||[],t=t||0;for(var i=t;r>=hg;)e[t++]=r&255|qn,r/=128;for(;r&cg;)e[t++]=r&255|qn,r>>>=7;return e[t]=r|0,Ca.bytes=t-i+1,e}var ug=es,lg=128,Bn=127;function es(r,i){var t=0,i=i||0,s=0,a=i,h,c=r.length;do{if(a>=c)throw es.bytes=0,new RangeError("Could not decode varint");h=r[a++],t+=s<28?(h&Bn)<<s:(h&Bn)*Math.pow(2,s),s+=7}while(h>=lg);return es.bytes=a-i,t}var fg=Math.pow(2,7),dg=Math.pow(2,14),pg=Math.pow(2,21),gg=Math.pow(2,28),yg=Math.pow(2,35),bg=Math.pow(2,42),mg=Math.pow(2,49),vg=Math.pow(2,56),_g=Math.pow(2,63),wg=function(r){return r<fg?1:r<dg?2:r<pg?3:r<gg?4:r<yg?5:r<bg?6:r<mg?7:r<vg?8:r<_g?9:10},Eg={encode:og,decode:ug,encodingLength:wg},Ra=Eg;const zn=(r,e,t=0)=>(Ra.encode(r,e,t),e),Kn=r=>Ra.encodingLength(r),ts=(r,e)=>{const t=e.byteLength,i=Kn(r),s=i+Kn(t),a=new Uint8Array(s+t);return zn(r,a,0),zn(t,a,i),a.set(e,s),new Dg(r,t,e,a)};class Dg{constructor(e,t,i,s){this.code=e,this.size=t,this.digest=i,this.bytes=s}}const Ta=({name:r,code:e,encode:t})=>new Sg(r,e,t);class Sg{constructor(e,t,i){this.name=e,this.code=t,this.encode=i}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?ts(this.code,t):t.then(i=>ts(this.code,i))}else throw Error("Unknown type, must be binary type")}}const Na=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),Ig=Ta({name:"sha2-256",code:18,encode:Na("SHA-256")}),Og=Ta({name:"sha2-512",code:19,encode:Na("SHA-512")});var xg=Object.freeze({__proto__:null,sha256:Ig,sha512:Og});const La=0,Pg="identity",Fa=xa,Ag=r=>ts(La,Fa(r)),Cg={code:La,name:Pg,encode:Fa,digest:Ag};var Rg=Object.freeze({__proto__:null,identity:Cg});new TextEncoder,new TextDecoder;const Vn={...Dp,...Ip,...xp,...Ap,...Tp,...Bp,...Vp,...Wp,...Zp,...ng};({...xg,...Rg});function Tg(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(r):new Uint8Array(r)}function Ua(r,e,t,i){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:i}}}const Gn=Ua("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),Ni=Ua("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);const e=Tg(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),Ng={utf8:Gn,"utf-8":Gn,hex:Vn.base16,latin1:Ni,ascii:Ni,binary:Ni,...Vn};function Lg(r,e="utf8"){const t=Ng[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r,"utf8"):t.decoder.decode(`${t.prefix}${r}`)}const $a="wc",Fg=2,Is="core",qt=`${$a}@${2}:${Is}:`,Ug={name:Is,logger:"error"},$g={database:":memory:"},Mg="crypto",kn="client_ed25519_seed",jg=ee.ONE_DAY,Hg="keychain",qg="0.3",Bg="messages",zg="0.3",Kg=ee.SIX_HOURS,Vg="publisher",Ma="irn",Gg="error",ja="wss://relay.walletconnect.com",kg="relayer",Xe={message:"relayer_message",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},Wg="_subscription",Xr={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},Yg=ee.ONE_SECOND,Jg="2.5.2",Xg="0.3",It={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},Qg="subscription",Zg="0.3",e0=ee.FIVE_SECONDS*1e3,t0="pairing",r0="0.3",Ir={wc_pairingDelete:{req:{ttl:ee.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ee.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ee.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ee.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ee.ONE_DAY,prompt:!1,tag:0},res:{ttl:ee.ONE_DAY,prompt:!1,tag:0}}},St={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},i0="history",s0="0.3",n0="expirer",vt={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},o0="0.3";class a0{constructor(e,t){this.core=e,this.logger=t,this.keychain=new Map,this.name=Hg,this.version=qg,this.initialized=!1,this.storagePrefix=qt,this.init=async()=>{if(!this.initialized){const i=await this.getKeyChain();typeof i<"u"&&(this.keychain=i),this.initialized=!0}},this.has=i=>(this.isInitialized(),this.keychain.has(i)),this.set=async(i,s)=>{this.isInitialized(),this.keychain.set(i,s),await this.persist()},this.get=i=>{this.isInitialized();const s=this.keychain.get(i);if(typeof s>"u"){const{message:a}=W("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(a)}return s},this.del=async i=>{this.isInitialized(),this.keychain.delete(i),await this.persist()},this.core=e,this.logger=Se.generateChildLogger(t,this.name)}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,ra(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?ia(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=W("NOT_INITIALIZED",this.name);throw new Error(e)}}}class c0{constructor(e,t,i){this.core=e,this.logger=t,this.name=Mg,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=s=>(this.isInitialized(),this.keychain.has(s)),this.getClientId=async()=>{this.isInitialized();const s=await this.getClientSeed(),a=Ln(s);return ba(a.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const s=_l();return this.setPrivateKey(s.publicKey,s.privateKey)},this.signJWT=async s=>{this.isInitialized();const a=await this.getClientSeed(),h=Ln(a),c=Xi();return await Od(c,s,jg,h)},this.generateSharedKey=(s,a,h)=>{this.isInitialized();const c=this.getPrivateKey(s),u=wl(c,a);return this.setSymKey(u,h)},this.setSymKey=async(s,a)=>{this.isInitialized();const h=a||El(s);return await this.keychain.set(h,s),h},this.deleteKeyPair=async s=>{this.isInitialized(),await this.keychain.del(s)},this.deleteSymKey=async s=>{this.isInitialized(),await this.keychain.del(s)},this.encode=async(s,a,h)=>{this.isInitialized();const c=ea(h),u=Fr(a);if(un(c)){const F=c.senderPublicKey,I=c.receiverPublicKey;s=await this.generateSharedKey(F,I)}const g=this.getSymKey(s),{type:b,senderPublicKey:E}=c;return Sl({type:b,symKey:g,message:u,senderPublicKey:E})},this.decode=async(s,a,h)=>{this.isInitialized();const c=xl(a,h);if(un(c)){const b=c.receiverPublicKey,E=c.senderPublicKey;s=await this.generateSharedKey(b,E)}const u=this.getSymKey(s),g=Il({symKey:u,encoded:a});return ms(g)},this.core=e,this.logger=Se.generateChildLogger(t,this.name),this.keychain=i||new a0(this.core,this.logger)}get context(){return Se.getLoggerContext(this.logger)}getPayloadType(e){const t=gs(e);return Mr(t.type)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(kn)}catch{e=Xi(),await this.keychain.set(kn,e)}return Lg(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=W("NOT_INITIALIZED",this.name);throw new Error(e)}}}class h0 extends nd{constructor(e,t){super(e,t),this.logger=e,this.core=t,this.messages=new Map,this.name=Bg,this.version=zg,this.initialized=!1,this.storagePrefix=qt,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const i=await this.getRelayerMessages();typeof i<"u"&&(this.messages=i),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(i){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(i)}finally{this.initialized=!0}}},this.set=async(i,s)=>{this.isInitialized();const a=ni(s);let h=this.messages.get(i);return typeof h>"u"&&(h={}),typeof h[a]<"u"||(h[a]=s,this.messages.set(i,h),await this.persist()),a},this.get=i=>{this.isInitialized();let s=this.messages.get(i);return typeof s>"u"&&(s={}),s},this.has=(i,s)=>{this.isInitialized();const a=this.get(i),h=ni(s);return typeof a[h]<"u"},this.del=async i=>{this.isInitialized(),this.messages.delete(i),await this.persist()},this.logger=Se.generateChildLogger(e,this.name),this.core=t}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,ra(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?ia(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=W("NOT_INITIALIZED",this.name);throw new Error(e)}}}class u0 extends od{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.events=new Ze.EventEmitter,this.name=Vg,this.queue=new Map,this.publishTimeout=1e4,this.publish=async(i,s,a)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:s,opts:a}});try{const h=(a==null?void 0:a.ttl)||Kg,c=Qi(a),u=(a==null?void 0:a.prompt)||!1,g=(a==null?void 0:a.tag)||0,b={topic:i,message:s,opts:{ttl:h,relay:c,prompt:u,tag:g}},E=ni(s);this.queue.set(E,b);try{await await oi(this.rpcPublish(i,s,h,c,u,g),this.publishTimeout),this.relayer.events.emit(Xe.publish,b)}catch{this.logger.debug("Publishing Payload stalled"),this.relayer.events.emit(Xe.connection_stalled);return}this.onPublish(E,b),this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:s,opts:a}})}catch(h){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(h),h}},this.on=(i,s)=>{this.events.on(i,s)},this.once=(i,s)=>{this.events.once(i,s)},this.off=(i,s)=>{this.events.off(i,s)},this.removeListener=(i,s)=>{this.events.removeListener(i,s)},this.relayer=e,this.logger=Se.generateChildLogger(t,this.name),this.registerEventListeners()}get context(){return Se.getLoggerContext(this.logger)}rpcPublish(e,t,i,s,a,h){var c,u,g,b;const E={method:ti(s.protocol).publish,params:{topic:e,message:t,ttl:i,prompt:a,tag:h}};return at((c=E.params)==null?void 0:c.prompt)&&((u=E.params)==null||delete u.prompt),at((g=E.params)==null?void 0:g.tag)&&((b=E.params)==null||delete b.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:E}),this.relayer.request(E)}onPublish(e,t){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:t,message:i,opts:s}=e;await this.publish(t,i,s)})}registerEventListeners(){this.relayer.core.heartbeat.on(qr.HEARTBEAT_EVENTS.pulse,()=>{this.checkQueue()})}}class l0{constructor(){this.map=new Map,this.set=(e,t)=>{const i=this.get(e);this.exists(e,t)||this.map.set(e,[...i,t])},this.get=e=>this.map.get(e)||[],this.exists=(e,t)=>this.get(e).includes(t),this.delete=(e,t)=>{if(typeof t>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const i=this.get(e);if(!this.exists(e,t))return;const s=i.filter(a=>a!==t);if(!s.length){this.map.delete(e);return}this.map.set(e,s)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var f0=Object.defineProperty,d0=Object.defineProperties,p0=Object.getOwnPropertyDescriptors,Wn=Object.getOwnPropertySymbols,g0=Object.prototype.hasOwnProperty,y0=Object.prototype.propertyIsEnumerable,Yn=(r,e,t)=>e in r?f0(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Or=(r,e)=>{for(var t in e||(e={}))g0.call(e,t)&&Yn(r,t,e[t]);if(Wn)for(var t of Wn(e))y0.call(e,t)&&Yn(r,t,e[t]);return r},Li=(r,e)=>d0(r,p0(e));class b0 extends hd{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.subscriptions=new Map,this.topicMap=new l0,this.events=new Ze.EventEmitter,this.name=Qg,this.version=Zg,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=qt,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(i,s)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:s}});try{const a=Qi(s),h={topic:i,relay:a};this.pending.set(i,h);const c=await this.rpcSubscribe(i,a);return this.onSubscribe(c,h),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:s}}),c}catch(a){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(a),a}},this.unsubscribe=async(i,s)=>{await this.restartToComplete(),this.isInitialized(),typeof(s==null?void 0:s.id)<"u"?await this.unsubscribeById(i,s.id,s):await this.unsubscribeByTopic(i,s)},this.isSubscribed=async i=>this.topics.includes(i)?!0:await new Promise((s,a)=>{const h=new ee.Watch;h.start(this.pendingSubscriptionWatchLabel);const c=setInterval(()=>{!this.pending.has(i)&&this.topics.includes(i)&&(clearInterval(c),h.stop(this.pendingSubscriptionWatchLabel),s(!0)),h.elapsed(this.pendingSubscriptionWatchLabel)>=e0&&(clearInterval(c),h.stop(this.pendingSubscriptionWatchLabel),a(!1))},this.pollingInterval)}),this.on=(i,s)=>{this.events.on(i,s)},this.once=(i,s)=>{this.events.once(i,s)},this.off=(i,s)=>{this.events.off(i,s)},this.removeListener=(i,s)=>{this.events.removeListener(i,s)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=Se.generateChildLogger(t,this.name),this.clientId=""}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,t){let i=!1;try{i=this.getSubscription(e).topic===t}catch{}return i}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){const i=this.topicMap.get(e);await Promise.all(i.map(async s=>await this.unsubscribeById(e,s,t)))}async unsubscribeById(e,t,i){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:i}});try{const s=Qi(i);await this.rpcUnsubscribe(e,t,s);const a=Ue("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,a),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:i}})}catch(s){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(s),s}}async rpcSubscribe(e,t){const i={method:ti(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});try{await await oi(this.relayer.request(i),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Xe.connection_stalled)}return ni(e+this.clientId)}async rpcBatchSubscribe(e){if(!e.length)return;const t=e[0].relay,i={method:ti(t.protocol).batchSubscribe,params:{topics:e.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});try{return await await oi(this.relayer.request(i),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Xe.connection_stalled)}}rpcUnsubscribe(e,t,i){const s={method:ti(i.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s}),this.relayer.request(s)}onSubscribe(e,t){this.setSubscription(e,Li(Or({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(t=>{this.setSubscription(t.id,Or({},t)),this.pending.delete(t.topic)})}async onUnsubscribe(e,t,i){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,i),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t))}addSubscription(e,t){this.subscriptions.set(e,Or({},t)),this.topicMap.set(t.topic,e),this.events.emit(It.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const t=this.subscriptions.get(e);if(!t){const{message:i}=W("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});const i=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(i.topic,e),this.events.emit(It.deleted,Li(Or({},i),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(It.sync)}async reset(){if(!this.cached.length)return;const e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let t=0;t<e;t++){const i=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(i)}this.events.emit(It.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:t}=W("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(!e.length)return;const t=await this.rpcBatchSubscribe(e);Ft(t)&&this.onBatchSubscribe(t.map((i,s)=>Li(Or({},e[s]),{id:i})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(this.relayer.transportExplicitlyClosed)return;const e=[];this.pending.forEach(t=>{e.push(t)}),await this.batchSubscribe(e)}registerEventListeners(){this.relayer.core.heartbeat.on(qr.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Xe.connect,async()=>{await this.onConnect()}),this.relayer.on(Xe.disconnect,()=>{this.onDisconnect()}),this.events.on(It.created,async e=>{const t=It.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()}),this.events.on(It.deleted,async e=>{const t=It.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=W("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){this.restartInProgress&&await new Promise(e=>{const t=setInterval(()=>{this.restartInProgress||(clearInterval(t),e())},this.pollingInterval)})}}var m0=Object.defineProperty,Jn=Object.getOwnPropertySymbols,v0=Object.prototype.hasOwnProperty,_0=Object.prototype.propertyIsEnumerable,Xn=(r,e,t)=>e in r?m0(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,w0=(r,e)=>{for(var t in e||(e={}))v0.call(e,t)&&Xn(r,t,e[t]);if(Jn)for(var t of Jn(e))_0.call(e,t)&&Xn(r,t,e[t]);return r};class E0 extends ad{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new Ze.EventEmitter,this.name=kg,this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.request=async t=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(t)}catch(i){throw this.logger.debug("Failed to Publish Request"),this.logger.error(i),i}},this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Se.generateChildLogger(e.logger,this.name):jr(Se.getDefaultLoggerOptions({level:e.logger||Gg})),this.messages=new h0(this.logger,e.core),this.subscriber=new b0(this,this.logger),this.publisher=new u0(this,this.logger),this.relayUrl=(e==null?void 0:e.relayUrl)||ja,this.projectId=e.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),await this.createProvider(),await Promise.all([this.messages.init(),this.transportOpen(),this.subscriber.init()]),this.registerEventListeners(),this.initialized=!0}get context(){return Se.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,t,i){this.isInitialized(),await this.publisher.publish(e,t,i),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now()})}async subscribe(e,t){this.isInitialized();let i="";return await Promise.all([new Promise(s=>{this.subscriber.once(It.created,a=>{a.topic===e&&s()})}),new Promise(async s=>{i=await this.subscriber.subscribe(e,t),s()})]),i}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(Xe.transport_closed))}async transportOpen(e){if(!this.reconnecting){this.relayUrl=e||this.relayUrl,this.transportExplicitlyClosed=!1,this.reconnecting=!0;try{await Promise.all([new Promise(t=>{this.initialized||t(),this.subscriber.once(It.resubscribed,()=>{t()})}),await Promise.race([new Promise(async(t,i)=>{await oi(this.provider.connect(),5e3,"socket stalled").catch(s=>i(s)).then(()=>t()).finally(()=>this.removeListener(Xe.transport_closed,this.rejectTransportOpen))}),new Promise(t=>this.once(Xe.transport_closed,this.rejectTransportOpen))])])}catch(t){this.logger.error(t);const i=t;if(!this.isConnectionStalled(i.message))throw t;this.events.emit(Xe.transport_closed)}finally{this.reconnecting=!1}}}async restartTransport(e){this.transportExplicitlyClosed||(this.relayUrl=e||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}isConnectionStalled(e){return this.staleConnectionErrors.some(t=>e.includes(t))}rejectTransportOpen(){throw new Error("closeTransport called before connection was established")}async createProvider(){const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new rr(new hp(ql({sdkVersion:Jg,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:t,message:i}=e;await this.messages.set(t,i)}async shouldIgnoreMessageEvent(e){const{topic:t,message:i}=e;return await this.subscriber.isSubscribed(t)?this.messages.has(t,i):!0}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),Ds(e)){if(!e.method.endsWith(Wg))return;const t=e.params,{topic:i,message:s,publishedAt:a}=t.data,h={topic:i,message:s,publishedAt:a};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(w0({type:"event",event:t.id},h)),this.events.emit(t.id,h),await this.acknowledgePayload(e),await this.onMessageEvent(h)}}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(Xe.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const t=Es(e.id,!0);await this.provider.connection.send(t)}registerProviderListeners(){this.provider.on(Xr.payload,e=>this.onProviderPayload(e)),this.provider.on(Xr.connect,()=>{this.events.emit(Xe.connect)}),this.provider.on(Xr.disconnect,()=>{this.onProviderDisconnect()}),this.provider.on(Xr.error,e=>{this.logger.error(e),this.events.emit(Xe.error,e)})}registerEventListeners(){this.events.on(Xe.connection_stalled,async()=>{await this.restartTransport()})}onProviderDisconnect(){this.events.emit(Xe.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.restartTransport()},ee.toMiliseconds(Yg))}isInitialized(){if(!this.initialized){const{message:e}=W("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(!this.connected){if(this.connecting)return await new Promise(e=>{const t=setInterval(()=>{this.connected&&(clearInterval(t),e())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var D0=Object.defineProperty,Qn=Object.getOwnPropertySymbols,S0=Object.prototype.hasOwnProperty,I0=Object.prototype.propertyIsEnumerable,Zn=(r,e,t)=>e in r?D0(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,eo=(r,e)=>{for(var t in e||(e={}))S0.call(e,t)&&Zn(r,t,e[t]);if(Qn)for(var t of Qn(e))I0.call(e,t)&&Zn(r,t,e[t]);return r};class wi extends cd{constructor(e,t,i,s=qt,a=void 0){super(e,t,i,s),this.core=e,this.logger=t,this.name=i,this.map=new Map,this.version=Xg,this.cached=[],this.initialized=!1,this.storagePrefix=qt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(h=>{this.getKey&&h!==null&&!at(h)?this.map.set(this.getKey(h),h):hf(h)?this.map.set(h.id,h):uf(h)&&this.map.set(h.topic,h)}),this.cached=[],this.initialized=!0)},this.set=async(h,c)=>{this.isInitialized(),this.map.has(h)?await this.update(h,c):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:h,value:c}),this.map.set(h,c),await this.persist())},this.get=h=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:h}),this.getData(h)),this.getAll=h=>(this.isInitialized(),h?this.values.filter(c=>Object.keys(h).every(u=>hi(c[u],h[u]))):this.values),this.update=async(h,c)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:h,update:c});const u=eo(eo({},this.getData(h)),c);this.map.set(h,u),await this.persist()},this.delete=async(h,c)=>{this.isInitialized(),this.map.has(h)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:h,reason:c}),this.map.delete(h),await this.persist())},this.logger=Se.generateChildLogger(t,this.name),this.storagePrefix=s,this.getKey=a}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const t=this.map.get(e);if(!t){const{message:i}=W("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:t}=W("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=W("NOT_INITIALIZED",this.name);throw new Error(e)}}}class O0{constructor(e,t){this.core=e,this.logger=t,this.name=t0,this.version=r0,this.events=new Ze,this.initialized=!1,this.storagePrefix=qt,this.ignoredPayloadTypes=[er],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:i})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...i])]},this.create=async()=>{this.isInitialized();const i=Xi(),s=await this.core.crypto.setSymKey(i),a=Ot(ee.FIVE_MINUTES),h={protocol:Ma},c={topic:s,expiry:a,relay:h,active:!1},u=Ql({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:i,relay:h});return await this.pairings.set(s,c),await this.core.relayer.subscribe(s),this.core.expirer.set(s,a),{topic:s,uri:u}},this.pair=async i=>{this.isInitialized(),this.isValidPair(i);const{topic:s,symKey:a,relay:h}=Jl(i.uri);if(this.pairings.keys.includes(s))throw new Error(`Pairing already exists: ${s}`);if(this.core.crypto.hasKeys(s))throw new Error(`Keychain already exists: ${s}`);const c=Ot(ee.FIVE_MINUTES),u={topic:s,relay:h,expiry:c,active:!1};return await this.pairings.set(s,u),await this.core.crypto.setSymKey(a,s),await this.core.relayer.subscribe(s,{relay:h}),this.core.expirer.set(s,c),i.activatePairing&&await this.activate({topic:s}),u},this.activate=async({topic:i})=>{this.isInitialized();const s=Ot(ee.THIRTY_DAYS);await this.pairings.update(i,{active:!0,expiry:s}),this.core.expirer.set(i,s)},this.ping=async i=>{this.isInitialized(),await this.isValidPing(i);const{topic:s}=i;if(this.pairings.keys.includes(s)){const a=await this.sendRequest(s,"wc_pairingPing",{}),{done:h,resolve:c,reject:u}=Xt();this.events.once(Fe("pairing_ping",a),({error:g})=>{g?u(g):c()}),await h()}},this.updateExpiry=async({topic:i,expiry:s})=>{this.isInitialized(),await this.pairings.update(i,{expiry:s})},this.updateMetadata=async({topic:i,metadata:s})=>{this.isInitialized(),await this.pairings.update(i,{peerMetadata:s})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async i=>{this.isInitialized(),await this.isValidDisconnect(i);const{topic:s}=i;this.pairings.keys.includes(s)&&(await this.sendRequest(s,"wc_pairingDelete",Ue("USER_DISCONNECTED")),await this.deletePairing(s))},this.sendRequest=async(i,s,a)=>{const h=ws(s,a),c=await this.core.crypto.encode(i,h),u=Ir[s].req;return this.core.history.set(i,h),await this.core.relayer.publish(i,c,u),h.id},this.sendResult=async(i,s,a)=>{const h=Es(i,a),c=await this.core.crypto.encode(s,h),u=await this.core.history.get(s,i),g=Ir[u.request.method].res;await this.core.relayer.publish(s,c,g),await this.core.history.resolve(h)},this.sendError=async(i,s,a)=>{const h=Ea(i,a),c=await this.core.crypto.encode(s,h),u=await this.core.history.get(s,i),g=Ir[u.request.method]?Ir[u.request.method].res:Ir.unregistered_method.res;await this.core.relayer.publish(s,c,g),await this.core.history.resolve(h)},this.deletePairing=async(i,s)=>{await this.core.relayer.unsubscribe(i),await Promise.all([this.pairings.delete(i,Ue("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(i),s?Promise.resolve():this.core.expirer.del(i)])},this.cleanup=async()=>{const i=this.pairings.getAll().filter(s=>Ht(s.expiry));await Promise.all(i.map(s=>this.deletePairing(s.topic)))},this.onRelayEventRequest=i=>{const{topic:s,payload:a}=i,h=a.method;if(this.pairings.keys.includes(s))switch(h){case"wc_pairingPing":return this.onPairingPingRequest(s,a);case"wc_pairingDelete":return this.onPairingDeleteRequest(s,a);default:return this.onUnknownRpcMethodRequest(s,a)}},this.onRelayEventResponse=async i=>{const{topic:s,payload:a}=i,h=(await this.core.history.get(s,a.id)).request.method;if(this.pairings.keys.includes(s))switch(h){case"wc_pairingPing":return this.onPairingPingResponse(s,a);default:return this.onUnknownRpcMethodResponse(h)}},this.onPairingPingRequest=async(i,s)=>{const{id:a}=s;try{this.isValidPing({topic:i}),await this.sendResult(a,i,!0),this.events.emit("pairing_ping",{id:a,topic:i})}catch(h){await this.sendError(a,i,h),this.logger.error(h)}},this.onPairingPingResponse=(i,s)=>{const{id:a}=s;setTimeout(()=>{Lt(s)?this.events.emit(Fe("pairing_ping",a),{}):xt(s)&&this.events.emit(Fe("pairing_ping",a),{error:s.error})},500)},this.onPairingDeleteRequest=async(i,s)=>{const{id:a}=s;try{this.isValidDisconnect({topic:i}),await this.deletePairing(i),this.events.emit("pairing_delete",{id:a,topic:i})}catch(h){await this.sendError(a,i,h),this.logger.error(h)}},this.onUnknownRpcMethodRequest=async(i,s)=>{const{id:a,method:h}=s;try{if(this.registeredMethods.includes(h))return;const c=Ue("WC_METHOD_UNSUPPORTED",h);await this.sendError(a,i,c),this.logger.error(c)}catch(c){await this.sendError(a,i,c),this.logger.error(c)}},this.onUnknownRpcMethodResponse=i=>{this.registeredMethods.includes(i)||this.logger.error(Ue("WC_METHOD_UNSUPPORTED",i))},this.isValidPair=i=>{if(!ct(i)){const{message:s}=W("MISSING_OR_INVALID",`pair() params: ${i}`);throw new Error(s)}if(!cf(i.uri)){const{message:s}=W("MISSING_OR_INVALID",`pair() uri: ${i.uri}`);throw new Error(s)}},this.isValidPing=async i=>{if(!ct(i)){const{message:a}=W("MISSING_OR_INVALID",`ping() params: ${i}`);throw new Error(a)}const{topic:s}=i;await this.isValidPairingTopic(s)},this.isValidDisconnect=async i=>{if(!ct(i)){const{message:a}=W("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw new Error(a)}const{topic:s}=i;await this.isValidPairingTopic(s)},this.isValidPairingTopic=async i=>{if(!Qe(i,!1)){const{message:s}=W("MISSING_OR_INVALID",`pairing topic should be a string: ${i}`);throw new Error(s)}if(!this.pairings.keys.includes(i)){const{message:s}=W("NO_MATCHING_KEY",`pairing topic doesn't exist: ${i}`);throw new Error(s)}if(Ht(this.pairings.get(i).expiry)){await this.deletePairing(i);const{message:s}=W("EXPIRED",`pairing topic: ${i}`);throw new Error(s)}},this.core=e,this.logger=Se.generateChildLogger(t,this.name),this.pairings=new wi(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Se.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=W("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(Xe.message,async e=>{const{topic:t,message:i}=e;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(i)))return;const s=await this.core.crypto.decode(t,i);Ds(s)?(this.core.history.set(t,s),this.onRelayEventRequest({topic:t,payload:s})):Sa(s)&&(await this.core.history.resolve(s),this.onRelayEventResponse({topic:t,payload:s}))})}registerExpirerEvents(){this.core.expirer.on(vt.expired,async e=>{const{topic:t}=na(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit("pairing_expire",{topic:t}))})}}class x0 extends sd{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.records=new Map,this.events=new Ze.EventEmitter,this.name=i0,this.version=s0,this.cached=[],this.initialized=!1,this.storagePrefix=qt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.records.set(i.id,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(i,s,a)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:i,request:s,chainId:a}),this.records.has(s.id))return;const h={id:s.id,topic:i,request:{method:s.method,params:s.params||null},chainId:a};this.records.set(h.id,h),this.events.emit(St.created,h)},this.resolve=async i=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:i}),!this.records.has(i.id))return;const s=await this.getRecord(i.id);typeof s.response>"u"&&(s.response=xt(i)?{error:i.error}:{result:i.result},this.records.set(s.id,s),this.events.emit(St.updated,s))},this.get=async(i,s)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:i,id:s}),await this.getRecord(s)),this.delete=(i,s)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:s}),this.values.forEach(a=>{if(a.topic===i){if(typeof s<"u"&&a.id!==s)return;this.records.delete(a.id),this.events.emit(St.deleted,a)}})},this.exists=async(i,s)=>(this.isInitialized(),this.records.has(s)?(await this.getRecord(s)).topic===i:!1),this.on=(i,s)=>{this.events.on(i,s)},this.once=(i,s)=>{this.events.once(i,s)},this.off=(i,s)=>{this.events.off(i,s)},this.removeListener=(i,s)=>{this.events.removeListener(i,s)},this.logger=Se.generateChildLogger(t,this.name)}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;const i={topic:t.topic,request:ws(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(i)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const t=this.records.get(e);if(!t){const{message:i}=W("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(St.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:t}=W("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(St.created,e=>{const t=St.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.events.on(St.updated,e=>{const t=St.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.events.on(St.deleted,e=>{const t=St.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=W("NOT_INITIALIZED",this.name);throw new Error(e)}}}class P0 extends ud{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.expirations=new Map,this.events=new Ze.EventEmitter,this.name=n0,this.version=o0,this.cached=[],this.initialized=!1,this.storagePrefix=qt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.expirations.set(i.target,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=i=>{try{const s=this.formatTarget(i);return typeof this.getExpiration(s)<"u"}catch{return!1}},this.set=(i,s)=>{this.isInitialized();const a=this.formatTarget(i),h={target:a,expiry:s};this.expirations.set(a,h),this.checkExpiry(a,h),this.events.emit(vt.created,{target:a,expiration:h})},this.get=i=>{this.isInitialized();const s=this.formatTarget(i);return this.getExpiration(s)},this.del=i=>{if(this.isInitialized(),this.has(i)){const s=this.formatTarget(i),a=this.getExpiration(s);this.expirations.delete(s),this.events.emit(vt.deleted,{target:s,expiration:a})}},this.on=(i,s)=>{this.events.on(i,s)},this.once=(i,s)=>{this.events.once(i,s)},this.off=(i,s)=>{this.events.off(i,s)},this.removeListener=(i,s)=>{this.events.removeListener(i,s)},this.logger=Se.generateChildLogger(t,this.name)}get context(){return Se.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return Bl(e);if(typeof e=="number")return zl(e);const{message:t}=W("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(vt.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:t}=W("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const t=this.expirations.get(e);if(!t){const{message:i}=W("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return t}checkExpiry(e,t){const{expiry:i}=t;ee.toMiliseconds(i)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(vt.expired,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(qr.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(vt.created,e=>{const t=vt.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(vt.expired,e=>{const t=vt.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(vt.deleted,e=>{const t=vt.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=W("NOT_INITIALIZED",this.name);throw new Error(e)}}}var A0=Object.defineProperty,to=Object.getOwnPropertySymbols,C0=Object.prototype.hasOwnProperty,R0=Object.prototype.propertyIsEnumerable,ro=(r,e,t)=>e in r?A0(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,io=(r,e)=>{for(var t in e||(e={}))C0.call(e,t)&&ro(r,t,e[t]);if(to)for(var t of to(e))R0.call(e,t)&&ro(r,t,e[t]);return r};let T0=class Ha extends id{constructor(e){super(e),this.protocol=$a,this.version=Fg,this.name=Is,this.events=new Ze.EventEmitter,this.initialized=!1,this.on=(i,s)=>this.events.on(i,s),this.once=(i,s)=>this.events.once(i,s),this.off=(i,s)=>this.events.off(i,s),this.removeListener=(i,s)=>this.events.removeListener(i,s),this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||ja;const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:jr(Se.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||Ug.logger}));this.logger=Se.generateChildLogger(t,this.name),this.heartbeat=new qr.HeartBeat,this.crypto=new c0(this,this.logger,e==null?void 0:e.keychain),this.history=new x0(this,this.logger),this.expirer=new P0(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new Jf(io(io({},$g),e==null?void 0:e.storageOptions)),this.relayer=new E0({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new O0(this,this.logger)}static async init(e){const t=new Ha(e);return await t.initialize(),t}get context(){return Se.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}};const N0=T0,qa="wc",Ba=2,za="client",Os=`${qa}@${Ba}:${za}:`,Fi={name:za,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},L0="proposal",Ka="Proposal expired",F0="session",Qr=ee.SEVEN_DAYS,U0="engine",xr={wc_sessionPropose:{req:{ttl:ee.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ee.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ee.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ee.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ee.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ee.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ee.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ee.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ee.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ee.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ee.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ee.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ee.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ee.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ee.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ee.THIRTY_SECONDS,prompt:!1,tag:1115}}},Ui={min:ee.FIVE_MINUTES,max:ee.SEVEN_DAYS},$0="request";var M0=Object.defineProperty,j0=Object.defineProperties,H0=Object.getOwnPropertyDescriptors,so=Object.getOwnPropertySymbols,q0=Object.prototype.hasOwnProperty,B0=Object.prototype.propertyIsEnumerable,no=(r,e,t)=>e in r?M0(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,mt=(r,e)=>{for(var t in e||(e={}))q0.call(e,t)&&no(r,t,e[t]);if(so)for(var t of so(e))B0.call(e,t)&&no(r,t,e[t]);return r},$i=(r,e)=>j0(r,H0(e));class z0 extends fd{constructor(e){super(e),this.name=U0,this.events=new Ze,this.initialized=!1,this.ignoredPayloadTypes=[er],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(xr)}),this.initialized=!0)},this.connect=async t=>{this.isInitialized();const i=$i(mt({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}});await this.isValidConnect(i);const{pairingTopic:s,requiredNamespaces:a,optionalNamespaces:h,sessionProperties:c,relays:u}=i;let g=s,b,E=!1;if(g&&(E=this.client.core.pairing.pairings.get(g).active),!g||!E){const{topic:P,uri:y}=await this.client.core.pairing.create();g=P,b=y}const F=await this.client.core.crypto.generateKeyPair(),I=mt({requiredNamespaces:a,optionalNamespaces:h,relays:u??[{protocol:Ma}],proposer:{publicKey:F,metadata:this.client.metadata}},c&&{sessionProperties:c}),{reject:w,resolve:j,done:M}=Xt(ee.FIVE_MINUTES,Ka);if(this.events.once(Fe("session_connect"),async({error:P,session:y})=>{if(P)w(P);else if(y){y.self.publicKey=F;const _=$i(mt({},y),{requiredNamespaces:y.requiredNamespaces,optionalNamespaces:y.optionalNamespaces});await this.client.session.set(y.topic,_),await this.setExpiry(y.topic,y.expiry),g&&await this.client.core.pairing.updateMetadata({topic:g,metadata:y.peer.metadata}),j(_)}}),!g){const{message:P}=W("NO_MATCHING_KEY",`connect() pairing topic: ${g}`);throw new Error(P)}const V=await this.sendRequest(g,"wc_sessionPropose",I),D=Ot(ee.FIVE_MINUTES);return await this.setProposal(V,mt({id:V,expiry:D},I)),{uri:b,approval:M}},this.pair=async t=>(this.isInitialized(),await this.client.core.pairing.pair(t)),this.approve=async t=>{this.isInitialized(),await this.isValidApprove(t);const{id:i,relayProtocol:s,namespaces:a,sessionProperties:h}=t,c=this.client.proposal.get(i);let{pairingTopic:u,proposer:g,requiredNamespaces:b,optionalNamespaces:E}=c;ur(b)||(b=rf(a,"approve()"));const F=await this.client.core.crypto.generateKeyPair(),I=g.publicKey,w=await this.client.core.crypto.generateSharedKey(F,I);u&&i&&(await this.client.core.pairing.updateMetadata({topic:u,metadata:g.metadata}),await this.sendResult(i,u,{relay:{protocol:s??"irn"},responderPublicKey:F}),await this.client.proposal.delete(i,Ue("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:u}));const j=mt({relay:{protocol:s??"irn"},namespaces:a,requiredNamespaces:b,optionalNamespaces:E,controller:{publicKey:F,metadata:this.client.metadata},expiry:Ot(Qr)},h&&{sessionProperties:h});await this.client.core.relayer.subscribe(w);const M=await this.sendRequest(w,"wc_sessionSettle",j),{done:V,resolve:D,reject:P}=Xt();this.events.once(Fe("session_approve",M),({error:_})=>{_?P(_):D(this.client.session.get(w))});const y=$i(mt({},j),{topic:w,acknowledged:!1,self:j.controller,peer:{publicKey:g.publicKey,metadata:g.metadata},controller:F});return await this.client.session.set(w,y),await this.setExpiry(w,Ot(Qr)),{topic:w,acknowledged:V}},this.reject=async t=>{this.isInitialized(),await this.isValidReject(t);const{id:i,reason:s}=t,{pairingTopic:a}=this.client.proposal.get(i);a&&(await this.sendError(i,a,s),await this.client.proposal.delete(i,Ue("USER_DISCONNECTED")))},this.update=async t=>{this.isInitialized(),await this.isValidUpdate(t);const{topic:i,namespaces:s}=t,a=await this.sendRequest(i,"wc_sessionUpdate",{namespaces:s}),{done:h,resolve:c,reject:u}=Xt();return this.events.once(Fe("session_update",a),({error:g})=>{g?u(g):c()}),await this.client.session.update(i,{namespaces:s}),{acknowledged:h}},this.extend=async t=>{this.isInitialized(),await this.isValidExtend(t);const{topic:i}=t,s=await this.sendRequest(i,"wc_sessionExtend",{}),{done:a,resolve:h,reject:c}=Xt();return this.events.once(Fe("session_extend",s),({error:u})=>{u?c(u):h()}),await this.setExpiry(i,Ot(Qr)),{acknowledged:a}},this.request=async t=>{this.isInitialized(),await this.isValidRequest(t);const{chainId:i,request:s,topic:a,expiry:h}=t,c=await this.sendRequest(a,"wc_sessionRequest",{request:s,chainId:i},h),{done:u,resolve:g,reject:b}=Xt(h);return this.events.once(Fe("session_request",c),({error:E,result:F})=>{E?b(E):g(F)}),this.client.events.emit("session_request_sent",{topic:a,request:s,chainId:i,id:c}),await u()},this.respond=async t=>{this.isInitialized(),await this.isValidRespond(t);const{topic:i,response:s}=t,{id:a}=s;Lt(s)?await this.sendResult(a,i,s.result):xt(s)&&await this.sendError(a,i,s.error),this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0})},this.ping=async t=>{this.isInitialized(),await this.isValidPing(t);const{topic:i}=t;if(this.client.session.keys.includes(i)){const s=await this.sendRequest(i,"wc_sessionPing",{}),{done:a,resolve:h,reject:c}=Xt();this.events.once(Fe("session_ping",s),({error:u})=>{u?c(u):h()}),await a()}else this.client.core.pairing.pairings.keys.includes(i)&&await this.client.core.pairing.ping({topic:i})},this.emit=async t=>{this.isInitialized(),await this.isValidEmit(t);const{topic:i,event:s,chainId:a}=t;await this.sendRequest(i,"wc_sessionEvent",{event:s,chainId:a})},this.disconnect=async t=>{this.isInitialized(),await this.isValidDisconnect(t);const{topic:i}=t;this.client.session.keys.includes(i)?(await this.sendRequest(i,"wc_sessionDelete",Ue("USER_DISCONNECTED")),await this.deleteSession(i)):await this.client.core.pairing.disconnect({topic:i})},this.find=t=>(this.isInitialized(),this.client.session.getAll().filter(i=>of(i,t))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.deleteSession=async(t,i)=>{const{self:s}=this.client.session.get(t);await this.client.core.relayer.unsubscribe(t),await Promise.all([this.client.session.delete(t,Ue("USER_DISCONNECTED")),this.client.core.crypto.deleteKeyPair(s.publicKey),this.client.core.crypto.deleteSymKey(t),i?Promise.resolve():this.client.core.expirer.del(t)])},this.deleteProposal=async(t,i)=>{await Promise.all([this.client.proposal.delete(t,Ue("USER_DISCONNECTED")),i?Promise.resolve():this.client.core.expirer.del(t)])},this.deletePendingSessionRequest=async(t,i,s=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,i),s?Promise.resolve():this.client.core.expirer.del(t)])},this.setExpiry=async(t,i)=>{this.client.session.keys.includes(t)&&await this.client.session.update(t,{expiry:i}),this.client.core.expirer.set(t,i)},this.setProposal=async(t,i)=>{await this.client.proposal.set(t,i),this.client.core.expirer.set(t,i.expiry)},this.setPendingSessionRequest=async t=>{const i=xr.wc_sessionRequest.req.ttl,{id:s,topic:a,params:h}=t;await this.client.pendingRequest.set(s,{id:s,topic:a,params:h}),i&&this.client.core.expirer.set(s,Ot(i))},this.sendRequest=async(t,i,s,a)=>{const h=ws(i,s),c=await this.client.core.crypto.encode(t,h),u=xr[i].req;return a&&(u.ttl=a),this.client.core.history.set(t,h),this.client.core.relayer.publish(t,c,u),h.id},this.sendResult=async(t,i,s)=>{const a=Es(t,s),h=await this.client.core.crypto.encode(i,a),c=await this.client.core.history.get(i,t),u=xr[c.request.method].res;this.client.core.relayer.publish(i,h,u),await this.client.core.history.resolve(a)},this.sendError=async(t,i,s)=>{const a=Ea(t,s),h=await this.client.core.crypto.encode(i,a),c=await this.client.core.history.get(i,t),u=xr[c.request.method].res;this.client.core.relayer.publish(i,h,u),await this.client.core.history.resolve(a)},this.cleanup=async()=>{const t=[],i=[];this.client.session.getAll().forEach(s=>{Ht(s.expiry)&&t.push(s.topic)}),this.client.proposal.getAll().forEach(s=>{Ht(s.expiry)&&i.push(s.id)}),await Promise.all([...t.map(s=>this.deleteSession(s)),...i.map(s=>this.deleteProposal(s))])},this.onRelayEventRequest=t=>{const{topic:i,payload:s}=t,a=s.method;switch(a){case"wc_sessionPropose":return this.onSessionProposeRequest(i,s);case"wc_sessionSettle":return this.onSessionSettleRequest(i,s);case"wc_sessionUpdate":return this.onSessionUpdateRequest(i,s);case"wc_sessionExtend":return this.onSessionExtendRequest(i,s);case"wc_sessionPing":return this.onSessionPingRequest(i,s);case"wc_sessionDelete":return this.onSessionDeleteRequest(i,s);case"wc_sessionRequest":return this.onSessionRequest(i,s);case"wc_sessionEvent":return this.onSessionEventRequest(i,s);default:return this.client.logger.info(`Unsupported request method ${a}`)}},this.onRelayEventResponse=async t=>{const{topic:i,payload:s}=t,a=(await this.client.core.history.get(i,s.id)).request.method;switch(a){case"wc_sessionPropose":return this.onSessionProposeResponse(i,s);case"wc_sessionSettle":return this.onSessionSettleResponse(i,s);case"wc_sessionUpdate":return this.onSessionUpdateResponse(i,s);case"wc_sessionExtend":return this.onSessionExtendResponse(i,s);case"wc_sessionPing":return this.onSessionPingResponse(i,s);case"wc_sessionRequest":return this.onSessionRequestResponse(i,s);default:return this.client.logger.info(`Unsupported response method ${a}`)}},this.onSessionProposeRequest=async(t,i)=>{const{params:s,id:a}=i;try{this.isValidConnect(mt({},i.params));const h=Ot(ee.FIVE_MINUTES),c=mt({id:a,pairingTopic:t,expiry:h},s);await this.setProposal(a,c),this.client.events.emit("session_proposal",{id:a,params:c})}catch(h){await this.sendError(a,t,h),this.client.logger.error(h)}},this.onSessionProposeResponse=async(t,i)=>{const{id:s}=i;if(Lt(i)){const{result:a}=i;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:a});const h=this.client.proposal.get(s);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:h});const c=h.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:c});const u=a.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:u});const g=await this.client.core.crypto.generateSharedKey(c,u);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:g});const b=await this.client.core.relayer.subscribe(g);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:b}),await this.client.core.pairing.activate({topic:t})}else xt(i)&&(await this.client.proposal.delete(s,Ue("USER_DISCONNECTED")),this.events.emit(Fe("session_connect"),{error:i.error}))},this.onSessionSettleRequest=async(t,i)=>{const{id:s,params:a}=i;try{this.isValidSessionSettleRequest(a);const{relay:h,controller:c,expiry:u,namespaces:g,requiredNamespaces:b,optionalNamespaces:E,sessionProperties:F}=i.params,I=mt({topic:t,relay:h,expiry:u,namespaces:g,acknowledged:!0,requiredNamespaces:b,optionalNamespaces:E,controller:c.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:c.publicKey,metadata:c.metadata}},F&&{sessionProperties:F});await this.sendResult(i.id,t,!0),this.events.emit(Fe("session_connect"),{session:I})}catch(h){await this.sendError(s,t,h),this.client.logger.error(h)}},this.onSessionSettleResponse=async(t,i)=>{const{id:s}=i;Lt(i)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit(Fe("session_approve",s),{})):xt(i)&&(await this.client.session.delete(t,Ue("USER_DISCONNECTED")),this.events.emit(Fe("session_approve",s),{error:i.error}))},this.onSessionUpdateRequest=async(t,i)=>{const{params:s,id:a}=i;try{this.isValidUpdate(mt({topic:t},s)),await this.client.session.update(t,{namespaces:s.namespaces}),await this.sendResult(a,t,!0),this.client.events.emit("session_update",{id:a,topic:t,params:s})}catch(h){await this.sendError(a,t,h),this.client.logger.error(h)}},this.onSessionUpdateResponse=(t,i)=>{const{id:s}=i;Lt(i)?this.events.emit(Fe("session_update",s),{}):xt(i)&&this.events.emit(Fe("session_update",s),{error:i.error})},this.onSessionExtendRequest=async(t,i)=>{const{id:s}=i;try{this.isValidExtend({topic:t}),await this.setExpiry(t,Ot(Qr)),await this.sendResult(s,t,!0),this.client.events.emit("session_extend",{id:s,topic:t})}catch(a){await this.sendError(s,t,a),this.client.logger.error(a)}},this.onSessionExtendResponse=(t,i)=>{const{id:s}=i;Lt(i)?this.events.emit(Fe("session_extend",s),{}):xt(i)&&this.events.emit(Fe("session_extend",s),{error:i.error})},this.onSessionPingRequest=async(t,i)=>{const{id:s}=i;try{this.isValidPing({topic:t}),await this.sendResult(s,t,!0),this.client.events.emit("session_ping",{id:s,topic:t})}catch(a){await this.sendError(s,t,a),this.client.logger.error(a)}},this.onSessionPingResponse=(t,i)=>{const{id:s}=i;setTimeout(()=>{Lt(i)?this.events.emit(Fe("session_ping",s),{}):xt(i)&&this.events.emit(Fe("session_ping",s),{error:i.error})},500)},this.onSessionDeleteRequest=async(t,i)=>{const{id:s}=i;try{this.isValidDisconnect({topic:t,reason:i.params}),this.client.core.relayer.once(Xe.publish,async()=>{await this.deleteSession(t)}),await this.sendResult(s,t,!0),this.client.events.emit("session_delete",{id:s,topic:t})}catch(a){await this.sendError(s,t,a),this.client.logger.error(a)}},this.onSessionRequest=async(t,i)=>{const{id:s,params:a}=i;try{this.isValidRequest(mt({topic:t},a)),await this.setPendingSessionRequest({id:s,topic:t,params:a}),this.client.events.emit("session_request",{id:s,topic:t,params:a})}catch(h){await this.sendError(s,t,h),this.client.logger.error(h)}},this.onSessionRequestResponse=(t,i)=>{const{id:s}=i;Lt(i)?this.events.emit(Fe("session_request",s),{result:i.result}):xt(i)&&this.events.emit(Fe("session_request",s),{error:i.error})},this.onSessionEventRequest=async(t,i)=>{const{id:s,params:a}=i;try{this.isValidEmit(mt({topic:t},a)),this.client.events.emit("session_event",{id:s,topic:t,params:a})}catch(h){await this.sendError(s,t,h),this.client.logger.error(h)}},this.isValidConnect=async t=>{if(!ct(t)){const{message:u}=W("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(u)}const{pairingTopic:i,requiredNamespaces:s,optionalNamespaces:a,sessionProperties:h,relays:c}=t;if(at(i)||await this.isValidPairingTopic(i),!mf(c,!0)){const{message:u}=W("MISSING_OR_INVALID",`connect() relays: ${c}`);throw new Error(u)}!at(s)&&ur(s)!==0&&this.validateNamespaces(s,"requiredNamespaces"),!at(a)&&ur(a)!==0&&this.validateNamespaces(a,"optionalNamespaces"),at(h)||this.validateSessionProps(h,"sessionProperties")},this.validateNamespaces=(t,i)=>{const s=bf(t,"connect()",i);if(s)throw new Error(s.message)},this.isValidApprove=async t=>{if(!ct(t))throw new Error(W("MISSING_OR_INVALID",`approve() params: ${t}`).message);const{id:i,namespaces:s,relayProtocol:a,sessionProperties:h}=t;await this.isValidProposalId(i);const c=this.client.proposal.get(i),u=ri(s,"approve()");if(u)throw new Error(u.message);const g=mn(c.requiredNamespaces,s,"approve()");if(g)throw new Error(g.message);if(!Qe(a,!0)){const{message:b}=W("MISSING_OR_INVALID",`approve() relayProtocol: ${a}`);throw new Error(b)}at(h)||this.validateSessionProps(h,"sessionProperties")},this.isValidReject=async t=>{if(!ct(t)){const{message:a}=W("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(a)}const{id:i,reason:s}=t;if(await this.isValidProposalId(i),!_f(s)){const{message:a}=W("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(s)}`);throw new Error(a)}},this.isValidSessionSettleRequest=t=>{if(!ct(t)){const{message:g}=W("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(g)}const{relay:i,controller:s,namespaces:a,expiry:h}=t;if(!aa(i)){const{message:g}=W("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(g)}const c=lf(s,"onSessionSettleRequest()");if(c)throw new Error(c.message);const u=ri(a,"onSessionSettleRequest()");if(u)throw new Error(u.message);if(Ht(h)){const{message:g}=W("EXPIRED","onSessionSettleRequest()");throw new Error(g)}},this.isValidUpdate=async t=>{if(!ct(t)){const{message:u}=W("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(u)}const{topic:i,namespaces:s}=t;await this.isValidSessionTopic(i);const a=this.client.session.get(i),h=ri(s,"update()");if(h)throw new Error(h.message);const c=mn(a.requiredNamespaces,s,"update()");if(c)throw new Error(c.message)},this.isValidExtend=async t=>{if(!ct(t)){const{message:s}=W("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(s)}const{topic:i}=t;await this.isValidSessionTopic(i)},this.isValidRequest=async t=>{if(!ct(t)){const{message:u}=W("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(u)}const{topic:i,request:s,chainId:a,expiry:h}=t;await this.isValidSessionTopic(i);const{namespaces:c}=this.client.session.get(i);if(!bn(c,a)){const{message:u}=W("MISSING_OR_INVALID",`request() chainId: ${a}`);throw new Error(u)}if(!wf(s)){const{message:u}=W("MISSING_OR_INVALID",`request() ${JSON.stringify(s)}`);throw new Error(u)}if(!Sf(c,a,s.method)){const{message:u}=W("MISSING_OR_INVALID",`request() method: ${s.method}`);throw new Error(u)}if(h&&!Pf(h,Ui)){const{message:u}=W("MISSING_OR_INVALID",`request() expiry: ${h}. Expiry must be a number (in seconds) between ${Ui.min} and ${Ui.max}`);throw new Error(u)}},this.isValidRespond=async t=>{if(!ct(t)){const{message:a}=W("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(a)}const{topic:i,response:s}=t;if(await this.isValidSessionTopic(i),!Ef(s)){const{message:a}=W("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(s)}`);throw new Error(a)}},this.isValidPing=async t=>{if(!ct(t)){const{message:s}=W("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(s)}const{topic:i}=t;await this.isValidSessionOrPairingTopic(i)},this.isValidEmit=async t=>{if(!ct(t)){const{message:c}=W("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(c)}const{topic:i,event:s,chainId:a}=t;await this.isValidSessionTopic(i);const{namespaces:h}=this.client.session.get(i);if(!bn(h,a)){const{message:c}=W("MISSING_OR_INVALID",`emit() chainId: ${a}`);throw new Error(c)}if(!Df(s)){const{message:c}=W("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(c)}if(!If(h,a,s.name)){const{message:c}=W("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(c)}},this.isValidDisconnect=async t=>{if(!ct(t)){const{message:s}=W("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(s)}const{topic:i}=t;await this.isValidSessionOrPairingTopic(i)},this.validateSessionProps=(t,i)=>{Object.values(t).forEach(s=>{if(!Qe(s,!1)){const{message:a}=W("MISSING_OR_INVALID",`${i} must be in Record<string, string> format. Received: ${JSON.stringify(s)}`);throw new Error(a)}})}}isInitialized(){if(!this.initialized){const{message:e}=W("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.client.core.relayer.on(Xe.message,async e=>{const{topic:t,message:i}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(i)))return;const s=await this.client.core.crypto.decode(t,i);Ds(s)?(this.client.core.history.set(t,s),this.onRelayEventRequest({topic:t,payload:s})):Sa(s)&&(await this.client.core.history.resolve(s),this.onRelayEventResponse({topic:t,payload:s}))})}registerExpirerEvents(){this.client.core.expirer.on(vt.expired,async e=>{const{topic:t,id:i}=na(e.target);if(i&&this.client.pendingRequest.keys.includes(i))return await this.deletePendingSessionRequest(i,W("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(await this.deleteSession(t,!0),this.client.events.emit("session_expire",{topic:t})):i&&(await this.deleteProposal(i,!0),this.client.events.emit("proposal_expire",{id:i}))})}isValidPairingTopic(e){if(!Qe(e,!1)){const{message:t}=W("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:t}=W("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(Ht(this.client.core.pairing.pairings.get(e).expiry)){const{message:t}=W("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}async isValidSessionTopic(e){if(!Qe(e,!1)){const{message:t}=W("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(!this.client.session.keys.includes(e)){const{message:t}=W("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if(Ht(this.client.session.get(e).expiry)){await this.deleteSession(e);const{message:t}=W("EXPIRED",`session topic: ${e}`);throw new Error(t)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(Qe(e,!1)){const{message:t}=W("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}else{const{message:t}=W("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}}async isValidProposalId(e){if(!vf(e)){const{message:t}=W("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!this.client.proposal.keys.includes(e)){const{message:t}=W("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if(Ht(this.client.proposal.get(e).expiry)){await this.deleteProposal(e);const{message:t}=W("EXPIRED",`proposal id: ${e}`);throw new Error(t)}}}class K0 extends wi{constructor(e,t){super(e,t,L0,Os),this.core=e,this.logger=t}}class V0 extends wi{constructor(e,t){super(e,t,F0,Os),this.core=e,this.logger=t}}class G0 extends wi{constructor(e,t){super(e,t,$0,Os,i=>i.id),this.core=e,this.logger=t}}let k0=class Va extends ld{constructor(e){super(e),this.protocol=qa,this.version=Ba,this.name=Fi.name,this.events=new Ze.EventEmitter,this.on=(i,s)=>this.events.on(i,s),this.once=(i,s)=>this.events.once(i,s),this.off=(i,s)=>this.events.off(i,s),this.removeListener=(i,s)=>this.events.removeListener(i,s),this.removeAllListeners=i=>this.events.removeAllListeners(i),this.connect=async i=>{try{return await this.engine.connect(i)}catch(s){throw this.logger.error(s.message),s}},this.pair=async i=>{try{return await this.engine.pair(i)}catch(s){throw this.logger.error(s.message),s}},this.approve=async i=>{try{return await this.engine.approve(i)}catch(s){throw this.logger.error(s.message),s}},this.reject=async i=>{try{return await this.engine.reject(i)}catch(s){throw this.logger.error(s.message),s}},this.update=async i=>{try{return await this.engine.update(i)}catch(s){throw this.logger.error(s.message),s}},this.extend=async i=>{try{return await this.engine.extend(i)}catch(s){throw this.logger.error(s.message),s}},this.request=async i=>{try{return await this.engine.request(i)}catch(s){throw this.logger.error(s.message),s}},this.respond=async i=>{try{return await this.engine.respond(i)}catch(s){throw this.logger.error(s.message),s}},this.ping=async i=>{try{return await this.engine.ping(i)}catch(s){throw this.logger.error(s.message),s}},this.emit=async i=>{try{return await this.engine.emit(i)}catch(s){throw this.logger.error(s.message),s}},this.disconnect=async i=>{try{return await this.engine.disconnect(i)}catch(s){throw this.logger.error(s.message),s}},this.find=i=>{try{return this.engine.find(i)}catch(s){throw this.logger.error(s.message),s}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(i){throw this.logger.error(i.message),i}},this.name=(e==null?void 0:e.name)||Fi.name,this.metadata=(e==null?void 0:e.metadata)||$l();const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:jr(Se.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||Fi.logger}));this.core=(e==null?void 0:e.core)||new N0(e),this.logger=Se.generateChildLogger(t,this.name),this.session=new V0(this.core,this.logger),this.proposal=new K0(this.core,this.logger),this.pendingRequest=new G0(this.core,this.logger),this.engine=new z0(this)}static async init(e){const t=new Va(e);return await t.initialize(),t}get context(){return Se.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}};var ui={},W0={get exports(){return ui},set exports(r){ui=r}};(function(r,e){var t=typeof self<"u"?self:nt,i=function(){function a(){this.fetch=!1,this.DOMException=t.DOMException}return a.prototype=t,new a}();(function(a){(function(h){var c={searchParams:"URLSearchParams"in a,iterable:"Symbol"in a&&"iterator"in Symbol,blob:"FileReader"in a&&"Blob"in a&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in a,arrayBuffer:"ArrayBuffer"in a};function u(l){return l&&DataView.prototype.isPrototypeOf(l)}if(c.arrayBuffer)var g=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],b=ArrayBuffer.isView||function(l){return l&&g.indexOf(Object.prototype.toString.call(l))>-1};function E(l){if(typeof l!="string"&&(l=String(l)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(l))throw new TypeError("Invalid character in header field name");return l.toLowerCase()}function F(l){return typeof l!="string"&&(l=String(l)),l}function I(l){var d={next:function(){var L=l.shift();return{done:L===void 0,value:L}}};return c.iterable&&(d[Symbol.iterator]=function(){return d}),d}function w(l){this.map={},l instanceof w?l.forEach(function(d,L){this.append(L,d)},this):Array.isArray(l)?l.forEach(function(d){this.append(d[0],d[1])},this):l&&Object.getOwnPropertyNames(l).forEach(function(d){this.append(d,l[d])},this)}w.prototype.append=function(l,d){l=E(l),d=F(d);var L=this.map[l];this.map[l]=L?L+", "+d:d},w.prototype.delete=function(l){delete this.map[E(l)]},w.prototype.get=function(l){return l=E(l),this.has(l)?this.map[l]:null},w.prototype.has=function(l){return this.map.hasOwnProperty(E(l))},w.prototype.set=function(l,d){this.map[E(l)]=F(d)},w.prototype.forEach=function(l,d){for(var L in this.map)this.map.hasOwnProperty(L)&&l.call(d,this.map[L],L,this)},w.prototype.keys=function(){var l=[];return this.forEach(function(d,L){l.push(L)}),I(l)},w.prototype.values=function(){var l=[];return this.forEach(function(d){l.push(d)}),I(l)},w.prototype.entries=function(){var l=[];return this.forEach(function(d,L){l.push([L,d])}),I(l)},c.iterable&&(w.prototype[Symbol.iterator]=w.prototype.entries);function j(l){if(l.bodyUsed)return Promise.reject(new TypeError("Already read"));l.bodyUsed=!0}function M(l){return new Promise(function(d,L){l.onload=function(){d(l.result)},l.onerror=function(){L(l.error)}})}function V(l){var d=new FileReader,L=M(d);return d.readAsArrayBuffer(l),L}function D(l){var d=new FileReader,L=M(d);return d.readAsText(l),L}function P(l){for(var d=new Uint8Array(l),L=new Array(d.length),$=0;$<d.length;$++)L[$]=String.fromCharCode(d[$]);return L.join("")}function y(l){if(l.slice)return l.slice(0);var d=new Uint8Array(l.byteLength);return d.set(new Uint8Array(l)),d.buffer}function _(){return this.bodyUsed=!1,this._initBody=function(l){this._bodyInit=l,l?typeof l=="string"?this._bodyText=l:c.blob&&Blob.prototype.isPrototypeOf(l)?this._bodyBlob=l:c.formData&&FormData.prototype.isPrototypeOf(l)?this._bodyFormData=l:c.searchParams&&URLSearchParams.prototype.isPrototypeOf(l)?this._bodyText=l.toString():c.arrayBuffer&&c.blob&&u(l)?(this._bodyArrayBuffer=y(l.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):c.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(l)||b(l))?this._bodyArrayBuffer=y(l):this._bodyText=l=Object.prototype.toString.call(l):this._bodyText="",this.headers.get("content-type")||(typeof l=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):c.searchParams&&URLSearchParams.prototype.isPrototypeOf(l)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},c.blob&&(this.blob=function(){var l=j(this);if(l)return l;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?j(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(V)}),this.text=function(){var l=j(this);if(l)return l;if(this._bodyBlob)return D(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(P(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},c.formData&&(this.formData=function(){return this.text().then(z)}),this.json=function(){return this.text().then(JSON.parse)},this}var v=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function n(l){var d=l.toUpperCase();return v.indexOf(d)>-1?d:l}function f(l,d){d=d||{};var L=d.body;if(l instanceof f){if(l.bodyUsed)throw new TypeError("Already read");this.url=l.url,this.credentials=l.credentials,d.headers||(this.headers=new w(l.headers)),this.method=l.method,this.mode=l.mode,this.signal=l.signal,!L&&l._bodyInit!=null&&(L=l._bodyInit,l.bodyUsed=!0)}else this.url=String(l);if(this.credentials=d.credentials||this.credentials||"same-origin",(d.headers||!this.headers)&&(this.headers=new w(d.headers)),this.method=n(d.method||this.method||"GET"),this.mode=d.mode||this.mode||null,this.signal=d.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&L)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(L)}f.prototype.clone=function(){return new f(this,{body:this._bodyInit})};function z(l){var d=new FormData;return l.trim().split("&").forEach(function(L){if(L){var $=L.split("="),U=$.shift().replace(/\+/g," "),A=$.join("=").replace(/\+/g," ");d.append(decodeURIComponent(U),decodeURIComponent(A))}}),d}function S(l){var d=new w,L=l.replace(/\r?\n[\t ]+/g," ");return L.split(/\r?\n/).forEach(function($){var U=$.split(":"),A=U.shift().trim();if(A){var q=U.join(":").trim();d.append(A,q)}}),d}_.call(f.prototype);function T(l,d){d||(d={}),this.type="default",this.status=d.status===void 0?200:d.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in d?d.statusText:"OK",this.headers=new w(d.headers),this.url=d.url||"",this._initBody(l)}_.call(T.prototype),T.prototype.clone=function(){return new T(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new w(this.headers),url:this.url})},T.error=function(){var l=new T(null,{status:0,statusText:""});return l.type="error",l};var N=[301,302,303,307,308];T.redirect=function(l,d){if(N.indexOf(d)===-1)throw new RangeError("Invalid status code");return new T(null,{status:d,headers:{location:l}})},h.DOMException=a.DOMException;try{new h.DOMException}catch{h.DOMException=function(d,L){this.message=d,this.name=L;var $=Error(d);this.stack=$.stack},h.DOMException.prototype=Object.create(Error.prototype),h.DOMException.prototype.constructor=h.DOMException}function H(l,d){return new Promise(function(L,$){var U=new f(l,d);if(U.signal&&U.signal.aborted)return $(new h.DOMException("Aborted","AbortError"));var A=new XMLHttpRequest;function q(){A.abort()}A.onload=function(){var K={status:A.status,statusText:A.statusText,headers:S(A.getAllResponseHeaders()||"")};K.url="responseURL"in A?A.responseURL:K.headers.get("X-Request-URL");var Q="response"in A?A.response:A.responseText;L(new T(Q,K))},A.onerror=function(){$(new TypeError("Network request failed"))},A.ontimeout=function(){$(new TypeError("Network request failed"))},A.onabort=function(){$(new h.DOMException("Aborted","AbortError"))},A.open(U.method,U.url,!0),U.credentials==="include"?A.withCredentials=!0:U.credentials==="omit"&&(A.withCredentials=!1),"responseType"in A&&c.blob&&(A.responseType="blob"),U.headers.forEach(function(K,Q){A.setRequestHeader(Q,K)}),U.signal&&(U.signal.addEventListener("abort",q),A.onreadystatechange=function(){A.readyState===4&&U.signal.removeEventListener("abort",q)}),A.send(typeof U._bodyInit>"u"?null:U._bodyInit)})}return H.polyfill=!0,a.fetch||(a.fetch=H,a.Headers=w,a.Request=f,a.Response=T),h.Headers=w,h.Request=f,h.Response=T,h.fetch=H,Object.defineProperty(h,"__esModule",{value:!0}),h})({})})(i),i.fetch.ponyfill=!0,delete i.fetch.polyfill;var s=i;e=s.fetch,e.default=s.fetch,e.fetch=s.fetch,e.Headers=s.Headers,e.Request=s.Request,e.Response=s.Response,r.exports=e})(W0,ui);const oo=Hc(ui),Y0="PARSE_ERROR",J0="INVALID_REQUEST",X0="METHOD_NOT_FOUND",Q0="INVALID_PARAMS",Ga="INTERNAL_ERROR",xs="SERVER_ERROR",Z0=[-32700,-32600,-32601,-32602,-32603],Rr={[Y0]:{code:-32700,message:"Parse error"},[J0]:{code:-32600,message:"Invalid Request"},[X0]:{code:-32601,message:"Method not found"},[Q0]:{code:-32602,message:"Invalid params"},[Ga]:{code:-32603,message:"Internal error"},[xs]:{code:-32e3,message:"Server error"}},ka=xs;function ey(r){return Z0.includes(r)}function ao(r){return Object.keys(Rr).includes(r)?Rr[r]:Rr[ka]}function ty(r){const e=Object.values(Rr).find(t=>t.code===r);return e||Rr[ka]}function ry(r,e,t){return r.message.includes("getaddrinfo ENOTFOUND")||r.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${t} RPC url at ${e}`):r}function iy(r,e,t){return{id:r,jsonrpc:"2.0",error:sy(e,t)}}function sy(r,e){return typeof r>"u"?ao(Ga):(typeof r=="string"&&(r=Object.assign(Object.assign({},ao(xs)),{message:r})),typeof e<"u"&&(r.data=e),ey(r.code)&&(r=ty(r.code)),r)}const ny="^https?:";function oy(r){const e=r.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function ay(r,e){const t=oy(r);return typeof t>"u"?!1:new RegExp(e).test(t)}function co(r){return ay(r,ny)}const cy={Accept:"application/json","Content-Type":"application/json"},hy="POST",ho={headers:cy,method:hy},uo=10;class pr{constructor(e){if(this.url=e,this.events=new Ze.EventEmitter,this.isAvailable=!1,this.registering=!1,!co(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e,t){this.isAvailable||await this.register();try{const i=Fr(e),a=await(await oo(this.url,Object.assign(Object.assign({},ho),{body:i}))).json();this.onPayload({data:a})}catch(i){this.onError(e.id,i)}}async register(e=this.url){if(!co(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((i,s)=>{this.events.once("register_error",a=>{this.resetMaxListeners(),s(a)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return s(new Error("HTTP connection is missing or invalid"));i()})})}this.url=e,this.registering=!0;try{const t=Fr({id:1,jsonrpc:"2.0",method:"test",params:[]});await oo(e,Object.assign(Object.assign({},ho),{body:t})),this.onOpen()}catch(t){const i=this.parseError(t);throw this.events.emit("register_error",i),this.onClose(),i}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?ms(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const i=this.parseError(t),s=i.message||i.toString(),a=iy(e,s);this.events.emit("payload",a)}parseError(e,t=this.url){return ry(e,t,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>uo&&this.events.setMaxListeners(uo)}}const lo="error",uy="wss://relay.walletconnect.com",ly="wc",fy="universal_provider",fo=`${ly}@${2}:${fy}:`,dy="https://rpc.walletconnect.com/v1",ir={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var py=Object.defineProperty,po=Object.getOwnPropertySymbols,gy=Object.prototype.hasOwnProperty,yy=Object.prototype.propertyIsEnumerable,go=(r,e,t)=>e in r?py(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,rs=(r,e)=>{for(var t in e||(e={}))gy.call(e,t)&&go(r,t,e[t]);if(po)for(var t of po(e))yy.call(e,t)&&go(r,t,e[t]);return r};function At(r,e,t){let i;const s=is(r);return e.rpcMap&&(i=e.rpcMap[s]),i||(i=`${dy}?chainId=eip155:${s}&projectId=${t}`),i}function is(r){return r.includes("eip155")?Number(r.split(":")[1]):Number(r)}function by(r,e){if(!e.includes(r))throw new Error(`Chain '${r}' not approved. Please use one of the following: ${e.toString()}`)}function my(r){return r.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function vy(r,e){const t=Object.keys(e.namespaces).filter(s=>s.includes(r));if(!t.length)return[];const i=[];return t.forEach(s=>{const a=e.namespaces[s].accounts;i.push(...a)}),i}function _y(r,e={}){const t=yo(r),i=yo(e);return rs({},Object.assign(t,i))}function yo(r){var e,t,i,s;const a={};if(!ur(r))return a;for(const[h,c]of Object.entries(r)){const u=Wa(h)?[h]:c.chains,g=c.methods||[],b=c.events||[],E=Ya(h);a[E]={chains:Mi(u,(e=a[E])==null?void 0:e.chains),methods:Mi(g,(t=a[E])==null?void 0:t.methods),events:Mi(b,(i=a[E])==null?void 0:i.events),rpcMap:rs(rs({},(s=a[E])==null?void 0:s.rpcMap),c.rpcMap)}}return a}function Wa(r){return r.includes(":")}function Ya(r){return Wa(r)?r.split(":")[0]:r}function Mi(r=[],e=[]){return[...new Set([...r,...e])]}const gr=(r,e)=>{const t=i=>{i.request!==e.request||i.topic!==e.topic||(r.events.removeListener("session_request_sent",t),wy(e))};r.on("session_request_sent",t)};function wy(r){if(typeof window<"u")try{const e=window.localStorage.getItem("WALLETCONNECT_DEEPLINK_CHOICE");if(e){const t=JSON.parse(e),i=t==null?void 0:t.href;if(typeof i=="string"){i.endsWith("/")&&i.slice(0,-1);const s=`${i}/wc?requestId=${r.id}&sessionTopic=${r.topic}`;window.open(s,"_self","noreferrer noopener")}}}catch(e){console.error(e)}}class Ey{constructor(e){this.name="eip155",this.namespace=e.namespace,this.client=e.client,this.events=e.events,this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){var t;switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return this.handleSwitchChain(e.request.params?(t=e.request.params[0])==null?void 0:t.chainId:"0x0"),null;case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(e.request.method)?(gr(this.client,e),await this.client.request(e)):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){const i=is(e);if(!this.httpProviders[i]){const s=t||At(`${this.name}:${i}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${i}`);this.setHttpProvider(i,s)}this.chainId=i,this.events.emit(ir.DEFAULT_CHAIN_CHANGED,`${this.name}:${i}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){const i=t||At(`${this.name}:${e}`,this.namespace,this.client.core.projectId);return typeof i>"u"?void 0:new rr(new pr(i))}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var i;const s=is(t);e[s]=this.createHttpProvider(s,(i=this.namespace.rpcMap)==null?void 0:i[t])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}handleSwitchChain(e){const t=parseInt(e,16),i=`${this.name}:${t}`;by(i,this.namespace.chains),this.setDefaultChain(`${t}`)}}class Dy{constructor(e){this.name="solana",this.namespace=e.namespace,this.events=e.events,this.client=e.client,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?(gr(this.client,e),this.client.request(e)):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const i=t||At(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.chainId=e,this.events.emit(ir.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var i;e[t]=this.createHttpProvider(t,(i=this.namespace.rpcMap)==null?void 0:i[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){const i=t||At(e,this.namespace,this.client.core.projectId);return typeof i>"u"?void 0:new rr(new pr(i))}}class Sy{constructor(e){this.name="cosmos",this.namespace=e.namespace,this.events=e.events,this.client=e.client,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?(gr(this.client,e),this.client.request(e)):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const i=t||At(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.events.emit(ir.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var i;e[t]=this.createHttpProvider(t,(i=this.namespace.rpcMap)==null?void 0:i[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){const i=t||At(e,this.namespace,this.client.core.projectId);return typeof i>"u"?void 0:new rr(new pr(i))}}class Iy{constructor(e){this.name="cip34",this.namespace=e.namespace,this.events=e.events,this.client=e.client,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?(gr(this.client,e),this.client.request(e)):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const i=t||this.getCardanoRPCUrl(e);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.events.emit(ir.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{const i=this.getCardanoRPCUrl(t);e[t]=this.createHttpProvider(t,i)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}getCardanoRPCUrl(e){const t=this.namespace.rpcMap;if(t)return t[e]}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){const i=t||this.getCardanoRPCUrl(e);return typeof i>"u"?void 0:new rr(new pr(i))}}class Oy{constructor(e){this.name="elrond",this.namespace=e.namespace,this.events=e.events,this.client=e.client,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?(gr(this.client,e),this.client.request(e)):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const i=t||At(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.chainId=e,this.events.emit(ir.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var i;e[t]=this.createHttpProvider(t,(i=this.namespace.rpcMap)==null?void 0:i[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){const i=t||At(e,this.namespace,this.client.core.projectId);return typeof i>"u"?void 0:new rr(new pr(i))}}class xy{constructor(e){this.name="multiversx",this.namespace=e.namespace,this.events=e.events,this.client=e.client,this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?(gr(this.client,e),this.client.request(e)):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const i=t||At(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.chainId=e,this.events.emit(ir.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var i;e[t]=this.createHttpProvider(t,(i=this.namespace.rpcMap)==null?void 0:i[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){const i=t||At(e,this.namespace,this.client.core.projectId);return typeof i>"u"?void 0:new rr(new pr(i))}}var Py=Object.defineProperty,Ay=Object.defineProperties,Cy=Object.getOwnPropertyDescriptors,bo=Object.getOwnPropertySymbols,Ry=Object.prototype.hasOwnProperty,Ty=Object.prototype.propertyIsEnumerable,mo=(r,e,t)=>e in r?Py(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Zr=(r,e)=>{for(var t in e||(e={}))Ry.call(e,t)&&mo(r,t,e[t]);if(bo)for(var t of bo(e))Ty.call(e,t)&&mo(r,t,e[t]);return r},ji=(r,e)=>Ay(r,Cy(e));let Ny=class Ja{constructor(e){this.events=new Ze,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.providerOpts=e,this.logger=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:jr(Se.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||lo}))}static async init(e){const t=new Ja(e);return await t.initialize(),t}async request(e,t){const[i,s]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(i).request({request:Zr({},e),chainId:`${i}:${s}`,topic:this.session.topic})}sendAsync(e,t,i){this.request(e,i).then(s=>t(null,s)).catch(s=>t(s,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:Ue("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){this.shouldAbortPairingAttempt=!1;let t=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(t>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:i,approval:s}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});i&&(this.uri=i,this.events.emit("display_uri",i)),await s().then(a=>{this.session=a}).catch(a=>{if(a.message!==Ka)throw a;t++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(e,t){try{const[i,s]=this.validateChain(e);this.getProvider(i).setDefaultChain(s,t)}catch(i){if(!/Please call connect/.test(i.message))throw i}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const t=this.client.pairing.getAll();if(Ft(t)){for(const i of t)e.deletePairings?this.client.core.expirer.set(i.topic,0):await this.client.core.relayer.subscriber.unsubscribe(i.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const e=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[e]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await k0.init({logger:this.providerOpts.logger||lo,relayUrl:this.providerOpts.relayUrl||uy,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");[...new Set(Object.keys(this.session.namespaces).map(e=>Ya(e)))].forEach(e=>{if(!this.session)return;const t=vy(e,this.session),i=my(t),s=_y(this.namespaces,this.optionalNamespaces),a=ji(Zr({},s[e]),{accounts:t,chains:i});switch(e){case"eip155":this.rpcProviders[e]=new Ey({client:this.client,namespace:a,events:this.events});break;case"solana":this.rpcProviders[e]=new Dy({client:this.client,namespace:a,events:this.events});break;case"cosmos":this.rpcProviders[e]=new Sy({client:this.client,namespace:a,events:this.events});break;case"polkadot":break;case"cip34":this.rpcProviders[e]=new Iy({client:this.client,namespace:a,events:this.events});break;case"elrond":this.rpcProviders[e]=new Oy({client:this.client,namespace:a,events:this.events});break;case"multiversx":this.rpcProviders[e]=new xy({client:this.client,namespace:a,events:this.events});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{const{params:t}=e,{event:i}=t;i.name==="accountsChanged"?this.events.emit("accountsChanged",i.data):i.name==="chainChanged"?this.onChainChanged(t.chainId):this.events.emit(i.name,i.data),this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var i;const{namespaces:s}=t,a=(i=this.client)==null?void 0:i.session.get(e);this.session=ji(Zr({},a),{namespaces:s}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",ji(Zr({},Ue("USER_DISCONNECTED")),{data:e.topic}))}),this.on(ir.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){if(!this.rpcProviders[e])throw new Error(`Provider not found: ${e}`);return this.rpcProviders[e]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace((t=this.session)==null?void 0:t.namespaces[e])})}setNamespaces(e){const{namespaces:t,optionalNamespaces:i,sessionProperties:s}=e;if(!t||!Object.keys(t).length)throw new Error("Namespaces must be not empty");this.namespaces=t,this.optionalNamespaces=i,this.sessionProperties=s,this.persist("namespaces",t),this.persist("optionalNamespaces",i)}validateChain(e){const[t,i]=(e==null?void 0:e.split(":"))||["",""];if(t&&!Object.keys(this.namespaces).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&i)return[t,i];const s=Object.keys(this.namespaces)[0],a=this.rpcProviders[s].getDefaultChain();return[s,a]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}onChainChanged(e,t=!1){const[i,s]=this.validateChain(e);t||this.getProvider(i).setDefaultChain(s),this.namespaces[i].defaultChain=s,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",s)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,await this.cleanupPendingPairings({deletePairings:!0})}persist(e,t){this.client.core.storage.setItem(`${fo}/${e}`,t)}async getFromStore(e){return await this.client.core.storage.getItem(`${fo}/${e}`)}};const Ly=Ny,Fy="wc",Uy="ethereum_provider",$y=`${Fy}@${2}:${Uy}:`,My="https://rpc.walletconnect.com/v1/",ss=["eth_sendTransaction","personal_sign"],r1=["eth_accounts","eth_requestAccounts","eth_call","eth_getBalance","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],ns=["chainChanged","accountsChanged"],i1=["message","disconnect","connect"];var jy=Object.defineProperty,Hy=Object.defineProperties,qy=Object.getOwnPropertyDescriptors,vo=Object.getOwnPropertySymbols,By=Object.prototype.hasOwnProperty,zy=Object.prototype.propertyIsEnumerable,_o=(r,e,t)=>e in r?jy(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Hi=(r,e)=>{for(var t in e||(e={}))By.call(e,t)&&_o(r,t,e[t]);if(vo)for(var t of vo(e))zy.call(e,t)&&_o(r,t,e[t]);return r},wo=(r,e)=>Hy(r,qy(e));function os(r){return Number(r[0].split(":")[1])}function qi(r){return`0x${r.toString(16)}`}function Ky(r){const{chains:e,optionalChains:t,methods:i,optionalMethods:s,events:a,optionalEvents:h,rpcMap:c}=r;if(!Ft(e))throw new Error("Invalid chains");const u=e,g=i||ss,b=a||ns,E={[os(u)]:c[os(u)]},F={chains:u,methods:g,events:b,rpcMap:E},I=a==null?void 0:a.filter(V=>!ns.includes(V)),w=i==null?void 0:i.filter(V=>!ss.includes(V));if(!t&&!h&&!s&&!(I!=null&&I.length)&&!(w!=null&&w.length))return{required:F};const j=(I==null?void 0:I.length)&&(w==null?void 0:w.length)||!t,M={chains:[...new Set(j?u.concat(t||[]):t)],methods:[...new Set(g.concat(s||[]))],events:[...new Set(b.concat(h||[]))],rpcMap:c};return{required:F,optional:M}}class Ps{constructor(){this.events=new Ze.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=$y,this.on=(e,t)=>(this.events.on(e,t),this),this.once=(e,t)=>(this.events.once(e,t),this),this.removeListener=(e,t)=>(this.events.removeListener(e,t),this),this.off=(e,t)=>(this.events.off(e,t),this),this.parseAccount=e=>this.isCompatibleChainId(e)?this.parseAccountId(e).address:e,this.signer={},this.rpc={}}static async init(e){const t=new Ps;return await t.initialize(e),t}async request(e){return await this.signer.request(e,this.formatChainId(this.chainId))}sendAsync(e,t){this.signer.sendAsync(e,t,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(e){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(e);const{required:t,optional:i}=Ky(this.rpc);try{const s=await new Promise(async(h,c)=>{var u;this.rpc.showQrModal&&((u=this.modal)==null||u.subscribeModal(g=>{!g.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),c(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(wo(Hi({namespaces:{[this.namespace]:t}},i&&{optionalNamespaces:{[this.namespace]:i}}),{pairingTopic:e==null?void 0:e.pairingTopic})).then(g=>{h(g)}).catch(g=>{c(new Error(g.message))})});if(!s)return;this.setChainIds(this.rpc.chains);const a=ml(s.namespaces,[this.namespace]);this.setAccounts(a),this.events.emit("connect",{chainId:qi(this.chainId)})}catch(s){throw this.signer.logger.error(s),s}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",e=>{const{params:t}=e,{event:i}=t;i.name==="accountsChanged"?(this.accounts=this.parseAccounts(i.data),this.events.emit("accountsChanged",this.accounts)):i.name==="chainChanged"?this.setChainId(this.formatChainId(i.data)):this.events.emit(i.name,i.data),this.events.emit("session_event",e)}),this.signer.on("chainChanged",e=>{const t=parseInt(e);this.chainId=t,this.events.emit("chainChanged",qi(this.chainId)),this.persist()}),this.signer.on("session_update",e=>{this.events.emit("session_update",e)}),this.signer.on("session_delete",e=>{this.reset(),this.events.emit("session_delete",e),this.events.emit("disconnect",wo(Hi({},Ue("USER_DISCONNECTED")),{data:e.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",e=>{var t,i;this.rpc.showQrModal&&((t=this.modal)==null||t.closeModal(),(i=this.modal)==null||i.openModal({uri:e})),this.events.emit("display_uri",e)})}setHttpProvider(e){this.request({method:"wallet_switchEthereumChain",params:[{chainId:e.toString(16)}]})}isCompatibleChainId(e){return typeof e=="string"?e.startsWith(`${this.namespace}:`):!1}formatChainId(e){return`${this.namespace}:${e}`}parseChainId(e){return Number(e.split(":")[1])}setChainIds(e){const t=e.filter(i=>this.isCompatibleChainId(i)).map(i=>this.parseChainId(i));t.length&&(this.chainId=t[0],this.events.emit("chainChanged",qi(this.chainId)),this.persist())}setChainId(e){if(this.isCompatibleChainId(e)){const t=this.parseChainId(e);this.chainId=t,this.setHttpProvider(t)}}parseAccountId(e){const[t,i,s]=e.split(":");return{chainId:`${t}:${i}`,address:s}}setAccounts(e){this.accounts=e.filter(t=>this.parseChainId(this.parseAccountId(t).chainId)===this.chainId).map(t=>this.parseAccountId(t).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(e){var t,i;return{chains:((t=e.chains)==null?void 0:t.map(s=>this.formatChainId(s)))||[`${this.namespace}:1`],optionalChains:e.optionalChains?e.optionalChains.map(s=>this.formatChainId(s)):void 0,methods:(e==null?void 0:e.methods)||ss,events:(e==null?void 0:e.events)||ns,optionalMethods:(e==null?void 0:e.optionalMethods)||[],optionalEvents:(e==null?void 0:e.optionalEvents)||[],rpcMap:(e==null?void 0:e.rpcMap)||this.buildRpcMap(e.chains.concat(e.optionalChains||[]),e.projectId),showQrModal:Boolean(e==null?void 0:e.showQrModal),qrModalOptions:(i=e==null?void 0:e.qrModalOptions)!=null?i:void 0,projectId:e.projectId,metadata:e.metadata}}buildRpcMap(e,t){const i={};return e.forEach(s=>{i[s]=this.getRpcUrl(s,t)}),i}async initialize(e){if(this.rpc=this.getRpcConfig(e),this.chainId=os(this.rpc.chains),this.signer=await Ly.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal)try{const{Web3Modal:t}=await qc(()=>import("./index-966e0b07.js").then(i=>i.a),["assets/index-966e0b07.js","assets/index-52750c41.js","assets/index-ee7bdf8e.css"]);this.modal=new t(Hi({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch{throw new Error("To use QR modal, please install @web3modal/standalone package")}}loadConnectOpts(e){if(!e)return;const{chains:t,optionalChains:i,rpcMap:s}=e;t&&Ft(t)&&(this.rpc.chains=t.map(a=>this.formatChainId(a)),t.forEach(a=>{this.rpc.rpcMap[a]=(s==null?void 0:s[a])||this.getRpcUrl(a)})),i&&Ft(i)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=i==null?void 0:i.map(a=>this.formatChainId(a)),i.forEach(a=>{this.rpc.rpcMap[a]=(s==null?void 0:s[a])||this.getRpcUrl(a)}))}getRpcUrl(e,t){var i;return((i=this.rpc.rpcMap)==null?void 0:i[e])||`${My}?chainId=eip155:${e}&projectId=${t||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const e=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`);this.setChainIds(e?[this.formatChainId(e)]:this.session.namespaces[this.namespace].accounts),this.setAccounts(this.session.namespaces[this.namespace].accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(e){return typeof e=="string"||e instanceof String?[this.parseAccount(e)]:e.map(t=>this.parseAccount(t))}}const s1=Ps;export{s1 as EthereumProvider,i1 as OPTIONAL_EVENTS,r1 as OPTIONAL_METHODS,ns as REQUIRED_EVENTS,ss as REQUIRED_METHODS,Ps as default};
